function q(t){throw t}!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){var i=[],n=t.document,o=i.slice,s=i.concat,a=i.push,r=i.indexOf,l={},c=l.toString,d=l.hasOwnProperty,u={},h="2.2.4",p=function(t,e){return new p.fn.init(t,e)},f=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,m=/^-ms-/,g=/-([\da-z])/gi,v=function(t,e){return e.toUpperCase()};function b(t){var e=!!t&&"length"in t&&t.length,i=p.type(t);return"function"!==i&&!p.isWindow(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}p.fn=p.prototype={jquery:h,constructor:p,selector:"",length:0,toArray:function(){return o.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:o.call(this)},pushStack:function(t){var e=p.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t){return p.each(this,t)},map:function(t){return this.pushStack(p.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:i.sort,splice:i.splice},p.extend=p.fn.extend=function(){var t,e,i,n,o,s,a=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[r]||{},r++),"object"==typeof a||p.isFunction(a)||(a={}),r===l&&(a=this,r--);l>r;r++)if(null!=(t=arguments[r]))for(e in t)i=a[e],a!==(n=t[e])&&(c&&n&&(p.isPlainObject(n)||(o=p.isArray(n)))?(o?(o=!1,s=i&&p.isArray(i)?i:[]):s=i&&p.isPlainObject(i)?i:{},a[e]=p.extend(c,s,n)):void 0!==n&&(a[e]=n));return a},p.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===p.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=t&&t.toString();return!p.isArray(t)&&e-parseFloat(e)+1>=0},isPlainObject:function(t){var e;if("object"!==p.type(t)||t.nodeType||p.isWindow(t))return!1;if(t.constructor&&!d.call(t,"constructor")&&!d.call(t.constructor.prototype||{},"isPrototypeOf"))return!1;for(e in t);return void 0===e||d.call(t,e)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[c.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;(t=p.trim(t))&&(1===t.indexOf("use strict")?((e=n.createElement("script")).text=t,n.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(m,"ms-").replace(g,v)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e){var i,n=0;if(b(t))for(i=t.length;i>n&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(f,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(b(Object(t))?p.merge(i,"string"==typeof t?[t]:t):a.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:r.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;i>n;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,s=t.length,a=!i;s>o;o++)!e(t[o],o)!==a&&n.push(t[o]);return n},map:function(t,e,i){var n,o,a=0,r=[];if(b(t))for(n=t.length;n>a;a++)null!=(o=e(t[a],a,i))&&r.push(o);else for(a in t)null!=(o=e(t[a],a,i))&&r.push(o);return s.apply([],r)},guid:1,proxy:function(t,e){var i,n,s;return"string"==typeof e&&(i=t[e],e=t,t=i),p.isFunction(t)?(n=o.call(arguments,2),s=function(){return t.apply(e||this,n.concat(o.call(arguments)))},s.guid=t.guid=t.guid||p.guid++,s):void 0},now:Date.now,support:u}),"function"==typeof Symbol&&(p.fn[Symbol.iterator]=i[Symbol.iterator]),p.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){l["[object "+e+"]"]=e.toLowerCase()}));var y=function(t){var e,i,n,o,s,a,r,l,c,d,u,h,p,f,m,g,v,b,y,_="sizzle"+1*new Date,w=t.document,x=0,k=0,S=st(),T=st(),C=st(),D=function(t,e){return t===e&&(u=!0),0},M=1<<31,O={}.hasOwnProperty,P=[],E=P.pop,A=P.push,I=P.push,L=P.slice,N=function(t,e){for(var i=0,n=t.length;n>i;i++)if(t[i]===e)return i;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",R="[\\x20\\t\\r\\n\\f]",$="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",B="\\["+R+"*("+$+")(?:"+R+"*([*^$|!~]?=)"+R+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+$+"))|)"+R+"*\\]",F=":("+$+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",H=new RegExp(R+"+","g"),W=new RegExp("^"+R+"+|((?:^|[^\\\\])(?:\\\\.)*)"+R+"+$","g"),U=new RegExp("^"+R+"*,"+R+"*"),q=new RegExp("^"+R+"*([>+~]|"+R+")"+R+"*"),z=new RegExp("="+R+"*([^\\]'\"]*?)"+R+"*\\]","g"),V=new RegExp(F),Y=new RegExp("^"+$+"$"),G={ID:new RegExp("^#("+$+")"),CLASS:new RegExp("^\\.("+$+")"),TAG:new RegExp("^("+$+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+R+"*(even|odd|(([+-]|)(\\d*)n|)"+R+"*(?:([+-]|)"+R+"*(\\d+)|))"+R+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+R+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+R+"*((?:-\\d)?\\d*)"+R+"*\\)|)(?=[^-]|$)","i")},K=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,J=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/[+~]/,tt=/'|\\/g,et=new RegExp("\\\\([\\da-f]{1,6}"+R+"?|("+R+")|.)","ig"),it=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},nt=function(){h()};try{I.apply(P=L.call(w.childNodes),w.childNodes),P[w.childNodes.length].nodeType}catch(t){I={apply:P.length?function(t,e){A.apply(t,L.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function ot(t,e,n,o){var s,r,c,d,u,f,v,b,x=e&&e.ownerDocument,k=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==k&&9!==k&&11!==k)return n;if(!o&&((e?e.ownerDocument||e:w)!==p&&h(e),e=e||p,m)){if(11!==k&&(f=Q.exec(t)))if(s=f[1]){if(9===k){if(!(c=e.getElementById(s)))return n;if(c.id===s)return n.push(c),n}else if(x&&(c=x.getElementById(s))&&y(e,c)&&c.id===s)return n.push(c),n}else{if(f[2])return I.apply(n,e.getElementsByTagName(t)),n;if((s=f[3])&&i.getElementsByClassName&&e.getElementsByClassName)return I.apply(n,e.getElementsByClassName(s)),n}if(i.qsa&&!C[t+" "]&&(!g||!g.test(t))){if(1!==k)x=e,b=t;else if("object"!==e.nodeName.toLowerCase()){for((d=e.getAttribute("id"))?d=d.replace(tt,"\\$&"):e.setAttribute("id",d=_),r=(v=a(t)).length,u=Y.test(d)?"#"+d:"[id='"+d+"']";r--;)v[r]=u+" "+mt(v[r]);b=v.join(","),x=Z.test(t)&&pt(e.parentNode)||e}if(b)try{return I.apply(n,x.querySelectorAll(b)),n}catch(t){}finally{d===_&&e.removeAttribute("id")}}}return l(t.replace(W,"$1"),e,n,o)}function st(){var t=[];return function e(i,o){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=o}}function at(t){return t[_]=!0,t}function rt(t){var e=p.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function lt(t,e){for(var i=t.split("|"),o=i.length;o--;)n.attrHandle[i[o]]=e}function ct(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||M)-(~t.sourceIndex||M);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function dt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ut(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function ht(t){return at((function(e){return e=+e,at((function(i,n){for(var o,s=t([],i.length,e),a=s.length;a--;)i[o=s[a]]&&(i[o]=!(n[o]=i[o]))}))}))}function pt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in i=ot.support={},s=ot.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},h=ot.setDocument=function(t){var e,o,a=t?t.ownerDocument||t:w;return a!==p&&9===a.nodeType&&a.documentElement?(f=(p=a).documentElement,m=!s(p),(o=p.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",nt,!1):o.attachEvent&&o.attachEvent("onunload",nt)),i.attributes=rt((function(t){return t.className="i",!t.getAttribute("className")})),i.getElementsByTagName=rt((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),i.getElementsByClassName=J.test(p.getElementsByClassName),i.getById=rt((function(t){return f.appendChild(t).id=_,!p.getElementsByName||!p.getElementsByName(_).length})),i.getById?(n.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var i=e.getElementById(t);return i?[i]:[]}},n.filter.ID=function(t){var e=t.replace(et,it);return function(t){return t.getAttribute("id")===e}}):(delete n.find.ID,n.filter.ID=function(t){var e=t.replace(et,it);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}}),n.find.TAG=i.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):i.qsa?e.querySelectorAll(t):void 0}:function(t,e){var i,n=[],o=0,s=e.getElementsByTagName(t);if("*"===t){for(;i=s[o++];)1===i.nodeType&&n.push(i);return n}return s},n.find.CLASS=i.getElementsByClassName&&function(t,e){return void 0!==e.getElementsByClassName&&m?e.getElementsByClassName(t):void 0},v=[],g=[],(i.qsa=J.test(p.querySelectorAll))&&(rt((function(t){f.appendChild(t).innerHTML="<a id='"+_+"'></a><select id='"+_+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+R+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+R+"*(?:value|"+j+")"),t.querySelectorAll("[id~="+_+"-]").length||g.push("~="),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+_+"+*").length||g.push(".#.+[+~]")})),rt((function(t){var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+R+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(i.matchesSelector=J.test(b=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&rt((function(t){i.disconnectedMatch=b.call(t,"div"),b.call(t,"[s!='']:x"),v.push("!=",F)})),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=J.test(f.compareDocumentPosition),y=e||J.test(f.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},D=e?function(t,e){if(t===e)return u=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===n?t===p||t.ownerDocument===w&&y(w,t)?-1:e===p||e.ownerDocument===w&&y(w,e)?1:d?N(d,t)-N(d,e):0:4&n?-1:1)}:function(t,e){if(t===e)return u=!0,0;var i,n=0,o=t.parentNode,s=e.parentNode,a=[t],r=[e];if(!o||!s)return t===p?-1:e===p?1:o?-1:s?1:d?N(d,t)-N(d,e):0;if(o===s)return ct(t,e);for(i=t;i=i.parentNode;)a.unshift(i);for(i=e;i=i.parentNode;)r.unshift(i);for(;a[n]===r[n];)n++;return n?ct(a[n],r[n]):a[n]===w?-1:r[n]===w?1:0},p):p},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&h(t),e=e.replace(z,"='$1']"),i.matchesSelector&&m&&!C[e+" "]&&(!v||!v.test(e))&&(!g||!g.test(e)))try{var n=b.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return ot(e,p,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!==p&&h(t),y(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==p&&h(t);var o=n.attrHandle[e.toLowerCase()],s=o&&O.call(n.attrHandle,e.toLowerCase())?o(t,e,!m):void 0;return void 0!==s?s:i.attributes||!m?t.getAttribute(e):(s=t.getAttributeNode(e))&&s.specified?s.value:null},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,n=[],o=0,s=0;if(u=!i.detectDuplicates,d=!i.sortStable&&t.slice(0),t.sort(D),u){for(;e=t[s++];)e===t[s]&&(o=n.push(s));for(;o--;)t.splice(n[o],1)}return d=null,t},o=ot.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=o(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n++];)i+=o(e);return i},n=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,it),t[3]=(t[3]||t[4]||t[5]||"").replace(et,it),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return G.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&V.test(i)&&(e=a(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+R+")"+t+"("+R+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var o=ot.attr(n,t);return null==o?"!="===e:!e||(o+="","="===e?o===i:"!="===e?o!==i:"^="===e?i&&0===o.indexOf(i):"*="===e?i&&o.indexOf(i)>-1:"$="===e?i&&o.slice(-i.length)===i:"~="===e?(" "+o.replace(H," ")+" ").indexOf(i)>-1:"|="===e&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,o){var s="nth"!==t.slice(0,3),a="last"!==t.slice(-4),r="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var c,d,u,h,p,f,m=s!==a?"nextSibling":"previousSibling",g=e.parentNode,v=r&&e.nodeName.toLowerCase(),b=!l&&!r,y=!1;if(g){if(s){for(;m;){for(h=e;h=h[m];)if(r?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&b){for(y=(p=(c=(d=(u=(h=g)[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[t]||[])[0]===x&&c[1])&&c[2],h=p&&g.childNodes[p];h=++p&&h&&h[m]||(y=p=0)||f.pop();)if(1===h.nodeType&&++y&&h===e){d[t]=[x,p,y];break}}else if(b&&(y=p=(c=(d=(u=(h=e)[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[t]||[])[0]===x&&c[1]),!1===y)for(;(h=++p&&h&&h[m]||(y=p=0)||f.pop())&&((r?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++y||(b&&((d=(u=h[_]||(h[_]={}))[h.uniqueID]||(u[h.uniqueID]={}))[t]=[x,y]),h!==e)););return(y-=o)===n||y%n==0&&y/n>=0}}},PSEUDO:function(t,e){var i,o=n.pseudos[t]||n.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return o[_]?o(e):o.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?at((function(t,i){for(var n,s=o(t,e),a=s.length;a--;)t[n=N(t,s[a])]=!(i[n]=s[a])})):function(t){return o(t,0,i)}):o}},pseudos:{not:at((function(t){var e=[],i=[],n=r(t.replace(W,"$1"));return n[_]?at((function(t,e,i,o){for(var s,a=n(t,null,o,[]),r=t.length;r--;)(s=a[r])&&(t[r]=!(e[r]=s))})):function(t,o,s){return e[0]=t,n(e,null,s,i),e[0]=null,!i.pop()}})),has:at((function(t){return function(e){return ot(t,e).length>0}})),contains:at((function(t){return t=t.replace(et,it),function(e){return(e.textContent||e.innerText||o(e)).indexOf(t)>-1}})),lang:at((function(t){return Y.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(et,it).toLowerCase(),function(e){var i;do{if(i=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return X.test(t.nodeName)},input:function(t){return K.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ht((function(){return[0]})),last:ht((function(t,e){return[e-1]})),eq:ht((function(t,e,i){return[0>i?i+e:i]})),even:ht((function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t})),odd:ht((function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t})),lt:ht((function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t})),gt:ht((function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t}))}},n.pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=dt(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ut(e);function ft(){}function mt(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function gt(t,e,i){var n=e.dir,o=i&&"parentNode"===n,s=k++;return e.first?function(e,i,s){for(;e=e[n];)if(1===e.nodeType||o)return t(e,i,s)}:function(e,i,a){var r,l,c,d=[x,s];if(a){for(;e=e[n];)if((1===e.nodeType||o)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||o){if((r=(l=(c=e[_]||(e[_]={}))[e.uniqueID]||(c[e.uniqueID]={}))[n])&&r[0]===x&&r[1]===s)return d[2]=r[2];if(l[n]=d,d[2]=t(e,i,a))return!0}}}function vt(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function bt(t,e,i,n,o){for(var s,a=[],r=0,l=t.length,c=null!=e;l>r;r++)(s=t[r])&&(i&&!i(s,n,o)||(a.push(s),c&&e.push(r)));return a}function yt(t,e,i,n,o,s){return n&&!n[_]&&(n=yt(n)),o&&!o[_]&&(o=yt(o,s)),at((function(s,a,r,l){var c,d,u,h=[],p=[],f=a.length,m=s||function(t,e,i){for(var n=0,o=e.length;o>n;n++)ot(t,e[n],i);return i}(e||"*",r.nodeType?[r]:r,[]),g=!t||!s&&e?m:bt(m,h,t,r,l),v=i?o||(s?t:f||n)?[]:a:g;if(i&&i(g,v,r,l),n)for(c=bt(v,p),n(c,[],r,l),d=c.length;d--;)(u=c[d])&&(v[p[d]]=!(g[p[d]]=u));if(s){if(o||t){if(o){for(c=[],d=v.length;d--;)(u=v[d])&&c.push(g[d]=u);o(null,v=[],c,l)}for(d=v.length;d--;)(u=v[d])&&(c=o?N(s,u):h[d])>-1&&(s[c]=!(a[c]=u))}}else v=bt(v===a?v.splice(f,v.length):v),o?o(null,a,v,l):I.apply(a,v)}))}function _t(t){for(var e,i,o,s=t.length,a=n.relative[t[0].type],r=a||n.relative[" "],l=a?1:0,d=gt((function(t){return t===e}),r,!0),u=gt((function(t){return N(e,t)>-1}),r,!0),h=[function(t,i,n){var o=!a&&(n||i!==c)||((e=i).nodeType?d(t,i,n):u(t,i,n));return e=null,o}];s>l;l++)if(i=n.relative[t[l].type])h=[gt(vt(h),i)];else{if((i=n.filter[t[l].type].apply(null,t[l].matches))[_]){for(o=++l;s>o&&!n.relative[t[o].type];o++);return yt(l>1&&vt(h),l>1&&mt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(W,"$1"),i,o>l&&_t(t.slice(l,o)),s>o&&_t(t=t.slice(o)),s>o&&mt(t))}h.push(i)}return vt(h)}function wt(t,e){var i=e.length>0,o=t.length>0,s=function(s,a,r,l,d){var u,f,g,v=0,b="0",y=s&&[],_=[],w=c,k=s||o&&n.find.TAG("*",d),S=x+=null==w?1:Math.random()||.1,T=k.length;for(d&&(c=a===p||a||d);b!==T&&null!=(u=k[b]);b++){if(o&&u){for(f=0,a||u.ownerDocument===p||(h(u),r=!m);g=t[f++];)if(g(u,a||p,r)){l.push(u);break}d&&(x=S)}i&&((u=!g&&u)&&v--,s&&y.push(u))}if(v+=b,i&&b!==v){for(f=0;g=e[f++];)g(y,_,a,r);if(s){if(v>0)for(;b--;)y[b]||_[b]||(_[b]=E.call(l));_=bt(_)}I.apply(l,_),d&&!s&&_.length>0&&v+e.length>1&&ot.uniqueSort(l)}return d&&(x=S,c=w),y};return i?at(s):s}return ft.prototype=n.filters=n.pseudos,n.setFilters=new ft,a=ot.tokenize=function(t,e){var i,o,s,a,r,l,c,d=T[t+" "];if(d)return e?0:d.slice(0);for(r=t,l=[],c=n.preFilter;r;){for(a in i&&!(o=U.exec(r))||(o&&(r=r.slice(o[0].length)||r),l.push(s=[])),i=!1,(o=q.exec(r))&&(i=o.shift(),s.push({value:i,type:o[0].replace(W," ")}),r=r.slice(i.length)),n.filter)!(o=G[a].exec(r))||c[a]&&!(o=c[a](o))||(i=o.shift(),s.push({value:i,type:a,matches:o}),r=r.slice(i.length));if(!i)break}return e?r.length:r?ot.error(t):T(t,l).slice(0)},r=ot.compile=function(t,e){var i,n=[],o=[],s=C[t+" "];if(!s){for(e||(e=a(t)),i=e.length;i--;)(s=_t(e[i]))[_]?n.push(s):o.push(s);(s=C(t,wt(o,n))).selector=t}return s},l=ot.select=function(t,e,o,s){var l,c,d,u,h,p="function"==typeof t&&t,f=!s&&a(t=p.selector||t);if(o=o||[],1===f.length){if((c=f[0]=f[0].slice(0)).length>2&&"ID"===(d=c[0]).type&&i.getById&&9===e.nodeType&&m&&n.relative[c[1].type]){if(!(e=(n.find.ID(d.matches[0].replace(et,it),e)||[])[0]))return o;p&&(e=e.parentNode),t=t.slice(c.shift().value.length)}for(l=G.needsContext.test(t)?0:c.length;l--&&(d=c[l],!n.relative[u=d.type]);)if((h=n.find[u])&&(s=h(d.matches[0].replace(et,it),Z.test(c[0].type)&&pt(e.parentNode)||e))){if(c.splice(l,1),!(t=s.length&&mt(c)))return I.apply(o,s),o;break}}return(p||r(t,f))(s,e,!m,o,!e||Z.test(t)&&pt(e.parentNode)||e),o},i.sortStable=_.split("").sort(D).join("")===_,i.detectDuplicates=!!u,h(),i.sortDetached=rt((function(t){return 1&t.compareDocumentPosition(p.createElement("div"))})),rt((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||lt("type|href|height|width",(function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),i.attributes&&rt((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||lt("value",(function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue})),rt((function(t){return null==t.getAttribute("disabled")}))||lt(j,(function(t,e,i){var n;return i?void 0:!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null})),ot}(t);p.find=y,p.expr=y.selectors,p.expr[":"]=p.expr.pseudos,p.uniqueSort=p.unique=y.uniqueSort,p.text=y.getText,p.isXMLDoc=y.isXML,p.contains=y.contains;var _=function(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&p(t).is(i))break;n.push(t)}return n},w=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},x=p.expr.match.needsContext,k=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,S=/^.[^:#\[\.,]*$/;function T(t,e,i){if(p.isFunction(e))return p.grep(t,(function(t,n){return!!e.call(t,n,t)!==i}));if(e.nodeType)return p.grep(t,(function(t){return t===e!==i}));if("string"==typeof e){if(S.test(e))return p.filter(e,t,i);e=p.filter(e,t)}return p.grep(t,(function(t){return r.call(e,t)>-1!==i}))}p.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?p.find.matchesSelector(n,t)?[n]:[]:p.find.matches(t,p.grep(e,(function(t){return 1===t.nodeType})))},p.fn.extend({find:function(t){var e,i=this.length,n=[],o=this;if("string"!=typeof t)return this.pushStack(p(t).filter((function(){for(e=0;i>e;e++)if(p.contains(o[e],this))return!0})));for(e=0;i>e;e++)p.find(t,o[e],n);return(n=this.pushStack(i>1?p.unique(n):n)).selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(T(this,t||[],!1))},not:function(t){return this.pushStack(T(this,t||[],!0))},is:function(t){return!!T(this,"string"==typeof t&&x.test(t)?p(t):t||[],!1).length}});var C,D=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,M=p.fn.init=function(t,e,i){var o,s;if(!t)return this;if(i=i||C,"string"==typeof t){if(!(o="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:D.exec(t))||!o[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(o[1]){if(e=e instanceof p?e[0]:e,p.merge(this,p.parseHTML(o[1],e&&e.nodeType?e.ownerDocument||e:n,!0)),k.test(o[1])&&p.isPlainObject(e))for(o in e)p.isFunction(this[o])?this[o](e[o]):this.attr(o,e[o]);return this}return(s=n.getElementById(o[2]))&&s.parentNode&&(this.length=1,this[0]=s),this.context=n,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):p.isFunction(t)?void 0!==i.ready?i.ready(t):t(p):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),p.makeArray(t,this))};M.prototype=p.fn,C=p(n);var O=/^(?:parents|prev(?:Until|All))/,P={children:!0,contents:!0,next:!0,prev:!0};function E(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}p.fn.extend({has:function(t){var e=p(t,this),i=e.length;return this.filter((function(){for(var t=0;i>t;t++)if(p.contains(this,e[t]))return!0}))},closest:function(t,e){for(var i,n=0,o=this.length,s=[],a=x.test(t)||"string"!=typeof t?p(t,e||this.context):0;o>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&p.find.matchesSelector(i,t))){s.push(i);break}return this.pushStack(s.length>1?p.uniqueSort(s):s)},index:function(t){return t?"string"==typeof t?r.call(p(t),this[0]):r.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(p.uniqueSort(p.merge(this.get(),p(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),p.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return _(t,"parentNode")},parentsUntil:function(t,e,i){return _(t,"parentNode",i)},next:function(t){return E(t,"nextSibling")},prev:function(t){return E(t,"previousSibling")},nextAll:function(t){return _(t,"nextSibling")},prevAll:function(t){return _(t,"previousSibling")},nextUntil:function(t,e,i){return _(t,"nextSibling",i)},prevUntil:function(t,e,i){return _(t,"previousSibling",i)},siblings:function(t){return w((t.parentNode||{}).firstChild,t)},children:function(t){return w(t.firstChild)},contents:function(t){return t.contentDocument||p.merge([],t.childNodes)}},(function(t,e){p.fn[t]=function(i,n){var o=p.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=p.filter(n,o)),this.length>1&&(P[t]||p.uniqueSort(o),O.test(t)&&o.reverse()),this.pushStack(o)}}));var A,I=/\S+/g;function L(){n.removeEventListener("DOMContentLoaded",L),t.removeEventListener("load",L),p.ready()}p.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return p.each(t.match(I)||[],(function(t,i){e[i]=!0})),e}(t):p.extend({},t);var e,i,n,o,s=[],a=[],r=-1,l=function(){for(o=t.once,n=e=!0;a.length;r=-1)for(i=a.shift();++r<s.length;)!1===s[r].apply(i[0],i[1])&&t.stopOnFalse&&(r=s.length,i=!1);t.memory||(i=!1),e=!1,o&&(s=i?[]:"")},c={add:function(){return s&&(i&&!e&&(r=s.length-1,a.push(i)),function e(i){p.each(i,(function(i,n){p.isFunction(n)?t.unique&&c.has(n)||s.push(n):n&&n.length&&"string"!==p.type(n)&&e(n)}))}(arguments),i&&!e&&l()),this},remove:function(){return p.each(arguments,(function(t,e){for(var i;(i=p.inArray(e,s,i))>-1;)s.splice(i,1),r>=i&&r--})),this},has:function(t){return t?p.inArray(t,s)>-1:s.length>0},empty:function(){return s&&(s=[]),this},disable:function(){return o=a=[],s=i="",this},disabled:function(){return!s},lock:function(){return o=a=[],i||(s=i=""),this},locked:function(){return!!o},fireWith:function(t,i){return o||(i=[t,(i=i||[]).slice?i.slice():i],a.push(i),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!n}};return c},p.extend({Deferred:function(t){var e=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return p.Deferred((function(i){p.each(e,(function(e,s){var a=p.isFunction(t[e])&&t[e];o[s[1]]((function(){var t=a&&a.apply(this,arguments);t&&p.isFunction(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[s[0]+"With"](this===n?i.promise():this,a?[t]:arguments)}))})),t=null})).promise()},promise:function(t){return null!=t?p.extend(t,n):n}},o={};return n.pipe=n.then,p.each(e,(function(t,s){var a=s[2],r=s[3];n[s[1]]=a.add,r&&a.add((function(){i=r}),e[1^t][2].disable,e[2][2].lock),o[s[0]]=function(){return o[s[0]+"With"](this===o?n:this,arguments),this},o[s[0]+"With"]=a.fireWith})),n.promise(o),t&&t.call(o,o),o},when:function(t){var e,i,n,s=0,a=o.call(arguments),r=a.length,l=1!==r||t&&p.isFunction(t.promise)?r:0,c=1===l?t:p.Deferred(),d=function(t,i,n){return function(s){i[t]=this,n[t]=arguments.length>1?o.call(arguments):s,n===e?c.notifyWith(i,n):--l||c.resolveWith(i,n)}};if(r>1)for(e=new Array(r),i=new Array(r),n=new Array(r);r>s;s++)a[s]&&p.isFunction(a[s].promise)?a[s].promise().progress(d(s,i,e)).done(d(s,n,a)).fail(c.reject):--l;return l||c.resolveWith(n,a),c.promise()}}),p.fn.ready=function(t){return p.ready.promise().done(t),this},p.extend({isReady:!1,readyWait:1,holdReady:function(t){t?p.readyWait++:p.ready(!0)},ready:function(t){(!0===t?--p.readyWait:p.isReady)||(p.isReady=!0,!0!==t&&--p.readyWait>0||(A.resolveWith(n,[p]),p.fn.triggerHandler&&(p(n).triggerHandler("ready"),p(n).off("ready"))))}}),p.ready.promise=function(e){return A||(A=p.Deferred(),"complete"===n.readyState||"loading"!==n.readyState&&!n.documentElement.doScroll?t.setTimeout(p.ready):(n.addEventListener("DOMContentLoaded",L),t.addEventListener("load",L))),A.promise(e)},p.ready.promise();var N=function(t,e,i,n,o,s,a){var r=0,l=t.length,c=null==i;if("object"===p.type(i))for(r in o=!0,i)N(t,e,r,i[r],!0,s,a);else if(void 0!==n&&(o=!0,p.isFunction(n)||(a=!0),c&&(a?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(p(t),i)})),e))for(;l>r;r++)e(t[r],i,a?n:n.call(t[r],r,e(t[r],i)));return o?t:c?e.call(t):l?e(t[0],i):s},j=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function R(){this.expando=p.expando+R.uid++}R.uid=1,R.prototype={register:function(t,e){var i=e||{};return t.nodeType?t[this.expando]=i:Object.defineProperty(t,this.expando,{value:i,writable:!0,configurable:!0}),t[this.expando]},cache:function(t){if(!j(t))return{};var e=t[this.expando];return e||(e={},j(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,o=this.cache(t);if("string"==typeof e)o[e]=i;else for(n in e)o[n]=e[n];return o},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?void 0!==(n=this.get(t,e))?n:this.get(t,p.camelCase(e)):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,o,s=t[this.expando];if(void 0!==s){if(void 0===e)this.register(t);else{p.isArray(e)?n=e.concat(e.map(p.camelCase)):(o=p.camelCase(e),e in s?n=[e,o]:n=(n=o)in s?[n]:n.match(I)||[]),i=n.length;for(;i--;)delete s[n[i]]}(void 0===e||p.isEmptyObject(s))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!p.isEmptyObject(e)}};var $=new R,B=new R,F=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,H=/[A-Z]/g;function W(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(H,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:F.test(i)?p.parseJSON(i):i)}catch(t){}B.set(t,e,i)}else i=void 0;return i}p.extend({hasData:function(t){return B.hasData(t)||$.hasData(t)},data:function(t,e,i){return B.access(t,e,i)},removeData:function(t,e){B.remove(t,e)},_data:function(t,e,i){return $.access(t,e,i)},_removeData:function(t,e){$.remove(t,e)}}),p.fn.extend({data:function(t,e){var i,n,o,s=this[0],a=s&&s.attributes;if(void 0===t){if(this.length&&(o=B.get(s),1===s.nodeType&&!$.get(s,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&(0===(n=a[i].name).indexOf("data-")&&(n=p.camelCase(n.slice(5)),W(s,n,o[n])));$.set(s,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each((function(){B.set(this,t)})):N(this,(function(e){var i,n;if(s&&void 0===e){if(void 0!==(i=B.get(s,t)||B.get(s,t.replace(H,"-$&").toLowerCase())))return i;if(n=p.camelCase(t),void 0!==(i=B.get(s,n)))return i;if(void 0!==(i=W(s,n,void 0)))return i}else n=p.camelCase(t),this.each((function(){var i=B.get(this,n);B.set(this,n,e),t.indexOf("-")>-1&&void 0!==i&&B.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){B.remove(this,t)}))}}),p.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=$.get(t,e),i&&(!n||p.isArray(i)?n=$.access(t,e,p.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=p.queue(t,e),n=i.length,o=i.shift(),s=p._queueHooks(t,e);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete s.stop,o.call(t,(function(){p.dequeue(t,e)}),s)),!n&&s&&s.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return $.get(t,i)||$.access(t,i,{empty:p.Callbacks("once memory").add((function(){$.remove(t,[e+"queue",i])}))})}}),p.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?p.queue(this[0],t):void 0===e?this:this.each((function(){var i=p.queue(this,t,e);p._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&p.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){p.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,o=p.Deferred(),s=this,a=this.length,r=function(){--n||o.resolveWith(s,[s])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(i=$.get(s[a],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(r));return r(),o.promise(e)}});var U=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,q=new RegExp("^(?:([+-])=|)("+U+")([a-z%]*)$","i"),z=["Top","Right","Bottom","Left"],V=function(t,e){return t=e||t,"none"===p.css(t,"display")||!p.contains(t.ownerDocument,t)};function Y(t,e,i,n){var o,s=1,a=20,r=n?function(){return n.cur()}:function(){return p.css(t,e,"")},l=r(),c=i&&i[3]||(p.cssNumber[e]?"":"px"),d=(p.cssNumber[e]||"px"!==c&&+l)&&q.exec(p.css(t,e));if(d&&d[3]!==c){c=c||d[3],i=i||[],d=+l||1;do{d/=s=s||".5",p.style(t,e,d+c)}while(s!==(s=r()/l)&&1!==s&&--a)}return i&&(d=+d||+l||0,o=i[1]?d+(i[1]+1)*i[2]:+i[2],n&&(n.unit=c,n.start=d,n.end=o)),o}var G=/^(?:checkbox|radio)$/i,K=/<([\w:-]+)/,X=/^$|\/(?:java|ecma)script/i,J={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Q(t,e){var i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&p.nodeName(t,e)?p.merge([t],i):i}function Z(t,e){for(var i=0,n=t.length;n>i;i++)$.set(t[i],"globalEval",!e||$.get(e[i],"globalEval"))}J.optgroup=J.option,J.tbody=J.tfoot=J.colgroup=J.caption=J.thead,J.th=J.td;var tt=/<|&#?\w+;/;function et(t,e,i,n,o){for(var s,a,r,l,c,d,u=e.createDocumentFragment(),h=[],f=0,m=t.length;m>f;f++)if((s=t[f])||0===s)if("object"===p.type(s))p.merge(h,s.nodeType?[s]:s);else if(tt.test(s)){for(a=a||u.appendChild(e.createElement("div")),r=(K.exec(s)||["",""])[1].toLowerCase(),l=J[r]||J._default,a.innerHTML=l[1]+p.htmlPrefilter(s)+l[2],d=l[0];d--;)a=a.lastChild;p.merge(h,a.childNodes),(a=u.firstChild).textContent=""}else h.push(e.createTextNode(s));for(u.textContent="",f=0;s=h[f++];)if(n&&p.inArray(s,n)>-1)o&&o.push(s);else if(c=p.contains(s.ownerDocument,s),a=Q(u.appendChild(s),"script"),c&&Z(a),i)for(d=0;s=a[d++];)X.test(s.type||"")&&i.push(s);return u}!function(){var t=n.createDocumentFragment().appendChild(n.createElement("div")),e=n.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),u.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",u.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var it=/^key/,nt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ot=/^([^.]*)(?:\.(.+)|)/;function st(){return!0}function at(){return!1}function rt(){try{return n.activeElement}catch(t){}}function lt(t,e,i,n,o,s){var a,r;if("object"==typeof e){for(r in"string"!=typeof i&&(n=n||i,i=void 0),e)lt(t,r,i,n,e[r],s);return t}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=at;else if(!o)return t;return 1===s&&(a=o,o=function(t){return p().off(t),a.apply(this,arguments)},o.guid=a.guid||(a.guid=p.guid++)),t.each((function(){p.event.add(this,e,o,n,i)}))}p.event={global:{},add:function(t,e,i,n,o){var s,a,r,l,c,d,u,h,f,m,g,v=$.get(t);if(v)for(i.handler&&(i=(s=i).handler,o=s.selector),i.guid||(i.guid=p.guid++),(l=v.events)||(l=v.events={}),(a=v.handle)||(a=v.handle=function(e){return void 0!==p&&p.event.triggered!==e.type?p.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(I)||[""]).length;c--;)f=g=(r=ot.exec(e[c])||[])[1],m=(r[2]||"").split(".").sort(),f&&(u=p.event.special[f]||{},f=(o?u.delegateType:u.bindType)||f,u=p.event.special[f]||{},d=p.extend({type:f,origType:g,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&p.expr.match.needsContext.test(o),namespace:m.join(".")},s),(h=l[f])||((h=l[f]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,n,m,a)||t.addEventListener&&t.addEventListener(f,a)),u.add&&(u.add.call(t,d),d.handler.guid||(d.handler.guid=i.guid)),o?h.splice(h.delegateCount++,0,d):h.push(d),p.event.global[f]=!0)},remove:function(t,e,i,n,o){var s,a,r,l,c,d,u,h,f,m,g,v=$.hasData(t)&&$.get(t);if(v&&(l=v.events)){for(c=(e=(e||"").match(I)||[""]).length;c--;)if(f=g=(r=ot.exec(e[c])||[])[1],m=(r[2]||"").split(".").sort(),f){for(u=p.event.special[f]||{},h=l[f=(n?u.delegateType:u.bindType)||f]||[],r=r[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;s--;)d=h[s],!o&&g!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(h.splice(s,1),d.selector&&h.delegateCount--,u.remove&&u.remove.call(t,d));a&&!h.length&&(u.teardown&&!1!==u.teardown.call(t,m,v.handle)||p.removeEvent(t,f,v.handle),delete l[f])}else for(f in l)p.event.remove(t,f+e[c],i,n,!0);p.isEmptyObject(l)&&$.remove(t,"handle events")}},dispatch:function(t){t=p.event.fix(t);var e,i,n,s,a,r=[],l=o.call(arguments),c=($.get(this,"events")||{})[t.type]||[],d=p.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,t)){for(r=p.event.handlers.call(this,t,c),e=0;(s=r[e++])&&!t.isPropagationStopped();)for(t.currentTarget=s.elem,i=0;(a=s.handlers[i++])&&!t.isImmediatePropagationStopped();)t.rnamespace&&!t.rnamespace.test(a.namespace)||(t.handleObj=a,t.data=a.data,void 0!==(n=((p.event.special[a.origType]||{}).handle||a.handler).apply(s.elem,l))&&!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,o,s,a=[],r=e.delegateCount,l=t.target;if(r&&l.nodeType&&("click"!==t.type||isNaN(t.button)||t.button<1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==t.type)){for(n=[],i=0;r>i;i++)void 0===n[o=(s=e[i]).selector+" "]&&(n[o]=s.needsContext?p(o,this).index(l)>-1:p.find(o,this,null,[l]).length),n[o]&&n.push(s);n.length&&a.push({elem:l,handlers:n})}return r<e.length&&a.push({elem:this,handlers:e.slice(r)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,o,s,a=e.button;return null==t.pageX&&null!=e.clientX&&(o=(i=t.target.ownerDocument||n).documentElement,s=i.body,t.pageX=e.clientX+(o&&o.scrollLeft||s&&s.scrollLeft||0)-(o&&o.clientLeft||s&&s.clientLeft||0),t.pageY=e.clientY+(o&&o.scrollTop||s&&s.scrollTop||0)-(o&&o.clientTop||s&&s.clientTop||0)),t.which||void 0===a||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(t){if(t[p.expando])return t;var e,i,o,s=t.type,a=t,r=this.fixHooks[s];for(r||(this.fixHooks[s]=r=nt.test(s)?this.mouseHooks:it.test(s)?this.keyHooks:{}),o=r.props?this.props.concat(r.props):this.props,t=new p.Event(a),e=o.length;e--;)t[i=o[e]]=a[i];return t.target||(t.target=n),3===t.target.nodeType&&(t.target=t.target.parentNode),r.filter?r.filter(t,a):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==rt()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===rt()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&p.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return p.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},p.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},p.Event=function(t,e){return this instanceof p.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?st:at):this.type=t,e&&p.extend(this,e),this.timeStamp=t&&t.timeStamp||p.now(),void(this[p.expando]=!0)):new p.Event(t,e)},p.Event.prototype={constructor:p.Event,isDefaultPrevented:at,isPropagationStopped:at,isImmediatePropagationStopped:at,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=st,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=st,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=st,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){p.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,o=t.handleObj;return n&&(n===this||p.contains(this,n))||(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}})),p.fn.extend({on:function(t,e,i,n){return lt(this,t,e,i,n)},one:function(t,e,i,n){return lt(this,t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,p(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=at),this.each((function(){p.event.remove(this,t,i,e)}))}});var ct=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,dt=/<script|<style|<link/i,ut=/checked\s*(?:[^=]|=\s*.checked.)/i,ht=/^true\/(.*)/,pt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function ft(t,e){return p.nodeName(t,"table")&&p.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function mt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function gt(t){var e=ht.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function vt(t,e){var i,n,o,s,a,r,l,c;if(1===e.nodeType){if($.hasData(t)&&(s=$.access(t),a=$.set(e,s),c=s.events))for(o in delete a.handle,a.events={},c)for(i=0,n=c[o].length;n>i;i++)p.event.add(e,o,c[o][i]);B.hasData(t)&&(r=B.access(t),l=p.extend({},r),B.set(e,l))}}function bt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&G.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function yt(t,e,i,n){e=s.apply([],e);var o,a,r,l,c,d,h=0,f=t.length,m=f-1,g=e[0],v=p.isFunction(g);if(v||f>1&&"string"==typeof g&&!u.checkClone&&ut.test(g))return t.each((function(o){var s=t.eq(o);v&&(e[0]=g.call(this,o,s.html())),yt(s,e,i,n)}));if(f&&(a=(o=et(e,t[0].ownerDocument,!1,t,n)).firstChild,1===o.childNodes.length&&(o=a),a||n)){for(l=(r=p.map(Q(o,"script"),mt)).length;f>h;h++)c=o,h!==m&&(c=p.clone(c,!0,!0),l&&p.merge(r,Q(c,"script"))),i.call(t[h],c,h);if(l)for(d=r[r.length-1].ownerDocument,p.map(r,gt),h=0;l>h;h++)c=r[h],X.test(c.type||"")&&!$.access(c,"globalEval")&&p.contains(d,c)&&(c.src?p._evalUrl&&p._evalUrl(c.src):p.globalEval(c.textContent.replace(pt,"")))}return t}function _t(t,e,i){for(var n,o=e?p.filter(e,t):t,s=0;null!=(n=o[s]);s++)i||1!==n.nodeType||p.cleanData(Q(n)),n.parentNode&&(i&&p.contains(n.ownerDocument,n)&&Z(Q(n,"script")),n.parentNode.removeChild(n));return t}p.extend({htmlPrefilter:function(t){return t.replace(ct,"<$1></$2>")},clone:function(t,e,i){var n,o,s,a,r=t.cloneNode(!0),l=p.contains(t.ownerDocument,t);if(!(u.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||p.isXMLDoc(t)))for(a=Q(r),n=0,o=(s=Q(t)).length;o>n;n++)bt(s[n],a[n]);if(e)if(i)for(s=s||Q(t),a=a||Q(r),n=0,o=s.length;o>n;n++)vt(s[n],a[n]);else vt(t,r);return(a=Q(r,"script")).length>0&&Z(a,!l&&Q(t,"script")),r},cleanData:function(t){for(var e,i,n,o=p.event.special,s=0;void 0!==(i=t[s]);s++)if(j(i)){if(e=i[$.expando]){if(e.events)for(n in e.events)o[n]?p.event.remove(i,n):p.removeEvent(i,n,e.handle);i[$.expando]=void 0}i[B.expando]&&(i[B.expando]=void 0)}}}),p.fn.extend({domManip:yt,detach:function(t){return _t(this,t,!0)},remove:function(t){return _t(this,t)},text:function(t){return N(this,(function(t){return void 0===t?p.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return yt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ft(this,t).appendChild(t)}))},prepend:function(){return yt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=ft(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return yt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return yt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(p.cleanData(Q(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return p.clone(this,t,e)}))},html:function(t){return N(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!dt.test(t)&&!J[(K.exec(t)||["",""])[1].toLowerCase()]){t=p.htmlPrefilter(t);try{for(;n>i;i++)1===(e=this[i]||{}).nodeType&&(p.cleanData(Q(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return yt(this,arguments,(function(e){var i=this.parentNode;p.inArray(this,t)<0&&(p.cleanData(Q(this)),i&&i.replaceChild(e,this))}),t)}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){p.fn[t]=function(t){for(var i,n=[],o=p(t),s=o.length-1,r=0;s>=r;r++)i=r===s?this:this.clone(!0),p(o[r])[e](i),a.apply(n,i.get());return this.pushStack(n)}}));var wt,xt={HTML:"block",BODY:"block"};function kt(t,e){var i=p(e.createElement(t)).appendTo(e.body),n=p.css(i[0],"display");return i.detach(),n}function St(t){var e=n,i=xt[t];return i||("none"!==(i=kt(t,e))&&i||((e=(wt=(wt||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),i=kt(t,e),wt.detach()),xt[t]=i),i}var Tt=/^margin/,Ct=new RegExp("^("+U+")(?!px)[a-z%]+$","i"),Dt=function(e){var i=e.ownerDocument.defaultView;return i&&i.opener||(i=t),i.getComputedStyle(e)},Mt=function(t,e,i,n){var o,s,a={};for(s in e)a[s]=t.style[s],t.style[s]=e[s];for(s in o=i.apply(t,n||[]),e)t.style[s]=a[s];return o},Ot=n.documentElement;function Pt(t,e,i){var n,o,s,a,r=t.style;return""!==(a=(i=i||Dt(t))?i.getPropertyValue(e)||i[e]:void 0)&&void 0!==a||p.contains(t.ownerDocument,t)||(a=p.style(t,e)),i&&!u.pixelMarginRight()&&Ct.test(a)&&Tt.test(e)&&(n=r.width,o=r.minWidth,s=r.maxWidth,r.minWidth=r.maxWidth=r.width=a,a=i.width,r.width=n,r.minWidth=o,r.maxWidth=s),void 0!==a?a+"":a}function Et(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}!function(){var e,i,o,s,a=n.createElement("div"),r=n.createElement("div");if(r.style){function l(){r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",r.innerHTML="",Ot.appendChild(a);var n=t.getComputedStyle(r);e="1%"!==n.top,s="2px"===n.marginLeft,i="4px"===n.width,r.style.marginRight="50%",o="4px"===n.marginRight,Ot.removeChild(a)}r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",u.clearCloneStyle="content-box"===r.style.backgroundClip,a.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",a.appendChild(r),p.extend(u,{pixelPosition:function(){return l(),e},boxSizingReliable:function(){return null==i&&l(),i},pixelMarginRight:function(){return null==i&&l(),o},reliableMarginLeft:function(){return null==i&&l(),s},reliableMarginRight:function(){var e,i=r.appendChild(n.createElement("div"));return i.style.cssText=r.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",r.style.width="1px",Ot.appendChild(a),e=!parseFloat(t.getComputedStyle(i).marginRight),Ot.removeChild(a),r.removeChild(i),e}})}}();var At=/^(none|table(?!-c[ea]).+)/,It={position:"absolute",visibility:"hidden",display:"block"},Lt={letterSpacing:"0",fontWeight:"400"},Nt=["Webkit","O","Moz","ms"],jt=n.createElement("div").style;function Rt(t){if(t in jt)return t;for(var e=t[0].toUpperCase()+t.slice(1),i=Nt.length;i--;)if((t=Nt[i]+e)in jt)return t}function $t(t,e,i){var n=q.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function Bt(t,e,i,n,o){for(var s=i===(n?"border":"content")?4:"width"===e?1:0,a=0;4>s;s+=2)"margin"===i&&(a+=p.css(t,i+z[s],!0,o)),n?("content"===i&&(a-=p.css(t,"padding"+z[s],!0,o)),"margin"!==i&&(a-=p.css(t,"border"+z[s]+"Width",!0,o))):(a+=p.css(t,"padding"+z[s],!0,o),"padding"!==i&&(a+=p.css(t,"border"+z[s]+"Width",!0,o)));return a}function Ft(t,e,i){var n=!0,o="width"===e?t.offsetWidth:t.offsetHeight,s=Dt(t),a="border-box"===p.css(t,"boxSizing",!1,s);if(0>=o||null==o){if((0>(o=Pt(t,e,s))||null==o)&&(o=t.style[e]),Ct.test(o))return o;n=a&&(u.boxSizingReliable()||o===t.style[e]),o=parseFloat(o)||0}return o+Bt(t,e,i||(a?"border":"content"),n,s)+"px"}function Ht(t,e){for(var i,n,o,s=[],a=0,r=t.length;r>a;a++)(n=t[a]).style&&(s[a]=$.get(n,"olddisplay"),i=n.style.display,e?(s[a]||"none"!==i||(n.style.display=""),""===n.style.display&&V(n)&&(s[a]=$.access(n,"olddisplay",St(n.nodeName)))):(o=V(n),"none"===i&&o||$.set(n,"olddisplay",o?i:p.css(n,"display"))));for(a=0;r>a;a++)(n=t[a]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?s[a]||"":"none"));return t}function Wt(t,e,i,n,o){return new Wt.prototype.init(t,e,i,n,o)}p.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Pt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,s,a,r=p.camelCase(e),l=t.style;return e=p.cssProps[r]||(p.cssProps[r]=Rt(r)||r),a=p.cssHooks[e]||p.cssHooks[r],void 0===i?a&&"get"in a&&void 0!==(o=a.get(t,!1,n))?o:l[e]:("string"===(s=typeof i)&&(o=q.exec(i))&&o[1]&&(i=Y(t,e,o),s="number"),void(null!=i&&i==i&&("number"===s&&(i+=o&&o[3]||(p.cssNumber[r]?"":"px")),u.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(l[e]=i))))}},css:function(t,e,i,n){var o,s,a,r=p.camelCase(e);return e=p.cssProps[r]||(p.cssProps[r]=Rt(r)||r),(a=p.cssHooks[e]||p.cssHooks[r])&&"get"in a&&(o=a.get(t,!0,i)),void 0===o&&(o=Pt(t,e,n)),"normal"===o&&e in Lt&&(o=Lt[e]),""===i||i?(s=parseFloat(o),!0===i||isFinite(s)?s||0:o):o}}),p.each(["height","width"],(function(t,e){p.cssHooks[e]={get:function(t,i,n){return i?At.test(p.css(t,"display"))&&0===t.offsetWidth?Mt(t,It,(function(){return Ft(t,e,n)})):Ft(t,e,n):void 0},set:function(t,i,n){var o,s=n&&Dt(t),a=n&&Bt(t,e,n,"border-box"===p.css(t,"boxSizing",!1,s),s);return a&&(o=q.exec(i))&&"px"!==(o[3]||"px")&&(t.style[e]=i,i=p.css(t,e)),$t(0,i,a)}}})),p.cssHooks.marginLeft=Et(u.reliableMarginLeft,(function(t,e){return e?(parseFloat(Pt(t,"marginLeft"))||t.getBoundingClientRect().left-Mt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px":void 0})),p.cssHooks.marginRight=Et(u.reliableMarginRight,(function(t,e){return e?Mt(t,{display:"inline-block"},Pt,[t,"marginRight"]):void 0})),p.each({margin:"",padding:"",border:"Width"},(function(t,e){p.cssHooks[t+e]={expand:function(i){for(var n=0,o={},s="string"==typeof i?i.split(" "):[i];4>n;n++)o[t+z[n]+e]=s[n]||s[n-2]||s[0];return o}},Tt.test(t)||(p.cssHooks[t+e].set=$t)})),p.fn.extend({css:function(t,e){return N(this,(function(t,e,i){var n,o,s={},a=0;if(p.isArray(e)){for(n=Dt(t),o=e.length;o>a;a++)s[e[a]]=p.css(t,e[a],!1,n);return s}return void 0!==i?p.style(t,e,i):p.css(t,e)}),t,e,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){V(this)?p(this).show():p(this).hide()}))}}),p.Tween=Wt,Wt.prototype={constructor:Wt,init:function(t,e,i,n,o,s){this.elem=t,this.prop=i,this.easing=o||p.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=s||(p.cssNumber[i]?"":"px")},cur:function(){var t=Wt.propHooks[this.prop];return t&&t.get?t.get(this):Wt.propHooks._default.get(this)},run:function(t){var e,i=Wt.propHooks[this.prop];return this.options.duration?this.pos=e=p.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Wt.propHooks._default.set(this),this}},Wt.prototype.init.prototype=Wt.prototype,Wt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=p.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){p.fx.step[t.prop]?p.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[p.cssProps[t.prop]]&&!p.cssHooks[t.prop]?t.elem[t.prop]=t.now:p.style(t.elem,t.prop,t.now+t.unit)}}},Wt.propHooks.scrollTop=Wt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},p.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},p.fx=Wt.prototype.init,p.fx.step={};var Ut,qt,zt=/^(?:toggle|show|hide)$/,Vt=/queueHooks$/;function Yt(){return t.setTimeout((function(){Ut=void 0})),Ut=p.now()}function Gt(t,e){var i,n=0,o={height:t};for(e=e?1:0;4>n;n+=2-e)o["margin"+(i=z[n])]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function Kt(t,e,i){for(var n,o=(Xt.tweeners[e]||[]).concat(Xt.tweeners["*"]),s=0,a=o.length;a>s;s++)if(n=o[s].call(i,e,t))return n}function Xt(t,e,i){var n,o,s=0,a=Xt.prefilters.length,r=p.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var e=Ut||Yt(),i=Math.max(0,c.startTime+c.duration-e),n=1-(i/c.duration||0),s=0,a=c.tweens.length;a>s;s++)c.tweens[s].run(n);return r.notifyWith(t,[c,n,i]),1>n&&a?i:(r.resolveWith(t,[c]),!1)},c=r.promise({elem:t,props:p.extend({},e),opts:p.extend(!0,{specialEasing:{},easing:p.easing._default},i),originalProperties:e,originalOptions:i,startTime:Ut||Yt(),duration:i.duration,tweens:[],createTween:function(e,i){var n=p.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(o)return this;for(o=!0;n>i;i++)c.tweens[i].run(1);return e?(r.notifyWith(t,[c,1,0]),r.resolveWith(t,[c,e])):r.rejectWith(t,[c,e]),this}}),d=c.props;for(function(t,e){var i,n,o,s,a;for(i in t)if(o=e[n=p.camelCase(i)],s=t[i],p.isArray(s)&&(o=s[1],s=t[i]=s[0]),i!==n&&(t[n]=s,delete t[i]),(a=p.cssHooks[n])&&"expand"in a)for(i in s=a.expand(s),delete t[n],s)i in t||(t[i]=s[i],e[i]=o);else e[n]=o}(d,c.opts.specialEasing);a>s;s++)if(n=Xt.prefilters[s].call(c,t,d,c.opts))return p.isFunction(n.stop)&&(p._queueHooks(c.elem,c.opts.queue).stop=p.proxy(n.stop,n)),n;return p.map(d,Kt,c),p.isFunction(c.opts.start)&&c.opts.start.call(t,c),p.fx.timer(p.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}p.Animation=p.extend(Xt,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return Y(i.elem,t,q.exec(e),i),i}]},tweener:function(t,e){p.isFunction(t)?(e=t,t=["*"]):t=t.match(I);for(var i,n=0,o=t.length;o>n;n++)i=t[n],Xt.tweeners[i]=Xt.tweeners[i]||[],Xt.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,o,s,a,r,l,c,d=this,u={},h=t.style,f=t.nodeType&&V(t),m=$.get(t,"fxshow");for(n in i.queue||(null==(r=p._queueHooks(t,"fx")).unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,d.always((function(){d.always((function(){r.unqueued--,p.queue(t,"fx").length||r.empty.fire()}))}))),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[h.overflow,h.overflowX,h.overflowY],"inline"===("none"===(c=p.css(t,"display"))?$.get(t,"olddisplay")||St(t.nodeName):c)&&"none"===p.css(t,"float")&&(h.display="inline-block")),i.overflow&&(h.overflow="hidden",d.always((function(){h.overflow=i.overflow[0],h.overflowX=i.overflow[1],h.overflowY=i.overflow[2]}))),e)if(o=e[n],zt.exec(o)){if(delete e[n],s=s||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!m||void 0===m[n])continue;f=!0}u[n]=m&&m[n]||p.style(t,n)}else c=void 0;if(p.isEmptyObject(u))"inline"===("none"===c?St(t.nodeName):c)&&(h.display=c);else for(n in m?"hidden"in m&&(f=m.hidden):m=$.access(t,"fxshow",{}),s&&(m.hidden=!f),f?p(t).show():d.done((function(){p(t).hide()})),d.done((function(){var e;for(e in $.remove(t,"fxshow"),u)p.style(t,e,u[e])})),u)a=Kt(f?m[n]:0,n,d),n in m||(m[n]=a.start,f&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}],prefilter:function(t,e){e?Xt.prefilters.unshift(t):Xt.prefilters.push(t)}}),p.speed=function(t,e,i){var n=t&&"object"==typeof t?p.extend({},t):{complete:i||!i&&e||p.isFunction(t)&&t,duration:t,easing:i&&e||e&&!p.isFunction(e)&&e};return n.duration=p.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in p.fx.speeds?p.fx.speeds[n.duration]:p.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){p.isFunction(n.old)&&n.old.call(this),n.queue&&p.dequeue(this,n.queue)},n},p.fn.extend({fadeTo:function(t,e,i,n){return this.filter(V).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=p.isEmptyObject(t),s=p.speed(e,i,n),a=function(){var e=Xt(this,p.extend({},t),s);(o||$.get(this,"finish"))&&e.stop(!0)};return a.finish=a,o||!1===s.queue?this.each(a):this.queue(s.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,o=null!=t&&t+"queueHooks",s=p.timers,a=$.get(this);if(o)a[o]&&a[o].stop&&n(a[o]);else for(o in a)a[o]&&a[o].stop&&Vt.test(o)&&n(a[o]);for(o=s.length;o--;)s[o].elem!==this||null!=t&&s[o].queue!==t||(s[o].anim.stop(i),e=!1,s.splice(o,1));!e&&i||p.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=$.get(this),n=i[t+"queue"],o=i[t+"queueHooks"],s=p.timers,a=n?n.length:0;for(i.finish=!0,p.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=s.length;e--;)s[e].elem===this&&s[e].queue===t&&(s[e].anim.stop(!0),s.splice(e,1));for(e=0;a>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),p.each(["toggle","show","hide"],(function(t,e){var i=p.fn[e];p.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(Gt(e,!0),t,n,o)}})),p.each({slideDown:Gt("show"),slideUp:Gt("hide"),slideToggle:Gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){p.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),p.timers=[],p.fx.tick=function(){var t,e=0,i=p.timers;for(Ut=p.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||p.fx.stop(),Ut=void 0},p.fx.timer=function(t){p.timers.push(t),t()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){qt||(qt=t.setInterval(p.fx.tick,p.fx.interval))},p.fx.stop=function(){t.clearInterval(qt),qt=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(e,i){return e=p.fx&&p.fx.speeds[e]||e,i=i||"fx",this.queue(i,(function(i,n){var o=t.setTimeout(i,e);n.stop=function(){t.clearTimeout(o)}}))},function(){var t=n.createElement("input"),e=n.createElement("select"),i=e.appendChild(n.createElement("option"));t.type="checkbox",u.checkOn=""!==t.value,u.optSelected=i.selected,e.disabled=!0,u.optDisabled=!i.disabled,(t=n.createElement("input")).value="t",t.type="radio",u.radioValue="t"===t.value}();var Jt,Qt=p.expr.attrHandle;p.fn.extend({attr:function(t,e){return N(this,p.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){p.removeAttr(this,t)}))}}),p.extend({attr:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return void 0===t.getAttribute?p.prop(t,e,i):(1===s&&p.isXMLDoc(t)||(e=e.toLowerCase(),o=p.attrHooks[e]||(p.expr.match.bool.test(e)?Jt:void 0)),void 0!==i?null===i?void p.removeAttr(t,e):o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:(t.setAttribute(e,i+""),i):o&&"get"in o&&null!==(n=o.get(t,e))?n:null==(n=p.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!u.radioValue&&"radio"===e&&p.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n,o=0,s=e&&e.match(I);if(s&&1===t.nodeType)for(;i=s[o++];)n=p.propFix[i]||i,p.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)}}),Jt={set:function(t,e,i){return!1===e?p.removeAttr(t,i):t.setAttribute(i,i),i}},p.each(p.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=Qt[e]||p.find.attr;Qt[e]=function(t,e,n){var o,s;return n||(s=Qt[e],Qt[e]=o,o=null!=i(t,e,n)?e.toLowerCase():null,Qt[e]=s),o}}));var Zt=/^(?:input|select|textarea|button)$/i,te=/^(?:a|area)$/i;p.fn.extend({prop:function(t,e){return N(this,p.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[p.propFix[t]||t]}))}}),p.extend({prop:function(t,e,i){var n,o,s=t.nodeType;if(3!==s&&8!==s&&2!==s)return 1===s&&p.isXMLDoc(t)||(e=p.propFix[e]||e,o=p.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=p.find.attr(t,"tabindex");return e?parseInt(e,10):Zt.test(t.nodeName)||te.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),u.optSelected||(p.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){p.propFix[this.toLowerCase()]=this}));var ee=/[\t\r\n\f]/g;function ie(t){return t.getAttribute&&t.getAttribute("class")||""}p.fn.extend({addClass:function(t){var e,i,n,o,s,a,r,l=0;if(p.isFunction(t))return this.each((function(e){p(this).addClass(t.call(this,e,ie(this)))}));if("string"==typeof t&&t)for(e=t.match(I)||[];i=this[l++];)if(o=ie(i),n=1===i.nodeType&&(" "+o+" ").replace(ee," ")){for(a=0;s=e[a++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");o!==(r=p.trim(n))&&i.setAttribute("class",r)}return this},removeClass:function(t){var e,i,n,o,s,a,r,l=0;if(p.isFunction(t))return this.each((function(e){p(this).removeClass(t.call(this,e,ie(this)))}));if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(I)||[];i=this[l++];)if(o=ie(i),n=1===i.nodeType&&(" "+o+" ").replace(ee," ")){for(a=0;s=e[a++];)for(;n.indexOf(" "+s+" ")>-1;)n=n.replace(" "+s+" "," ");o!==(r=p.trim(n))&&i.setAttribute("class",r)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):p.isFunction(t)?this.each((function(i){p(this).toggleClass(t.call(this,i,ie(this),e),e)})):this.each((function(){var e,n,o,s;if("string"===i)for(n=0,o=p(this),s=t.match(I)||[];e=s[n++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==i||((e=ie(this))&&$.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":$.get(this,"__className__")||""))}))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+ie(i)+" ").replace(ee," ").indexOf(e)>-1)return!0;return!1}});var ne=/\r/g,oe=/[\x20\t\r\n\f]+/g;p.fn.extend({val:function(t){var e,i,n,o=this[0];return arguments.length?(n=p.isFunction(t),this.each((function(i){var o;1===this.nodeType&&(null==(o=n?t.call(this,i,p(this).val()):t)?o="":"number"==typeof o?o+="":p.isArray(o)&&(o=p.map(o,(function(t){return null==t?"":t+""}))),(e=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))}))):o?(e=p.valHooks[o.type]||p.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(ne,""):null==i?"":i:void 0}}),p.extend({valHooks:{option:{get:function(t){var e=p.find.attr(t,"value");return null!=e?e:p.trim(p.text(t)).replace(oe," ")}},select:{get:function(t){for(var e,i,n=t.options,o=t.selectedIndex,s="select-one"===t.type||0>o,a=s?null:[],r=s?o+1:n.length,l=0>o?r:s?o:0;r>l;l++)if(((i=n[l]).selected||l===o)&&(u.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!p.nodeName(i.parentNode,"optgroup"))){if(e=p(i).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var i,n,o=t.options,s=p.makeArray(e),a=o.length;a--;)((n=o[a]).selected=p.inArray(p.valHooks.option.get(n),s)>-1)&&(i=!0);return i||(t.selectedIndex=-1),s}}}}),p.each(["radio","checkbox"],(function(){p.valHooks[this]={set:function(t,e){return p.isArray(e)?t.checked=p.inArray(p(t).val(),e)>-1:void 0}},u.checkOn||(p.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var se=/^(?:focusinfocus|focusoutblur)$/;p.extend(p.event,{trigger:function(e,i,o,s){var a,r,l,c,u,h,f,m=[o||n],g=d.call(e,"type")?e.type:e,v=d.call(e,"namespace")?e.namespace.split("."):[];if(r=l=o=o||n,3!==o.nodeType&&8!==o.nodeType&&!se.test(g+p.event.triggered)&&(g.indexOf(".")>-1&&(v=g.split("."),g=v.shift(),v.sort()),u=g.indexOf(":")<0&&"on"+g,(e=e[p.expando]?e:new p.Event(g,"object"==typeof e&&e)).isTrigger=s?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=o),i=null==i?[e]:p.makeArray(i,[e]),f=p.event.special[g]||{},s||!f.trigger||!1!==f.trigger.apply(o,i))){if(!s&&!f.noBubble&&!p.isWindow(o)){for(c=f.delegateType||g,se.test(c+g)||(r=r.parentNode);r;r=r.parentNode)m.push(r),l=r;l===(o.ownerDocument||n)&&m.push(l.defaultView||l.parentWindow||t)}for(a=0;(r=m[a++])&&!e.isPropagationStopped();)e.type=a>1?c:f.bindType||g,(h=($.get(r,"events")||{})[e.type]&&$.get(r,"handle"))&&h.apply(r,i),(h=u&&r[u])&&h.apply&&j(r)&&(e.result=h.apply(r,i),!1===e.result&&e.preventDefault());return e.type=g,s||e.isDefaultPrevented()||f._default&&!1!==f._default.apply(m.pop(),i)||!j(o)||u&&p.isFunction(o[g])&&!p.isWindow(o)&&((l=o[u])&&(o[u]=null),p.event.triggered=g,o[g](),p.event.triggered=void 0,l&&(o[u]=l)),e.result}},simulate:function(t,e,i){var n=p.extend(new p.Event,i,{type:t,isSimulated:!0});p.event.trigger(n,null,e)}}),p.fn.extend({trigger:function(t,e){return this.each((function(){p.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];return i?p.event.trigger(t,e,i,!0):void 0}}),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(t,e){p.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}})),p.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),u.focusin="onfocusin"in t,u.focusin||p.each({focus:"focusin",blur:"focusout"},(function(t,e){var i=function(t){p.event.simulate(e,t.target,p.event.fix(t))};p.event.special[e]={setup:function(){var n=this.ownerDocument||this,o=$.access(n,e);o||n.addEventListener(t,i,!0),$.access(n,e,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=$.access(n,e)-1;o?$.access(n,e,o):(n.removeEventListener(t,i,!0),$.remove(n,e))}}}));var ae=t.location,re=p.now(),le=/\?/;p.parseJSON=function(t){return JSON.parse(t+"")},p.parseXML=function(e){var i;if(!e||"string"!=typeof e)return null;try{i=(new t.DOMParser).parseFromString(e,"text/xml")}catch(t){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||p.error("Invalid XML: "+e),i};var ce=/#.*$/,de=/([?&])_=[^&]*/,ue=/^(.*?):[ \t]*([^\r\n]*)$/gm,he=/^(?:GET|HEAD)$/,pe=/^\/\//,fe={},me={},ge="*/".concat("*"),ve=n.createElement("a");function be(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,s=e.toLowerCase().match(I)||[];if(p.isFunction(i))for(;n=s[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function ye(t,e,i,n){var o={},s=t===me;function a(r){var l;return o[r]=!0,p.each(t[r]||[],(function(t,r){var c=r(e,i,n);return"string"!=typeof c||s||o[c]?s?!(l=c):void 0:(e.dataTypes.unshift(c),a(c),!1)})),l}return a(e.dataTypes[0])||!o["*"]&&a("*")}function _e(t,e){var i,n,o=p.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&p.extend(!0,t,n),t}ve.href=ae.href,p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ae.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ae.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ge,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?_e(_e(t,p.ajaxSettings),e):_e(p.ajaxSettings,t)},ajaxPrefilter:be(fe),ajaxTransport:be(me),ajax:function(e,i){"object"==typeof e&&(i=e,e=void 0),i=i||{};var o,s,a,r,l,c,d,u,h=p.ajaxSetup({},i),f=h.context||h,m=h.context&&(f.nodeType||f.jquery)?p(f):p.event,g=p.Deferred(),v=p.Callbacks("once memory"),b=h.statusCode||{},y={},_={},w=0,x="canceled",k={readyState:0,getResponseHeader:function(t){var e;if(2===w){if(!r)for(r={};e=ue.exec(a);)r[e[1].toLowerCase()]=e[2];e=r[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===w?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return w||(t=_[i]=_[i]||t,y[t]=e),this},overrideMimeType:function(t){return w||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>w)for(e in t)b[e]=[b[e],t[e]];else k.always(t[k.status]);return this},abort:function(t){var e=t||x;return o&&o.abort(e),S(0,e),this}};if(g.promise(k).complete=v.add,k.success=k.done,k.error=k.fail,h.url=((e||h.url||ae.href)+"").replace(ce,"").replace(pe,ae.protocol+"//"),h.type=i.method||i.type||h.method||h.type,h.dataTypes=p.trim(h.dataType||"*").toLowerCase().match(I)||[""],null==h.crossDomain){c=n.createElement("a");try{c.href=h.url,c.href=c.href,h.crossDomain=ve.protocol+"//"+ve.host!=c.protocol+"//"+c.host}catch(t){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=p.param(h.data,h.traditional)),ye(fe,h,i,k),2===w)return k;for(u in(d=p.event&&h.global)&&0==p.active++&&p.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!he.test(h.type),s=h.url,h.hasContent||(h.data&&(s=h.url+=(le.test(s)?"&":"?")+h.data,delete h.data),!1===h.cache&&(h.url=de.test(s)?s.replace(de,"$1_="+re++):s+(le.test(s)?"&":"?")+"_="+re++)),h.ifModified&&(p.lastModified[s]&&k.setRequestHeader("If-Modified-Since",p.lastModified[s]),p.etag[s]&&k.setRequestHeader("If-None-Match",p.etag[s])),(h.data&&h.hasContent&&!1!==h.contentType||i.contentType)&&k.setRequestHeader("Content-Type",h.contentType),k.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+ge+"; q=0.01":""):h.accepts["*"]),h.headers)k.setRequestHeader(u,h.headers[u]);if(h.beforeSend&&(!1===h.beforeSend.call(f,k,h)||2===w))return k.abort();for(u in x="abort",{success:1,error:1,complete:1})k[u](h[u]);if(o=ye(me,h,i,k)){if(k.readyState=1,d&&m.trigger("ajaxSend",[k,h]),2===w)return k;h.async&&h.timeout>0&&(l=t.setTimeout((function(){k.abort("timeout")}),h.timeout));try{w=1,o.send(y,S)}catch(t){if(!(2>w))throw t;S(-1,t)}}else S(-1,"No Transport");function S(e,i,n,r){var c,u,y,_,x,S=i;2!==w&&(w=2,l&&t.clearTimeout(l),o=void 0,a=r||"",k.readyState=e>0?4:0,c=e>=200&&300>e||304===e,n&&(_=function(t,e,i){for(var n,o,s,a,r=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in r)if(r[o]&&r[o].test(n)){l.unshift(o);break}if(l[0]in i)s=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){s=o;break}a||(a=o)}s=s||a}return s?(s!==l[0]&&l.unshift(s),i[s]):void 0}(h,k,n)),_=function(t,e,i,n){var o,s,a,r,l,c={},d=t.dataTypes.slice();if(d[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(s=d.shift();s;)if(t.responseFields[s]&&(i[t.responseFields[s]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=s,s=d.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(!(a=c[l+" "+s]||c["* "+s]))for(o in c)if((r=o.split(" "))[1]===s&&(a=c[l+" "+r[0]]||c["* "+r[0]])){!0===a?a=c[o]:!0!==c[o]&&(s=r[0],d.unshift(r[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+s}}}return{state:"success",data:e}}(h,_,k,c),c?(h.ifModified&&((x=k.getResponseHeader("Last-Modified"))&&(p.lastModified[s]=x),(x=k.getResponseHeader("etag"))&&(p.etag[s]=x)),204===e||"HEAD"===h.type?S="nocontent":304===e?S="notmodified":(S=_.state,u=_.data,c=!(y=_.error))):(y=S,!e&&S||(S="error",0>e&&(e=0))),k.status=e,k.statusText=(i||S)+"",c?g.resolveWith(f,[u,S,k]):g.rejectWith(f,[k,S,y]),k.statusCode(b),b=void 0,d&&m.trigger(c?"ajaxSuccess":"ajaxError",[k,h,c?u:y]),v.fireWith(f,[k,S]),d&&(m.trigger("ajaxComplete",[k,h]),--p.active||p.event.trigger("ajaxStop")))}return k},getJSON:function(t,e,i){return p.get(t,e,i,"json")},getScript:function(t,e){return p.get(t,void 0,e,"script")}}),p.each(["get","post"],(function(t,e){p[e]=function(t,i,n,o){return p.isFunction(i)&&(o=o||n,n=i,i=void 0),p.ajax(p.extend({url:t,type:e,dataType:o,data:i,success:n},p.isPlainObject(t)&&t))}})),p._evalUrl=function(t){return p.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},p.fn.extend({wrapAll:function(t){var e;return p.isFunction(t)?this.each((function(e){p(this).wrapAll(t.call(this,e))})):(this[0]&&(e=p(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this)},wrapInner:function(t){return p.isFunction(t)?this.each((function(e){p(this).wrapInner(t.call(this,e))})):this.each((function(){var e=p(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=p.isFunction(t);return this.each((function(i){p(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(){return this.parent().each((function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)})).end()}}),p.expr.filters.hidden=function(t){return!p.expr.filters.visible(t)},p.expr.filters.visible=function(t){return t.offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0};var we=/%20/g,xe=/\[\]$/,ke=/\r?\n/g,Se=/^(?:submit|button|image|reset|file)$/i,Te=/^(?:input|select|textarea|keygen)/i;function Ce(t,e,i,n){var o;if(p.isArray(e))p.each(e,(function(e,o){i||xe.test(t)?n(t,o):Ce(t+"["+("object"==typeof o&&null!=o?e:"")+"]",o,i,n)}));else if(i||"object"!==p.type(e))n(t,e);else for(o in e)Ce(t+"["+o+"]",e[o],i,n)}p.param=function(t,e){var i,n=[],o=function(t,e){e=p.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=p.ajaxSettings&&p.ajaxSettings.traditional),p.isArray(t)||t.jquery&&!p.isPlainObject(t))p.each(t,(function(){o(this.name,this.value)}));else for(i in t)Ce(i,t[i],e,o);return n.join("&").replace(we,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=p.prop(this,"elements");return t?p.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!p(this).is(":disabled")&&Te.test(this.nodeName)&&!Se.test(t)&&(this.checked||!G.test(t))})).map((function(t,e){var i=p(this).val();return null==i?null:p.isArray(i)?p.map(i,(function(t){return{name:e.name,value:t.replace(ke,"\r\n")}})):{name:e.name,value:i.replace(ke,"\r\n")}})).get()}}),p.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(t){}};var De={0:200,1223:204},Me=p.ajaxSettings.xhr();u.cors=!!Me&&"withCredentials"in Me,u.ajax=Me=!!Me,p.ajaxTransport((function(e){var i,n;return u.cors||Me&&!e.crossDomain?{send:function(o,s){var a,r=e.xhr();if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)r[a]=e.xhrFields[a];for(a in e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)r.setRequestHeader(a,o[a]);i=function(t){return function(){i&&(i=n=r.onload=r.onerror=r.onabort=r.onreadystatechange=null,"abort"===t?r.abort():"error"===t?"number"!=typeof r.status?s(0,"error"):s(r.status,r.statusText):s(De[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=i(),n=r.onerror=i("error"),void 0!==r.onabort?r.onabort=n:r.onreadystatechange=function(){4===r.readyState&&t.setTimeout((function(){i&&n()}))},i=i("abort");try{r.send(e.hasContent&&e.data||null)}catch(t){if(i)throw t}},abort:function(){i&&i()}}:void 0})),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return p.globalEval(t),t}}}),p.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),p.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain)return{send:function(o,s){e=p("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&s("error"===t.type?404:200,t.type)}),n.head.appendChild(e[0])},abort:function(){i&&i()}}}));var Oe=[],Pe=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Oe.pop()||p.expando+"_"+re++;return this[t]=!0,t}}),p.ajaxPrefilter("json jsonp",(function(e,i,n){var o,s,a,r=!1!==e.jsonp&&(Pe.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pe.test(e.data)&&"data");return r||"jsonp"===e.dataTypes[0]?(o=e.jsonpCallback=p.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,r?e[r]=e[r].replace(Pe,"$1"+o):!1!==e.jsonp&&(e.url+=(le.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return a||p.error(o+" was not called"),a[0]},e.dataTypes[0]="json",s=t[o],t[o]=function(){a=arguments},n.always((function(){void 0===s?p(t).removeProp(o):t[o]=s,e[o]&&(e.jsonpCallback=i.jsonpCallback,Oe.push(o)),a&&p.isFunction(s)&&s(a[0]),a=s=void 0})),"script"):void 0})),p.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||n;var o=k.exec(t),s=!i&&[];return o?[e.createElement(o[1])]:(o=et([t],e,s),s&&s.length&&p(s).remove(),p.merge([],o.childNodes))};var Ee=p.fn.load;function Ae(t){return p.isWindow(t)?t:9===t.nodeType&&t.defaultView}p.fn.load=function(t,e,i){if("string"!=typeof t&&Ee)return Ee.apply(this,arguments);var n,o,s,a=this,r=t.indexOf(" ");return r>-1&&(n=p.trim(t.slice(r)),t=t.slice(0,r)),p.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&p.ajax({url:t,type:o||"GET",dataType:"html",data:e}).done((function(t){s=arguments,a.html(n?p("<div>").append(p.parseHTML(t)).find(n):t)})).always(i&&function(t,e){a.each((function(){i.apply(this,s||[t.responseText,e,t])}))}),this},p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){p.fn[e]=function(t){return this.on(e,t)}})),p.expr.filters.animated=function(t){return p.grep(p.timers,(function(e){return t===e.elem})).length},p.offset={setOffset:function(t,e,i){var n,o,s,a,r,l,c=p.css(t,"position"),d=p(t),u={};"static"===c&&(t.style.position="relative"),r=d.offset(),s=p.css(t,"top"),l=p.css(t,"left"),("absolute"===c||"fixed"===c)&&(s+l).indexOf("auto")>-1?(a=(n=d.position()).top,o=n.left):(a=parseFloat(s)||0,o=parseFloat(l)||0),p.isFunction(e)&&(e=e.call(t,i,p.extend({},r))),null!=e.top&&(u.top=e.top-r.top+a),null!=e.left&&(u.left=e.left-r.left+o),"using"in e?e.using.call(t,u):d.css(u)}},p.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){p.offset.setOffset(this,t,e)}));var e,i,n=this[0],o={top:0,left:0},s=n&&n.ownerDocument;return s?(e=s.documentElement,p.contains(e,n)?(o=n.getBoundingClientRect(),i=Ae(s),{top:o.top+i.pageYOffset-e.clientTop,left:o.left+i.pageXOffset-e.clientLeft}):o):void 0},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===p.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),p.nodeName(t[0],"html")||(n=t.offset()),n.top+=p.css(t[0],"borderTopWidth",!0),n.left+=p.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-p.css(i,"marginTop",!0),left:e.left-n.left-p.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===p.css(t,"position");)t=t.offsetParent;return t||Ot}))}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;p.fn[t]=function(n){return N(this,(function(t,n,o){var s=Ae(t);return void 0===o?s?s[e]:t[n]:void(s?s.scrollTo(i?s.pageXOffset:o,i?o:s.pageYOffset):t[n]=o)}),t,n,arguments.length)}})),p.each(["top","left"],(function(t,e){p.cssHooks[e]=Et(u.pixelPosition,(function(t,i){return i?(i=Pt(t,e),Ct.test(i)?p(t).position()[e]+"px":i):void 0}))})),p.each({Height:"height",Width:"width"},(function(t,e){p.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){p.fn[n]=function(n,o){var s=arguments.length&&(i||"boolean"!=typeof n),a=i||(!0===n||!0===o?"margin":"border");return N(this,(function(e,i,n){var o;return p.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===n?p.css(e,i,a):p.style(e,i,n,a)}),e,s?n:void 0,s,null)}}))})),p.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},size:function(){return this.length}}),p.fn.andSelf=p.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],(function(){return p}));var Ie=t.jQuery,Le=t.$;return p.noConflict=function(e){return t.$===p&&(t.$=Le),e&&t.jQuery===p&&(t.jQuery=Ie),p},e||(t.jQuery=t.$=p),p})),function(t){"use strict";var e="__RETRY__"+(new Date).getTime();t.ajaxPrefilter((function(i,n,o){if(!i[e]&&void 0!==i.shouldRetry){n[e]=!0;var s,a=t.Deferred(),r=t.Deferred(),l={},c=0,d=function(e,n,o){var s,a=i.shouldRetry;switch(typeof a){case"number":s=a>n;break;case"boolean":s=a;break;case"function":s=a(e,n,o)}return"object"==typeof s&&"function"==typeof s.then?t.Deferred((function(t){s.then(t.resolve,(function(){t.resolve(!1)}))})).promise():t.when(s)};(function e(i,n,u){(n?d(n,c++,i.type||"GET"):t.when(!0)).done((function(c){!0===c?(n?t.ajax(i):o).then((function(t,e,i){s=i.status,a.resolveWith(this,arguments),a.done(l[s]),r.resolveWith(this,[i,e])}),(function(t,n){var o=arguments,c=this;e(i,t,(function(){s=t.status,a.rejectWith(c,o),a.fail(l[s]),r.resolveWith(c,[t,n])}))})):u()}))})(t.extend({},n,{success:t.noop,error:t.noop,complete:t.noop,statusCode:{}})),o.complete&&(o.complete=r.done,o.success=a.done,o.error=a.fail),t.extend(o,a.promise()),o.statusCode=function(t){var e;if(t)if(function(t){return t.state?"pending"!==t.state():t.isResolved()||t.isRejected()}(a))a.then(t[s],t[s]);else for(e in t)l[e]=[l[e],t[e]];return this}}}))}(jQuery),function(){"use strict";function t(e,n){var o;if(n=n||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=n.touchBoundary||10,this.layer=e,this.tapDelay=n.tapDelay||200,this.tapTimeout=n.tapTimeout||700,!t.notNeeded(e)){for(var s=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],a=this,r=0,l=s.length;r<l;r++)a[s[r]]=c(a[s[r]],a);i&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,i,n){var o=Node.prototype.removeEventListener;"click"===t?o.call(e,t,i.hijacked||i,n):o.call(e,t,i,n)},e.addEventListener=function(t,i,n){var o=Node.prototype.addEventListener;"click"===t?o.call(e,t,i.hijacked||(i.hijacked=function(t){t.propagationStopped||i(t)}),n):o.call(e,t,i,n)}),"function"==typeof e.onclick&&(o=e.onclick,e.addEventListener("click",(function(t){o(t)}),!1),e.onclick=null)}function c(t,e){return function(){return t.apply(e,arguments)}}}var e=navigator.userAgent.indexOf("Windows Phone")>=0,i=navigator.userAgent.indexOf("Android")>0&&!e,n=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e,o=n&&/OS 4_\d(_\d)?/.test(navigator.userAgent),s=n&&/OS [6-7]_\d/.test(navigator.userAgent),a=navigator.userAgent.indexOf("BB10")>0;t.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(n&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},t.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!i;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},t.prototype.sendClick=function(t,e){var i,n;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),n=e.changedTouches[0],(i=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(t),!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),i.forwardedTouchEvent=!0,t.dispatchEvent(i)},t.prototype.determineEventType=function(t){return i&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},t.prototype.focus=function(t){var e;n&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type&&"email"!==t.type?(e=t.value.length,t.focus(),t.setSelectionRange(e,e)):t.focus()},t.prototype.updateScrollParent=function(t){var e,i;if(!(e=t.fastClickScrollParent)||!e.contains(t)){i=t;do{if(i.scrollHeight>i.offsetHeight){e=i,t.fastClickScrollParent=i;break}i=i.parentElement}while(i)}e&&(e.fastClickLastScrollTop=e.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},t.prototype.onTouchStart=function(t){var e,i,s,a;if(t.timeStamp<0?(a=(new Date).getTime(),this.isTrackingClickStartFromEvent=!1):(a=t.timeStamp,this.isTrackingClickStartFromEvent=!0),t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),i=t.targetTouches[0],n){if((s=window.getSelection()).rangeCount&&!s.isCollapsed)return!0;if(!o){if(i.identifier&&i.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=i.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=a,this.targetElement=e,this.touchStartX=i.pageX,this.touchStartY=i.pageY,a-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},t.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],i=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>i||Math.abs(e.pageY-this.touchStartY)>i},t.prototype.onTouchMove=function(t){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0)},t.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},t.prototype.onTouchEnd=function(t){var e,a,r,l,c,d,u=this.targetElement;if(d=this.isTrackingClickStartFromEvent?t.timeStamp:(new Date).getTime(),!this.trackingClick)return!0;if(d-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(d-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=d,a=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,s&&(c=t.changedTouches[0],(u=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset)||u).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(r=u.tagName.toLowerCase())){if(e=this.findControl(u)){if(this.focus(u),i)return!1;u=e}}else if(this.needsFocus(u))return d-a>100||n&&window.top!==window&&"input"===r?(this.targetElement=null,!1):(this.focus(u),this.sendClick(u,t),n&&"select"===r||(this.targetElement=null,t.preventDefault()),!1);return!(!n||o||!(l=u.fastClickScrollParent)||l.fastClickLastScrollTop===l.scrollTop)||(this.needsClick(u)||(t.preventDefault(),this.sendClick(u,t)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(t){return!(this.targetElement&&!t.forwardedTouchEvent&&t.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)&&(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),1))},t.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail||((e=this.onMouse(t))||(this.targetElement=null),e)},t.prototype.destroy=function(){var t=this.layer;i&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},t.notNeeded=function(t){var e,n,o;if(void 0===window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!i)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(a&&(o=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]>=10&&o[2]>=3&&(e=document.querySelector("meta[name=viewport]"))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction||!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(e=document.querySelector("meta[name=viewport]"))&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||"none"===t.style.touchAction||"manipulation"===t.style.touchAction},t.attach=function(e,i){return new t(e,i)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define((function(){return t})):"undefined"!=typeof module&&module.exports?(module.exports=t.attach,module.exports.FastClick=t):window.FastClick=t}(),"undefined"==typeof links&&(links={}),"undefined"==typeof google&&(google=void 0),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this[e]==t)return e;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var i=0,n=this.length;n>i;++i)t.call(e||this,this[i],i,this)}),links.Timeline=function(t,e){if(t){this.dom={},this.conversion={},this.eventParams={},this.groups=[],this.groupIndexes={},this.items=[],this.renderQueue={show:[],hide:[],update:[]},this.renderedItems=[],this.clusterGenerator=new links.Timeline.ClusterGenerator(this),this.currentClusters=[],this.selection=void 0,this.listeners={},this.size={actualHeight:0,axis:{characterMajorHeight:0,characterMajorWidth:0,characterMinorHeight:0,characterMinorWidth:0,height:0,labelMajorTop:0,labelMinorTop:0,line:0,lineMajorWidth:0,lineMinorHeight:0,lineMinorTop:0,lineMinorWidth:0,top:0},contentHeight:0,contentLeft:0,contentWidth:0,frameHeight:0,frameWidth:0,groupsLeft:0,groupsWidth:0,items:{top:0}},this.dom.container=t,this.options={width:"100%",height:"auto",minHeight:0,groupMinHeight:0,autoHeight:!0,eventMargin:10,eventMarginAxis:20,dragAreaWidth:10,min:void 0,max:void 0,zoomMin:10,zoomMax:31536e10,moveable:!0,zoomable:!0,selectable:!0,unselectable:!0,editable:!1,snapEvents:!0,groupChangeable:!0,timeChangeable:!0,showCurrentTime:!0,showCustomTime:!1,showMajorLabels:!0,showMinorLabels:!0,showNavigation:!1,showButtonNew:!1,groupsOnRight:!1,groupsOrder:!0,axisOnTop:!1,stackEvents:!0,animate:!0,animateZoom:!0,cluster:!1,clusterMaxItems:5,style:"box",customStackOrder:!1,locale:"en",MONTHS:["January","February","March","April","May","June","July","August","September","October","November","December"],MONTHS_SHORT:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DAYS_SHORT:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ZOOM_IN:"Zoom in",ZOOM_OUT:"Zoom out",MOVE_LEFT:"Move left",MOVE_RIGHT:"Move right",NEW:"New",CREATE_NEW_EVENT:"Create new event"},this.setOptions(e),this.clientTimeOffset=0;for(var i=this.dom;i.container.hasChildNodes();)i.container.removeChild(i.container.firstChild);this.step=new links.Timeline.StepDate,this.itemTypes={box:links.Timeline.ItemBox,range:links.Timeline.ItemRange,floatingRange:links.Timeline.ItemFloatingRange,dot:links.Timeline.ItemDot},this.data=[],this.firstDraw=!0,this.setVisibleChartRange(void 0,void 0,!1),this.render();var n=this;setTimeout((function(){n.trigger("ready")}),0)}},links.Timeline.prototype.draw=function(t,e){e&&console.log("WARNING: Passing options in draw() is deprecated. Pass options to the constructur or use setOptions() instead!"),this.setOptions(e),this.options.selectable&&links.Timeline.addClassName(this.dom.frame,"timeline-selectable"),this.setData(t),e&&(e.start||e.end)?this.setVisibleChartRange(e.start,e.end):this.firstDraw&&this.setVisibleChartRangeAuto(),this.firstDraw=!1},links.Timeline.prototype.setOptions=function(t){if(t){for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e]);if(void 0!==links.locales&&"en"!==this.options.locale){var i=links.locales[this.options.locale];if(i)for(var n in i)i.hasOwnProperty(n)&&(this.options[n]=i[n])}null!=t.showButtonAdd&&(this.options.showButtonNew=t.showButtonAdd,console.log("WARNING: Option showButtonAdd is deprecated. Use showButtonNew instead")),null!=t.intervalMin&&(this.options.zoomMin=t.intervalMin,console.log("WARNING: Option intervalMin is deprecated. Use zoomMin instead")),null!=t.intervalMax&&(this.options.zoomMax=t.intervalMax,console.log("WARNING: Option intervalMax is deprecated. Use zoomMax instead")),t.scale&&t.step&&this.step.setScale(t.scale,t.step)}this.options.autoHeight="auto"===this.options.height},links.Timeline.prototype.getOptions=function(){return this.options},links.Timeline.prototype.addItemType=function(t,e){this.itemTypes[t]=e},links.Timeline.mapColumnIds=function(t){for(var e={},i=t.getNumberOfColumns(),n=!0,o=0;i>o;o++){var s=t.getColumnId(o)||t.getColumnLabel(o);e[s]=o,("start"==s||"end"==s||"content"==s||"group"==s||"className"==s||"editable"==s||"type"==s)&&(n=!1)}return n&&(e.start=0,e.end=1,e.content=2,i>3&&(e.group=3),i>4&&(e.className=4),i>5&&(e.editable=5),i>6&&(e.type=6)),e},links.Timeline.prototype.setData=function(t){this.unselectItem(),t||(t=[]),this.stackCancelAnimation(),this.clearItems(),this.data=t;var e=this.items;if(this.deleteGroups(),google&&google.visualization&&t instanceof google.visualization.DataTable)for(var i=links.Timeline.mapColumnIds(t),n=0,o=t.getNumberOfRows();o>n;n++)e.push(this.createItem({start:null!=i.start?t.getValue(n,i.start):void 0,end:null!=i.end?t.getValue(n,i.end):void 0,content:null!=i.content?t.getValue(n,i.content):void 0,group:null!=i.group?t.getValue(n,i.group):void 0,className:null!=i.className?t.getValue(n,i.className):void 0,editable:null!=i.editable?t.getValue(n,i.editable):void 0,type:null!=i.type?t.getValue(n,i.type):void 0}));else{if(!links.Timeline.isArray(t))throw"Unknown data type. DataTable or Array expected.";for(n=0,o=t.length;o>n;n++){var s=t[n],a=this.createItem(s);e.push(a)}}this.options.cluster&&this.clusterGenerator.setData(this.items),this.render({animate:!1})},links.Timeline.prototype.getData=function(){return this.data},links.Timeline.prototype.updateData=function(t,e){var i,n=this.data;if(google&&google.visualization&&n instanceof google.visualization.DataTable){var o=t+1-n.getNumberOfRows();o>0&&n.addRows(o);var s=links.Timeline.mapColumnIds(n);for(i in e)if(e.hasOwnProperty(i)){var a=s[i];if(null==a){var r=e[i],l="string";"number"==typeof r?l="number":"boolean"==typeof r?l="boolean":r instanceof Date&&(l="datetime"),a=n.addColumn(l,i)}n.setValue(t,a,e[i])}}else{if(!links.Timeline.isArray(n))throw"Cannot update data, unknown type of data";var c=n[t];for(i in null==c&&(c={},n[t]=c),e)e.hasOwnProperty(i)&&(c[i]=e[i])}},links.Timeline.prototype.getItemIndex=function(t){for(var e=t,i=this.dom.items.frame,n=this.items,o=void 0;e.parentNode&&e.parentNode!==i;)e=e.parentNode;if(e.parentNode===i)for(var s=0,a=n.length;a>s;s++)if(n[s].dom===e){o=s;break}return o},links.Timeline.prototype.getClusterIndex=function(t){var e=t,i=this.dom.items.frame,n=this.clusters,o=void 0;if(this.clusters){for(;e.parentNode&&e.parentNode!==i;)e=e.parentNode;if(e.parentNode===i)for(var s=0,a=n.length;a>s;s++)if(n[s].dom===e){o=s;break}}return o},links.Timeline.prototype.getVisibleItems=function(t,e){var i=this.items,n=[];if(i)for(var o=0,s=i.length;s>o;o++){var a=i[o];a.end?t<=a.start&&a.end<=e&&n.push({row:o}):t<=a.start&&a.start<=e&&n.push({row:o})}return n},links.Timeline.prototype.setSize=function(t,e){t&&(this.options.width=t,this.dom.frame.style.width=t),e&&(this.options.height=e,this.options.autoHeight="auto"===this.options.height,"auto"!==e&&(this.dom.frame.style.height=e)),this.render({animate:!1})},links.Timeline.prototype.setVisibleChartRange=function(t,e,i){var n={};t&&e||(n=this.getDataRange(!0)),t||(e?n.min&&n.min.valueOf()<e.valueOf()?t=n.min:(t=new Date(e.valueOf())).setDate(t.getDate()-7):(t=new Date).setDate(t.getDate()-3)),e||(n.max?e=n.max:(e=new Date(t.valueOf())).setDate(e.getDate()+7)),t>=e&&(e=new Date(t.valueOf())).setDate(e.getDate()+7);var o=this.options.min?this.options.min:void 0;null!=o&&t.valueOf()<o.valueOf()&&(t=new Date(o.valueOf()));var s=this.options.max?this.options.max:void 0;null!=s&&e.valueOf()>s.valueOf()&&(e=new Date(s.valueOf())),this.applyRange(t,e),null==i||1==i?this.render({animate:!1}):this.recalcConversion()},links.Timeline.prototype.setVisibleChartRangeAuto=function(){var t=this.getDataRange(!0);this.setVisibleChartRange(t.min,t.max)},links.Timeline.prototype.setVisibleChartRangeNow=function(){var t=new Date,e=this.end.valueOf()-this.start.valueOf(),i=new Date(t.valueOf()-e/2),n=new Date(i.valueOf()+e);this.setVisibleChartRange(i,n)},links.Timeline.prototype.getVisibleChartRange=function(){return{start:new Date(this.start.valueOf()),end:new Date(this.end.valueOf())}},links.Timeline.prototype.getDataRange=function(t){var e=this.items,i=void 0,n=void 0;if(e)for(var o=0,s=e.length;s>o;o++){var a=e[o],r=null!=a.start?a.start.valueOf():void 0,l=null!=a.end?a.end.valueOf():r;null!=r&&(i=null!=i?Math.min(i.valueOf(),r.valueOf()):r),null!=l&&(n=null!=n?Math.max(n.valueOf(),l.valueOf()):l)}if(i&&n&&t){var c=n-i;i-=.05*c,n+=.05*c}return{min:null!=i?new Date(i):void 0,max:null!=n?new Date(n):void 0}},links.Timeline.prototype.render=function(t){var e=(this.reflowFrame(),this.reflowAxis(),this.reflowGroups(),this.reflowItems(),this.options.animate);if(t&&null!=t.animate&&(e=t.animate),this.recalcConversion(),this.clusterItems(),this.filterItems(),this.stackItems(e),this.recalcItems(),this.repaint()){var i=t?t.renderTimesLeft:void 0;null==i&&(i=5),i>0&&this.render({animate:t?t.animate:void 0,renderTimesLeft:i-1})}},links.Timeline.prototype.repaint=function(){var t=this.repaintFrame(),e=this.repaintAxis(),i=this.repaintGroups(),n=this.repaintItems();return this.repaintCurrentTime(),this.repaintCustomTime(),t||e||i||n},links.Timeline.prototype.reflowFrame=function(){var t=this.dom,e=(this.options,this.size),i=!1,n=t.frame?t.frame.offsetWidth:0,o=t.frame?t.frame.clientHeight:0;return i=(i=i||e.frameWidth!==n)||e.frameHeight!==o,e.frameWidth=n,e.frameHeight=o,i},links.Timeline.prototype.repaintFrame=function(){var t=!1,e=this.dom,i=this.options,n=this.size;e.frame||(e.frame=document.createElement("DIV"),e.frame.className="timeline-frame ui-widget ui-widget-content ui-corner-all",e.container.appendChild(e.frame),t=!0);var o=i.autoHeight?n.actualHeight+"px":i.height||"100%",s=i.width||"100%";if(t=(t=t||e.frame.style.height!=o)||e.frame.style.width!=s,e.frame.style.height=o,e.frame.style.width=s,!e.content){e.content=document.createElement("DIV"),e.content.className="timeline-content",e.frame.appendChild(e.content);var a=document.createElement("DIV");a.style.position="absolute",a.style.left="0px",a.style.top="0px",a.style.height="100%",a.style.width="0px",e.content.appendChild(a),e.contentTimelines=a;var r=this.eventParams,l=this;r.onMouseDown||(r.onMouseDown=function(t){l.onMouseDown(t)},links.Timeline.addEventListener(e.content,"mousedown",r.onMouseDown)),r.onTouchStart||(r.onTouchStart=function(t){l.onTouchStart(t)},links.Timeline.addEventListener(e.content,"touchstart",r.onTouchStart)),r.onMouseWheel||(r.onMouseWheel=function(t){l.onMouseWheel(t)},links.Timeline.addEventListener(e.content,"mousewheel",r.onMouseWheel)),r.onDblClick||(r.onDblClick=function(t){l.onDblClick(t)},links.Timeline.addEventListener(e.content,"dblclick",r.onDblClick)),t=!0}return e.content.style.left=n.contentLeft+"px",e.content.style.top="0px",e.content.style.width=n.contentWidth+"px",e.content.style.height=n.frameHeight+"px",this.repaintNavigation(),t},links.Timeline.prototype.reflowAxis=function(){var t=!1,e=this.dom,i=this.options,n=this.size,o=e.axis,s=o&&o.characterMinor?o.characterMinor.clientWidth:0,a=o&&o.characterMinor?o.characterMinor.clientHeight:0,r=o&&o.characterMajor?o.characterMajor.clientWidth:0,l=o&&o.characterMajor?o.characterMajor.clientHeight:0,c=(i.showMinorLabels?a:0)+(i.showMajorLabels?l:0),d=i.axisOnTop?0:n.frameHeight-c,u=i.axisOnTop?c:d;t=(t=(t=t||n.axis.top!==d)||n.axis.line!==u)||n.axis.height!==c,n.axis.top=d,n.axis.line=u,n.axis.height=c,n.axis.labelMajorTop=i.axisOnTop?0:u+(i.showMinorLabels?a:0),n.axis.labelMinorTop=i.axisOnTop?i.showMajorLabels?l:0:u,n.axis.lineMinorTop=i.axisOnTop?n.axis.labelMinorTop:0,n.axis.lineMinorHeight=i.showMajorLabels?n.frameHeight-l:n.frameHeight,n.axis.lineMinorWidth=o&&o.minorLines&&o.minorLines.length?o.minorLines[0].offsetWidth:1,n.axis.lineMajorWidth=o&&o.majorLines&&o.majorLines.length?o.majorLines[0].offsetWidth:1,t=(t=(t=(t=t||n.axis.characterMinorWidth!==s)||n.axis.characterMinorHeight!==a)||n.axis.characterMajorWidth!==r)||n.axis.characterMajorHeight!==l,n.axis.characterMinorWidth=s,n.axis.characterMinorHeight=a,n.axis.characterMajorWidth=r,n.axis.characterMajorHeight=l;var h=Math.max(n.frameHeight-c,0);return n.contentLeft=i.groupsOnRight?0:n.groupsWidth,n.contentWidth=Math.max(n.frameWidth-n.groupsWidth,0),n.contentHeight=h,t},links.Timeline.prototype.repaintAxis=function(){var t=!1,e=this.dom,i=this.options,n=this.size,o=this.step,s=e.axis;s||(s={},e.axis=s),n.axis.properties||(n.axis.properties={}),s.minorTexts||(s.minorTexts=[]),s.minorLines||(s.minorLines=[]),s.majorTexts||(s.majorTexts=[]),s.majorLines||(s.majorLines=[]),s.frame||(s.frame=document.createElement("DIV"),s.frame.style.position="absolute",s.frame.style.left="0px",s.frame.style.top="0px",e.content.appendChild(s.frame)),e.content.removeChild(s.frame),s.frame.style.width=n.contentWidth+"px",s.frame.style.height=n.axis.height+"px";var a=this.screenToTime(0),r=this.screenToTime(n.contentWidth);n.axis.characterMinorWidth&&(this.minimumStep=this.screenToTime(6*n.axis.characterMinorWidth)-this.screenToTime(0),o.setRange(a,r,this.minimumStep));var l=this.repaintAxisCharacters();t=t||l,this.repaintAxisStartOverwriting(),o.start();for(var c=void 0,d=0;!o.end()&&1e3>d;){d++;var u=o.getCurrent(),h=this.timeToScreen(u),p=o.isMajor();i.showMinorLabels&&this.repaintAxisMinorText(h,o.getLabelMinor(i)),p&&i.showMajorLabels?(h>0&&(null==c&&(c=h),this.repaintAxisMajorText(h,o.getLabelMajor(i))),this.repaintAxisMajorLine(h)):this.repaintAxisMinorLine(h),o.next()}if(i.showMajorLabels){var f=this.screenToTime(0),m=this.step.getLabelMajor(i,f),g=m.length*n.axis.characterMajorWidth+10;(null==c||c>g)&&this.repaintAxisMajorText(0,m,f)}return this.repaintAxisEndOverwriting(),this.repaintAxisHorizontal(),e.content.insertBefore(s.frame,e.content.firstChild),t},links.Timeline.prototype.repaintAxisCharacters=function(){var t,e=!1,i=this.dom.axis;if(!i.characterMinor){t=document.createTextNode("0");var n=document.createElement("DIV");n.className="timeline-axis-text timeline-axis-text-minor",n.appendChild(t),n.style.position="absolute",n.style.visibility="hidden",n.style.paddingLeft="0px",n.style.paddingRight="0px",i.frame.appendChild(n),i.characterMinor=n,e=!0}if(!i.characterMajor){t=document.createTextNode("0");var o=document.createElement("DIV");o.className="timeline-axis-text timeline-axis-text-major",o.appendChild(t),o.style.position="absolute",o.style.visibility="hidden",o.style.paddingLeft="0px",o.style.paddingRight="0px",i.frame.appendChild(o),i.characterMajor=o,e=!0}return e},links.Timeline.prototype.repaintAxisStartOverwriting=function(){var t=this.size.axis.properties;t.minorTextNum=0,t.minorLineNum=0,t.majorTextNum=0,t.majorLineNum=0},links.Timeline.prototype.repaintAxisEndOverwriting=function(){var t,e=this.dom,i=this.size.axis.properties,n=this.dom.axis.frame,o=e.axis.minorTexts;for(t=i.minorTextNum;o.length>t;){var s=o[t];n.removeChild(s),o.splice(t,1)}var a=e.axis.minorLines;for(t=i.minorLineNum;a.length>t;){var r=a[t];n.removeChild(r),a.splice(t,1)}var l=e.axis.majorTexts;for(t=i.majorTextNum;l.length>t;){var c=l[t];n.removeChild(c),l.splice(t,1)}var d=e.axis.majorLines;for(t=i.majorLineNum;d.length>t;){var u=d[t];n.removeChild(u),d.splice(t,1)}},links.Timeline.prototype.repaintAxisHorizontal=function(){var t=this.dom.axis,e=this.size,i=this.options,n=i.showMinorLabels||i.showMajorLabels;if(n){if(!t.backgroundLine){var o=document.createElement("DIV");o.className="timeline-axis",o.style.position="absolute",o.style.left="0px",o.style.width="100%",o.style.border="none",t.frame.insertBefore(o,t.frame.firstChild),t.backgroundLine=o}t.backgroundLine&&(t.backgroundLine.style.top=e.axis.top+"px",t.backgroundLine.style.height=e.axis.height+"px")}else t.backgroundLine&&(t.frame.removeChild(t.backgroundLine),delete t.backgroundLine);if(n){if(t.line){var s=t.frame.removeChild(t.line);t.frame.appendChild(s)}else{(s=document.createElement("DIV")).className="timeline-axis",s.style.position="absolute",s.style.left="0px",s.style.width="100%",s.style.height="0px",t.frame.appendChild(s),t.line=s}t.line.style.top=e.axis.line+"px"}else t.line&&t.line.parentElement&&(t.frame.removeChild(t.line),delete t.line)},links.Timeline.prototype.repaintAxisMinorText=function(t,e){var i,n=this.size,o=this.dom,s=n.axis.properties,a=o.axis.frame,r=o.axis.minorTexts,l=s.minorTextNum;if(l<r.length)i=r[l];else{var c=document.createTextNode("");(i=document.createElement("DIV")).appendChild(c),i.className="timeline-axis-text timeline-axis-text-minor",i.style.position="absolute",a.appendChild(i),r.push(i)}i.childNodes[0].nodeValue=e,i.style.left=t+"px",i.style.top=n.axis.labelMinorTop+"px",s.minorTextNum++},links.Timeline.prototype.repaintAxisMinorLine=function(t){var e,i=this.size.axis,n=this.dom,o=i.properties,s=n.axis.frame,a=n.axis.minorLines,r=o.minorLineNum;r<a.length?e=a[r]:((e=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-minor",e.style.position="absolute",e.style.width="0px",s.appendChild(e),a.push(e)),e.style.top=i.lineMinorTop+"px",e.style.height=i.lineMinorHeight+"px",e.style.left=t-i.lineMinorWidth/2+"px",o.minorLineNum++},links.Timeline.prototype.repaintAxisMajorText=function(t,e){var i,n=this.size,o=n.axis.properties,s=this.dom.axis.frame,a=this.dom.axis.majorTexts,r=o.majorTextNum;if(r<a.length)i=a[r];else{var l=document.createTextNode(e);(i=document.createElement("DIV")).className="timeline-axis-text timeline-axis-text-major",i.appendChild(l),i.style.position="absolute",i.style.top="0px",s.appendChild(i),a.push(i)}i.childNodes[0].nodeValue=e,i.style.top=n.axis.labelMajorTop+"px",i.style.left=t+"px",o.majorTextNum++},links.Timeline.prototype.repaintAxisMajorLine=function(t){var e,i=this.size,n=i.axis.properties,o=this.size.axis,s=this.dom.axis.frame,a=this.dom.axis.majorLines,r=n.majorLineNum;r<a.length?e=a[r]:((e=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-major",e.style.position="absolute",e.style.top="0px",e.style.width="0px",s.appendChild(e),a.push(e)),e.style.left=t-o.lineMajorWidth/2+"px",e.style.height=i.frameHeight+"px",n.majorLineNum++},links.Timeline.prototype.reflowItems=function(){var t,e,i,n=!1,o=this.groups,s=this.renderedItems;for(o&&o.forEach((function(t){t.itemsHeight=0})),t=0,e=s.length;e>t;t++){var a=s[t],r=a.dom;if(i=a.group,r){var l=r?r.clientWidth:0,c=r?r.clientHeight:0;n=(n=n||a.width!=l)||a.height!=c,a.width=l,a.height=c,a.reflow()}i&&(i.itemsHeight=Math.max(this.options.groupMinHeight,i.itemsHeight?Math.max(i.itemsHeight,a.height):a.height))}return n},links.Timeline.prototype.recalcItems=function(){var t,e,i,n,o,s,a=!1,r=this.groups,l=this.size,c=this.options,d=this.renderedItems,u=0;if(0==r.length){if(c.autoHeight||c.cluster){var h=0,p=0;if(this.stack&&this.stack.finalItems)for((n=(o=this.stack.finalItems)[0])&&n.top&&(h=n.top,p=n.top+n.height),t=1,e=o.length;e>t;t++)n=o[t],h=Math.min(h,n.top),p=Math.max(p,n.top+n.height);else for((i=d[0])&&i.top&&(h=i.top,p=i.top+i.height),t=1,e=d.length;e>t;t++)(i=d[t]).top&&(h=Math.min(h,i.top),p=Math.max(p,i.top+i.height));if((u=p-h+2*c.eventMarginAxis+l.axis.height)<c.minHeight&&(u=c.minHeight),l.actualHeight!=u&&c.autoHeight&&!c.axisOnTop){var f=u-l.actualHeight;if(this.stack&&this.stack.finalItems)for(t=0,e=(o=this.stack.finalItems).length;e>t;t++)o[t].top+=f,o[t].item.top+=f;else for(t=0,e=d.length;e>t;t++)d[t].top+=f}}}else{for(u=l.axis.height+2*c.eventMarginAxis,t=0,e=r.length;e>t;t++){var m=(s=r[t]).itemsHeight;a=a||m!=s.height,s.height=Math.max(m,c.groupMinHeight),u+=r[t].height+c.eventMargin}var g=c.eventMargin,v=c.axisOnTop?c.eventMarginAxis+g/2:l.contentHeight-c.eventMarginAxis+g/2,b=l.axis.height;for(t=0,e=r.length;e>t;t++)s=r[t],c.axisOnTop?(s.top=v+b,s.labelTop=v+b+(s.height-s.labelHeight)/2,s.lineTop=v+b+s.height+g/2,v+=s.height+g):(v-=s.height+g,s.top=v,s.labelTop=v+(s.height-s.labelHeight)/2,s.lineTop=v-g/2);a=!0}return u<c.minHeight&&(u=c.minHeight),a=a||u!=l.actualHeight,l.actualHeight=u,a},links.Timeline.prototype.clearItems=function(){var t=this.renderQueue.hide;this.renderedItems.forEach((function(e){t.push(e)})),this.clusterGenerator.clear(),this.items=[]},links.Timeline.prototype.repaintItems=function(){var t,e,i=!1,n=this.dom,o=this.size,s=this,a=this.renderedItems;n.items||(n.items={});var r=n.items.frame;r||((r=document.createElement("DIV")).style.position="relative",n.content.appendChild(r),n.items.frame=r),r.style.left="0px",r.style.top=o.items.top+"px",r.style.height="0px",n.content.removeChild(r);var l=this.renderQueue,c=[];for(i=i||l.show.length>0||l.update.length>0||l.hide.length>0;t=l.show.shift();)t.showDOM(r),t.getImageUrls(c),a.push(t);for(;t=l.update.shift();)t.updateDOM(r),t.getImageUrls(c),-1==(e=this.renderedItems.indexOf(t))&&a.push(t);for(;t=l.hide.shift();)t.hideDOM(r),-1!=(e=this.renderedItems.indexOf(t))&&a.splice(e,1);if(a.forEach((function(t){t.updatePosition(s)})),this.repaintDeleteButton(),this.repaintDragAreas(),n.content.appendChild(r),c.length){links.imageloader.loadAll(c,(function(){s.render()}),!1)}return i},links.Timeline.prototype.reflowGroups=function(){for(var t=!1,e=this.options,i=this.size,n=this.dom,o=0,s=this.groups,a=this.dom.groups?this.dom.groups.labels:[],r=0,l=s.length;l>r;r++){var c=s[r],d=a[r];c.labelWidth=d?d.clientWidth:0,c.labelHeight=d?d.clientHeight:0,c.width=c.labelWidth,o=Math.max(o,c.width)}void 0!==e.groupsWidth&&(o=n.groups.frame?n.groups.frame.clientWidth:0),o+=1;var u=e.groupsOnRight?i.frameWidth-o:0;return t=(t=t||i.groupsWidth!==o)||i.groupsLeft!==u,i.groupsWidth=o,i.groupsLeft=u,t},links.Timeline.prototype.repaintGroups=function(){var t=this.dom,e=this,i=this.options,n=this.size,o=this.groups;void 0===t.groups&&(t.groups={});var s=t.groups.labels;s||(s=[],t.groups.labels=s);var a=t.groups.labelLines;a||(a=[],t.groups.labelLines=a);var r=t.groups.itemLines;r||(r=[],t.groups.itemLines=r);var l=t.groups.frame;l||((l=document.createElement("DIV")).className="timeline-groups-axis",l.style.position="absolute",l.style.overflow="hidden",l.style.top="0px",l.style.height="100%",t.frame.appendChild(l),t.groups.frame=l),l.style.left=n.groupsLeft+"px",l.style.width=void 0!==i.groupsWidth?i.groupsWidth:n.groupsWidth+"px",l.style.display=0==o.length?"none":"";for(var c=s.length,d=o.length,u=0,h=Math.min(c,d);h>u;u++){var p=o[u];(f=s[u]).innerHTML=this.getGroupName(p),f.style.display=""}for(u=c;d>u;u++){p=o[u];(f=document.createElement("DIV")).className="timeline-groups-text",f.style.position="absolute",void 0===i.groupsWidth&&(f.style.whiteSpace="nowrap"),f.innerHTML=this.getGroupName(p),l.appendChild(f),s[u]=f,(m=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-minor",m.style.position="absolute",m.style.left="0px",m.style.width="100%",m.style.height="0px",m.style.borderTopStyle="solid",l.appendChild(m),a[u]=m,(g=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-minor",g.style.position="absolute",g.style.left="0px",g.style.width="100%",g.style.height="0px",g.style.borderTopStyle="solid",t.content.insertBefore(g,t.content.firstChild),r[u]=g}for(u=d;c>u;u++){var f=s[u],m=a[u],g=r[u];l.removeChild(f),l.removeChild(m),t.content.removeChild(g)}s.splice(d,c-d),a.splice(d,c-d),r.splice(d,c-d),links.Timeline.addClassName(l,i.groupsOnRight?"timeline-groups-axis-onright":"timeline-groups-axis-onleft");for(u=0,h=o.length;h>u;u++){p=o[u],f=s[u],m=a[u],g=r[u];f.style.top=p.labelTop+"px",m.style.top=p.lineTop+"px",g.style.top=p.lineTop+"px",g.style.width=n.contentWidth+"px"}if(!t.groups.background){var v=document.createElement("DIV");v.className="timeline-axis",v.style.position="absolute",v.style.left="0px",v.style.width="100%",v.style.border="none",l.appendChild(v),t.groups.background=v}if(t.groups.background.style.top=n.axis.top+"px",t.groups.background.style.height=n.axis.height+"px",!t.groups.line){var b=document.createElement("DIV");b.className="timeline-axis",b.style.position="absolute",b.style.left="0px",b.style.width="100%",b.style.height="0px",l.appendChild(b),t.groups.line=b}if(t.groups.line.style.top=n.axis.line+"px",t.groups.frame&&o.length){var y=[];if(links.imageloader.filterImageUrls(t.groups.frame,y),y.length){links.imageloader.loadAll(y,(function(){e.render()}),!1)}}},links.Timeline.prototype.repaintCurrentTime=function(){var t=this.options,e=this.dom,i=this.size;if(t.showCurrentTime){if(!e.currentTime){var n=document.createElement("DIV");n.className="timeline-currenttime",n.style.position="absolute",n.style.top="0px",n.style.height="100%",e.contentTimelines.appendChild(n),e.currentTime=n}var o=new Date,s=new Date(o.valueOf()+this.clientTimeOffset),a=this.timeToScreen(s),r=a>-i.contentWidth&&a<2*i.contentWidth;e.currentTime.style.display=r?"":"none",e.currentTime.style.left=a+"px",e.currentTime.title="Current time: "+s,null!=this.currentTimeTimer&&(clearTimeout(this.currentTimeTimer),delete this.currentTimeTimer);var l=this,c=1/this.conversion.factor/2;30>c&&(c=30),this.currentTimeTimer=setTimeout((function(){l.repaintCurrentTime()}),c)}else e.currentTime&&(e.contentTimelines.removeChild(e.currentTime),delete e.currentTime)},links.Timeline.prototype.repaintCustomTime=function(){var t=this.options,e=this.dom,i=this.size;if(t.showCustomTime){if(!e.customTime){var n=document.createElement("DIV");n.className="timeline-customtime",n.style.position="absolute",n.style.top="0px",n.style.height="100%";var o=document.createElement("DIV");o.style.position="relative",o.style.top="0px",o.style.left="-10px",o.style.height="100%",o.style.width="20px",n.appendChild(o),e.contentTimelines.appendChild(n),e.customTime=n,this.customTime=new Date}var s=this.timeToScreen(this.customTime),a=s>-i.contentWidth&&s<2*i.contentWidth;e.customTime.style.display=a?"":"none",e.customTime.style.left=s+"px",e.customTime.title="Time: "+this.customTime}else e.customTime&&(e.contentTimelines.removeChild(e.customTime),delete e.customTime)},links.Timeline.prototype.repaintDeleteButton=function(){var t=this.dom,e=t.items.frame,i=t.items.deleteButton;i||((i=document.createElement("DIV")).className="timeline-navigation-delete",i.style.position="absolute",e.appendChild(i),t.items.deleteButton=i);var n=this.selection&&void 0!==this.selection.index?this.selection.index:-1,o=this.selection&&void 0!==this.selection.index?this.items[n]:void 0;if(o&&o.rendered&&this.isEditable(o)){var s=o.getRight(this),a=o.top;i.style.left=s+"px",i.style.top=a+"px",i.style.display="",e.removeChild(i),e.appendChild(i)}else i.style.display="none"},links.Timeline.prototype.repaintDragAreas=function(){var t=this.options,e=this.dom,i=this.dom.items.frame,n=e.items.dragLeft;n||((n=document.createElement("DIV")).className="timeline-event-range-drag-left",n.style.position="absolute",i.appendChild(n),e.items.dragLeft=n);var o=e.items.dragRight;o||((o=document.createElement("DIV")).className="timeline-event-range-drag-right",o.style.position="absolute",i.appendChild(o),e.items.dragRight=o);var s=this.selection&&void 0!==this.selection.index?this.selection.index:-1,a=this.selection&&void 0!==this.selection.index?this.items[s]:void 0;if(a&&a.rendered&&this.isEditable(a)&&(a instanceof links.Timeline.ItemRange||a instanceof links.Timeline.ItemFloatingRange)){var r=a.getLeft(this),l=a.getRight(this),c=a.top,d=a.height;n.style.left=r+"px",n.style.top=c+"px",n.style.width=t.dragAreaWidth+"px",n.style.height=d+"px",n.style.display="",i.removeChild(n),i.appendChild(n),o.style.left=l-t.dragAreaWidth+"px",o.style.top=c+"px",o.style.width=t.dragAreaWidth+"px",o.style.height=d+"px",o.style.display="",i.removeChild(o),i.appendChild(o)}else n.style.display="none",o.style.display="none"},links.Timeline.prototype.repaintNavigation=function(){var t=this,e=this.options,i=this.dom,n=i.frame,o=i.navBar;if(!o){var s=e.showButtonNew&&e.editable,a=e.showNavigation&&(e.zoomable||e.moveable);if((a||s)&&((o=document.createElement("DIV")).style.position="absolute",o.className="timeline-navigation ui-widget ui-state-highlight ui-corner-all",e.groupsOnRight?o.style.left="10px":o.style.right="10px",e.axisOnTop?o.style.bottom="10px":o.style.top="10px",i.navBar=o,n.appendChild(o)),s){o.addButton=document.createElement("DIV"),o.addButton.className="timeline-navigation-new",o.addButton.title=e.CREATE_NEW_EVENT;var r=document.createElement("SPAN");r.className="ui-icon ui-icon-circle-plus",o.addButton.appendChild(r);links.Timeline.addEventListener(o.addButton,"mousedown",(function(i){links.Timeline.preventDefault(i),links.Timeline.stopPropagation(i);var n=t.size.contentWidth/2,o=t.screenToTime(n);e.snapEvents&&t.step.snap(o);var s=e.NEW,a=t.groups.length?t.groups[0].content:void 0;t.addItem({start:o,content:s,group:a},!0);var r=t.items.length-1;t.selectItem(r),t.applyAdd=!0,t.trigger("add"),t.applyAdd?(t.render({animate:!1}),t.selectItem(r)):t.deleteItem(r)})),o.appendChild(o.addButton)}if(s&&a&&links.Timeline.addClassName(o.addButton,"timeline-navigation-new-line"),a){if(e.zoomable){o.zoomInButton=document.createElement("DIV"),o.zoomInButton.className="timeline-navigation-zoom-in",o.zoomInButton.title=this.options.ZOOM_IN;var l=document.createElement("SPAN");l.className="ui-icon ui-icon-circle-zoomin",o.zoomInButton.appendChild(l);links.Timeline.addEventListener(o.zoomInButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.zoom(.4),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.zoomInButton),o.zoomOutButton=document.createElement("DIV"),o.zoomOutButton.className="timeline-navigation-zoom-out",o.zoomOutButton.title=this.options.ZOOM_OUT;var c=document.createElement("SPAN");c.className="ui-icon ui-icon-circle-zoomout",o.zoomOutButton.appendChild(c);links.Timeline.addEventListener(o.zoomOutButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.zoom(-.4),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.zoomOutButton)}if(e.moveable){o.moveLeftButton=document.createElement("DIV"),o.moveLeftButton.className="timeline-navigation-move-left",o.moveLeftButton.title=this.options.MOVE_LEFT;var d=document.createElement("SPAN");d.className="ui-icon ui-icon-circle-arrow-w",o.moveLeftButton.appendChild(d);links.Timeline.addEventListener(o.moveLeftButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.move(-.2),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.moveLeftButton),o.moveRightButton=document.createElement("DIV"),o.moveRightButton.className="timeline-navigation-move-right",o.moveRightButton.title=this.options.MOVE_RIGHT;var u=document.createElement("SPAN");u.className="ui-icon ui-icon-circle-arrow-e",o.moveRightButton.appendChild(u);links.Timeline.addEventListener(o.moveRightButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.move(.2),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.moveRightButton)}}}},links.Timeline.prototype.setCurrentTime=function(t){var e=new Date;this.clientTimeOffset=t.valueOf()-e.valueOf(),this.repaintCurrentTime()},links.Timeline.prototype.getCurrentTime=function(){var t=new Date;return new Date(t.valueOf()+this.clientTimeOffset)},links.Timeline.prototype.setCustomTime=function(t){this.customTime=new Date(t.valueOf()),this.repaintCustomTime()},links.Timeline.prototype.getCustomTime=function(){return new Date(this.customTime.valueOf())},links.Timeline.prototype.setScale=function(t,e){this.step.setScale(t,e),this.render()},links.Timeline.prototype.setAutoScale=function(t){this.step.setAutoScale(t),this.render()},links.Timeline.prototype.redraw=function(){this.setData(this.data)},links.Timeline.prototype.checkResize=function(){this.render()},links.Timeline.prototype.isEditable=function(t){return!!t&&(null!=t.editable?t.editable:this.options.editable)},links.Timeline.prototype.recalcConversion=function(){this.conversion.offset=this.start.valueOf(),this.conversion.factor=this.size.contentWidth/(this.end.valueOf()-this.start.valueOf())},links.Timeline.prototype.screenToTime=function(t){var e=this.conversion;return new Date(t/e.factor+e.offset)},links.Timeline.prototype.timeToScreen=function(t){var e=this.conversion;return(t.valueOf()-e.offset)*e.factor},links.Timeline.prototype.onTouchStart=function(t){var e=this.eventParams,i=this;if(!e.touchDown){e.touchDown=!0,e.zoomed=!1,this.onMouseDown(t),e.onTouchMove||(e.onTouchMove=function(t){i.onTouchMove(t)},links.Timeline.addEventListener(document,"touchmove",e.onTouchMove)),e.onTouchEnd||(e.onTouchEnd=function(t){i.onTouchEnd(t)},links.Timeline.addEventListener(document,"touchend",e.onTouchEnd));var n=links.Timeline.getTarget(t),o=this.getItemIndex(n);e.doubleTapStartPrev=e.doubleTapStart,e.doubleTapStart=(new Date).valueOf(),e.doubleTapItemPrev=e.doubleTapItem,e.doubleTapItem=o,links.Timeline.preventDefault(t)}},links.Timeline.prototype.onTouchMove=function(t){var e=this.eventParams;if(t.scale&&1!==t.scale&&(e.zoomed=!0),e.zoomed){if(this.options.zoomable){e.zoomed=!0;var i=t.scale,n=e.end.valueOf()-e.start.valueOf(),o=n/i-n,s=new Date(parseInt(e.start.valueOf()-o/2)),a=new Date(parseInt(e.end.valueOf()+o/2));this.setVisibleChartRange(s,a),this.trigger("rangechange")}}else this.onMouseMove(t);links.Timeline.preventDefault(t)},links.Timeline.prototype.onTouchEnd=function(t){var e=this.eventParams;e.touchDown=!1,e.zoomed&&this.trigger("rangechanged"),e.onTouchMove&&(links.Timeline.removeEventListener(document,"touchmove",e.onTouchMove),delete e.onTouchMove),e.onTouchEnd&&(links.Timeline.removeEventListener(document,"touchend",e.onTouchEnd),delete e.onTouchEnd),this.onMouseUp(t);var i=(new Date).valueOf(),n=links.Timeline.getTarget(t);this.getItemIndex(n),e.doubleTapStartPrev&&i-e.doubleTapStartPrev<500&&e.doubleTapItem==e.doubleTapItemPrev&&(e.touchDown=!0,this.onDblClick(t),e.touchDown=!1),links.Timeline.preventDefault(t)},links.Timeline.prototype.onMouseDown=function(t){t=t||window.event;var e=this.eventParams,i=this.options,n=this.dom;if((t.which?1==t.which:1==t.button)||e.touchDown){e.mouseX=links.Timeline.getPageX(t),e.mouseY=links.Timeline.getPageY(t),e.frameLeft=links.Timeline.getAbsoluteLeft(this.dom.content),e.frameTop=links.Timeline.getAbsoluteTop(this.dom.content),e.previousLeft=0,e.previousOffset=0,e.moved=!1,e.start=new Date(this.start.valueOf()),e.end=new Date(this.end.valueOf()),e.target=links.Timeline.getTarget(t);var o=n.items&&n.items.dragLeft?n.items.dragLeft:void 0,s=n.items&&n.items.dragRight?n.items.dragRight:void 0;if(e.itemDragLeft=e.target===o,e.itemDragRight=e.target===s,e.itemDragLeft||e.itemDragRight?(e.itemIndex=this.selection&&void 0!==this.selection.index?this.selection.index:void 0,delete e.clusterIndex):(e.itemIndex=this.getItemIndex(e.target),e.clusterIndex=this.getClusterIndex(e.target)),e.customTime=e.target===n.customTime||e.target.parentNode===n.customTime?this.customTime:void 0,e.addItem=i.editable&&t.ctrlKey,e.addItem){var a=e.mouseX-e.frameLeft,r=e.mouseY-e.frameTop,l=this.screenToTime(a);i.snapEvents&&this.step.snap(l);var c=new Date(l.valueOf()),d=i.NEW,u=this.getGroupFromHeight(r);this.addItem({start:l,end:c,content:d,group:this.getGroupName(u)}),e.itemIndex=this.items.length-1,delete e.clusterIndex,this.selectItem(e.itemIndex),e.itemDragRight=!0}var h=this.items[e.itemIndex],p=this.isSelected(e.itemIndex);if(e.editItem=p&&this.isEditable(h),e.editItem?(e.itemStart=h.start,e.itemEnd=h.end,e.itemGroup=h.group,e.itemLeft=h.getLeft(this),e.itemRight=h.getRight(this)):this.dom.frame.style.cursor="move",!e.touchDown){var f=this;e.onMouseMove||(e.onMouseMove=function(t){f.onMouseMove(t)},links.Timeline.addEventListener(document,"mousemove",e.onMouseMove)),e.onMouseUp||(e.onMouseUp=function(t){f.onMouseUp(t)},links.Timeline.addEventListener(document,"mouseup",e.onMouseUp)),links.Timeline.preventDefault(t)}}},links.Timeline.prototype.onMouseMove=function(t){t=t||window.event;var e=this.eventParams,i=this.size,n=this.dom,o=this.options,s=links.Timeline.getPageX(t),a=links.Timeline.getPageY(t);null==e.mouseX&&(e.mouseX=s),null==e.mouseY&&(e.mouseY=a);var r=s-e.mouseX,l=a-e.mouseY;if(Math.abs(l)>=1&&(newy=$.mobile.window.scrollTop(),$.mobile.window.scrollTop(newy-l)),Math.abs(r)>=1&&(e.moved=!0),e.customTime){var c=this.timeToScreen(e.customTime)+r;this.customTime=this.screenToTime(c),this.repaintCustomTime(),this.trigger("timechange")}else if(e.editItem){var d,u,h=this.items[e.itemIndex];e.itemDragLeft&&o.timeChangeable?(d=e.itemLeft+r,u=e.itemRight,h.start=this.screenToTime(d),o.snapEvents&&(this.step.snap(h.start),d=this.timeToScreen(h.start)),d>u&&(d=u,h.start=this.screenToTime(d)),this.trigger("change")):e.itemDragRight&&o.timeChangeable?(d=e.itemLeft,u=e.itemRight+r,h.end=this.screenToTime(u),o.snapEvents&&(this.step.snap(h.end),u=this.timeToScreen(h.end)),d>u&&(u=d,h.end=this.screenToTime(u)),this.trigger("change")):o.timeChangeable&&(d=e.itemLeft+r,h.start=this.screenToTime(d),o.snapEvents&&(this.step.snap(h.start),d=this.timeToScreen(h.start)),h.end&&(u=d+(e.itemRight-e.itemLeft),h.end=this.screenToTime(u)),this.trigger("change")),h.setPosition(d,u);var p=e.itemDragLeft||e.itemDragRight;if(this.groups.length&&!p){var f=a-e.frameTop,m=this.getGroupFromHeight(f);if(o.groupsChangeable&&h.group!==m){var g=this.items.indexOf(h);this.changeItem(g,{group:this.getGroupName(m)})}else this.repaintDeleteButton(),this.repaintDragAreas()}else this.render()}else if(o.moveable){var v=e.end.valueOf()-e.start.valueOf(),b=Math.round(-r/i.contentWidth*v),y=new Date(e.start.valueOf()+b),_=new Date(e.end.valueOf()+b);this.applyRange(y,_);var w=this.start.valueOf()-y.valueOf();w&&(b+=w),this.recalcConversion();var x=e.previousLeft||0,k=parseFloat(n.items.frame.style.left)||0,S=(e.previousOffset||0)+(k-x),T=-b/v*i.contentWidth+S;n.items.frame.style.left=T+"px",e.previousOffset=S,e.previousLeft=parseFloat(n.items.frame.style.left)||T,this.repaintCurrentTime(),this.repaintCustomTime(),this.repaintAxis(),this.trigger("rangechange")}links.Timeline.preventDefault(t)},links.Timeline.prototype.onMouseUp=function(t){var e=this.eventParams,i=this.options;if(t=t||window.event,this.dom.frame.style.cursor="auto",e.onMouseMove&&(links.Timeline.removeEventListener(document,"mousemove",e.onMouseMove),delete e.onMouseMove),e.onMouseUp&&(links.Timeline.removeEventListener(document,"mouseup",e.onMouseUp),delete e.onMouseUp),e.customTime)this.trigger("timechanged");else if(e.editItem){var n=this.items[e.itemIndex];if(e.moved||e.addItem){if(this.applyChange=!0,this.applyAdd=!0,this.updateData(e.itemIndex,{start:n.start,end:n.end}),this.trigger(e.addItem?"add":"changed"),n=this.items[e.itemIndex],e.addItem)this.applyAdd?this.updateData(e.itemIndex,{start:n.start,end:n.end,content:n.content,group:this.getGroupName(n.group)}):this.deleteItem(e.itemIndex);else if(this.applyChange)this.updateData(e.itemIndex,{start:n.start,end:n.end});else{delete this.applyChange,delete this.applyAdd,(n=this.items[e.itemIndex]).dom,n.start=e.itemStart,n.end=e.itemEnd,n.group=e.itemGroup,n.setPosition(e.itemLeft,e.itemRight),this.updateData(e.itemIndex,{start:e.itemStart,end:e.itemEnd})}this.options.cluster&&this.clusterGenerator.updateData(),this.render()}}else e.moved||e.zoomed?(this.render(),(e.moved&&i.moveable||e.zoomed&&i.zoomable)&&this.trigger("rangechanged")):e.target===this.dom.items.deleteButton?this.selection&&void 0!==this.selection.index&&this.confirmDeleteItem(this.selection.index):i.selectable&&(null!=e.itemIndex?this.isSelected(e.itemIndex)||(this.selectItem(e.itemIndex),this.trigger("select")):null!=e.clusterIndex?(this.selectCluster(e.clusterIndex),this.trigger("select")):i.unselectable&&(this.unselectItem(),this.trigger("select")))},links.Timeline.prototype.onDblClick=function(t){var e=this.eventParams,i=this.options,n=this.dom;if(this.size,t=t||window.event,null!=e.itemIndex){var o=this.items[e.itemIndex];o&&this.isEditable(o)&&this.trigger("edit")}else if(i.editable){e.mouseX=links.Timeline.getPageX(t),e.mouseY=links.Timeline.getPageY(t);var s=e.mouseX-links.Timeline.getAbsoluteLeft(n.content),a=e.mouseY-links.Timeline.getAbsoluteTop(n.content),r=this.screenToTime(s);i.snapEvents&&this.step.snap(r);var l=i.NEW,c=this.getGroupFromHeight(a);this.addItem({start:r,content:l,group:this.getGroupName(c)},!0),e.itemIndex=this.items.length-1,this.selectItem(e.itemIndex),this.applyAdd=!0,this.trigger("add"),this.applyAdd?(this.render({animate:!1}),this.selectItem(e.itemIndex)):this.deleteItem(e.itemIndex)}links.Timeline.preventDefault(t)},links.Timeline.prototype.onMouseWheel=function(t){if(this.options.zoomable){t||(t=window.event);var e=0;if(t.wheelDelta?e=t.wheelDelta/120:t.detail&&(e=-t.detail/3),e){var i=this;t.shiftKey?(i.move(-.2*e),i.trigger("rangechange"),i.trigger("rangechanged")):function(){var n=e/5,o=links.Timeline.getAbsoluteLeft(i.dom.content),s=links.Timeline.getPageX(t),a=null!=s&&null!=o?i.screenToTime(s-o):void 0;i.zoom(n,a),i.trigger("rangechange"),i.trigger("rangechanged")}()}links.Timeline.preventDefault(t)}},links.Timeline.prototype.zoom=function(t,e){null==e&&(e=new Date((this.start.valueOf()+this.end.valueOf())/2)),t>=1&&(t=.9),-1>=t&&(t=-.9),0>t&&(t/=1+t);var i=this.start.valueOf()-e,n=this.end.valueOf()-e,o=new Date(this.start.valueOf()-i*t),s=new Date(this.end.valueOf()-n*t),a=s.valueOf()-o.valueOf(),r=Number(this.options.zoomMin)||10;10>r&&(r=10),a>=r&&(this.applyRange(o,s,e),this.render({animate:this.options.animate&&this.options.animateZoom}))},links.Timeline.prototype.move=function(t){var e=this.end.valueOf()-this.start.valueOf(),i=new Date(this.start.valueOf()+e*t),n=new Date(this.end.valueOf()+e*t);this.applyRange(i,n),this.render()},links.Timeline.prototype.applyRange=function(t,e,i){var n=t.valueOf(),o=e.valueOf(),s=o-n,a=this.options,r=31536e6,l=Number(a.zoomMin)||10;10>l&&(l=10);var c=Number(a.zoomMax)||1e4*r;c>1e4*r&&(c=1e4*r),l>c&&(c=l);var d=a.min?a.min.valueOf():void 0,u=a.max?a.max.valueOf():void 0;if(null!=d&&null!=u){if(d>=u){u=d+864e5}c>u-d&&(c=u-d),l>u-d&&(l=u-d)}if(n>=o&&(o+=864e5),l>s){var h=l-s,p=i?(i.valueOf()-n)/s:.5;n-=Math.round(h*p),o+=Math.round(h*(1-p))}if(s>c){var h=s-c;p=i?(i.valueOf()-n)/s:.5;n+=Math.round(h*p),o-=Math.round(h*(1-p))}null!=d&&(0>(h=n-d)&&(n-=h,o-=h));null!=u&&(0>(h=u-o)&&(n+=h,o+=h));this.start=new Date(n),this.end=new Date(o)},links.Timeline.prototype.confirmDeleteItem=function(t){this.applyDelete=!0,this.isSelected(t)||this.selectItem(t),this.trigger("delete"),this.applyDelete&&this.deleteItem(t),delete this.applyDelete},links.Timeline.prototype.deleteItem=function(t,e){if(t>=this.items.length)throw"Cannot delete row, index out of range";this.selection&&void 0!==this.selection.index&&(this.selection.index==t?this.unselectItem():this.selection.index>t&&this.selection.index--);var i=this.items.splice(t,1)[0];if(this.renderQueue.hide.push(i),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRow(t);else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(t,1)}this.options.cluster&&this.clusterGenerator.updateData(),e||this.render()},links.Timeline.prototype.deleteAllItems=function(){if(this.unselectItem(),this.clearItems(),this.deleteGroups(),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRows(0,this.data.getNumberOfRows());else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(0,this.data.length)}this.options.cluster&&this.clusterGenerator.updateData(),this.render()},links.Timeline.prototype.getGroupFromHeight=function(t){var e,i,n=this.groups;if(n.length){if(this.options.axisOnTop){for(e=n.length-1;e>=0;e--)if(t>(i=n[e]).top)return i}else for(e=0;e<n.length;e++)if(t>(i=n[e]).top)return i;return i}},links.Timeline.Item=function(t,e){if(t&&(this.start=t.start,this.end=t.end,this.content=t.content,this.className=t.className,this.editable=t.editable,this.group=t.group,this.type=t.type),this.top=0,this.left=0,this.width=0,this.height=0,this.lineWidth=0,this.dotWidth=0,this.dotHeight=0,this.rendered=!1,e)for(var i in e)e.hasOwnProperty(i)&&(this[i]=e[i])},links.Timeline.Item.prototype.reflow=function(){return!1},links.Timeline.Item.prototype.getImageUrls=function(t){this.dom&&links.imageloader.filterImageUrls(this.dom,t)},links.Timeline.Item.prototype.select=function(){},links.Timeline.Item.prototype.unselect=function(){},links.Timeline.Item.prototype.createDOM=function(){},links.Timeline.Item.prototype.showDOM=function(){},links.Timeline.Item.prototype.hideDOM=function(){},links.Timeline.Item.prototype.updateDOM=function(){},links.Timeline.Item.prototype.updatePosition=function(){},links.Timeline.Item.prototype.isRendered=function(){return this.rendered},links.Timeline.Item.prototype.isVisible=function(){return!1},links.Timeline.Item.prototype.setPosition=function(){},links.Timeline.Item.prototype.getLeft=function(){return 0},links.Timeline.Item.prototype.getRight=function(){return 0},links.Timeline.Item.prototype.getWidth=function(){return this.width||0},links.Timeline.ItemBox=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemBox.prototype=new links.Timeline.Item,links.Timeline.ItemBox.prototype.reflow=function(){var t=this.dom,e=t.dot.offsetHeight,i=t.dot.offsetWidth,n=t.line.offsetWidth,o=this.dotHeight!=e||this.dotWidth!=i||this.lineWidth!=n;return this.dotHeight=e,this.dotWidth=i,this.lineWidth=n,o},links.Timeline.ItemBox.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active"),links.Timeline.addClassName(t.line,"timeline-event-selected ui-state-active"),links.Timeline.addClassName(t.dot,"timeline-event-selected ui-state-active")},links.Timeline.ItemBox.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active"),links.Timeline.removeClassName(t.line,"timeline-event-selected ui-state-active"),links.Timeline.removeClassName(t.dot,"timeline-event-selected ui-state-active")},links.Timeline.ItemBox.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute",t.style.left=this.left+"px",t.style.top=this.top+"px";var e=document.createElement("DIV");e.className="timeline-event-content",e.innerHTML=this.content,t.appendChild(e);var i=document.createElement("DIV");i.style.position="absolute",i.style.width="0px",t.line=i;var n=document.createElement("DIV");return n.style.position="absolute",n.style.width="0px",n.style.height="0px",t.dot=n,this.dom=t,this.updateDOM(),t},links.Timeline.ItemBox.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),t.insertBefore(e.line,t.firstChild),t.appendChild(e.dot),this.rendered=!0)},links.Timeline.ItemBox.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),t.line&&t.line.parentNode&&t.line.parentNode.removeChild(t.line),t.dot&&t.dot.parentNode&&t.dot.parentNode.removeChild(t.dot),this.rendered=!1)},links.Timeline.ItemBox.prototype.updateDOM=function(){var t=this.dom;if(t){var e=t.line,i=t.dot;t.firstChild.innerHTML=this.content,t.className="timeline-event timeline-event-box ui-widget ui-state-default",e.className="timeline-event timeline-event-line ui-widget ui-state-default",i.className="timeline-event timeline-event-dot ui-widget ui-state-default",this.isCluster&&(links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(e,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(i,"timeline-event-cluster ui-widget-header")),this.className&&(links.Timeline.addClassName(t,this.className),links.Timeline.addClassName(e,this.className),links.Timeline.addClassName(i,this.className))}},links.Timeline.ItemBox.prototype.updatePosition=function(t){var e=this.dom;if(e){var i=t.timeToScreen(this.start),n=t.options.axisOnTop,o=t.size.axis.top,s=t.size.axis.height,a=t.options.box&&t.options.box.align?t.options.box.align:void 0;e.style.top=this.top+"px",e.style.left="right"==a?i-this.width+"px":"left"==a?i+"px":i-this.width/2+"px";var r=e.line,l=e.dot;r.style.left=i-this.lineWidth/2+"px",l.style.left=i-this.dotWidth/2+"px",n?(r.style.top=s+"px",r.style.height=Math.max(this.top-s,0)+"px",l.style.top=s-this.dotHeight/2+"px"):(r.style.top=this.top+this.height+"px",r.style.height=Math.max(o-this.top-this.height,0)+"px",l.style.top=o-this.dotHeight/2+"px")}},links.Timeline.ItemBox.prototype.isVisible=function(t,e){return!this.cluster&&(this.start>t&&this.start<e)},links.Timeline.ItemBox.prototype.setPosition=function(t){var e=this.dom;e.style.left=t-this.width/2+"px",e.line.style.left=t-this.lineWidth/2+"px",e.dot.style.left=t-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,e.style.top=this.top+"px")},links.Timeline.ItemBox.prototype.getLeft=function(t){var e=t.options.box&&t.options.box.align?t.options.box.align:void 0;return t.timeToScreen(this.start)-("right"==e?width:this.width/2)},links.Timeline.ItemBox.prototype.getRight=function(t){var e=t.options.box&&t.options.box.align?t.options.box.align:void 0,i=t.timeToScreen(this.start);return"right"==e?i:"left"==e?i+this.width:i+this.width/2},links.Timeline.ItemRange=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemRange.prototype=new links.Timeline.Item,links.Timeline.ItemRange.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemRange.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemRange.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute";var e=document.createElement("DIV");return e.className="timeline-event-content",t.appendChild(e),this.dom=t,this.updateDOM(),t},links.Timeline.ItemRange.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),this.rendered=!0)},links.Timeline.ItemRange.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),this.rendered=!1)},links.Timeline.ItemRange.prototype.updateDOM=function(){var t=this.dom;t&&(t.firstChild.innerHTML=this.content,t.className="timeline-event timeline-event-range ui-widget ui-state-default",this.isCluster&&links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),this.className&&links.Timeline.addClassName(t,this.className))},links.Timeline.ItemRange.prototype.updatePosition=function(t){var e=this.dom;if(e){var i=t.size.contentWidth,n=t.timeToScreen(this.start),o=t.timeToScreen(this.end);-i>n&&(n=-i),o>2*i&&(o=2*i),e.style.top=this.top+"px",e.style.left=n+"px",e.style.width=Math.max(o-n,1)+"px"}},links.Timeline.ItemRange.prototype.isVisible=function(t,e){return!this.cluster&&(this.end>t&&this.start<e)},links.Timeline.ItemRange.prototype.setPosition=function(t,e){var i=this.dom;i.style.left=t+"px",i.style.width=e-t+"px",this.group&&(this.top=this.group.top,i.style.top=this.top+"px")},links.Timeline.ItemRange.prototype.getLeft=function(t){return t.timeToScreen(this.start)},links.Timeline.ItemRange.prototype.getRight=function(t){return t.timeToScreen(this.end)},links.Timeline.ItemRange.prototype.getWidth=function(t){return t.timeToScreen(this.end)-t.timeToScreen(this.start)},links.Timeline.ItemFloatingRange=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemFloatingRange.prototype=new links.Timeline.Item,links.Timeline.ItemFloatingRange.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemFloatingRange.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemFloatingRange.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute";var e=document.createElement("DIV");return e.className="timeline-event-content",t.appendChild(e),this.dom=t,this.updateDOM(),t},links.Timeline.ItemFloatingRange.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),this.rendered=!0)},links.Timeline.ItemFloatingRange.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),this.rendered=!1)},links.Timeline.ItemFloatingRange.prototype.updateDOM=function(){var t=this.dom;t&&(t.firstChild.innerHTML=this.content,t.className="timeline-event timeline-event-range ui-widget ui-state-default",this.isCluster&&links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),this.className&&links.Timeline.addClassName(t,this.className))},links.Timeline.ItemFloatingRange.prototype.updatePosition=function(t){var e=this.dom;if(e){var i=t.size.contentWidth,n=this.getLeft(t),o=this.getRight(t);-i>n&&(n=-i),o>2*i&&(o=2*i),e.style.top=this.top+"px",e.style.left=n+"px",e.style.width=Math.max(o-n,1)+"px"}},links.Timeline.ItemFloatingRange.prototype.isVisible=function(t,e){return!this.cluster&&(this.end&&this.start?this.end>t&&this.start<e:this.start?this.start<e:!this.end||this.end>t)},links.Timeline.ItemFloatingRange.prototype.setPosition=function(t,e){var i=this.dom;i.style.left=t+"px",i.style.width=e-t+"px",this.group&&(this.top=this.group.top,i.style.top=this.top+"px")},links.Timeline.ItemFloatingRange.prototype.getLeft=function(t){return this.start?t.timeToScreen(this.start):0},links.Timeline.ItemFloatingRange.prototype.getRight=function(t){return this.end?t.timeToScreen(this.end):t.size.contentWidth},links.Timeline.ItemFloatingRange.prototype.getWidth=function(t){return this.getRight(t)-this.getLeft(t)},links.Timeline.ItemDot=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemDot.prototype=new links.Timeline.Item,links.Timeline.ItemDot.prototype.reflow=function(){var t=this.dom,e=t.dot.offsetHeight,i=t.dot.offsetWidth,n=t.content.offsetHeight,o=this.dotHeight!=e||this.dotWidth!=i||this.contentHeight!=n;return this.dotHeight=e,this.dotWidth=i,this.contentHeight=n,o},links.Timeline.ItemDot.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemDot.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemDot.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute";var e=document.createElement("DIV");e.className="timeline-event-content",t.appendChild(e);var i=document.createElement("DIV");return i.style.position="absolute",i.style.width="0px",i.style.height="0px",t.appendChild(i),t.content=e,t.dot=i,this.dom=t,this.updateDOM(),t},links.Timeline.ItemDot.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),this.rendered=!0)},links.Timeline.ItemDot.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),this.rendered=!1)},links.Timeline.ItemDot.prototype.updateDOM=function(){if(this.dom){var t=this.dom,e=t.dot;t.firstChild.innerHTML=this.content,t.className="timeline-event-dot-container",e.className="timeline-event timeline-event-dot ui-widget ui-state-default",this.isCluster&&(links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(e,"timeline-event-cluster ui-widget-header")),this.className&&(links.Timeline.addClassName(t,this.className),links.Timeline.addClassName(e,this.className))}},links.Timeline.ItemDot.prototype.updatePosition=function(t){var e=this.dom;if(e){var i=t.timeToScreen(this.start);e.style.top=this.top+"px",e.style.left=i-this.dotWidth/2+"px",e.content.style.marginLeft=1.5*this.dotWidth+"px",e.dot.style.top=(this.height-this.dotHeight)/2+"px"}},links.Timeline.ItemDot.prototype.isVisible=function(t,e){return!this.cluster&&(this.start>t&&this.start<e)},links.Timeline.ItemDot.prototype.setPosition=function(t){var e=this.dom;e.style.left=t-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,e.style.top=this.top+"px")},links.Timeline.ItemDot.prototype.getLeft=function(t){return t.timeToScreen(this.start)},links.Timeline.ItemDot.prototype.getRight=function(t){return t.timeToScreen(this.start)+this.width},links.Timeline.prototype.getItem=function(t){if(t>=this.items.length)throw"Cannot get item, index out of range";var e,i=this.data;if(google&&google.visualization&&i instanceof google.visualization.DataTable){var n=links.Timeline.mapColumnIds(i);for(var o in e={},n)n.hasOwnProperty(o)&&(e[o]=this.data.getValue(t,n[o]))}else{if(!links.Timeline.isArray(this.data))throw"Unknown data type. DataTable or Array expected.";e=links.Timeline.clone(this.data[t])}var s=this.items[t];return e.start=new Date(s.start.valueOf()),s.end&&(e.end=new Date(s.end.valueOf())),e.content=s.content,s.group&&(e.group=this.getGroupName(s.group)),s.className&&(e.className=s.className),void 0!==s.editable&&(e.editable=s.editable),s.type&&(e.type=s.type),e},links.Timeline.prototype.getCluster=function(t){if(t>=this.clusters.length)throw"Cannot get cluster, index out of range";var e={},i=this.clusters[t],n=i.items;e.start=new Date(i.start.valueOf()),i.type&&(e.type=i.type),e.items=[];for(var o=0;o<n.length;o++)for(var s=0;s<this.items.length;s++)if(this.items[s]==n[o]){e.items.push(this.getItem(s));break}return e},links.Timeline.prototype.addItem=function(t,e){var i=[t];this.addItems(i,e)},links.Timeline.prototype.addItems=function(t,e){var i=this,n=this.items;t.forEach((function(t){var e=n.length;n.push(i.createItem(t)),i.updateData(e,t)})),this.options.cluster&&this.clusterGenerator.updateData(),e||this.render({animate:!1})},links.Timeline.prototype.createItem=function(t){var e=t.type||(t.end?"range":this.options.style),i=links.Timeline.clone(t);i.type=e,i.group=this.getGroup(t.group);var n,o=this.options;return n=o.axisOnTop?this.size.axis.height+o.eventMarginAxis+o.eventMargin/2:this.size.contentHeight-o.eventMarginAxis-o.eventMargin/2,e in this.itemTypes?new this.itemTypes[e](i,{top:n}):(console.log('ERROR: Unknown event type "'+e+'"'),new links.Timeline.Item(i,{top:n}))},links.Timeline.prototype.changeItem=function(t,e,i){var n=this.items[t];if(!n)throw"Cannot change item, index out of range";var o=this.createItem({start:e.hasOwnProperty("start")?e.start:n.start,end:e.hasOwnProperty("end")?e.end:n.end,content:e.hasOwnProperty("content")?e.content:n.content,group:e.hasOwnProperty("group")?e.group:this.getGroupName(n.group),className:e.hasOwnProperty("className")?e.className:n.className,editable:e.hasOwnProperty("editable")?e.editable:n.editable,type:e.hasOwnProperty("type")?e.type:n.type});this.items[t]=o,this.renderQueue.hide.push(n),this.renderQueue.show.push(o),this.updateData(t,e),this.options.cluster&&this.clusterGenerator.updateData(),i||(this.render({animate:!1}),this.selection&&this.selection.index==t&&o.select())},links.Timeline.prototype.deleteGroups=function(){this.groups=[],this.groupIndexes={}},links.Timeline.prototype.getGroup=function(t){var e=this.groups,i=this.groupIndexes,n=void 0,o=i[t];if(null==o&&null!=t){n={content:t,labelTop:0,lineTop:0},e.push(n),1==this.options.groupsOrder?e=e.sort((function(t,e){return t.content>e.content?1:t.content<e.content?-1:0})):"function"==typeof this.options.groupsOrder&&(e=e.sort(this.options.groupsOrder));for(var s=0,a=e.length;a>s;s++)i[e[s].content]=s}else n=e[o];return n},links.Timeline.prototype.getGroupName=function(t){return t?t.content:void 0},links.Timeline.prototype.cancelChange=function(){this.applyChange=!1},links.Timeline.prototype.cancelDelete=function(){this.applyDelete=!1},links.Timeline.prototype.cancelAdd=function(){this.applyAdd=!1},links.Timeline.prototype.setSelection=function(t){if(null!=t&&t.length>0){if(null!=t[0].row){var e=t[0].row;if(this.items[e]){var i=this.items[e];this.selectItem(e);var n,o=i.start,s=i.end;n=null!=s?(s.valueOf()+o.valueOf())/2:o.valueOf();var a=this.end.valueOf()-this.start.valueOf(),r=new Date(n-a/2),l=new Date(n+a/2);return this.setVisibleChartRange(r,l),!0}}}else this.unselectItem();return!1},links.Timeline.prototype.getSelection=function(){var t=[];return this.selection&&t.push(void 0!==this.selection.index?{row:this.selection.index}:{cluster:this.selection.cluster}),t},links.Timeline.prototype.selectItem=function(t){if(this.unselectItem(),this.selection=void 0,null!=this.items[t]){var e=this.items[t];e.dom,this.selection={index:t},e&&e.dom&&(this.isEditable(e)&&(e.dom.style.cursor="move"),e.select()),this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.selectCluster=function(t){this.unselectItem(),this.selection=void 0,null!=this.clusters[t]&&(this.selection={cluster:t},this.repaintDeleteButton(),this.repaintDragAreas())},links.Timeline.prototype.isSelected=function(t){return this.selection&&this.selection.index==t},links.Timeline.prototype.unselectItem=function(){if(this.selection&&void 0!==this.selection.index){var t=this.items[this.selection.index];if(t&&t.dom)t.dom.style.cursor="",t.unselect();this.selection=void 0,this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.stackItems=function(t){null==t&&(t=!1);var e=this.stack;if(e||(e={},this.stack=e),e.sortedItems=this.stackOrder(this.renderedItems),e.finalItems=this.stackCalculateFinal(e.sortedItems),t||e.timer){var i=this,n=function(){var t=i.stackMoveOneStep(e.sortedItems,e.finalItems);i.repaint(),t?delete e.timer:e.timer=setTimeout(n,30)};e.timer||(e.timer=setTimeout(n,30))}else this.stackMoveToFinal(e.sortedItems,e.finalItems)},links.Timeline.prototype.stackCancelAnimation=function(){this.stack&&this.stack.timer&&(clearTimeout(this.stack.timer),delete this.stack.timer)},links.Timeline.prototype.getItemsByGroup=function(t){for(var e={},i=0;i<t.length;++i){var n=t[i],o="undefined";n.group&&(o=n.group.content?n.group.content:n.group),e[o]||(e[o]=[]),e[o].push(n)}return e},links.Timeline.prototype.stackOrder=function(t){var e=t.concat([]),i=this.options.customStackOrder&&"function"==typeof this.options.customStackOrder?this.options.customStackOrder:function(t,e){return(t instanceof links.Timeline.ItemRange||t instanceof links.Timeline.ItemFloatingRange)&&!(e instanceof links.Timeline.ItemRange||e instanceof links.Timeline.ItemFloatingRange)?-1:t instanceof links.Timeline.ItemRange||t instanceof links.Timeline.ItemFloatingRange||!(e instanceof links.Timeline.ItemRange||e instanceof links.Timeline.ItemFloatingRange)?t.left-e.left:1};return e.sort(i),e},links.Timeline.prototype.stackCalculateFinal=function(t){var e,i=this.size,n=this.options,o=n.axisOnTop,s=n.eventMargin,a=n.eventMarginAxis,r=o?i.axis.height+a+s/2:i.contentHeight-a-s/2,l=[];for(e=this.getItemsByGroup(t),j=0;j<this.groups.length;++j){var c=this.groups[j];e[c.content]?(this.finalItemsPosition(e[c.content],r,c).forEach((function(t){l.push(t)})),o?r+=c.itemsHeight+s:r-=c.itemsHeight+s):o?r+=n.groupMinHeight+s:r-=n.groupMinHeight+s}return e.undefined&&this.finalItemsPosition(e.undefined,r).forEach((function(t){l.push(t)})),l},links.Timeline.prototype.finalItemsPosition=function(t,e,i){var n,o,s,a=this.options,r=a.axisOnTop,l=a.eventMargin;for(n=0,o=(s=this.initialItemsPosition(t,e)).length;o>n;n++){var c=s[n],d=null;if(this.options.stackEvents)do{null!=(d=this.stackItemsCheckOverlap(s,n,0,n-1))&&(c.top=r?d.top+d.height+l:d.top-c.height-l,c.bottom=c.top+c.height)}while(d);i&&(i.itemsHeight=r?i.itemsHeight?Math.max(i.itemsHeight,c.bottom-e):c.height+l:i.itemsHeight?Math.max(i.itemsHeight,e-c.top):c.height+l)}return s},links.Timeline.prototype.initialItemsPosition=function(t,e){for(var i=this.options.axisOnTop,n=[],o=0,s=t.length;s>o;++o){var a,r,l=t[o],c=l.height,d=l.getWidth(this),u=l.getRight(this),h=u-d;r=(a=i?e:e-c)+c,n.push({left:h,top:a,right:u,bottom:r,height:c,item:l})}return n},links.Timeline.prototype.stackMoveOneStep=function(t,e){for(var i=!0,n=0,o=e.length;o>n;n++){var s=e[n],a=s.item,r=parseInt(a.top),l=parseInt(s.top),c=l-r;if(c){var d=l==r?0:l>r?1:-1;Math.abs(c)>4&&(d=c/4);var u=parseInt(r+d);u!=l&&(i=!1),a.top=u,a.bottom=a.top+a.height}else a.top=s.top,a.bottom=s.bottom;a.left=s.left,a.right=s.right}return i},links.Timeline.prototype.stackMoveToFinal=function(t,e){for(var i=0,n=e.length;n>i;i++){var o=e[i],s=o.item;s.left=o.left,s.top=o.top,s.right=o.right,s.bottom=o.bottom}},links.Timeline.prototype.stackItemsCheckOverlap=function(t,e,i,n){for(var o=this.options.eventMargin,s=this.collision,a=t[e],r=n;r>=i;r--){var l=t[r];if(s(a,l,o)&&r!=e)return l}},links.Timeline.prototype.collision=function(t,e,i){return null==i&&(i=0),t.left-i<e.right&&t.right+i>e.left&&t.top-i<e.bottom&&t.bottom+i>e.top},links.Timeline.prototype.trigger=function(t){var e=null;switch(t){case"rangechange":case"rangechanged":e={start:new Date(this.start.valueOf()),end:new Date(this.end.valueOf())};break;case"timechange":case"timechanged":e={time:new Date(this.customTime.valueOf())}}links.events.trigger(this,t,e),google&&google.visualization&&google.visualization.events.trigger(this,t,e)},links.Timeline.prototype.clusterItems=function(){if(this.options.cluster){var t=this.clusterGenerator.getClusters(this.conversion.factor,this.options.clusterMaxItems);if(this.clusters!=t){var e=this.renderQueue;this.clusters&&this.clusters.forEach((function(t){e.hide.push(t),t.items.forEach((function(t){t.cluster=void 0}))})),t.forEach((function(t){t.items.forEach((function(e){e.cluster=t}))})),this.clusters=t}}},links.Timeline.prototype.filterItems=function(){function t(t){t.forEach((function(t){var i=t.rendered,s=t.isVisible(n,o);i!=s&&(i&&e.hide.push(t),s&&-1==e.show.indexOf(t)&&e.show.push(t))}))}var e=this.renderQueue,i=this.end-this.start,n=new Date(this.start.valueOf()-i),o=new Date(this.end.valueOf()+i);t(this.items),this.clusters&&t(this.clusters)},links.Timeline.ClusterGenerator=function(t){this.timeline=t,this.clear()},links.Timeline.ClusterGenerator.prototype.clear=function(){this.items=[],this.groups={},this.clearCache()},links.Timeline.ClusterGenerator.prototype.clearCache=function(){this.cache={},this.cacheLevel=-1,this.cache[this.cacheLevel]=[]},links.Timeline.ClusterGenerator.prototype.setData=function(t,e){this.items=t||[],this.dataChanged=!0,this.applyOnChangedLevel=!0,e&&e.applyOnChangedLevel&&(this.applyOnChangedLevel=e.applyOnChangedLevel)},links.Timeline.ClusterGenerator.prototype.updateData=function(){this.dataChanged=!0,this.applyOnChangedLevel=!1},links.Timeline.ClusterGenerator.prototype.filterData=function(){var t=this.items||[],e={};for(var i in this.groups=e,t.forEach((function(t){var i=t.group?t.group.content:"",n=e[i];n||(n=[],e[i]=n),n.push(t),t.start&&(t.center=t.end?(t.start.valueOf()+t.end.valueOf())/2:t.start.valueOf())})),e)e.hasOwnProperty(i)&&e[i].sort((function(t,e){return t.center-e.center}));this.dataChanged=!1},links.Timeline.ClusterGenerator.prototype.getClusters=function(t,e){var i=-1,n=0;if(t>0&&(i=Math.round(Math.log(100/t)/Math.log(2)),n=Math.pow(2,i)),this.dataChanged){var o=i!=this.cacheLevel;(!this.applyOnChangedLevel||o)&&(this.clearCache(),this.filterData())}this.cacheLevel=i;var s=this.cache[i];if(!s){for(var a in s=[],this.groups)if(this.groups.hasOwnProperty(a))for(var r=this.groups[a],l=r.length,c=0;l>c;){for(var d=r[c],u=1,h=c-1;h>=0&&d.center-r[h].center<n/2;)r[h].cluster||u++,h--;for(var p=c+1;p<r.length&&r[p].center-d.center<n/2;)u++,p++;for(var f=s.length-1;f>=0&&d.center-s[f].center<n/2;)d.group==s[f].group&&u++,f--;if(u>e){for(var m=u-e+1,g=[],v=void 0,b=void 0,y=void 0,_=!1,w=0,x=c;g.length<m&&x<r.length;){var k=r[x],S=k.start.valueOf(),T=k.end?k.end.valueOf():k.start.valueOf();g.push(k),v=w?w/(w+1)*v+1/(w+1)*k.center:k.center,b=null!=b?Math.min(b,S):S,y=null!=y?Math.max(y,T):T,_=_||k instanceof links.Timeline.ItemRange||k instanceof links.Timeline.ItemFloatingRange,w++,x++}var C,D='<div title="'+("Cluster containing "+w+" events. Zoom in to see the individual events.")+'">'+w+" events</div>",M=d.group?d.group.content:void 0;(C=this.timeline.createItem(_?{start:new Date(b),end:new Date(y),content:D,group:M}:{start:new Date(v),content:D,group:M})).isCluster=!0,C.items=g,C.items.forEach((function(t){t.cluster=C})),s.push(C),c+=m}else delete d.cluster,c+=1}this.cache[i]=s}return s},links.events=links.events||{listeners:[],indexOf:function(t){for(var e=this.listeners,i=0,n=this.listeners.length;n>i;i++){var o=e[i];if(o&&o.object==t)return i}return-1},addListener:function(t,e,i){var n=this.indexOf(t),o=this.listeners[n];o||(o={object:t,events:{}},this.listeners.push(o));var s=o.events[e];s||(s=[],o.events[e]=s),-1==s.indexOf(i)&&s.push(i)},removeListener:function(t,e,i){var n=this.indexOf(t),o=this.listeners[n];if(o){var s=o.events[e];if(s)-1!=(n=s.indexOf(i))&&s.splice(n,1),0==s.length&&delete o.events[e];var a=0,r=o.events;for(var l in r)r.hasOwnProperty(l)&&a++;0==a&&delete this.listeners[n]}},removeAllListeners:function(){this.listeners=[]},trigger:function(t,e,i){var n=this.indexOf(t),o=this.listeners[n];if(o){var s=o.events[e];if(s)for(var a=0,r=s.length;r>a;a++)s[a](i)}}},links.Timeline.StepDate=function(t,e,i){this.current=new Date,this._start=new Date,this._end=new Date,this.autoScale=!0,this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1,this.setRange(t,e,i)},links.Timeline.StepDate.SCALE={MILLISECOND:1,SECOND:2,MINUTE:3,HOUR:4,DAY:5,WEEKDAY:6,MONTH:7,YEAR:8},links.Timeline.StepDate.prototype.setRange=function(t,e,i){t instanceof Date&&e instanceof Date&&(this._start=null!=t?new Date(t.valueOf()):new Date,this._end=null!=e?new Date(e.valueOf()):new Date,this.autoScale&&this.setMinimumStep(i))},links.Timeline.StepDate.prototype.start=function(){this.current=new Date(this._start.valueOf()),this.roundToMinor()},links.Timeline.StepDate.prototype.roundToMinor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.step*Math.floor(this.current.getFullYear()/this.step)),this.current.setMonth(0);case links.Timeline.StepDate.SCALE.MONTH:this.current.setDate(1);case links.Timeline.StepDate.SCALE.DAY:case links.Timeline.StepDate.SCALE.WEEKDAY:this.current.setHours(0);case links.Timeline.StepDate.SCALE.HOUR:this.current.setMinutes(0);case links.Timeline.StepDate.SCALE.MINUTE:this.current.setSeconds(0);case links.Timeline.StepDate.SCALE.SECOND:this.current.setMilliseconds(0)}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.setMilliseconds(this.current.getMilliseconds()-this.current.getMilliseconds()%this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()-this.current.getSeconds()%this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()-this.current.getMinutes()%this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()-this.current.getHours()%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()-1-(this.current.getDate()-1)%this.step+1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()-this.current.getMonth()%this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()-this.current.getFullYear()%this.step)}},links.Timeline.StepDate.prototype.end=function(){return this.current.valueOf()>this._end.valueOf()},links.Timeline.StepDate.prototype.next=function(){var t=this.current.valueOf();if(this.current.getMonth()<6)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current=new Date(this.current.valueOf()+1e3*this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current=new Date(this.current.valueOf()+1e3*this.step*60);break;case links.Timeline.StepDate.SCALE.HOUR:this.current=new Date(this.current.valueOf()+1e3*this.step*60*60);var e=this.current.getHours();this.current.setHours(e-e%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step)}else switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()+this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()+this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()+this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step)}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.getMilliseconds()<this.step&&this.current.setMilliseconds(0);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.getSeconds()<this.step&&this.current.setSeconds(0);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.getMinutes()<this.step&&this.current.setMinutes(0);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.getHours()<this.step&&this.current.setHours(0);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.getDate()<this.step+1&&this.current.setDate(1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.getMonth()<this.step&&this.current.setMonth(0);case links.Timeline.StepDate.SCALE.YEAR:}this.current.valueOf()==t&&(this.current=new Date(this._end.valueOf()))},links.Timeline.StepDate.prototype.getCurrent=function(){return this.current},links.Timeline.StepDate.prototype.setScale=function(t,e){this.scale=t,e>0&&(this.step=e),this.autoScale=!1},links.Timeline.StepDate.prototype.setAutoScale=function(t){this.autoScale=t},links.Timeline.StepDate.prototype.setMinimumStep=function(t){if(null!=t){var e=31104e6,i=2592e6,n=864e5,o=36e5,s=6e4,a=1e3;1e3*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1e3),500*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=500),100*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=100),50*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=50),10*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=10),5*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=5),e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1),3*i>t&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=3),i>t&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=1),5*n>t&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=5),2*n>t&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=2),n>t&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1),n/2>t&&(this.scale=links.Timeline.StepDate.SCALE.WEEKDAY,this.step=1),4*o>t&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=4),o>t&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=1),15*s>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=15),10*s>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=10),5*s>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=5),s>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=1),15*a>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=15),10*a>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=10),5*a>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=5),a>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=1),200>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=200),100>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=100),50>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=50),10>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=10),5>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=5),1>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=1)}},links.Timeline.StepDate.prototype.snap=function(t){if(this.scale==links.Timeline.StepDate.SCALE.YEAR){var e=t.getFullYear()+Math.round(t.getMonth()/12);t.setFullYear(Math.round(e/this.step)*this.step),t.setMonth(0),t.setDate(0),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MONTH)t.getDate()>15?(t.setDate(1),t.setMonth(t.getMonth()+1)):t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);else if(this.scale==links.Timeline.StepDate.SCALE.DAY||this.scale==links.Timeline.StepDate.SCALE.WEEKDAY){switch(this.step){case 5:case 2:t.setHours(24*Math.round(t.getHours()/24));break;default:t.setHours(12*Math.round(t.getHours()/12))}t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.HOUR){if(4===this.step)t.setMinutes(60*Math.round(t.getMinutes()/60));else t.setMinutes(30*Math.round(t.getMinutes()/30));t.setSeconds(0),t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MINUTE){switch(this.step){case 15:case 10:t.setMinutes(5*Math.round(t.getMinutes()/5)),t.setSeconds(0);break;case 5:t.setSeconds(60*Math.round(t.getSeconds()/60));break;default:t.setSeconds(30*Math.round(t.getSeconds()/30))}t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.SECOND)switch(this.step){case 15:case 10:t.setSeconds(5*Math.round(t.getSeconds()/5)),t.setMilliseconds(0);break;case 5:t.setMilliseconds(1e3*Math.round(t.getMilliseconds()/1e3));break;default:t.setMilliseconds(500*Math.round(t.getMilliseconds()/500))}else if(this.scale==links.Timeline.StepDate.SCALE.MILLISECOND){var i=this.step>5?this.step/2:1;t.setMilliseconds(Math.round(t.getMilliseconds()/i)*i)}},links.Timeline.StepDate.prototype.isMajor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return 0==this.current.getMilliseconds();case links.Timeline.StepDate.SCALE.SECOND:return 0==this.current.getSeconds();case links.Timeline.StepDate.SCALE.MINUTE:return 0==this.current.getHours()&&0==this.current.getMinutes();case links.Timeline.StepDate.SCALE.HOUR:return 0==this.current.getHours();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return 1==this.current.getDate();case links.Timeline.StepDate.SCALE.MONTH:return 0==this.current.getMonth();case links.Timeline.StepDate.SCALE.YEAR:default:return!1}},links.Timeline.StepDate.prototype.getLabelMinor=function(t,e){switch(null==e&&(e=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return String(e.getMilliseconds());case links.Timeline.StepDate.SCALE.SECOND:return String(e.getSeconds());case links.Timeline.StepDate.SCALE.MINUTE:case links.Timeline.StepDate.SCALE.HOUR:return this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2);case links.Timeline.StepDate.SCALE.WEEKDAY:return t.DAYS_SHORT[e.getDay()]+" "+e.getDate();case links.Timeline.StepDate.SCALE.DAY:return String(e.getDate());case links.Timeline.StepDate.SCALE.MONTH:return t.MONTHS_SHORT[e.getMonth()];case links.Timeline.StepDate.SCALE.YEAR:return String(e.getFullYear());default:return""}},links.Timeline.StepDate.prototype.getLabelMajor=function(t,e){switch(null==e&&(e=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2)+":"+this.addZeros(e.getSeconds(),2);case links.Timeline.StepDate.SCALE.SECOND:return e.getDate()+" "+t.MONTHS[e.getMonth()]+" "+this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2);case links.Timeline.StepDate.SCALE.MINUTE:case links.Timeline.StepDate.SCALE.HOUR:return t.DAYS[e.getDay()]+" "+e.getDate()+" "+t.MONTHS[e.getMonth()]+" "+e.getFullYear();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return t.MONTHS[e.getMonth()]+" "+e.getFullYear();case links.Timeline.StepDate.SCALE.MONTH:return String(e.getFullYear());default:return""}},links.Timeline.StepDate.prototype.addZeros=function(t,e){for(var i=""+t;i.length<e;)i="0"+i;return i},links.imageloader=function(){function t(t){if(1==n[t])return!0;var e=new Image;return e.src=t,!!e.complete}function e(t){return null!=o[t]}function i(i,s,a){if(null==a&&(a=!0),t(i))a&&s(i);else if(!e(i)||a){var r=o[i];if(!r){var l=new Image;l.src=i,r=[],o[i]=r,l.onload=function(){n[i]=!0,delete o[i];for(var t=0;t<r.length;t++)r[t](i)}}-1==r.indexOf(s)&&r.push(s)}}var n={},o={};return{isLoaded:t,isLoading:e,load:i,loadAll:function(e,n,o){var s=[];if(e.forEach((function(e){t(e)||s.push(e)})),s.length){var a=s.length;s.forEach((function(t){i(t,(function(){0==--a&&n()}),o)}))}else o&&n()},filterImageUrls:function t(e,i){for(var n=e.firstChild;n;){if("IMG"==n.tagName){var o=n.src;-1==i.indexOf(o)&&i.push(o)}t(n,i),n=n.nextSibling}}}}(),links.Timeline.addEventListener=function(t,e,i,n){t.addEventListener?(void 0===n&&(n=!1),"mousewheel"===e&&navigator.userAgent.indexOf("Firefox")>=0&&(e="DOMMouseScroll"),t.addEventListener(e,i,n)):t.attachEvent("on"+e,i)},links.Timeline.removeEventListener=function(t,e,i,n){t.removeEventListener?(void 0===n&&(n=!1),"mousewheel"===e&&navigator.userAgent.indexOf("Firefox")>=0&&(e="DOMMouseScroll"),t.removeEventListener(e,i,n)):t.detachEvent("on"+e,i)},links.Timeline.getTarget=function(t){var e;return t||(t=window.event),t.target?e=t.target:t.srcElement&&(e=t.srcElement),null!=e.nodeType&&3==e.nodeType&&(e=e.parentNode),e},links.Timeline.stopPropagation=function(t){t||(t=window.event),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},links.Timeline.preventDefault=function(t){t||(t=window.event),t.preventDefault?t.preventDefault():t.returnValue=!1},links.Timeline.getAbsoluteLeft=function(t){for(var e=document.documentElement,i=document.body,n=t.offsetLeft,o=t.offsetParent;null!=o&&o!=i&&o!=e;)n+=o.offsetLeft,n-=o.scrollLeft,o=o.offsetParent;return n},links.Timeline.getAbsoluteTop=function(t){for(var e=document.documentElement,i=document.body,n=t.offsetTop,o=t.offsetParent;null!=o&&o!=i&&o!=e;)n+=o.offsetTop,n-=o.scrollTop,o=o.offsetParent;return n},links.Timeline.getPageY=function(t){if("targetTouches"in t&&t.targetTouches.length&&(t=t.targetTouches[0]),"pageY"in t)return t.pageY;var e=t.clientY,i=document.documentElement,n=document.body;return e+(i&&i.scrollTop||n&&n.scrollTop||0)-(i&&i.clientTop||n&&n.clientTop||0)},links.Timeline.getPageX=function(t){if("targetTouches"in t&&t.targetTouches.length&&(t=t.targetTouches[0]),"pageX"in t)return t.pageX;var e=t.clientX,i=document.documentElement,n=document.body;return e+(i&&i.scrollLeft||n&&n.scrollLeft||0)-(i&&i.clientLeft||n&&n.clientLeft||0)},links.Timeline.addClassName=function(t,e){for(var i=t.className.split(" "),n=e.split(" "),o=!1,s=0;s<n.length;s++)-1==i.indexOf(n[s])&&(i.push(n[s]),o=!0);o&&(t.className=i.join(" "))},links.Timeline.removeClassName=function(t,e){for(var i=t.className.split(" "),n=e.split(" "),o=!1,s=0;s<n.length;s++){var a=i.indexOf(n[s]);-1!=a&&(i.splice(a,1),o=!0)}o&&(t.className=i.join(" "))},links.Timeline.isArray=function(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)},links.Timeline.clone=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},links.Timeline.parseJSONDate=function(t){if(null!=t){if(t instanceof Date)return t;var e=t.match(/\/Date\((-?\d+)([-\+]?\d{2})?(\d{2})?\)\//i);if(e){var i=e[2]?36e5*e[2]+6e4*e[3]*(e[2]/Math.abs(e[2])):0;return new Date(1*e[1]+i)}return Date.parse(t)}},function(t){var e={},i={};t.ajaxq=function(n,o){function s(){if(e[n]){var t=e[n].shift();if(t){var o=t();i[n]=o}else delete e[n],delete i[n]}}if(void 0===o)throw"AjaxQ: queue name is not provided";var a=t.Deferred(),r=a.promise();r.success=r.done,r.error=r.fail,r.complete=r.always;var l="function"==typeof o,c=l?null:t.extend(!0,{},o);return function(t){if(e[n])e[n].push(t);else{e[n]=[];var o=t();i[n]=o}}((function(){var e=t.ajax.apply(window,[l?o():c]);return e.done((function(){a.resolve.apply(this,arguments)})),e.fail((function(){a.reject.apply(this,arguments)})),e.always(s),e})),r},t.each(["getq","postq"],(function(e,i){t[i]=function(e,n,o,s,a){return t.isFunction(o)&&(a=a||s,s=o,o=void 0),t.ajaxq(e,{type:"postq"===i?"post":"get",url:n,data:o,success:s,dataType:a})}}));var n=function(t){return e.hasOwnProperty(t)&&e[t].length>0};t.ajaxq.isRunning=function(t){return t?n(t):function(){for(var t in e)if(n(t))return!0;return!1}()},t.ajaxq.getActiveRequest=function(t){if(!t)throw"AjaxQ: queue name is required";return i[t]},t.ajaxq.abort=function(n){if(!n)throw"AjaxQ: queue name is required";var o=t.ajaxq.getActiveRequest(n);delete e[n],delete i[n],o&&o.abort()},t.ajaxq.clear=function(t){if(t)e[t]&&(e[t]=[]);else for(var i in e)e.hasOwnProperty(i)&&(e[i]=[])}}(jQuery),function(){"use strict";function t(t){return new Date((t+.5-T)*S)}function e(t){return function(t){return t.valueOf()/S-.5+T}(t)-C}function i(t,e){return w(v(t)*b(D)-y(e)*v(D),b(t))}function n(t,e){return _(v(e)*b(D)+b(e)*v(D)*v(t))}function o(t,e,i){return w(v(t),b(t)*v(e)-y(i)*b(e))}function s(t,e,i){return _(v(e)*v(i)+b(e)*b(i)*b(t))}function a(t,e){return k*(280.16+360.9856235*t)-e}function r(t){return k*(357.5291+.98560028*t)}function l(t){return t+k*(1.9148*v(t)+.02*v(2*t)+3e-4*v(3*t))+102.9372*k+g}function c(t){var e=l(r(t));return{dec:n(e,0),ra:i(e,0)}}function d(t,e){return Math.round(t-P-e/(2*g))}function u(t,e,i){return P+(t+e)/(2*g)+i}function h(t,e,i){return C+t+.0053*v(e)-.0069*v(2*i)}function p(t,e,i,n,o,s,a){var r=function(t,e,i){return x((v(t)-v(e)*v(i))/(b(e)*b(i)))}(t,i,n);return h(u(r,e,o),s,a)}function f(t){var e=k*(134.963+13.064993*t),o=k*(93.272+13.22935*t),s=k*(218.316+13.176396*t)+6.289*k*v(e),a=5.128*k*v(o),r=385001-20905*b(e);return{ra:i(s,a),dec:n(s,a),dist:r}}function m(t,e){return new Date(t.valueOf()+e*S/24)}var g=Math.PI,v=Math.sin,b=Math.cos,y=Math.tan,_=Math.asin,w=Math.atan2,x=Math.acos,k=g/180,S=864e5,T=2440588,C=2451545,D=23.4397*k,M={getPosition:function(t,i,n){var r=k*-n,l=k*i,d=e(t),u=c(d),h=a(d,r)-u.ra;return{azimuth:o(h,l,u.dec),altitude:s(h,l,u.dec)}}},O=M.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];M.addTime=function(t,e,i){O.push([t,e,i])};var P=9e-4;M.getTimes=function(i,o,s){var a,c,f,m,g,v=k*-s,b=k*o,y=d(e(i),v),_=u(0,v,y),w=r(_),x=l(w),S=n(x,0),T=h(_,w,x),C={solarNoon:t(T),nadir:t(T-.5)};for(a=0,c=O.length;c>a;a+=1)g=T-((m=p((f=O[a])[0]*k,v,b,S,y,w,x))-T),C[f[1]]=t(g),C[f[2]]=t(m);return C},M.getMoonPosition=function(t,i,n){var r=k*-n,l=k*i,c=e(t),d=f(c),u=a(c,r)-d.ra,h=s(u,l,d.dec);return h+=.017*k/y(h+10.26*k/(h+5.1*k)),{azimuth:o(u,l,d.dec),altitude:h,distance:d.dist}},M.getMoonIllumination=function(t){var i=e(t),n=c(i),o=f(i),s=149598e3,a=x(v(n.dec)*v(o.dec)+b(n.dec)*b(o.dec)*b(n.ra-o.ra)),r=w(s*v(a),o.dist-s*b(a)),l=w(b(n.dec)*v(n.ra-o.ra),v(n.dec)*b(o.dec)-b(n.dec)*v(o.dec)*b(n.ra-o.ra));return{fraction:(1+b(r))/2,phase:.5+.5*r*(0>l?-1:1)/Math.PI,angle:l}},M.getMoonTimes=function(t,e,i){var n=new Date(t);n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);for(var o,s,a,r,l,c,d,u,h,p,f,g,v,b=.133*k,y=M.getMoonPosition(n,e,i).altitude-b,_=1;24>=_&&(o=M.getMoonPosition(m(n,_),e,i).altitude-b,u=((l=(y+(s=M.getMoonPosition(m(n,_+1),e,i).altitude-b))/2-o)*(d=-(c=(s-y)/2)/(2*l))+c)*d+o,p=0,(h=c*c-4*l*o)>=0&&(f=d-(v=Math.sqrt(h)/(2*Math.abs(l))),g=d+v,Math.abs(f)<=1&&p++,Math.abs(g)<=1&&p++,-1>f&&(f=g)),1===p?0>y?a=_+f:r=_+f:2===p&&(a=_+(0>u?g:f),r=_+(0>u?f:g)),!a||!r);_+=2)y=s;var w={};return a&&(w.rise=m(n,a)),r&&(w.set=m(n,r)),a||r||(w[u>0?"alwaysUp":"alwaysDown"]=!0),w},"function"==typeof define&&define.amd?define(M):"undefined"!=typeof module?module.exports=M:window.SunCalc=M}(),function(t){"use strict";function e(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function i(t,i,n,o,s,a){return e(function(t,e){return t<<e|t>>>32-e}(e(e(i,t),e(o,a)),s),n)}function n(t,e,n,o,s,a,r){return i(e&n|~e&o,t,e,s,a,r)}function o(t,e,n,o,s,a,r){return i(e&o|n&~o,t,e,s,a,r)}function s(t,e,n,o,s,a,r){return i(e^n^o,t,e,s,a,r)}function a(t,e,n,o,s,a,r){return i(n^(e|~o),t,e,s,a,r)}function r(t,i){t[i>>5]|=128<<i%32,t[14+(i+64>>>9<<4)]=i;var r,l,c,d,u,h=1732584193,p=-271733879,f=-1732584194,m=271733878;for(r=0;r<t.length;r+=16)l=h,c=p,d=f,u=m,h=n(h,p,f,m,t[r],7,-680876936),m=n(m,h,p,f,t[r+1],12,-389564586),f=n(f,m,h,p,t[r+2],17,606105819),p=n(p,f,m,h,t[r+3],22,-1044525330),h=n(h,p,f,m,t[r+4],7,-176418897),m=n(m,h,p,f,t[r+5],12,1200080426),f=n(f,m,h,p,t[r+6],17,-1473231341),p=n(p,f,m,h,t[r+7],22,-45705983),h=n(h,p,f,m,t[r+8],7,1770035416),m=n(m,h,p,f,t[r+9],12,-1958414417),f=n(f,m,h,p,t[r+10],17,-42063),p=n(p,f,m,h,t[r+11],22,-1990404162),h=n(h,p,f,m,t[r+12],7,1804603682),m=n(m,h,p,f,t[r+13],12,-40341101),f=n(f,m,h,p,t[r+14],17,-1502002290),h=o(h,p=n(p,f,m,h,t[r+15],22,1236535329),f,m,t[r+1],5,-165796510),m=o(m,h,p,f,t[r+6],9,-1069501632),f=o(f,m,h,p,t[r+11],14,643717713),p=o(p,f,m,h,t[r],20,-373897302),h=o(h,p,f,m,t[r+5],5,-701558691),m=o(m,h,p,f,t[r+10],9,38016083),f=o(f,m,h,p,t[r+15],14,-660478335),p=o(p,f,m,h,t[r+4],20,-405537848),h=o(h,p,f,m,t[r+9],5,568446438),m=o(m,h,p,f,t[r+14],9,-1019803690),f=o(f,m,h,p,t[r+3],14,-187363961),p=o(p,f,m,h,t[r+8],20,1163531501),h=o(h,p,f,m,t[r+13],5,-1444681467),m=o(m,h,p,f,t[r+2],9,-51403784),f=o(f,m,h,p,t[r+7],14,1735328473),h=s(h,p=o(p,f,m,h,t[r+12],20,-1926607734),f,m,t[r+5],4,-378558),m=s(m,h,p,f,t[r+8],11,-2022574463),f=s(f,m,h,p,t[r+11],16,1839030562),p=s(p,f,m,h,t[r+14],23,-35309556),h=s(h,p,f,m,t[r+1],4,-1530992060),m=s(m,h,p,f,t[r+4],11,1272893353),f=s(f,m,h,p,t[r+7],16,-155497632),p=s(p,f,m,h,t[r+10],23,-1094730640),h=s(h,p,f,m,t[r+13],4,681279174),m=s(m,h,p,f,t[r],11,-358537222),f=s(f,m,h,p,t[r+3],16,-722521979),p=s(p,f,m,h,t[r+6],23,76029189),h=s(h,p,f,m,t[r+9],4,-640364487),m=s(m,h,p,f,t[r+12],11,-421815835),f=s(f,m,h,p,t[r+15],16,530742520),h=a(h,p=s(p,f,m,h,t[r+2],23,-995338651),f,m,t[r],6,-198630844),m=a(m,h,p,f,t[r+7],10,1126891415),f=a(f,m,h,p,t[r+14],15,-1416354905),p=a(p,f,m,h,t[r+5],21,-57434055),h=a(h,p,f,m,t[r+12],6,1700485571),m=a(m,h,p,f,t[r+3],10,-1894986606),f=a(f,m,h,p,t[r+10],15,-1051523),p=a(p,f,m,h,t[r+1],21,-2054922799),h=a(h,p,f,m,t[r+8],6,1873313359),m=a(m,h,p,f,t[r+15],10,-30611744),f=a(f,m,h,p,t[r+6],15,-1560198380),p=a(p,f,m,h,t[r+13],21,1309151649),h=a(h,p,f,m,t[r+4],6,-145523070),m=a(m,h,p,f,t[r+11],10,-1120210379),f=a(f,m,h,p,t[r+2],15,718787259),p=a(p,f,m,h,t[r+9],21,-343485551),h=e(h,l),p=e(p,c),f=e(f,d),m=e(m,u);return[h,p,f,m]}function l(t){var e,i="";for(e=0;e<32*t.length;e+=8)i+=String.fromCharCode(t[e>>5]>>>e%32&255);return i}function c(t){var e,i=[];for(i[(t.length>>2)-1]=void 0,e=0;e<i.length;e+=1)i[e]=0;for(e=0;e<8*t.length;e+=8)i[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return i}function d(t){var e,i,n="0123456789abcdef",o="";for(i=0;i<t.length;i+=1)e=t.charCodeAt(i),o+=n.charAt(e>>>4&15)+n.charAt(15&e);return o}function u(t){return unescape(encodeURIComponent(t))}function h(t){return function(t){return l(r(c(t),8*t.length))}(u(t))}function p(t,e){return function(t,e){var i,n,o=c(t),s=[],a=[];for(s[15]=a[15]=void 0,o.length>16&&(o=r(o,8*t.length)),i=0;16>i;i+=1)s[i]=909522486^o[i],a[i]=1549556828^o[i];return n=r(s.concat(c(e)),512+8*e.length),l(r(a.concat(n),640))}(u(t),u(e))}function f(t,e,i){return e?i?p(e,t):function(t,e){return d(p(t,e))}(e,t):i?h(t):function(t){return d(h(t))}(t)}"function"==typeof define&&define.amd?define((function(){return f})):t.md5=f}(this),Array.prototype.remove=function(t,e){var i=this.slice((e||t)+1||this.length);return this.length=0>t?this.length+t:t,this.push.apply(this,i)};var s=void 0,u=!1,sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};function w(t,e,i){4!==e.length&&q(new sjcl.exception.invalid("invalid aes block size"));var n=t.b[i],o=e[0]^n[0],s=e[i?3:1]^n[1],a=e[2]^n[2];e=e[i?1:3]^n[3];var r,l,c,d,u=n.length/4-2,h=4,p=[0,0,0,0];t=(r=t.l[i])[0];var f=r[1],m=r[2],g=r[3],v=r[4];for(d=0;d<u;d++)r=t[o>>>24]^f[s>>16&255]^m[a>>8&255]^g[255&e]^n[h],l=t[s>>>24]^f[a>>16&255]^m[e>>8&255]^g[255&o]^n[h+1],c=t[a>>>24]^f[e>>16&255]^m[o>>8&255]^g[255&s]^n[h+2],e=t[e>>>24]^f[o>>16&255]^m[s>>8&255]^g[255&a]^n[h+3],h+=4,o=r,s=l,a=c;for(d=0;4>d;d++)p[i?3&-d:d]=v[o>>>24]<<24^v[s>>16&255]<<16^v[a>>8&255]<<8^v[255&e]^n[h++],r=o,o=s,s=a,a=e,e=r;return p}function x(t,e){var i,n,o,s=e.slice(0),a=t.s,r=t.b,l=a[0],c=a[1],d=a[2],u=a[3],h=a[4],p=a[5],f=a[6],m=a[7];for(i=0;64>i;i++)16>i?n=s[i]:(n=s[i+1&15],o=s[i+14&15],n=s[15&i]=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+s[15&i]+s[i+9&15]|0),n=n+m+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(f^h&(p^f))+r[i],m=f,f=p,p=h,h=u+n|0,u=d,d=c,l=n+((c=l)&d^u&(c^d))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;a[0]=a[0]+l|0,a[1]=a[1]+c|0,a[2]=a[2]+d|0,a[3]=a[3]+u|0,a[4]=a[4]+h|0,a[5]=a[5]+p|0,a[6]=a[6]+f|0,a[7]=a[7]+m|0}function C(t,e){var i,n=sjcl.random.B[t],o=[];for(i in n)n.hasOwnProperty(i)&&o.push(n[i]);for(i=0;i<o.length;i++)o[i](e)}function E(t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),t,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),t,"loadtime")}function A(t){t.b=B(t).concat(B(t)),t.C=new sjcl.cipher.aes(t.b)}function B(t){for(var e=0;4>e&&(t.f[e]=t.f[e]+1|0,!t.f[e]);e++);return t.C.encrypt(t.f)}function D(t,e){return function(){e.apply(t,arguments)}}"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],(function(){return sjcl})),sjcl.cipher.aes=function(t){this.l[0][0][0]||this.G();var e,i,n,o,s=this.l[0][4],a=this.l[1],r=1;for(4!==(e=t.length)&&6!==e&&8!==e&&q(new sjcl.exception.invalid("invalid aes key size")),this.b=[n=t.slice(0),o=[]],t=e;t<4*e+28;t++)i=n[t-1],(0==t%e||8===e&&4==t%e)&&(i=s[i>>>24]<<24^s[i>>16&255]<<16^s[i>>8&255]<<8^s[255&i],0==t%e&&(i=i<<8^i>>>24^r<<24,r=r<<1^283*(r>>7))),n[t]=n[t-e]^i;for(e=0;t;e++,t--)i=n[3&e?t:t-4],o[e]=4>=t||4>e?i:a[0][s[i>>>24]]^a[1][s[i>>16&255]]^a[2][s[i>>8&255]]^a[3][s[255&i]]},sjcl.cipher.aes.prototype={encrypt:function(t){return w(this,t,0)},decrypt:function(t){return w(this,t,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){var t,e,i,n,o,s,a,r=this.l[0],l=this.l[1],c=r[4],d=l[4],u=[],h=[];for(t=0;256>t;t++)h[(u[t]=t<<1^283*(t>>7))^t]=t;for(e=i=0;!c[e];e^=n||1,i=h[i]||1)for(s=(s=i^i<<1^i<<2^i<<3^i<<4)>>8^255&s^99,c[e]=s,d[s]=e,a=16843009*(o=u[t=u[n=u[e]]])^65537*t^257*n^16843008*e,o=257*u[s]^16843008*s,t=0;4>t;t++)r[t][e]=o=o<<24^o>>>8,l[t][s]=a=a<<24^a>>>8;for(t=0;5>t;t++)r[t]=r[t].slice(0),l[t]=l[t].slice(0)}},sjcl.bitArray={bitSlice:function(t,e,i){return t=sjcl.bitArray.R(t.slice(e/32),32-(31&e)).slice(1),i===s?t:sjcl.bitArray.clamp(t,i-e)},extract:function(t,e,i){var n=Math.floor(-e-i&31);return(-32&(e+i-1^e)?t[e/32|0]<<32-n^t[e/32+1|0]>>>n:t[e/32|0]>>>n)&(1<<i)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var i=t[t.length-1],n=sjcl.bitArray.getPartial(i);return 32===n?t.concat(e):sjcl.bitArray.R(e,n,0|i,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:32*(e-1)+sjcl.bitArray.getPartial(t[e-1])},clamp:function(t,e){if(32*t.length<e)return t;var i=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<i&&e&&(t[i-1]=sjcl.bitArray.partial(e,t[i-1]&2147483648>>e-1,1)),t},partial:function(t,e,i){return 32===t?e:(i?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return u;var i,n=0;for(i=0;i<t.length;i++)n|=t[i]^e[i];return 0===n},R:function(t,e,i,n){var o;for(o=0,n===s&&(n=[]);32<=e;e-=32)n.push(i),i=0;if(0===e)return n.concat(t);for(o=0;o<t.length;o++)n.push(i|t[o]>>>e),i=t[o]<<32-e;return o=t.length?t[t.length-1]:0,t=sjcl.bitArray.getPartial(o),n.push(sjcl.bitArray.partial(e+t&31,32<e+t?i:n.pop(),1)),n},g:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,i;for(e=0;e<t.length;++e)i=t[e],t[e]=i>>>24|i>>>8&65280|(65280&i)<<8|i<<24;return t}},sjcl.codec.utf8String={fromBits:function(t){var e,i,n="",o=sjcl.bitArray.bitLength(t);for(e=0;e<o/8;e++)0==(3&e)&&(i=t[e/4]),n+=String.fromCharCode(i>>>24),i<<=8;return decodeURIComponent(escape(n))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,i=[],n=0;for(e=0;e<t.length;e++)n=n<<8|t.charCodeAt(e),3==(3&e)&&(i.push(n),n=0);return 3&e&&i.push(sjcl.bitArray.partial(8*(3&e),n)),i}},sjcl.codec.hex={fromBits:function(t){var e,i="";for(e=0;e<t.length;e++)i+=(0xf00000000000+(0|t[e])).toString(16).substr(4);return i.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,i,n=[];for(i=(t=t.replace(/\s|0x/g,"")).length,t+="00000000",e=0;e<t.length;e+=8)n.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(n,4*i)}},sjcl.codec.base32={p:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",O:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,e,i){var n=sjcl.codec.base32.BASE,o=sjcl.codec.base32.REMAINING,s="",a=0,r=sjcl.codec.base32.p,l=0,c=sjcl.bitArray.bitLength(t);for(i&&(r=sjcl.codec.base32.O),i=0;s.length*n<c;)s+=r.charAt((l^t[i]>>>a)>>>o),a<n?(l=t[i]<<n-a,a+=o,i++):(l<<=n,a-=n);for(;7&s.length&&!e;)s+="=";return s},toBits:function(t,e){t=t.replace(/\s|=/g,"").toUpperCase();var i,n,o=sjcl.codec.base32.BITS,s=sjcl.codec.base32.BASE,a=sjcl.codec.base32.REMAINING,r=[],l=0,c=sjcl.codec.base32.p,d=0,u="base32";for(e&&(c=sjcl.codec.base32.O,u="base32hex"),i=0;i<t.length;i++){if(0>(n=c.indexOf(t.charAt(i)))){if(!e)try{return sjcl.codec.base32hex.toBits(t)}catch(t){}q(new sjcl.exception.invalid("this isn't "+u+"!"))}l>a?(l-=a,r.push(d^n>>>l),d=n<<o-l):d^=n<<o-(l+=s)}return 56&l&&r.push(sjcl.bitArray.partial(56&l,d,1)),r}},sjcl.codec.base32hex={fromBits:function(t,e){return sjcl.codec.base32.fromBits(t,e,1)},toBits:function(t){return sjcl.codec.base32.toBits(t,1)}},sjcl.codec.base64={p:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,i){var n="",o=0,s=sjcl.codec.base64.p,a=0,r=sjcl.bitArray.bitLength(t);for(i&&(s=s.substr(0,62)+"-_"),i=0;6*n.length<r;)n+=s.charAt((a^t[i]>>>o)>>>26),6>o?(a=t[i]<<6-o,o+=26,i++):(a<<=6,o-=6);for(;3&n.length&&!e;)n+="=";return n},toBits:function(t,e){t=t.replace(/\s|=/g,"");var i,n,o=[],s=0,a=sjcl.codec.base64.p,r=0;for(e&&(a=a.substr(0,62)+"-_"),i=0;i<t.length;i++)0>(n=a.indexOf(t.charAt(i)))&&q(new sjcl.exception.invalid("this isn't base64!")),26<s?(s-=26,o.push(r^n>>>s),r=n<<32-s):r^=n<<32-(s+=6);return 56&s&&o.push(sjcl.bitArray.partial(56&s,r,1)),o}},sjcl.codec.base64url={fromBits:function(t){return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.hash.sha256=function(t){this.b[0]||this.G(),t?(this.s=t.s.slice(0),this.o=t.o.slice(0),this.i=t.i):this.reset()},sjcl.hash.sha256.hash=function(t){return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.s=this.P.slice(0),this.o=[],this.i=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,i=this.o=sjcl.bitArray.concat(this.o,t);for(e=this.i,t=this.i=e+sjcl.bitArray.bitLength(t),e=512+e&-512;e<=t;e+=512)x(this,i.splice(0,16));return this},finalize:function(){var t,e=this.o,i=this.s;for(t=(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this.i/4294967296)),e.push(0|this.i);e.length;)x(this,e.splice(0,16));return this.reset(),i},P:[],b:[],G:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,i=0,n=2;t:for(;64>i;n++){for(e=2;e*e<=n;e++)if(0==n%e)continue t;8>i&&(this.P[i]=t(Math.pow(n,.5))),this.b[i]=t(Math.pow(n,1/3)),i++}}},sjcl.mode.ccm={name:"ccm",t:[],listenProgress:function(t){sjcl.mode.ccm.t.push(t)},unListenProgress:function(t){-1<(t=sjcl.mode.ccm.t.indexOf(t))&&sjcl.mode.ccm.t.splice(t,1)},X:function(t){var e,i=sjcl.mode.ccm.t.slice();for(e=0;e<i.length;e+=1)i[e](t)},encrypt:function(t,e,i,n,o){var s,a=e.slice(0),r=sjcl.bitArray,l=r.bitLength(i)/8,c=r.bitLength(a)/8;for(o=o||64,n=n||[],7>l&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),s=2;4>s&&c>>>8*s;s++);return s<15-l&&(s=15-l),i=r.clamp(i,8*(15-s)),e=sjcl.mode.ccm.M(t,e,i,n,o,s),a=sjcl.mode.ccm.q(t,a,i,e,o,s),r.concat(a.data,a.tag)},decrypt:function(t,e,i,n,o){o=o||64,n=n||[];var s=sjcl.bitArray,a=s.bitLength(i)/8,r=s.bitLength(e),l=s.clamp(e,r-o),c=s.bitSlice(e,r-o);r=(r-o)/8;for(7>a&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),e=2;4>e&&r>>>8*e;e++);return e<15-a&&(e=15-a),i=s.clamp(i,8*(15-e)),l=sjcl.mode.ccm.q(t,l,i,c,o,e),t=sjcl.mode.ccm.M(t,l.data,i,n,o,e),s.equal(l.tag,t)||q(new sjcl.exception.corrupt("ccm: tag doesn't match")),l.data},ea:function(t,e,i,n,o,s){var a=[],r=sjcl.bitArray,l=r.g;if(n=[r.partial(8,(e.length?64:0)|n-2<<2|s-1)],(n=r.concat(n,i))[3]|=o,n=t.encrypt(n),e.length)for(65279>=(i=r.bitLength(e)/8)?a=[r.partial(16,i)]:4294967295>=i&&(a=r.concat([r.partial(16,65534)],[i])),a=r.concat(a,e),e=0;e<a.length;e+=4)n=t.encrypt(l(n,a.slice(e,e+4).concat([0,0,0])));return n},M:function(t,e,i,n,o,s){var a=sjcl.bitArray,r=a.g;for(((o/=8)%2||4>o||16<o)&&q(new sjcl.exception.invalid("ccm: invalid tag length")),(4294967295<n.length||4294967295<e.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")),i=sjcl.mode.ccm.ea(t,n,i,o,a.bitLength(e)/8,s),n=0;n<e.length;n+=4)i=t.encrypt(r(i,e.slice(n,n+4).concat([0,0,0])));return a.clamp(i,8*o)},q:function(t,e,i,n,o,s){var a,r=sjcl.bitArray;a=r.g;var l=e.length,c=r.bitLength(e),d=l/50,u=d;if(i=r.concat([r.partial(8,s-1)],i).concat([0,0,0]).slice(0,4),n=r.bitSlice(a(n,t.encrypt(i)),0,o),!l)return{tag:n,data:[]};for(a=0;a<l;a+=4)a>d&&(sjcl.mode.ccm.X(a/l),d+=u),i[3]++,o=t.encrypt(i),e[a]^=o[0],e[a+1]^=o[1],e[a+2]^=o[2],e[a+3]^=o[3];return{tag:n,data:r.clamp(e,c)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(t,e,i,n,o,s){128!==sjcl.bitArray.bitLength(i)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var a,r=sjcl.mode.ocb2.J,l=sjcl.bitArray,c=l.g,d=[0,0,0,0];i=r(t.encrypt(i));var u,h=[];for(n=n||[],o=o||64,a=0;a+4<e.length;a+=4)d=c(d,u=e.slice(a,a+4)),h=h.concat(c(i,t.encrypt(c(i,u)))),i=r(i);return u=e.slice(a),e=l.bitLength(u),a=t.encrypt(c(i,[0,0,0,e])),u=l.clamp(c(u.concat([0,0,0]),a),e),d=c(d,c(u.concat([0,0,0]),a)),d=t.encrypt(c(d,c(i,r(i)))),n.length&&(d=c(d,s?n:sjcl.mode.ocb2.pmac(t,n))),h.concat(l.concat(u,l.clamp(d,o)))},decrypt:function(t,e,i,n,o,s){128!==sjcl.bitArray.bitLength(i)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits")),o=o||64;var a,r,l=sjcl.mode.ocb2.J,c=sjcl.bitArray,d=c.g,u=[0,0,0,0],h=l(t.encrypt(i)),p=sjcl.bitArray.bitLength(e)-o,f=[];for(n=n||[],i=0;i+4<p/32;i+=4)a=d(h,t.decrypt(d(h,e.slice(i,i+4)))),u=d(u,a),f=f.concat(a),h=l(h);return r=p-32*i,a=t.encrypt(d(h,[0,0,0,r])),a=d(a,c.clamp(e.slice(i),r).concat([0,0,0])),u=d(u,a),u=t.encrypt(d(u,d(h,l(h)))),n.length&&(u=d(u,s?n:sjcl.mode.ocb2.pmac(t,n))),c.equal(c.clamp(u,o),c.bitSlice(e,p))||q(new sjcl.exception.corrupt("ocb: tag doesn't match")),f.concat(c.clamp(a,r))},pmac:function(t,e){var i,n=sjcl.mode.ocb2.J,o=sjcl.bitArray,s=o.g,a=[0,0,0,0],r=s(r=t.encrypt([0,0,0,0]),n(n(r)));for(i=0;i+4<e.length;i+=4)r=n(r),a=s(a,t.encrypt(s(r,e.slice(i,i+4))));return i=e.slice(i),128>o.bitLength(i)&&(r=s(r,n(r)),i=o.concat(i,[-2147483648,0,0,0])),a=s(a,i),t.encrypt(s(n(s(r,n(r))),a))},J:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(t,e,i,n,o){var s=e.slice(0);return e=sjcl.bitArray,n=n||[],t=sjcl.mode.gcm.q(!0,t,s,n,i,o||128),e.concat(t.data,t.tag)},decrypt:function(t,e,i,n,o){var s=e.slice(0),a=sjcl.bitArray,r=a.bitLength(s);return n=n||[],(o=o||128)<=r?(e=a.bitSlice(s,r-o),s=a.bitSlice(s,0,r-o)):(e=s,s=[]),t=sjcl.mode.gcm.q(u,t,s,n,i,o),a.equal(t.tag,e)||q(new sjcl.exception.corrupt("gcm: tag doesn't match")),t.data},ba:function(t,e){var i,n,o,s,a,r=sjcl.bitArray.g;for(o=[0,0,0,0],s=e.slice(0),i=0;128>i;i++){for((n=0!=(t[Math.floor(i/32)]&1<<31-i%32))&&(o=r(o,s)),a=0!=(1&s[3]),n=3;0<n;n--)s[n]=s[n]>>>1|(1&s[n-1])<<31;s[0]>>>=1,a&&(s[0]^=-520093696)}return o},h:function(t,e,i){var n,o=i.length;for(e=e.slice(0),n=0;n<o;n+=4)e[0]^=4294967295&i[n],e[1]^=4294967295&i[n+1],e[2]^=4294967295&i[n+2],e[3]^=4294967295&i[n+3],e=sjcl.mode.gcm.ba(e,t);return e},q:function(t,e,i,n,o,s){var a,r,l,c,d,u,h,p,f=sjcl.bitArray;for(u=i.length,h=f.bitLength(i),p=f.bitLength(n),r=f.bitLength(o),a=e.encrypt([0,0,0,0]),96===r?(o=o.slice(0),o=f.concat(o,[1])):(o=sjcl.mode.gcm.h(a,[0,0,0,0],o),o=sjcl.mode.gcm.h(a,o,[0,0,Math.floor(r/4294967296),4294967295&r])),r=sjcl.mode.gcm.h(a,[0,0,0,0],n),d=o.slice(0),n=r.slice(0),t||(n=sjcl.mode.gcm.h(a,r,i)),c=0;c<u;c+=4)d[3]++,l=e.encrypt(d),i[c]^=l[0],i[c+1]^=l[1],i[c+2]^=l[2],i[c+3]^=l[3];return i=f.clamp(i,h),t&&(n=sjcl.mode.gcm.h(a,r,i)),t=[Math.floor(p/4294967296),4294967295&p,Math.floor(h/4294967296),4294967295&h],n=sjcl.mode.gcm.h(a,n,t),l=e.encrypt(o),n[0]^=l[0],n[1]^=l[1],n[2]^=l[2],n[3]^=l[3],{tag:f.bitSlice(n,0,s),data:i}}},sjcl.misc.hmac=function(t,e){this.N=e=e||sjcl.hash.sha256;var i,n=[[],[]],o=e.prototype.blockSize/32;for(this.n=[new e,new e],t.length>o&&(t=e.hash(t)),i=0;i<o;i++)n[0][i]=909522486^t[i],n[1][i]=1549556828^t[i];this.n[0].update(n[0]),this.n[1].update(n[1]),this.I=new e(this.n[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){return this.S&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!")),this.update(t),this.digest(t)},sjcl.misc.hmac.prototype.reset=function(){this.I=new this.N(this.n[0]),this.S=u},sjcl.misc.hmac.prototype.update=function(t){this.S=!0,this.I.update(t)},sjcl.misc.hmac.prototype.digest=function(){var t=this.I.finalize();t=new this.N(this.n[1]).update(t).finalize();return this.reset(),t},sjcl.misc.pbkdf2=function(t,e,i,n,o){i=i||1e3,(0>n||0>i)&&q(sjcl.exception.invalid("invalid params to pbkdf2")),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),t=new(o=o||sjcl.misc.hmac)(t);var s,a,r,l,c=[],d=sjcl.bitArray;for(l=1;32*c.length<(n||1);l++){for(o=s=t.encrypt(d.concat(e,[l])),a=1;a<i;a++)for(s=t.encrypt(s),r=0;r<s.length;r++)o[r]^=s[r];c=c.concat(o)}return n&&(c=d.clamp(c,n)),c},sjcl.prng=function(t){this.c=[new sjcl.hash.sha256],this.j=[0],this.H=0,this.u={},this.F=0,this.L={},this.Q=this.d=this.k=this.Z=0,this.b=[0,0,0,0,0,0,0,0],this.f=[0,0,0,0],this.C=s,this.D=t,this.r=u,this.B={progress:{},seeded:{}},this.m=this.Y=0,this.w=1,this.A=2,this.U=65536,this.K=[0,48,64,96,128,192,256,384,512,768,1024],this.V=3e4,this.T=80},sjcl.prng.prototype={randomWords:function(t,e){var i,n,o=[];if((i=this.isReady(e))===this.m&&q(new sjcl.exception.notReady("generator isn't seeded")),i&this.A){i=!(i&this.w),n=[];var s,a=0;for(this.Q=n[0]=(new Date).valueOf()+this.V,s=0;16>s;s++)n.push(4294967296*Math.random()|0);for(s=0;s<this.c.length&&(n=n.concat(this.c[s].finalize()),a+=this.j[s],this.j[s]=0,i||!(this.H&1<<s));s++);for(this.H>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.j.push(0)),this.d-=a,a>this.k&&(this.k=a),this.H++,this.b=sjcl.hash.sha256.hash(this.b.concat(n)),this.C=new sjcl.cipher.aes(this.b),i=0;4>i&&(this.f[i]=this.f[i]+1|0,!this.f[i]);i++);}for(i=0;i<t;i+=4)0==(i+1)%this.U&&A(this),n=B(this),o.push(n[0],n[1],n[2],n[3]);return A(this),o.slice(0,t)},setDefaultParanoia:function(t,e){0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e&&q("Setting paranoia=0 will ruin your security; use it only for testing"),this.D=t},addEntropy:function(t,e,i){i=i||"user";var n,o,a=(new Date).valueOf(),r=this.u[i],l=this.isReady(),c=0;switch((n=this.L[i])===s&&(n=this.L[i]=this.Z++),r===s&&(r=this.u[i]=0),this.u[i]=(this.u[i]+1)%this.c.length,typeof t){case"number":e===s&&(e=1),this.c[r].update([n,this.F++,1,e,a,1,0|t]);break;case"object":if("[object Uint32Array]"===(i=Object.prototype.toString.call(t))){for(o=[],i=0;i<t.length;i++)o.push(t[i]);t=o}else for("[object Array]"!==i&&(c=1),i=0;i<t.length&&!c;i++)"number"!=typeof t[i]&&(c=1);if(!c){if(e===s)for(i=e=0;i<t.length;i++)for(o=t[i];0<o;)e++,o>>>=1;this.c[r].update([n,this.F++,2,e,a,t.length].concat(t))}break;case"string":e===s&&(e=t.length),this.c[r].update([n,this.F++,3,e,a,t.length]),this.c[r].update(t);break;default:c=1}c&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")),this.j[r]+=e,this.d+=e,l===this.m&&(this.isReady()!==this.m&&C("seeded",Math.max(this.k,this.d)),C("progress",this.getProgress()))},isReady:function(t){return t=this.K[t!==s?t:this.D],this.k&&this.k>=t?this.j[0]>this.T&&(new Date).valueOf()>this.Q?this.A|this.w:this.w:this.d>=t?this.A|this.m:this.m},getProgress:function(t){return t=this.K[t||this.D],this.k>=t||this.d>t?1:this.d/t},startCollectors:function(){this.r||(this.a={loadTimeCollector:D(this,this.da),mouseCollector:D(this,this.fa),keyboardCollector:D(this,this.ca),accelerometerCollector:D(this,this.W),touchCollector:D(this,this.ha)},window.addEventListener?(window.addEventListener("load",this.a.loadTimeCollector,u),window.addEventListener("mousemove",this.a.mouseCollector,u),window.addEventListener("keypress",this.a.keyboardCollector,u),window.addEventListener("devicemotion",this.a.accelerometerCollector,u),window.addEventListener("touchmove",this.a.touchCollector,u)):document.attachEvent?(document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)):q(new sjcl.exception.bug("can't attach event")),this.r=!0)},stopCollectors:function(){this.r&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,u),window.removeEventListener("mousemove",this.a.mouseCollector,u),window.removeEventListener("keypress",this.a.keyboardCollector,u),window.removeEventListener("devicemotion",this.a.accelerometerCollector,u),window.removeEventListener("touchmove",this.a.touchCollector,u)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.r=u)},addEventListener:function(t,e){this.B[t][this.Y++]=e},removeEventListener:function(t,e){var i,n,o=this.B[t],s=[];for(n in o)o.hasOwnProperty(n)&&o[n]===e&&s.push(n);for(i=0;i<s.length;i++)delete o[n=s[i]]},ca:function(){E(1)},fa:function(t){var e,i;try{e=t.x||t.clientX||t.offsetX||0,i=t.y||t.clientY||t.offsetY||0}catch(t){i=e=0}0!=e&&0!=i&&sjcl.random.addEntropy([e,i],2,"mouse"),E(0)},ha:function(t){t=t.touches[0]||t.changedTouches[0],sjcl.random.addEntropy([t.pageX||t.clientX,t.pageY||t.clientY],1,"touch"),E(0)},da:function(){E(2)},W:function(t){if(t=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z,window.orientation){var e=window.orientation;"number"==typeof e&&sjcl.random.addEntropy(e,1,"accelerometer")}t&&sjcl.random.addEntropy(t,2,"accelerometer"),E(0)}},sjcl.random=new sjcl.prng(6);t:try{var F,G,H,I;if(I="undefined"!=typeof module){var J;if(J=module.exports){var K;try{K=require("crypto")}catch(t){K=null}J=(G=K)&&G.randomBytes}I=J}if(I)F=G.randomBytes(128),F=new Uint32Array(new Uint8Array(F).buffer),sjcl.random.addEntropy(F,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(H=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(H);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break t;window.msCrypto.getRandomValues(H)}sjcl.random.addEntropy(H,1024,"crypto['getRandomValues']")}}catch(t){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(t))}sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},aa:function(t,e,i,n){i=i||{},n=n||{};var o,s=sjcl.json,a=s.e({iv:sjcl.random.randomWords(4,0)},s.defaults);return s.e(a,i),i=a.adata,"string"==typeof a.salt&&(a.salt=sjcl.codec.base64.toBits(a.salt)),"string"==typeof a.iv&&(a.iv=sjcl.codec.base64.toBits(a.iv)),(!sjcl.mode[a.mode]||!sjcl.cipher[a.cipher]||"string"==typeof t&&100>=a.iter||64!==a.ts&&96!==a.ts&&128!==a.ts||128!==a.ks&&192!==a.ks&&256!==a.ks||2>a.iv.length||4<a.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters")),"string"==typeof t?(t=(o=sjcl.misc.cachedPbkdf2(t,a)).key.slice(0,a.ks/32),a.salt=o.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.publicKey&&(o=t.kem(),a.kemtag=o.tag,t=o.key.slice(0,a.ks/32)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof i&&(a.adata=i=sjcl.codec.utf8String.toBits(i)),o=new sjcl.cipher[a.cipher](t),s.e(n,a),n.key=t,a.ct="ccm"===a.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&e instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(o,e,a.iv,i,a.ts):sjcl.mode[a.mode].encrypt(o,e,a.iv,i,a.ts),a},encrypt:function(t,e,i,n){var o=sjcl.json,s=o.aa.apply(o,arguments);return o.encode(s)},$:function(t,e,i,n){i=i||{},n=n||{};var o,s,a=sjcl.json;return o=(e=a.e(a.e(a.e({},a.defaults),e),i,!0)).adata,"string"==typeof e.salt&&(e.salt=sjcl.codec.base64.toBits(e.salt)),"string"==typeof e.iv&&(e.iv=sjcl.codec.base64.toBits(e.iv)),(!sjcl.mode[e.mode]||!sjcl.cipher[e.cipher]||"string"==typeof t&&100>=e.iter||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||2>e.iv.length||4<e.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters")),"string"==typeof t?(t=(s=sjcl.misc.cachedPbkdf2(t,e)).key.slice(0,e.ks/32),e.salt=s.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.secretKey&&(t=t.unkem(sjcl.codec.base64.toBits(e.kemtag)).slice(0,e.ks/32)),"string"==typeof o&&(o=sjcl.codec.utf8String.toBits(o)),s=new sjcl.cipher[e.cipher](t),o="ccm"===e.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&e.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(s,e.ct,e.iv,e.tag,o,e.ts):sjcl.mode[e.mode].decrypt(s,e.ct,e.iv,o,e.ts),a.e(n,e),n.key=t,1===i.raw?o:sjcl.codec.utf8String.fromBits(o)},decrypt:function(t,e,i,n){var o=sjcl.json;return o.$(t,o.decode(e),i,n)},encode:function(t){var e,i="{",n="";for(e in t)if(t.hasOwnProperty(e))switch(e.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),i+=n+'"'+e+'":',n=",",typeof t[e]){case"number":case"boolean":i+=t[e];break;case"string":i+='"'+escape(t[e])+'"';break;case"object":i+='"'+sjcl.codec.base64.fromBits(t[e],0)+'"';break;default:q(new sjcl.exception.bug("json encode: unsupported type"))}return i+"}"},decode:function(t){(t=t.replace(/\s/g,"")).match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!")),t=t.replace(/^\{|\}$/g,"").split(/,/);var e,i,n={};for(e=0;e<t.length;e++)(i=t[e].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),null!=i[3]?n[i[2]]=parseInt(i[3],10):null!=i[4]?n[i[2]]=i[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(i[4]):unescape(i[4]):null!=i[5]&&(n[i[2]]="true"===i[5]);return n},e:function(t,e,i){if(t===s&&(t={}),e===s)return t;for(var n in e)e.hasOwnProperty(n)&&(i&&t[n]!==s&&t[n]!==e[n]&&q(new sjcl.exception.invalid("required parameter overridden")),t[n]=e[n]);return t},ja:function(t,e){var i,n={};for(i in t)t.hasOwnProperty(i)&&t[i]!==e[i]&&(n[i]=t[i]);return n},ia:function(t,e){var i,n={};for(i=0;i<e.length;i++)t[e[i]]!==s&&(n[e[i]]=t[e[i]]);return n}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.ga={},sjcl.misc.cachedPbkdf2=function(t,e){var i,n=sjcl.misc.ga;return i=(e=e||{}).iter||1e3,(i=(n=n[t]=n[t]||{})[i]=n[i]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)})[n=e.salt===s?i.firstSalt:e.salt]=i[n]||sjcl.misc.pbkdf2(t,n,e.iter),{key:i[n].slice(0),salt:n.slice(0)}};var curr183,currToken,currIp,currPrefix,currAuth,currPass,currAuthUser,currAuthPass,currLocal,currLang,language,deviceip,errorTimeout,weather,openPanel,DEFAULT_WEATHER_SERVER_URL="https://weather.opensprinkler.com",WEATHER_SERVER_URL=DEFAULT_WEATHER_SERVER_URL,isIEMobile=/IEMobile/.test(navigator.userAgent),isAndroid=/Android|\bSilk\b/.test(navigator.userAgent),isiOS=/iP(ad|hone|od)/.test(navigator.userAgent),isFireFox=/Firefox/.test(navigator.userAgent),isWinApp=/MSAppHost/.test(navigator.userAgent),isOSXApp=window.cordova&&"osx"===window.cordova.platformId,isChromeApp="object"==typeof chrome&&"object"==typeof chrome.storage,isFileCapable=!isiOS&&!isAndroid&&!isIEMobile&&!isOSXApp&&!isWinApp&&window.FileReader,isTouchCapable="ontouchstart"in window||"onmsgesturechange"in window,isMetric=-1===["US","BM","PW"].indexOf(navigator.languages[0].split("-")[1]),groupView=!1,storage={get:function(t,e){if(e=e||function(){},isChromeApp)chrome.storage.local.get(t,e);else{var i,n={};for(i in"string"==typeof t&&(t=[t]),t)t.hasOwnProperty(i)&&(n[t[i]]=localStorage.getItem(t[i]));e(n)}},set:function(t,e){if(e=e||function(){},isChromeApp)chrome.storage.local.set(t,e);else{var i;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&localStorage.setItem(i,t[i]);e(!0)}},remove:function(t,e){if(e=e||function(){},isChromeApp)chrome.storage.local.remove(t,e);else{var i;for(i in"string"==typeof t&&(t=[t]),t)t.hasOwnProperty(i)&&localStorage.removeItem(t[i]);e(!0)}}},regex={gps:/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/},statusBarPrimary=isAndroid?"#121212":"#1D1D1D",statusBarOverlay=isAndroid?"#151515":"#202020",retryCount=2,controller={},switching=!1,currentCoordinates=[0,0],pageHistoryCount=-1,goingBack=!1,keyIndex={tz:1,ntp:2,dhcp:3,ip1:4,ip2:5,ip3:6,ip4:7,gw1:8,gw2:9,gw3:10,gw4:11,hp0:12,hp1:13,ar:14,ext:15,seq:16,sdt:17,mas:18,mton:19,mtof:20,urs:21,rso:22,wl:23,den:24,ipas:25,devid:26,con:27,lit:28,dim:29,bst:30,uwt:31,ntp1:32,ntp2:33,ntp3:34,ntp4:35,lg:36,mas2:37,mton2:38,mtof2:39,fpr0:41,fpr1:42,re:43,dns1:44,dns2:45,dns3:46,dns4:47,sar:48,ife:49,sn1t:50,sn1o:51,sn2t:52,sn2o:53,sn1on:54,sn1of:55,sn2on:56,sn2of:57,subn1:58,subn2:59,subn3:60,subn4:61},dialog={REMOVE_STATION:1},popupData={shift:void 0},MANUAL_STATION_PID=99,MASTER_STATION_1=1,MASTER_STATION_2=2,IGNORE_SENSOR_1=1,IGNORE_SENSOR_2=2,NUM_SEQ_GROUPS=4,PARALLEL_GROUP_NAME="P",PARALLEL_GID_VALUE=255,MASTER_GROUP_NAME="M",MASTER_GID_VALUE=254,notifications=[],timers={};if(isWinApp&&$(window).on("error",(function(t,e,i){return window.console.log(t,e,i),!0})),window.MSApp){if(window.Windows&&Windows.UI&&Windows.UI.ApplicationSettings&&Windows.UI.ApplicationSettings.SettingsPane){var settingsPane=Windows.UI.ApplicationSettings.SettingsPane.getForCurrentView();settingsPane.addEventListener("commandsrequested",(function(t){var e=t.request.applicationCommands,i=new Windows.UI.ApplicationSettings.SettingsCommand("privacy","Privacy Policy",(function(){window.open("https://albahra.com/journal/privacy-policy")}));e.append(i)}))}MSApp.execUnsafeLocalFunction&&($.fn.oldDomManIp=$.fn.domManip,$.fn.domManip=function(t,e,i){var n=this;return MSApp.execUnsafeLocalFunction((function(){return n.oldDomManIp(t,e,i)}))})}function initApp(){updateLang(),currLocal||$.ajaxSetup({timeout:1e4}),isIEMobile&&insertStyle(".ui-toolbar-back-btn{display:none!important}ul{list-style:none!important;}"),isChromeApp&&insertStyle("html,body{overflow-y:scroll}"),isAndroid?(insertStyle(".ui-toolbar-back-btn{display:none!important}"),$(this).ajaxStart((function(){try{navigator.app.clearCache()}catch(t){}}))):isFireFox?$.ajaxSetup({xhr:function(){return new window.XMLHttpRequest({mozSystem:!0})}}):$.ajaxSetup({cache:!1}),$.mobile.defaultPageTransition=isAndroid||isIEMobile?"fade":"slide",$.mobile.hoverDelay=0,$.mobile.activeBtnClass="activeButton",$.mobile.document.on("click",".iab",(function(){var t=isOSXApp?"_system":"_blank",e=$(this),i=window.open(this.href,t,"location="+(isAndroid?"yes":"no")+",enableViewportScale="+(e.hasClass("iabNoScale")?"no":"yes")+",toolbar=yes,toolbarposition=top,toolbarcolor="+statusBarPrimary+",closebuttoncaption="+(e.hasClass("iabNoScale")?_("Back"):_("Done")));return isIEMobile&&($.mobile.document.data("iabOpen",!0),i.addEventListener("exit",(function(){$.mobile.document.removeData("iabOpen")}))),setTimeout((function(){e.removeClass("ui-btn-active")}),100),!1})),$.mobile.document.on("click",".ui-select .ui-btn",(function(){var t=$(this),e=t.attr("id").replace("-button","-listbox"),i=$("#"+e);return i.popup("destroy").detach().addClass("ui-page-theme-a"),$.mobile.pageContainer.append(i),i.popup({history:!1,positionTo:t,overlayTheme:"b"}).popup("open"),t.off("click").on("click",(function(){i.popup("open")})),!1})),$.mobile.document.on("swiperight swipeleft",".ui-page",(function(t){var e=$(".ui-page-active");"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName||"open"===e.jqmData("panel")||e.find(".ui-popup-active").length||("swiperight"===t.type?openPanel():showNotifications())})),$.widget("mobile.collapsible",$.mobile.collapsible,{_handleExpandCollapse:function(t){this._trigger("before"+(t?"collapse":"expand"))&&this._superApply(arguments)}}),$("#site-selector").on("change",(function(){updateSite($(this).val())})),$("#footer-menu").on("click",(function(){showHomeMenu(this)})),$("#header,#footer").toolbar(),FastClick.attach(document.body),updateTimers(),$.mobile.document.on("keydown",(function(t){var e=$(t.target).prop("tagName");if("INPUT"!==e&&"TEXTAREA"!==e){var i=t.keyCode,n=t.altKey,o=$("#mainMenu-popup").hasClass("ui-popup-active");if(77===i)$("#mainMenu").length>0?$("#mainMenu").popup("close"):showHomeMenu();else(o||n)&&80===i?(t.preventDefault(),changePage("#programs")):(o||n)&&79===i?(t.preventDefault(),changePage("#os-options")):(o||n)&&86===i?(t.preventDefault(),changePage("#preview")):(o||n)&&76===i?(t.preventDefault(),changePage("#logs")):(o||n)&&82===i?(t.preventDefault(),changePage("#runonce")):(o||n)&&85===i?(t.preventDefault(),showPause()):(o||n)&&68===i&&(t.preventDefault(),showRainDelay())}})),bindPanel(),currLocal||void 0!==window.cordova||updateDeviceIP(),cloudSync(),setTimeout((function(){checkConfigured(!0)}),200)}function flipSwitched(){if(!switching){var t,e=$(this),i=e.attr("id"),n=e.is(":checked"),o="mmm"===i?"mm":i;t=sendToOS(n?"/cv?pw=&"+o+"=1":"/cv?pw=&"+o+"=0"),$.when(t).then((function(){refreshStatus(),"mmm"===i&&$("#mm_list .green").removeClass("green"),checkStatus()}),(function(){switching=!0,setTimeout((function(){switching=!1}),200),e.prop("checked",!n).flipswitch("refresh")}))}}function sendToOS(t,e){t=t.replace("pw=","pw="+encodeURIComponent(currPass)),e=e||"text";var i=/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|up|cm)/.exec(t),n=i?"change":"default",o=i&&checkOSVersion(300),s=o?t.split("?")[0]:t,a={url:currToken?"https://cloud.openthings.io/forward/v1/"+currToken+s:currPrefix+currIp+s,type:o?"POST":"GET",data:o?getUrlVars(t):null,dataType:e,shouldRetry:function(t,e){return!(0===t.status&&"abort"===t.statusText||retryCount<e)||($.ajaxq.abort(n),!1)}};return currAuth&&$.extend(a,{beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+btoa(currAuthUser+":"+currAuthPass))}}),curr183&&$.extend(a,{cache:"true"}),$.ajaxq(n,a).then((function(e){if("string"==typeof e)try{e=$.parseJSON(e)}catch(t){return e}return"object"!=typeof e||"number"!=typeof e.result||1===e.result?e:2===e.result?(/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|up|cm)/.exec(t)&&showerror(_("Check device password and try again.")),$.Deferred().reject({status:401})):32===e.result?$.Deferred().reject({status:404}):/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|up|cm)/.exec(t)?(48===e.result?showerror(_("The selected station is already running or is scheduled to run.")):showerror(_("Please check input and try again.")),$.Deferred().reject(e)):void 0}),(function(e){"timeout"!==e.statusText&&0!==e.status||!/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|cm)/.exec(t)?401===e.status&&showerror(_("Check device password and try again.")):showerror(_("Connection timed-out. Please try again."))}))}function networkFail(){changeStatus(0,"red","<p class='running-text center'>"+_("Network Error")+"</p>",(function(){showLoading("#weather,#footer-running"),refreshStatus(),updateWeather()}))}function newLoad(){var t=$("#site-selector").val(),e="<div class='logo'></div><h1 style='padding-top:5px'>"+_("Connecting to")+" "+t+"</h1><p class='cancel tight center inline-icon'><span class='btn-no-border ui-btn ui-icon-delete ui-btn-icon-notext'></span>Cancel</p>";$.mobile.loading("show",{html:currLocal?"<h1>"+_("Loading")+"</h1>":e,textVisible:!0,theme:"b"}),$(".ui-loader").css({"box-shadow":"none","margin-top":"-4em"}).find(".cancel").one("click",(function(){$.ajaxq.abort("default"),changePage("#site-control",{transition:"none"})})),controller={},clearNotifications(),timers={},$.ajaxq.abort("default"),updateController((function(){var e=$(".weatherAdjust"),i=$(".changePassword");$.mobile.loading("hide"),checkURLandUpdateWeather(),checkOSVersion(210)?e.css("display",""):e.hide(),checkOSVersion(230)&&(updateAnalogSensor(),updateProgramAdjustments()),isOSPi()||checkOSVersion(208)?i.css("display",""):i.hide(),currLocal?$("#info-list").find("li[data-role='list-divider']").text(_("Information")):($("#info-list").find("li[data-role='list-divider']").text(t),document.title="OpenSprinkler - "+t),checkFirmwareUpdate(),detectUnusedExpansionBoards(),checkOSVersion(213)&&255!==controller.options.hwv&&fixPasswordHash(t),currLocal||"number"!=typeof controller.settings.eip||checkPublicAccess(controller.settings.eip),updateLoginButtons(),isOSPi()&&showUnifiedFirmwareNotification(),controller.options.firstRun?showGuidedSetup():goHome(!0)}),(function(e){$.ajaxq.abort("default"),controller={},$.mobile.loading("hide");var i=function(){currLocal?storage.remove(["sites"],(function(){window.location.reload()})):"site-control"===$(".ui-page-active").attr("id")?n():($.mobile.document.one("pageshow",n),changePage("#site-control",{transition:"none"}))},n=function(){showerror(_("Unable to connect to")+" "+t,3500)};"object"==typeof e&&401===e.status?($(".ui-popup-active").find("[data-role='popup']").popup("close"),changePassword({fixIncorrect:!0,name:t,callback:newLoad,cancel:i})):i()}))}function updateController(t,e){t=t||function(){},e=e||function(){};var i=function(){$("html").trigger("datarefresh"),checkStatus(),t()};isControllerConnected()&&checkOSVersion(216)?updateControllerData(i,e):$.when(updateControllerPrograms(),updateControllerStations(),updateControllerOptions(),updateControllerStatus(),updateControllerSettings()).then(i,e)}function updateControllerData(t,e){sendToOS("/ja?pw=","json").then((function(i){if(void 0===i||$.isEmptyObject(i))e();else{var n=controller.special;(controller=i).special=n,controller.status=controller.status.sn,t()}}))}function updateControllerPrograms(t){return t=t||function(){},!0===curr183?sendToOS("/gp?d=0").done((function(e){for(var i,n,o=e.match(/(nprogs|nboards|mnp)=[\w|\d|.\"]+/g),s=/pd=\[\];(.*);/.exec(e),a={},r=0;r<o.length;r++)""!==o[r]&&(a[(i=o[r].split("="))[0]]=parseInt(i[1]));if(a.pd=[],null!==s)for(s=s[1].split(";"),r=0;r<s.length;r++)n=(n=(n=s[r].split("="))[1].replace("[","")).replace("]",""),a.pd[r]=parseIntArray(n.split(","));controller.programs=a,t()})):sendToOS("/jp?pw=","json").done((function(e){controller.programs=e,t()}))}function updateControllerStations(t){return t=t||function(){},!0===curr183?sendToOS("/vs").done((function(e){var i=/snames=\[(.*?)\];/.exec(e),n=e.match(/(?:masop|mo)\s?[=|:]\s?\[(.*?)\]/);(i=i[1].split(",")).pop();for(var o=0;o<i.length;o++)i[o]=i[o].replace(/'/g,"");n=parseIntArray(n[1].split(",")),controller.stations={snames:i,masop:n,maxlen:i.length},t()})):sendToOS("/jn?pw=","json").done((function(e){controller.stations=e,t()}))}function updateControllerOptions(t){return t=t||function(){},!0===curr183?sendToOS("/vo").done((function(e){var i,n,o,s={};if(e.match(/var sd\s*=/)){for(var a=/(tz|htp|htp2|nbrd|seq|sdt|mas|mton|mtoff|urs|rst|wl|ipas)\s?[=|:]\s?([\w|\d|.\"]+)/gm;null!==(i=a.exec(e));)s[i[1].replace("nbrd","ext").replace("mtoff","mtof")]=+i[2];s.ext--,s.fwv="1.8.3-ospi"}else{var r=[1,2,12,13,14,15,16,17,18,19,20,21,22,23,25,26];for(i=(i=/var opts=\[(.*)\];/.exec(e))[1].replace(/"/g,"").split(","),n=0;n<i.length-1;n+=4)o=+i[n+3],-1!==$.inArray(o,r)&&(s[keyIndex[o]]=+i[n+2]);s.fwv=183}controller.options=s,t()})):sendToOS("/jo?pw=","json").done((function(e){controller.options=e,t()}))}function updateControllerStatus(t){return t=t||function(){},!0===curr183?sendToOS("/sn0").then((function(e){var i=e.toString().match(/\d+/);i=parseIntArray(i[0].split("")),controller.status=i,t()}),(function(){controller.status=[]})):sendToOS("/js?pw=","json").then((function(e){controller.status=e.sn,t()}),(function(){controller.status=[]}))}function updateControllerSettings(t){return t=t||function(){},!0===curr183?sendToOS("").then((function(t){var e,i,n=/(ver|devt|nbrd|tz|en|rd|rs|mm|rdst|urs)\s?[=|:]\s?([\w|\d|.\"]+)/gm,o=t.match(/loc\s?[=|:]\s?[\"|'](.*)[\"|']/),s=t.match(/lrun=\[(.*)\]/),a=t.match(/ps=\[(.*)\];/),r={};for(i=(a=a[1].split("],[")).length-1;i>=0;i--)a[i]=parseIntArray(a[i].replace(/\[|\]/g,"").split(","));for(;null!==(e=n.exec(t));)r[e[1]]=+e[2];r.loc=o[1],r.ps=a,r.lrun=parseIntArray(s[1].split(",")),controller.settings=r}),(function(){if(controller.settings&&controller.stations){var t,e=[];for(t=0;t<controller.stations.maxlen;t++)e.push([0,0]);controller.settings.ps=e}})):sendToOS("/jc?pw=").then((function(e){if("object"!=typeof e)try{e=JSON.parse(e)}catch(t){var i=/,"wto":\{.*?\}/,n=e.match(i);e=e.replace(i,"");try{e=JSON.parse(e),handleCorruptedWeatherOptions(n)}catch(t){return!1}}if(void 0===e.lrun&&(e.lrun=[0,0,0,0]),e.loc.match(regex.gps)){var o=e.loc.split(",");currentCoordinates=[parseFloat(o[0]),parseFloat(o[1])]}controller.settings=e,t()}),(function(){if(controller.settings&&controller.stations){var t,e=[];for(t=0;t<controller.stations.maxlen;t++)e.push([0,0]);controller.settings.ps=e}}))}function updateControllerStationSpecial(t){return t=t||function(){},sendToOS("/je?pw=","json").then((function(e){controller.special=e,t()}),(function(){controller.special={}}))}function checkConfigured(t){storage.get(["sites","current_site","cloudToken"],(function(e){var i,n=e.sites,o=e.current_site;if(n=parseSites(n),(i=Object.keys(n)).length){if(null===o||!(o in n))return $.mobile.loading("hide"),void changePage("#site-control",{transition:t?"none":void 0});updateSiteList(i,o),currToken=n[o].os_token,currIp=n[o].os_ip,currPass=n[o].os_pw,currPrefix=void 0!==n[o].ssl&&"1"===n[o].ssl?"https://":"http://",void 0!==n[o].auth_user&&void 0!==n[o].auth_pw?(currAuth=!0,currAuthUser=n[o].auth_user,currAuthPass=n[o].auth_pw):currAuth=!1,curr183=!!n[o].is183,newLoad()}else t&&(void 0===e.cloudToken||null===e.cloudToken?changePage("#start",{transition:"none"}):changePage("#site-control",{transition:"none"}))}))}function fixPasswordHash(t){storage.get(["sites"],(function(e){var i=parseSites(e.sites);if(!isMD5(currPass)){var n=md5(currPass);sendToOS("/sp?pw=&npw="+encodeURIComponent(n)+"&cpw="+encodeURIComponent(n),"json").done((function(e){var o=e.result;if(!o||o>1)return!1;i[t].os_pw=currPass=n,storage.set({sites:JSON.stringify(i)},cloudSaveSites)}))}}))}function submitNewUser(t,e){document.activeElement.blur(),$.mobile.loading("show");var i,n=$(".connection-type input[type='radio']:checked").val(),o=$.mobile.path.parseUrl($("#os_ip").val()).hrefNoHash.replace(/https?:\/\//,""),s="token"===n?$("#os_token").val():null,a=function(i,n){var a;if($.mobile.loading("hide"),("string"==typeof i&&i.match(/var (en|sd)\s*=/)||"number"==typeof i.fwv&&203===i.fwv)&&(a=!0),void 0!==i.fwv||!0===a){var r=$("#os_name").val(),l=$("#os_pw").val(),c=$("#save_pw").is(":checked");""===r&&(r="Site "+(Object.keys(n).length+1)),n[r]={},n[r].os_token=currToken=s,n[r].os_ip=currIp=o,"number"==typeof i.fwv&&i.fwv>=213&&"number"==typeof i.wl&&(l=md5(l)),n[r].os_pw=c?l:"",currPass=l,t?(n[r].ssl="1",currPrefix="https://"):currPrefix="http://",e?(n[r].auth_user=$("#os_auth_user").val(),n[r].auth_pw=$("#os_auth_pw").val(),currAuth=!0,currAuthUser=n[r].auth_user,currAuthPass=n[r].auth_pw):currAuth=!1,!0===a&&(n[r].is183="1",curr183=!0),$("#os_name,#os_ip,#os_pw,#os_auth_user,#os_auth_pw,#os_token").val(""),storage.set({sites:JSON.stringify(n),current_site:r},(function(){cloudSaveSites(),updateSiteList(Object.keys(n),r),newLoad()}))}else showerror(_("Check IP/Port and try again."))},r=function(i){e||401!==i.status?t?($.mobile.loading("hide"),showerror(_("Check IP/Port and try again."))):submitNewUser(!0):l()},l=function(){$("#addnew-auth").length?submitNewUser(t,!0):d()},c=function(){return btoa($("#os_auth_user").val()+":"+$("#os_auth_pw").val())},d=function(){$.mobile.loading("hide");var e=$("<div class='ui-content' id='addnew-auth'><form method='post' novalidate><p class='center smaller'>"+_("Authorization Required")+"</p><label for='os_auth_user'>"+_("Username:")+"</label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' name='os_auth_user' id='os_auth_user'><label for='os_auth_pw'>"+_("Password:")+"</label><input type='password' name='os_auth_pw' id='os_auth_pw'><input type='submit' value='"+_("Submit")+"'></form></div>").enhanceWithin();e.on("submit","form",(function(){return submitNewUser(t,!0),!1})),$("#addnew-content").hide(),$("#addnew").append(e).popup("reposition",{positionTo:"window"})};if(o||s)if(s&&32!==s.length)showerror(_("OpenThings Token must be 32 characters long."));else if(!0!==e&&$("#os_useauth").is(":checked"))l();else{!0===$("#os_usessl").is(":checked")&&(t=!0),i=t?"https://":"http://",e&&($("#addnew-auth").hide(),$("#addnew-content").show(),$("#addnew").popup("reposition",{positionTo:"window"}));var u="/jo?pw="+md5($("#os_pw").val()),h=s?"https://cloud.openthings.io/forward/v1/"+s+u:i+o+u;$.ajax({url:h,type:"GET",dataType:"json",timeout:1e4,global:!1,beforeSend:function(t){!s&&e&&t.setRequestHeader("Authorization","Basic "+c())},error:function(t){e||401!==t.status?$.ajax({url:s?"https://cloud.openthings.io/forward/v1/"+s:i+o,type:"GET",dataType:"text",timeout:1e4,global:!1,cache:!0,beforeSend:function(t){!s&&e&&t.setRequestHeader("Authorization","Basic "+c())},success:function(t){storage.get("sites",(function(e){var i=parseSites(e.sites);a(t,i)}))},error:r}):l()},success:function(t){storage.get("sites",(function(e){var i=parseSites(e.sites);a(t,i)}))}})}else showerror(_("An IP address or token is required to continue."))}function parseSites(t){return null==t?{}:JSON.parse(t)}function showSiteSelect(t){$("#site-select").popup("destroy").remove();var e=$("<div data-role='popup' id='site-select' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+_("Select Site")+"</h1></div><div class='ui-content'><ul data-role='none' class='ui-listview ui-corner-all ui-shadow'></ul></div></div>");t&&e.find("ul").html(t),e.one("popupafterclose",(function(){$(this).popup("destroy").remove()})).popup({history:!1,positionTo:"window"}).enhanceWithin().popup("open")}function showAddNew(t,e){$("#addnew").popup("destroy").remove();var i=!!t,n=$("<div data-role='popup' id='addnew' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+_("New Device")+"</h1></div><div class='ui-content' id='addnew-content'><form method='post' novalidate>"+(i?"":"<p class='center smaller'>"+_("Note: The name is used to identify the OpenSprinkler within the app. OpenSprinkler IP can be either an IP or hostname. You can also specify a port by using IP:Port")+"</p>")+"<label for='os_name'>"+_("Open Sprinkler Name:")+"</label><input autocorrect='off' spellcheck='false' type='text' name='os_name' id='os_name' placeholder='Home'>"+(i?"":"<div class='ui-field-contain'><fieldset data-role='controlgroup' class='ui-mini center connection-type' data-type='horizontal'><legend class='left'>"+_("Connection Type")+":</legend><input class='noselect' type='radio' name='connectionType' id='type-direct' value='ip' checked='checked'><label for='type-direct'>"+_("Direct")+"</label><input class='noselect' type='radio' name='connectionType' id='type-token' value='token'><label for='type-token'>"+_("OpenThings Cloud")+"</label></fieldset></div><label class='ip-field' for='os_ip'>"+_("Open Sprinkler IP:")+"</label>")+"<input data-wrapper-class='ip-field' "+(i?"data-role='none' style='display:none' ":"")+"autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='url' pattern='' name='os_ip' id='os_ip' value='"+(i?t:"")+"' placeholder='home.dyndns.org'><label class='token-field' for='os_token' style='display: none'>"+_("OpenThings Token")+":</label><input data-wrapper-class='token-field hidden' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' pattern='' name='os_token' id='os_token' value='' placeholder='"+_("OpenThings Token")+"'><label for='os_pw'>"+_("Open Sprinkler Password:")+"</label><input type='password' name='os_pw' id='os_pw' value=''><label for='save_pw'>"+_("Save Password")+"</label><input type='checkbox' data-wrapper-class='save_pw' name='save_pw' id='save_pw' data-mini='true' checked='checked'>"+(i?"":"<div data-theme='a' data-mini='true' data-role='collapsible' class='advanced-options'><h4>"+_("Advanced")+"</h4><fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' class='center'><input type='checkbox' name='os_usessl' id='os_usessl'><label for='os_usessl'>"+_("Use SSL")+"</label><input type='checkbox' name='os_useauth' id='os_useauth'><label for='os_useauth'>"+_("Use Auth")+"</label></fieldset></div>")+"<input type='submit' data-theme='b' value='"+_("Submit")+"'></form></div></div>");return n.find("form").on("submit",(function(){return submitNewUser(),!1})),n.one("popupafterclose",(function(){$(this).popup("destroy").remove()})).popup({history:!1,positionTo:"window"}).enhanceWithin(),e?$(".ui-popup-active").children().first().one("popupafterclose",(function(){n.popup("open")})).popup("close"):n.popup("open"),fixInputClick(n),n.find(".ui-collapsible-heading-toggle").on("click",(function(){var t=$(this).parents(".ui-collapsible").hasClass("ui-collapsible-collapsed"),e=$(".ui-page-active"),i=parseInt(e.css("min-height"));t?e.css("min-height",i+65+"px"):e.css("min-height",i-65+"px"),n.popup("reposition",{positionTo:"window"})})),n.find(".connection-type input[type='radio']").on("change",(function(){var t="token"===this.value?"ip":"token";n.find("."+t+"-field").hide(),n.find("."+this.value+"-field").removeClass("hidden").show(),n.find(".advanced-options").toggle("ip"===this.value)})),!1}$(document).one("deviceready",(function(){window.cordova&&window.cordova.InAppBrowser&&(window.open=window.cordova.InAppBrowser.open);try{StatusBar.overlaysWebView(!1),StatusBar.styleLightContent(),StatusBar.backgroundColorByHexString(statusBarPrimary),$.mobile.window.on("statusTap",(function(){$("body, html").animate({scrollTop:0},700)}))}catch(t){}setTimeout((function(){try{navigator.splashscreen.hide()}catch(t){}}),500),$.mobile.document.on("backbutton",(function(){return isIEMobile&&$.mobile.document.data("iabOpen")||checkChangesBeforeBack(),!1})),updateDeviceIP(),isiOS&&ThreeDeeTouch.isAvailable((function(t){t&&(ThreeDeeTouch.enableLinkPreview(),ThreeDeeTouch.configureQuickActions([{type:"sites",title:_("Manage Sites"),iconType:"Location"},{type:"addprogram",title:_("Add Program"),iconType:"Add"},{type:"stopall",title:_("Stop All Stations"),iconType:"Pause"}]),ThreeDeeTouch.onHomeIconPressed=function(t){"sites"===t.type?changePage("#site-control"):"addprogram"===t.type?changePage("#addprogram"):"stopall"===t.type&&stopAllStations()})}))})).one("mobileinit",(function(){(isChromeApp||"file:"===window.location.protocol)&&($.mobile.hashListeningEnabled=!1),$.support.cors=!0,$.mobile.allowCrossDomainPages=!0,loadLocalSettings()})).on("pagebeforechange",(function(t,e){var i,n=e.toPage,o=$(".ui-page-active");"string"==typeof e.toPage&&(i=$.mobile.path.parseUrl(n).hash,o.length>0&&i==="#"+o.attr("id")||("popup"===e.options.role||$(".ui-popup-active").length||$.mobile.silentScroll(0),"#programs"===i?getPrograms(e.options.programToExpand):"#addprogram"===i?addProgram(e.options.copyID):"#manual"===i?getManual():"#about"===i?showAbout():"#runonce"===i?getRunonce():"#os-options"===i?showOptions(e.options.expandItem):"#analogsensorconfig"===i?showAnalogSensorConfig():"#analogsensorchart"===i?showAnalogSensorCharts():"#preview"===i?getPreview():"#logs"===i?getLogs():"#forecast"===i?showForecast():"#loadingPage"===i?checkConfigured(!0):"#start"===i?showStart():"#site-control"===i?showSites():"#sprinklers"===i&&(0===$(i).length?showHome(e.options.firstLoad):$(i).one("pageshow",(function(){refreshStatus()})))))})).on("resume",(function(){void 0!==currIp&&(cloudSync(),showLoading("#weather,#footer-running"),updateController(updateWeather,networkFail))})).on("pause",(function(){})).on("pagebeforeshow",(function(t){var e="#"+t.target.id;"#start"===e||"#loadingPage"===e?$("#header,#footer,#footer-menu").hide():$("#header,#footer,#footer-menu").show(),storage.get("showDisabled",(function(t){t.showDisabled&&"true"===t.showDisabled?$(e).addClass("show-hidden").find(".station-hidden").show():$(e).removeClass("show-hidden").find(".station-hidden").hide()}))})).on("pageshow",(function(t){var e="#"+t.target.id,i=$(e);if(goingBack?goingBack=!1:pageHistoryCount++,fixInputClick(i),isControllerConnected()&&"#site-control"!==e&&"#start"!==e&&"#loadingPage"!==e){var n,o=setInterval((function(){refreshStatus()}),5e3);checkOSVersion(216)||(n=setInterval(refreshData,2e4)),i.one("pagehide",(function(){clearInterval(o),clearInterval(n)}))}})).on("popupafteropen",(function(){if($(".ui-overlay-b:not(.ui-screen-hidden)").length)try{StatusBar.backgroundColorByHexString(statusBarOverlay)}catch(t){}})).on("popupafterclose",(function(){$(".ui-page-active").children().add("#sprinklers-settings").removeClass("blur-filter");try{StatusBar.backgroundColorByHexString(statusBarPrimary)}catch(t){}})).on("popupbeforeposition",(function(){$(".ui-page-active").children().add("#sprinklers-settings").addClass("blur-filter")})).on("popupbeforeposition","#localization",checkCurrLang).one("pagebeforeshow","#loadingPage",initApp);var showSites=function(){var t,e,i,n=$("<div data-role='page' id='site-control'><div class='ui-content'></div></div>"),o=function(){var t=function(){e.eq(0).hide(),$("#header").show(),$("#footer, #footer-menu").hide()};n.hasClass("ui-page-active")?t():n.one("pagebeforeshow",(function(e){e.stopImmediatePropagation(),t()})),n.on("swiperight swipeleft",(function(t){t.stopImmediatePropagation()})),document.title="OpenSprinkler"},s=$("<div data-role='popup' id='addsite' data-theme='b'><ul data-role='listview'><li data-icon='false'><a href='#' id='site-add-scan'>"+_("Scan For Device")+"</a></li><li data-icon='false'><a href='#' id='site-add-manual'>"+_("Manually Add Device")+"</a></li></ul></div>");function a(){storage.get(["sites","current_site","cloudToken"],(function(e){if(t=parseSites(e.sites),$.isEmptyObject(t)){if("string"!=typeof e.cloudToken)return void changePage("#start");o(),n.find(".ui-content").html("<p class='center'>"+_("Please add a site by tapping the 'Add' button in the top right corner.")+"</p>")}else{var s="<div data-role='collapsible-set'>",r=[],l=0;i=Object.keys(t).length,isControllerConnected()&&i&&e.current_site in t||o(),t=sortObj(t),$.each(t,(function(t,e){r.push(t),t=htmlEscape(t),s+="<fieldset "+(1===i?"data-collapsed='false'":"")+" id='site-"+l+"' data-role='collapsible'><h3><a class='ui-btn ui-btn-corner-all connectnow yellow' data-site='"+l+"' href='#'>"+_("connect")+"</a>"+t+"</h3><form data-site='"+l+"' novalidate><div class='ui-field-contain'><label for='cnm-"+l+"'>"+_("Change Name")+"</label><input id='cnm-"+l+"' type='text' value='"+t+"'></div>"+(e.os_token?"":"<div class='ui-field-contain'><label for='cip-"+l+"'>"+_("Change IP")+"</label><input id='cip-"+l+"' type='url' value='"+e.os_ip+"' autocomplete='off' autocorrect='off' autocapitalize='off' pattern='' spellcheck='false'></div>")+(e.os_token?"<div class='ui-field-contain'><label for='ctoken-"+l+"'>"+_("Change Token")+"</label><input id='ctoken-"+l+"' type='text' value='"+e.os_token+"' autocomplete='off' autocorrect='off' autocapitalize='off' pattern='' spellcheck='false'></div>":"")+"<div class='ui-field-contain'><label for='cpw-"+l+"'>"+_("Change Password")+"</label><input id='cpw-"+l+"' type='password'></div>"+(e.os_token?"":"<fieldset data-mini='true' data-role='collapsible'><h3><span style='line-height:23px'>"+_("Advanced")+"</span><button data-helptext='"+_("These options are only for an OpenSprinkler behind a proxy capable of SSL and/or Basic Authentication.")+"' class='collapsible-button-right help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></h3><label for='usessl-"+l+"'><input data-mini='true' type='checkbox' id='usessl-"+l+"' name='usessl-"+l+"'"+(void 0!==e.ssl&&"1"===e.ssl?" checked='checked'":"")+">"+_("Use SSL")+"</label><label for='useauth-"+l+"'><input class='useauth' data-user='"+e.auth_user+"' data-pw='"+e.auth_pw+"' data-mini='true' type='checkbox' id='useauth-"+l+"' name='useauth-"+l+"'"+(void 0!==e.auth_user&&void 0!==e.auth_pw?" checked='checked'":"")+">"+_("Use Auth")+"</label></fieldset>")+"<input class='submit' type='submit' value='"+_("Save Changes to")+" "+t+"'><a data-role='button' class='deletesite' data-site='"+l+"' href='#' data-theme='b'>"+_("Delete")+" "+t+"</a></form></fieldset>",testSite(e,l,(function(t,e){n.find("#site-"+t+" .connectnow").removeClass("yellow").addClass(e?"green":"red")})),l++})),(s=$(s+"</div>")).find("form").one("change input",(function(){$(this).find(".submit").addClass("hasChanges")})),s.find(".connectnow").on("click",(function(){return updateSite(r[$(this).data("site")]),!1})),s.find(".help-icon").on("click",showHelpText),s.find(".useauth").on("change",(function(){var t=$(this);if(t.is(":checked")){var e=$("<div data-role='popup' data-theme='a'><form method='post' class='ui-content' novalidate><label for='auth_user'>"+_("Username:")+"</label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' name='auth_user' id='auth_user'><label for='auth_pw'>"+_("Password:")+"</label><input type='password' name='auth_pw' id='auth_pw'><input type='submit' class='submit' value='"+_("Submit")+"'></form></div>").enhanceWithin(),i=!1;e.find(".submit").on("click",(function(){return t.data({user:e.find("#auth_user").val(),pw:e.find("#auth_pw").val()}),i=!0,e.popup("close"),!1})),e.one("popupafterclose",(function(){i||t.attr("checked",!1).checkboxradio("refresh")})),openPopup(e)}else t.data({user:"",pw:""})})),s.find("form").on("submit",(function(){var i=$(this),n=i.data("site"),o=r[n],l=s.find("#cip-"+n).val(),c=s.find("#cpw-"+n).val(),d=s.find("#cnm-"+n).val(),u=s.find("#useauth-"+n).is(":checked"),h=s.find("#usessl-"+n).is(":checked")?"1":void 0,p=s.find("#useauth-"+n).data("user"),f=s.find("#useauth-"+n).data("pw"),m=""!==l&&l!==t[o].os_ip||h!==t[o].ssl||p!==t[o].auth_user||f!==t[o].auth_pw,g=o===e.current_site,v=""!==d&&d!==o;return i.find(".submit").removeClass("hasChanges"),u?(t[o].auth_user=p,t[o].auth_pw=f):(delete t[o].auth_user,delete t[o].auth_pw),"1"===h?t[o].ssl=h:delete t[o].ssl,""!==l&&l!==t[o].os_ip&&(t[o].os_ip=l),""!==c&&c!==t[o].os_pw&&(isMD5(t[o].os_pw)&&(c=md5(c)),t[o].os_pw=c),v&&(t[d]=t[o],delete t[o],o=d,g&&(storage.set({current_site:o}),e.current_site=o),updateSiteList(Object.keys(t),e.current_site)),storage.set({sites:JSON.stringify(t)},cloudSaveSites),showerror(_("Site updated successfully")),o===e.current_site&&(""!==c&&(currPass=c),m&&checkConfigured()),v&&!i.find(".submit").hasClass("preventUpdate")&&a(),!1})),s.find(".deletesite").on("click",(function(){var i=r[$(this).data("site")];return areYouSure(_("Are you sure you want to delete ")+i+"?","",(function(){$("#site-selector").val()===i&&o(),delete t[i],storage.set({sites:JSON.stringify(t)},(function(){return cloudSaveSites(),updateSiteList(Object.keys(t),e.current_site),$.isEmptyObject(t)?storage.get("cloudToken",(function(){if(null===e.cloudToken||void 0===e.cloudToken)return currIp="",currPass="",void changePage("#start")})):(a(),showerror(_("Site deleted successfully"))),!1}))})),!1})),n.find(".ui-content").html(s.enhanceWithin())}"string"==typeof e.cloudToken&&n.find(".ui-content").prepend(addSyncStatus(e.cloudToken))}))}return s.find("#site-add-scan").on("click",(function(){return s.popup("close"),startScan(),!1})),s.find("#site-add-manual").on("click",(function(){return showAddNew(!1,!0),!1})),n.on("pagehide",(function(){s.popup("destroy").detach(),n.detach()})),$("html").on("siterefresh",(function(){n.hasClass("ui-page-active")&&a()})),function(){e=changeHeader({title:_("Manage Sites"),animate:!!isControllerConnected(),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:function(){n.find(".hasChanges").addClass("preventUpdate"),checkChangesBeforeBack()}},rightBtn:{icon:"plus",text:_("Add"),on:function(){void 0===deviceip?showAddNew():s.popup("open").popup("reposition",{positionTo:e.eq(2)})}}}),a(),$.mobile.pageContainer.append(s),s.popup({history:!1,positionTo:e.eq(2)}).enhanceWithin(),$("#site-control").remove(),$.mobile.pageContainer.append(n)}}();function addSyncStatus(t){var e=$("<div class='ui-bar smaller ui-bar-a ui-corner-all logged-in-alert'><div class='inline ui-btn ui-icon-recycle btn-no-border ui-btn-icon-notext ui-mini'></div><div class='inline syncStatus'>"+_("Synced with OpenSprinkler.com")+" ("+getTokenUser(t)+")</div><div class='inline ui-btn ui-icon-delete btn-no-border ui-btn-icon-notext ui-mini logout'></div></div>");return e.find(".logout").on("click",logout),e.find(".ui-icon-recycle").on("click",(function(){var t=$(this);t.addClass("spin"),cloudSync((function(){t.removeClass("spin")}))})),e}function testSite(t,e,i){var n="/jo?pw="+encodeURIComponent(t.os_pw),o=t.os_token?"https://cloud.openthings.io/forward/v1/"+t.os_token+n:("1"===t.ssl?"https://":"http://")+t.os_ip+n;$.ajax({url:o,type:"GET",dataType:"json",beforeSend:function(e){void 0!==t.auth_user&&void 0!==t.auth_pw&&e.setRequestHeader("Authorization","Basic "+btoa(t.auth_user+":"+t.auth_pw))}}).then((function(){i(e,!0)}),(function(){i(e,!1)}))}function updateSiteList(t,e){var i="",n=$("#site-selector");$.each(t,(function(){i+="<option "+(this.toString()===e?"selected ":"")+"value='"+htmlEscape(this)+"'>"+this+"</option>"})),$("#info-list").find("li[data-role='list-divider']").text(e),n.html(i),n.parent().parent().hasClass("ui-select")&&n.selectmenu("refresh")}function updateSite(t){storage.get("sites",(function(e){var i=parseSites(e.sites);t in i&&closePanel((function(){storage.set({current_site:t},checkConfigured)}))}))}function findLocalSiteName(t,e){for(var i in t)if(t.hasOwnProperty(i)&&-1!==currIp.indexOf(t[i].os_ip))return void e(i);e(!1)}function updateDeviceIP(t){var e,i=function(e){deviceip=e,"function"==typeof t&&t(e)};if(isChromeApp)chrome.system.network.getNetworkInterfaces((function(t){var n;for(n in t)t.hasOwnProperty(n)&&/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(t[n].address)&&(e=t[n].address);i(e)}));else try{networkinterface.getWiFiIPAddress((function(t){e=t.ip,i(e)}))}catch(t){findRouter((function(t,e){i(t?e:void 0)}))}}function isLocalIP(t){var e=parseIntArray(t.split("."));return 10===e[0]||127===e[0]||172===e[0]&&e[1]>17&&e[1]<32||192===e[0]&&168===e[1]}function startScan(t,e){var i,n,o,s,a,r,l,c,d,u=deviceip.split("."),h=1,p=0,f="",m="",g=[],v=!1;for(e=e||0,t="number"==typeof t?t:80,storage.get("sites",(function(t){var e,i=parseSites(t.sites);for(e in i)i.hasOwnProperty(e)&&g.push(i[e].os_ip)})),o=function(){h++},s=function(t){h++;var e,i,n=$.mobile.path.parseUrl(this.url).authority;if(-1===$.inArray(n,g)){if("text"===this.dataType){if(!(i=t.match(/var\s*ver=(\d+)/)))return;e=i[1]}else{if(!t.hasOwnProperty("fwv"))return;e=t.fwv}p++,f+="<li><a class='ui-btn ui-btn-icon-right ui-icon-carat-r' href='#' data-ip='"+n+"'>"+n+"<p>"+_("Firmware")+": "+getOSVersion(e)+"</p></a></li>"}},r=function(){if(!0===v)return $.mobile.loading("hide"),clearInterval(l),!1;245===h&&($.mobile.loading("hide"),clearInterval(l),p?((f=$(f)).find("a").on("click",(function(){return addFound($(this).data("ip")),!1})),showSiteSelect(f)):0===e?startScan(8080,1):1===e?startScan(80,2):2===e?startScan(8080,3):showerror(_("No new devices were detected on your network")))},u.pop(),a=u.join("."),0===e?d=_("Scanning for OpenSprinkler"):1===e?d=_("Scanning for OpenSprinkler Pi"):2===e?d=_("Scanning for OpenSprinkler (1.8.3)"):3===e&&(d=_("Scanning for OpenSprinkler Pi (1.8.3)")),$.mobile.loading("show",{html:"<h1>"+d+"</h1><p class='cancel tight center inline-icon'><span class='btn-no-border ui-btn ui-icon-delete ui-btn-icon-notext'></span>"+_("Cancel")+"</p>",textVisible:!0,theme:"b"}),$(".ui-loader").find(".cancel").one("click",(function(){v=!0})),i=1;i<=244;i++)e<2?(m="/jo",c="json"):c="text",n="http://"+(u=a+"."+i)+(t&&80!==t?":"+t:"")+m,$.ajax({url:n,type:"GET",dataType:c,timeout:6e3,global:!1,error:o,success:s});l=setInterval(r,200)}function findRouter(t){t=t||function(){};var e,i,n,o=["192.168.1.1","10.0.1.1","192.168.1.220","192.168.2.1","10.1.1.1","192.168.11.1","192.168.0.1","192.168.0.30","192.168.0.50","192.168.10.1","192.168.20.1","192.168.30.1","192.168.62.1","192.168.102.1","192.168.1.254","192.168.0.227","10.0.0.138","192.168.123.254","192.168.4.1","10.0.0.2","10.0.2.1","10.0.3.1","10.0.4.1","10.0.5.1"],s=o.length,a=0,r=function(t,e){a++,!0===t&&(i=e)};for(n=0;n<s;n++)"string"!=typeof i&&ping(o[n],r);e=setInterval((function(){a!==s&&"string"!=typeof i||(clearInterval(e),"string"==typeof i?t(!0,i):t(!1))}),50)}function ping(t,e){e=e||function(){},t&&""!==t||e(!1),$.ajax({url:"http://"+t,type:"GET",timeout:6e3,global:!1}).then((function(){e(!0,t)}),(function(i){"timeout"===i.statusText?e(!1):e(!0,t)}))}function addFound(t){$("#site-select").one("popupafterclose",(function(){showAddNew(t)})).popup("close")}function showZimmermanAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var i=$.extend({},{h:100,t:100,r:100,bh:30,bt:70,br:0},unescapeJSON(t.value)),n=checkOSVersion(2162);isMetric&&(i.bt=Math.round(5*(i.bt-32)/9*10)/10,i.br=Math.round(25.4*i.br*10)/10);var o=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Set the baseline weather conditions for your location. ")+_("The Zimmerman method will adjust the watering duration based on differences from this reference point.")+"</p><div class='ui-grid-b'><div class='ui-block-a'><label class='center'>"+_("Temp")+(isMetric?" &#176;C":" &#176;F")+"</label><input data-wrapper-class='pad_buttons' class='bt' type='number' "+(isMetric?"min='-20' max='50'":"min='0' max='120'")+" value='"+i.bt+(n?"'>":"' disabled='disabled'>")+"</div><div class='ui-block-b'><label class='center'>"+_("Rain")+(isMetric?" mm":' "')+"</label><input data-wrapper-class='pad_buttons' class='br' type='number' "+(isMetric?"min='0' max='25' step='0.1'":"min='0' max='1' step='0.01'")+" value='"+i.br+(n?"'>":"' disabled='disabled'>")+"</div><div class='ui-block-c'><label class='center'>"+_("Humidity")+" %</label><input data-wrapper-class='pad_buttons' class='bh' type='number'  min='0' max='100' value='"+i.bh+(n?"'>":"' disabled='disabled'>")+"</div></div><p class='rain-desc center smaller'>"+_("Set the sensitivity of the watering adjustment to changes in each of the above weather conditions.")+"</p><span><fieldset class='ui-grid-b incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div></fieldset><div class='ui-grid-b inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='t' type='number' min='0' max='100' value='"+i.t+"'></div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='r' type='number'  min='0' max='100' value='"+i.r+"'></div><div class='ui-block-c'><input data-wrapper-class='pad_buttons' class='h' type='number'  min='0' max='100' value='"+i.h+"'></div></div><fieldset class='ui-grid-b decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div></fieldset></span><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>"),s=function(t,e){var i=o.find(".inputs input").eq(t),n=parseInt(i.val());-1===e&&0===n||1===e&&100===n||i.val(n+e)};o.find(".submit").on("click",(function(){var i={h:parseInt(o.find(".h").val()),t:parseInt(o.find(".t").val()),r:parseInt(o.find(".r").val())};return n&&($.extend(i,{bh:parseInt(o.find(".bh").val()),bt:parseFloat(o.find(".bt").val()),br:parseFloat(o.find(".br").val())}),isMetric&&(i.bt=Math.round(100*(9*i.bt/5+32))/100,i.br=Math.round(i.br/25.4*1e3)/1e3)),t&&(t.value=escapeJSON(i)),e(),o.popup("close"),!1})),o.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),holdButton(o.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return s(e,1),!1})),holdButton(o.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return s(e,-1),!1})),$("#adjustmentOptions").remove(),o.css("max-width","380px"),openPopup(o,{positionTo:"window"})}function showAutoRainDelayAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var i=$.extend({},{d:24},unescapeJSON(t.value)),n=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("If the weather reports any condition suggesting rain, a rain delay is automatically issued using the below set delay duration.")+"</p><label class='center' for='delay_duration'>"+_("Delay Duration (hours)")+"</label><div class='input_with_buttons'><button class='decr ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input id='delay_duration' type='number' pattern='[0-9]*' value='"+i.d+"'><button class='incr ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>"),o=function(t){var e=n.find("#delay_duration"),i=parseInt(e.val());-1===t&&0===i||1===t&&8760===i||e.val(i+t)};n.find(".submit").on("click",(function(){return i={d:parseInt(n.find("#delay_duration").val())},t&&(t.value=escapeJSON(i)),e(),n.popup("close"),!1})),n.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){(""===this.value||parseInt(this.value)<0)&&(this.value="0")})),holdButton(n.find(".incr"),(function(){return o(1),!1})),holdButton(n.find(".decr"),(function(){return o(-1),!1})),$("#adjustmentOptions").remove(),n.css("max-width","380px"),openPopup(n,{positionTo:"window"})}function showMonthlyAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var i=$.extend({},{scales:[100,100,100,100,100,100,100,100,100,100,100,100]},unescapeJSON(t.value)),n=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Input Monthly Watering Percentage Values")+"</p><div class='ui-grid-c'><div class='ui-block-a'><label class='center'>"+_("Jan")+"</label><input data-wrapper-class='pad_buttons' class='sc0' type='number' min=0 max=250 value="+i.scales[0]+"></div><div class='ui-block-b'><label class='center'>"+_("Feb")+"</label><input data-wrapper-class='pad_buttons' class='sc1' type='number' min=0 max=250 value="+i.scales[1]+"></div><div class='ui-block-c'><label class='center'>"+_("Mar")+"</label><input data-wrapper-class='pad_buttons' class='sc2' type='number' min=0 max=250 value="+i.scales[2]+"></div><div class='ui-block-d'><label class='center'>"+_("Apr")+"</label><input data-wrapper-class='pad_buttons' class='sc3' type='number' min=0 max=250 value="+i.scales[3]+"></div></div><div class='ui-grid-c'><div class='ui-block-a'><label class='center'>"+_("May")+"</label><input data-wrapper-class='pad_buttons' class='sc4' type='number' min=0 max=250 value="+i.scales[4]+"></div><div class='ui-block-b'><label class='center'>"+_("Jun")+"</label><input data-wrapper-class='pad_buttons' class='sc5' type='number' min=0 max=250 value="+i.scales[5]+"></div><div class='ui-block-c'><label class='center'>"+_("Jul")+"</label><input data-wrapper-class='pad_buttons' class='sc6' type='number' min=0 max=250 value="+i.scales[6]+"></div><div class='ui-block-d'><label class='center'>"+_("Aug")+"</label><input data-wrapper-class='pad_buttons' class='sc7' type='number' min=0 max=250 value="+i.scales[7]+"></div></div><div class='ui-grid-c'><div class='ui-block-a'><label class='center'>"+_("Sep")+"</label><input data-wrapper-class='pad_buttons' class='sc8' type='number' min=0 max=250 value="+i.scales[8]+"></div><div class='ui-block-b'><label class='center'>"+_("Oct")+"</label><input data-wrapper-class='pad_buttons' class='sc9' type='number' min=0 max=250 value="+i.scales[9]+"></div><div class='ui-block-c'><label class='center'>"+_("Nov")+"</label><input data-wrapper-class='pad_buttons' class='sc10' type='number' min=0 max=250 value="+i.scales[10]+"></div><div class='ui-block-d'><label class='center'>"+_("Dec")+"</label><input data-wrapper-class='pad_buttons' class='sc11' type='number' min=0 max=250 value="+i.scales[11]+"></div></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");n.find(".submit").on("click",(function(){for(var o=[],s=0;s<12;s++)o[s]=parseInt(n.find(".sc"+s).val()),o[s]<0&&(o[s]=0),o[s]>250&&(o[s]=250);return i={scales:o},t&&(t.value=escapeJSON(i)),e(),n.popup("close"),!1})),n.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){(""===this.value||parseInt(this.value)<0)&&(this.value="0")})),$("#adjustmentOptions").remove(),n.css("max-width","380px"),openPopup(n,{positionTo:"window"})}function validateWULocation(t,e){controller.settings.wto&&"string"==typeof controller.settings.wto.key&&""!==controller.settings.wto.key||e(!1),$.ajax({url:"https://api.weather.com/v2/pws/observations/hourly/7day?stationId="+t+"&format=json&units=e&apiKey="+controller.settings.wto.key,cache:!0}).done((function(t){t&&!t.errors?e(!0):e(!1)})).fail((function(){e(!1)}))}function showEToAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var i=$.extend({},{baseETo:0,elevation:600},unescapeJSON(t.value));isMetric&&(i.baseETo=Math.round(25.4*i.baseETo*100)/100,i.elevation=Math.round(i.elevation/3.28));var n=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Set the baseline potential evapotranspiration (ETo) and elevation for your location. ")+_("The ETo adjustment method will adjust the watering duration based on the difference between the baseline ETo and the current ETo.")+"</p><div class='ui-grid-a'><div class='ui-block-a'><label class='center'>"+_("Baseline ETo")+(isMetric?" (mm":"(in")+"/day)</label><input data-wrapper-class='pad_buttons' class='baseline-ETo' type='number' min='0' "+(isMetric?"max='25' step='0.1'":"max='1' step='0.01'")+" value='"+i.baseETo+"'></div><div class='ui-block-b'><label class='center'>"+_("Elevation")+(isMetric?" (m)":" (ft)")+"</label><input data-wrapper-class='pad_buttons' class='elevation' type='number' step='1'"+(isMetric?"min='-400' max='9000'":"min='-1400' max='30000'")+" value='"+i.elevation+"'></div></div><button class='detect-baseline-eto'>"+_("Detect baseline ETo")+"</button><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");n.find(".submit").on("click",(function(){return i={baseETo:parseFloat(n.find(".baseline-ETo").val()),elevation:parseInt(n.find(".elevation").val())},isMetric&&(i.baseETo=Math.round(i.baseETo/25.4*100)/100,i.elevation=Math.round(3.28*i.elevation)),t&&(t.value=escapeJSON(i)),e(),n.popup("close"),!1})),n.find(".detect-baseline-eto").on("click",(function(){var t=$(".detect-baseline-eto").html();return showLoading(".detect-baseline-eto"),$.ajax({url:WEATHER_SERVER_URL+"/baselineETo?loc="+encodeURIComponent(controller.settings.loc),contentType:"application/json; charset=utf-8",success:function(t){var e=t.eto;isMetric&&(e=Math.round(25.4*e*100)/100),$(".baseline-ETo").val(e),window.alert("Detected baseline ETo for configured location is "+e+(isMetric?"mm":"in")+"/day")},error:function(t,e){var i="Unable to detect baseline ETo: "+(t.status?t.responseText+"("+t.status+")":e);window.alert(i),window.console.error(i)},complete:function(){$(".detect-baseline-eto").html(t)}}),!1})),n.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),$("#adjustmentOptions").remove(),n.css("max-width","380px"),openPopup(n,{positionTo:"window"})}function formatTemp(t){return t=isMetric?Math.round(5/9*(t-32)*10)/10+" &#176;C":Math.round(10*t)/10+" &#176;F"}function formatPrecip(t){return t=isMetric?Math.round(25.4*t*10)/10+" mm":Math.round(100*t)/100+" in"}function formatHumidity(t){return Math.round(t)+" %"}function formatSpeed(t){return t=isMetric?Math.round(1.6*t*10)/10+" km/h":Math.round(10*t)/10+" mph"}function hideWeather(){$("#weather").empty().parents(".info-card").addClass("noweather")}function finishWeatherUpdate(){updateWeatherBox(),$.mobile.document.trigger("weatherUpdateComplete")}function updateWeather(){var t=(new Date).getTime();if(weather&&weather.providedLocation===controller.settings.loc&&t-weather.lastUpdated<36e4)finishWeatherUpdate();else{if(localStorage.weatherData)try{var e=JSON.parse(localStorage.weatherData);if(e.providedLocation===controller.settings.loc&&t-e.lastUpdated<36e4)return weather=e,void finishWeatherUpdate()}catch(t){}weather=void 0,""!==controller.settings.loc?(showLoading("#weather"),$.ajax({url:WEATHER_SERVER_URL+"/weatherData?loc="+encodeURIComponent(controller.settings.loc),contentType:"application/json; charset=utf-8",success:function(t){"object"==typeof t?(currentCoordinates=t.location,weather=t,t.lastUpdated=(new Date).getTime(),t.providedLocation=controller.settings.loc,localStorage.weatherData=JSON.stringify(t),finishWeatherUpdate()):hideWeather()}})):hideWeather()}}function checkURLandUpdateWeather(){var t=function(t){WEATHER_SERVER_URL=t?currPrefix+t:DEFAULT_WEATHER_SERVER_URL,updateWeather()};return controller.settings.wsp?"weather.opensprinkler.com"===controller.settings.wsp?void t():void t(controller.settings.wsp):$.get(currPrefix+currIp+"/su").then((function(e){var i=e.match(/value="([\w|:|/|.]+)" name=wsp/);t(i?i[1]:void 0)}))}function updateWeatherBox(){$("#weather").html((controller.settings.rd?"<div class='rain-delay red'><span class='icon ui-icon-alert'></span>Rain Delay<span class='time'>"+dateToString(new Date(1e3*controller.settings.rdst),void 0,!0)+"</span></div>":"")+"<div title='"+weather.description+"' class='wicon'><img src='https://openweathermap.org/img/w/"+weather.icon+".png'></div><div class='inline tight'>"+formatTemp(weather.temp)+"</div><br><div class='inline location tight'>"+_("Current Weather")+"</div>"+("object"==typeof weather.alert?"<div><button class='tight help-icon btn-no-border ui-btn ui-icon-alert ui-btn-icon-notext ui-corner-all'></button>"+weather.alert.type+"</div>":"")).off("click").on("click",(function(t){var e=$(t.target);return e.hasClass("rain-delay")||e.parents(".rain-delay").length?areYouSure(_("Do you want to turn off rain delay?"),"",(function(){showLoading("#weather"),sendToOS("/cv?pw=&rd=0").done((function(){updateController(updateWeather)}))})):changePage("#forecast"),!1})).parents(".info-card").removeClass("noweather")}function coordsToLocation(t,e,i,n){n=n||t+","+e,$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?latlng="+t+","+e+"&key=AIzaSyDaT_HTZwFojXmvYIhwWudK00vFXzMmOKc&result_type=locality|sublocality|administrative_area_level_1|country",(function(t){if(0!==t.results.length){t=t.results,n=t[0].formatted_address;var e=!1;for(var o in t)if(t.hasOwnProperty(o)&&($.inArray("locality",t[o].types)>-1||$.inArray("sublocality",t[o].types)>-1||$.inArray("postal_code",t[o].types)>-1||$.inArray("street_address",t[o].types)>-1)){e=!0;break}if(!1!==e){t=t[o].address_components;var s="",a="";for(o in e=!1,t)t.hasOwnProperty(o)&&!e&&(""===s&&$.inArray("locality",t[o].types)>-1&&(s=t[o].long_name+", "+s),""===s&&$.inArray("sublocality",t[o].types)>-1&&(s=t[o].long_name+", "+s),$.inArray("administrative_area_level_1",t[o].types)>-1&&(s+=t[o].long_name,e=!0),$.inArray("country",t[o].types)>-1&&(a=t[o].long_name));e||(s+=a),i(s)}else i(n)}else i(n)}))}function getSunTimes(t){t=t||new Date(1e3*controller.settings.devt);var e=SunCalc.getTimes(t,currentCoordinates[0],currentCoordinates[1]),i=e.sunrise,n=e.sunset,o=getTimezoneOffset();return i.setUTCMinutes(i.getUTCMinutes()+o),n.setUTCMinutes(n.getUTCMinutes()+o),[i=60*i.getUTCHours()+i.getUTCMinutes(),n=60*n.getUTCHours()+n.getUTCMinutes()]}function makeAttribution(t){if("string"!=typeof t)return"";var e="<div class='weatherAttribution'>";switch(t){case"DarkSky":case"DS":e+="<a href='https://darksky.net/poweredby/' target='_blank'>"+_("Powered by Dark Sky")+"</a>";break;case"OWM":e+="<a href='https://openweathermap.org/' target='_blank'>"+_("Powered by OpenWeather")+"</a>";break;case"WUnderground":case"WU":e+="<a href='https://wunderground.com/' target='_blank'>"+_("Powered by Weather Underground")+"</a>";break;case"DWD":e+="<a href='https://brightsky.dev/' target='_blank'>"+_("Powered by Deutscher Wetterdienst")+"</a>";break;case"OpenMeteo":case"OM":e+="<a href='https://open-meteo.com/' target='_blank'>"+_("Powered by Open Meteo")+"</a>";break;case"local":e+=_("Powered by your Local PWS");break;case"Manual":e+=_("Using manual watering");break;default:e+=_("Unrecognised weather provider")}return e+"</div>"}function showForecast(){var t=$("<div data-role='page' id='forecast'><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'>"+makeForecast()+"</ul>"+makeAttribution(weather.wp||weather.weatherProvider)+"</div></div>");changeHeader({title:_("Forecast"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack},rightBtn:{icon:"refresh",text:_("Refresh"),on:function(){$.mobile.loading("show"),$.mobile.document.one("weatherUpdateComplete",(function(){$.mobile.loading("hide")})),updateWeather()}}}),t.one("pagehide",(function(){t.remove()})),t.find(".alert").on("click",(function(){openPopup($("<div data-role='popup' data-theme='a'><div data-role='header' data-theme='b'><h1>"+weather.alert.name+"</h1></div><div class='ui-content'><span style='white-space: pre-wrap'>"+$.trim(weather.alert.message)+"</span></div></div>"))})),$("#forecast").remove(),$.mobile.pageContainer.append(t)}function makeForecast(){var t,e,i,n="",o=controller.settings.sunrise?controller.settings.sunrise:getSunTimes()[0],s=controller.settings.sunset?controller.settings.sunset:getSunTimes()[1],a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(n+="<li data-icon='false' class='center'><div>"+_("Now")+"</div><br><div title='"+weather.description+"' class='wicon'><img src='https://openweathermap.org/img/w/"+weather.icon+".png'></div><span>"+formatTemp(weather.temp)+"</span><br><span>"+_("Sunrise")+"</span><span>: "+pad(parseInt(o/60)%24)+":"+pad(o%60)+"</span> <span>"+_("Sunset")+"</span><span>: "+pad(parseInt(s/60)%24)+":"+pad(s%60)+"</span></li>",t=1;t<weather.forecast.length;t++)o=(i=getSunTimes(e=new Date(1e3*weather.forecast[t].date)))[0],s=i[1],n+="<li data-icon='false' class='center'><div>"+e.toLocaleDateString()+"</div><br><div title='"+weather.forecast[t].description+"' class='wicon'><img src='https://openweathermap.org/img/w/"+weather.forecast[t].icon+".png'></div><span>"+_(a[e.getDay()])+"</span><br><span>"+_("Low")+"</span><span>: "+formatTemp(weather.forecast[t].temp_min)+"  </span><span>"+_("High")+"</span><span>: "+formatTemp(weather.forecast[t].temp_max)+"</span><br><span>"+_("Sunrise")+"</span><span>: "+pad(parseInt(o/60)%24)+":"+pad(o%60)+"</span> <span>"+_("Sunset")+"</span><span>: "+pad(parseInt(s/60)%24)+":"+pad(s%60)+"</span></li>";return n}function overlayMap(t){$("#location-list").popup("destroy").remove(),$.mobile.loading("show"),t=t||function(){};var e=$("<div data-role='popup' id='location-list' data-theme='a' style='background-color:rgb(229, 227, 223);'><a href='#' data-rel='back' class='ui-btn ui-corner-all ui-shadow ui-btn-b ui-icon-delete ui-btn-icon-notext ui-btn-right'>"+_("Close")+"</a><iframe style='border:none' src='"+getAppURLPath()+"map.html' width='100%' height='100%' seamless=''></iframe></div>"),i=function(t){t=t||function(t){t&&o.get(0).contentWindow.postMessage({type:"currentLocation",payload:{lat:t.coords.latitude,lon:t.coords.longitude}},"*")};var e,i=function(i){clearTimeout(e),$.mobile.loading("hide"),i||showerror(_("Unable to retrieve your current location")),t(i)};try{e=setTimeout((function(){$.mobile.loading("show",{html:"<div class='logo'></div><h1 style='padding-top:5px'>"+_("Attempting to retrieve your current location")+"</h1></p>",textVisible:!0,theme:"b"})}),100),navigator.geolocation.getCurrentPosition((function(t){clearTimeout(e),i(t)}),(function(){i(!1)}),{timeout:1e4})}catch(t){i(!1)}},n=function(t,e){var i=$("#wtkey").val();""!==i&&$.ajax({url:"https://api.weather.com/v3/location/near?format=json&product=pws&apiKey="+i+"&geocode="+encodeURIComponent(t)+","+encodeURIComponent(e),cache:!0}).done((function(t){var e=[];t.location.stationId.forEach((function(i,n){e.push({id:i,lat:t.location.latitude[n],lon:t.location.longitude[n],message:t.location.stationId[n]})})),e.length>0&&(e=encodeURIComponent(JSON.stringify(e)),o.get(0).contentWindow.postMessage({type:"pwsData",payload:e},"*"))}))},o=e.find("iframe"),s=$("#loc").val(),a={lat:s.match(regex.gps)?s.split(",")[0]:currentCoordinates[0],lon:s.match(regex.gps)?s.split(",")[1]:currentCoordinates[1]},r=!1;$.mobile.window.off("message onmessage").on("message onmessage",(function(o){var s=o.originalEvent.data;if(void 0!==s.WS){var a=s.WS.split(",");t(a.length>1?a:s.WS,s.station),r=!0,e.popup("destroy").remove()}else!0===s.loaded?$.mobile.loading("hide"):"object"==typeof s.location?n(s.location[0],s.location[1]):!0===s.dismissKeyboard?document.activeElement.blur():!0===s.getLocation&&i()})),o.one("load",(function(){0===a.lat&&0===a.lon&&i(),this.contentWindow.postMessage({type:"startLocation",payload:{start:a}},"*")})),e.one("popupafterclose",(function(){!1===r&&t(!1)})),openPopup(e,{beforeposition:function(){e.css({width:window.innerWidth-36,height:window.innerHeight-28})},x:0,y:0}),n(a.lat,a.lon)}var rebootReasons={0:_("None"),1:_("Factory Reset"),2:_("Reset Button"),3:_("WiFi Change"),4:_("Web Request"),5:_("Web Request"),6:_("WiFi Configure"),7:_("Firmware Update"),8:_("Weather Failure"),9:_("Network Failure"),10:_("Clock Update"),99:_("Power On")},weatherErrors={"-4":_("Empty Response"),"-3":_("Timed Out"),"-2":_("Connection Failed"),"-1":_("No Response"),0:_("Success"),1:_("Weather Data Error"),10:_("Building Weather History"),11:_("Weather Provider Response Incomplete"),12:_("Weather Provider Request Failed"),2:_("Location Error"),20:_("Location Request Error"),21:_("Location Not Found"),22:_("Invalid Location Format"),3:_("PWS Error"),30:_("Invalid WUnderground PWS"),31:_("Invalid WUnderground Key"),32:_("WUnderground Authentication Error"),33:_("Unsupported WUnderground Method"),34:_("No WUnderground PWS Provided"),4:_("Adjustment Method Error"),40:_("Unsupported Adjustment Method"),41:_("No Adjustment Method Provided"),5:_("Adjustment Options Error"),50:_("Corrupt Adjustment Options"),51:_("Missing Adjustment Option"),99:_("Unexpected Error")};function getRebootReason(t){return t in rebootReasons?rebootReasons[t]:_("Unrecognised")+" ("+t+")"}function getWeatherError(t){var e=Math.floor(t/10);return t in weatherErrors?weatherErrors[t]:t<=59&&t>=10&&e in weatherErrors?weatherErrors[e]:_("Unrecognised")+" ("+t+")"}function getWeatherStatus(t){return t<0?"<font class='debugWUError'>"+_("Offline")+"</font>":t>0?"<font class='debugWUError'>"+_("Error")+"</font>":"<font class='debugWUOK'>"+_("Online")+"</font>"}function getWiFiRating(t){return _(t<-80?"Unuseable":t<-70?"Poor":t<-60?"Fair":t<-50?"Good":"Excellent")}function debugWU(){var t="<div data-role='popup' id='debugWU' class='ui-content ui-page-theme-a'>";return t+="<div class='debugWUHeading'>System Status</div><table class='debugWUTable'>"+("number"==typeof controller.settings.lupt?"<tr><td>"+_("Last Reboot")+"</td><td>"+(controller.settings.lupt<1e3?"--":dateToString(new Date(1e3*controller.settings.lupt),null,2))+"</td></tr>":"")+("number"==typeof controller.settings.lrbtc?"<tr><td>"+_("Reboot Reason")+"</td><td>"+getRebootReason(controller.settings.lrbtc)+"</td></tr>":"")+("number"==typeof controller.settings.RSSI?"<tr><td>"+_("WiFi Strength")+"</td><td>"+getWiFiRating(controller.settings.RSSI)+"</td></tr>":"")+("number"==typeof controller.settings.wterr?"<tr><td>"+_("Weather Service")+"</td><td>"+getWeatherStatus(controller.settings.wterr)+"</td></tr>":"")+"</table><div class='debugWUHeading'>Watering Level</div><table class='debugWUTable'>"+(void 0!==controller.options.uwt?"<tr><td>"+_("Method")+"</td><td>"+getAdjustmentMethod(controller.options.uwt).name+"</td></tr>":"")+(void 0!==controller.options.wl?"<tr><td>"+_("Watering Level")+"</td><td>"+controller.options.wl+" %</td></tr>":"")+("number"==typeof controller.settings.lswc?"<tr><td>"+_("Last Updated")+"</td><td>"+(0===controller.settings.lswc?_("Never"):humaniseDuration(1e3*controller.settings.devt,1e3*controller.settings.lswc))+"</td></tr>":"")+"</table><div class='debugWUHeading'>Weather Service Details</div><div class='debugWUScrollable'><table class='debugWUTable'>","object"==typeof controller.settings.wtdata&&Object.keys(controller.settings.wtdata).length>0&&(t+=(void 0!==controller.settings.wtdata.h?"<tr><td>"+_("Mean Humidity")+"</td><td>"+formatHumidity(controller.settings.wtdata.h)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.t?"<tr><td>"+_("Mean Temp")+"</td><td>"+formatTemp(controller.settings.wtdata.t)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.p?"<tr><td>"+_("Total Rain")+"</td><td>"+formatPrecip(controller.settings.wtdata.p)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.eto?"<tr><td>"+_("ETo")+"</td><td>"+formatPrecip(controller.settings.wtdata.eto)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.radiation?"<tr><td>"+_("Mean Radiation")+"</td><td>"+controller.settings.wtdata.radiation+" kWh/m2</td></tr>":"")+(void 0!==controller.settings.wtdata.minT?"<tr><td>"+_("Min Temp")+"</td><td>"+formatTemp(controller.settings.wtdata.minT)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.maxT?"<tr><td>"+_("Max Temp")+"</td><td>"+formatTemp(controller.settings.wtdata.maxT)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.minH?"<tr><td>"+_("Min Humidity")+"</td><td>"+formatHumidity(controller.settings.wtdata.minH)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.maxH?"<tr><td>"+_("Max Humidity")+"</td><td>"+formatHumidity(controller.settings.wtdata.maxH)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.wind?"<tr><td>"+_("Mean Wind")+"</td><td>"+formatSpeed(controller.settings.wtdata.wind)+"</td></tr>":"")),t+="number"==typeof controller.settings.lwc?"<tr><td>"+_("Last Request")+"</td><td>"+dateToString(new Date(1e3*controller.settings.lwc),null,2)+"</td></tr>":"",t+="number"==typeof controller.settings.wterr?"<tr><td>"+_("Last Response")+"</td><td>"+getWeatherError(controller.settings.wterr)+"</td></tr>":"",t+="</table></div>","number"==typeof controller.settings.otcs&&(t+="<div class='debugWUHeading'>Integrations</div><table class='debugWUTable'><tr><td>OpenThings Cloud</td><td>"+resolveOTCStatus(controller.settings.otcs)+"</td></tr></table>"),!controller.settings.wtdata||"string"!=typeof controller.settings.wtdata.wp&&"string"!=typeof controller.settings.wtdata.weatherProvider||(t+="<hr>",t+=makeAttribution(controller.settings.wtdata.wp||controller.settings.wtdata.weatherProvider)),t+="</div>",openPopup($(t)),!1}function resolveOTCStatus(t){switch(t){case 0:return"Not Enabled";case 1:return"Connecting...";case 2:return"<font class='debugWUError'>Disconnected</font>";case 3:return"<font class='debugWUOK'>Connected</font>"}}function showRainDelay(){$(".ui-popup-active").find("[data-role='popup']").popup("close"),showDurationBox({title:_("Change Rain Delay"),callback:raindelay,label:_("Duration"),maximum:31536e3,granularity:2,preventCompression:!0,incrementalUpdate:!1,updateOnChange:!1,helptext:_("Enable manual rain delay by entering a value into the input below. To turn off a currently enabled rain delay use a value of 0.")})}function showPause(){StationQueue.isPaused()?areYouSure(_("Do you want to resume program operation?"),"",(function(){sendToOS("/pq?pw=")})):showDurationBox({title:"Pause Station Runs",incrementalUpdate:!1,maximum:65535,callback:function(t){sendToOS("/pq?dur="+t+"&pw=")}})}function getAdjustmentMethod(t){var e=[{name:_("Manual"),id:0},{name:"Zimmerman",id:1},{name:_("Auto Rain Delay"),id:2,minVersion:216},{name:"ETo",id:3,minVersion:216},{name:"Monthly",id:4,minVersion:220}];return void 0===t?e:e[-129&t]}function getCurrentAdjustmentMethodId(){return-129&controller.options.uwt}function getRestriction(t){return[{isCurrent:0,name:_("None")},{isCurrent:!!(controller.options.uwt>>7&1),name:_("California Restriction")}][t]}function setRestriction(t,e){return e=e||-129&controller.options.uwt,1===t&&(e|=128),e}function testAPIKey(t,e){$.ajax({url:"https://api.weather.com/v2/pws/observations/current?stationId=KMAHANOV10&format=json&units=m&apiKey="+t,cache:!0}).done((function(t){t.errors?e(!1):e(!0)})).fail((function(){e(!1)}))}function bindPanel(){var t=$("#sprinklers-settings"),e=function(){return controller&&controller.settings&&controller.settings.en&&1===controller.settings.en?_("Disable"):_("Enable")};t.enhanceWithin().panel().removeClass("hidden").panel("option","classes.modal","needsclick ui-panel-dismiss"),t.find("a[href='#site-control']").on("click",(function(){return changePage("#site-control"),!1})),t.find("a[href='#about']").on("click",(function(){return changePage("#about"),!1})),t.find(".cloud-login").on("click",(function(){return requestCloudAuth(),!1})),t.find("a[href='#debugWU']").on("click",debugWU),t.find("a[href='#localization']").on("click",languageSelect),t.find(".export_config").on("click",(function(){return"object"!=typeof controller.stations.stn_spe||"object"==typeof controller.special||controller.stations.stn_spe.every((function(t){return 0===t}))?getExportMethod():updateControllerStationSpecial(getExportMethod),!1})),t.find(".import_config").on("click",(function(){return storage.get("backup",(function(t){getImportMethod(t.backup)})),!1})),t.find(".toggleOperation").on("click",(function(){var t=$(this),i=1-controller.settings.en;return areYouSure(_("Are you sure you want to")+" "+e().toLowerCase()+" "+_("operation?"),"",(function(){sendToOS("/cv?pw=&en="+i).done((function(){$.when(updateControllerSettings(),updateControllerStatus()).done((function(){checkStatus(),t.find("span:first").html(e()).attr("data-translate",e())}))}))})),!1})).find("span:first").html(e()).attr("data-translate",e()),t.find(".reboot-os").on("click",(function(){return areYouSure(_("Are you sure you want to reboot OpenSprinkler?"),"",(function(){$.mobile.loading("show"),sendToOS("/cv?pw=&rbt=1").done((function(){$.mobile.loading("hide"),showerror(_("OpenSprinkler is rebooting now"))}))})),!1})),t.find(".changePassword > a").on("click",changePassword),t.find("#downgradeui").on("click",(function(){return areYouSure(_("Are you sure you want to downgrade the UI?"),"",(function(){var t="http://rayshobby.net/scripts/java/svc"+getOSVersion();sendToOS("/cu?jsp="+encodeURIComponent(t)+"&pw=").done((function(){storage.remove(["sites","current_site","lang","provider","wapikey","runonce"]),location.reload()}))})),!1})),t.find("#logout").on("click",(function(){return logout(),!1})),openPanel=function(){var t=$("#sprinklers-settings"),e=function(){var e=controller&&controller.settings&&controller.settings.en&&1===controller.settings.en?_("Disable"):_("Enable");t.find(".toggleOperation span:first").html(e).attr("data-translate",e)};return $("html").on("datarefresh",e),function(){var i=$(".ui-page-active").attr("id");"start"!==i&&"loadingPage"!==i&&isControllerConnected()&&1===$(".ui-page-active").length&&(e(),t.panel("open"))}}()}function showOptions(t){var e,i,n,o="",s=$("<div data-role='page' id='os-options'><div class='ui-content' role='main'><div data-role='collapsibleset' id='os-options-list'></div><a class='submit preventBack' style='display:none'></a></div></div>"),a=function(t,e,i){return"<div class='ui-field-contain'><fieldset data-role='controlgroup' class='ui-mini center sensor-options' data-type='horizontal'><legend class='left'>"+_("Sensor")+(i?" "+i+" ":" ")+_("Type")+"</legend><input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-none' value='0'"+(0===e?" checked='checked'":"")+"><label for='o"+t+"-none'>"+_("None")+"</label><input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-rain' value='1'"+(1===e?" checked='checked'":"")+"><label for='o"+t+"-rain'>"+_("Rain")+"</label>"+(52===t?"":"<input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-flow' value='2'"+(2===e?" checked='checked'":"")+"><label for='o"+t+"-flow'>"+_("Flow")+"</label>")+(checkOSVersion(219)?"<input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-soil' value='3'"+(3===e?" checked='checked'":"")+"><label for='o"+t+"-soil'>"+_("Soil")+"</label>":"")+(checkOSVersion(217)?"<input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-program' value='240'"+(240===e?" checked='checked'":"")+"><label for='o"+t+"-program'>"+_("Program Switch")+"</label>":"")+"</fieldset></div>"},r=function(){var t,e={},i=!1,n=isOSPi(),o=l.eq(2);if(o.prop("disabled",!0),s.find(".submit").removeClass("hasChanges"),s.find("#os-options-list").find(":input,button").filter(":not(.noselect)").each((function(){var o,a=$(this),r=a.attr("id"),l=a.val();if(!r||!l&&""!==l)return!0;switch(r){case"o1":var c=l.split(":");c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10),c[1]=(c[1]/15>>0)/4,c[0]=c[0]+(c[0]>=0?c[1]:-c[1]),l=4*(c[0]+12)>>0;break;case"datetime":var d=new Date(1e3*l);return e.tyy=d.getUTCFullYear(),e.tmm=d.getUTCMonth(),e.tdd=d.getUTCDate(),e.thh=d.getUTCHours(),e.tmi=d.getUTCMinutes(),e.ttt=Math.round(d.getTime()/1e3),!0;case"ip_addr":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid IP address is required when DHCP is not used")),i=!0,!1):(e.o4=o[0],e.o5=o[1],e.o6=o[2],e.o7=o[3],!0);case"subnet":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid subnet address is required when DHCP is not used")),i=!0,!1):(e.o58=o[0],e.o59=o[1],e.o60=o[2],e.o61=o[3],!0);case"gateway":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid gateway address is required when DHCP is not used")),i=!0,!1):(e.o8=o[0],e.o9=o[1],e.o10=o[2],e.o11=o[3],!0);case"dns":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid DNS address is required when DHCP is not used")),i=!0,!1):(e.o44=o[0],e.o45=o[1],e.o46=o[2],e.o47=o[3],!0);case"ntp_addr":return o=l.split("."),e.o32=o[0],e.o33=o[1],e.o34=o[2],e.o35=o[3],!0;case"wtkey":return!0;case"wto":if(l=escapeJSON($.extend({},unescapeJSON(l),{key:s.find("#wtkey").val()})),escapeJSON(controller.settings.wto)===l)return!0;break;case"mqtt":if(escapeJSON(controller.settings.mqtt)===l)return!0;break;case"otc":if(escapeJSON(controller.settings.otc)===l)return!0;break;case"isMetric":return isMetric=a.is(":checked"),storage.set({isMetric:isMetric}),!0;case"groupView":return groupView=a.is(":checked"),storage.set({groupView:groupView}),!0;case"o12":return n||(e.o12=255&l,e.o13=l>>8&255),!0;case"o31":if(3===parseInt(l)&&!unescapeJSON($("#wto")[0].value).baseETo)return showerror(_("You must specify a baseline ETo adjustment method option to use the ET adjustment method.")),i=!0,!1;var u=s.find("#weatherRestriction");u.length&&(l=setRestriction(parseInt(u.val()),l));break;case"o18":case"o37":parseInt(l)>8*(parseInt(s.find("#o15").val())+1)&&(l=0);break;case"o41":return"gallon"===s.find("#o41-units").val()&&(l*=3.78541),e.o41=100*l&255,e.o42=100*l>>8&255,!0;case"o2":case"o3":case"o14":case"o16":case"o21":case"o22":case"o25":case"o36":case"o48":case"o50":case"o51":case"o52":case"o53":if(l=a.is(":checked")?1:0,!checkOSVersion(219)&&!l)return!0}n&&("loc"===r||"lg"===r?r="o"+r:(t=/\d+/.exec(r),r="o"+Object.keys(keyIndex).find((function(e){return keyIndex[e]===t})))),!0===checkOSVersion(208)&&"loc"===r&&(l=l.replace(/\s/g,"_")),e[r]=l})),i)return o.prop("disabled",!1),void s.find(".submit").addClass("hasChanges");void 0!==controller.options.fpr0&&(void 0!==controller.options.urs?e.o21=s.find("input[name='o21'][type='radio']:checked").val():(void 0!==controller.options.sn1t&&(e.o50=s.find("input[name='o50'][type='radio']:checked").val()),void 0!==controller.options.sn2t&&(e.o52=s.find("input[name='o52'][type='radio']:checked").val()))),e=transformKeys(e),$.mobile.loading("show"),sendToOS("/co?pw=&"+$.param(e)).done((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Settings have been saved"))})),goBack(),updateController(updateWeather)})).fail((function(){o.prop("disabled",!1),s.find(".submit").addClass("hasChanges")}))},l=changeHeader({title:_("Edit Options"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:checkChangesBeforeBack},rightBtn:{icon:"check",text:_("Submit"),class:"submit",on:r}});if(s.find(".submit").on("click",r),o="<fieldset data-role='collapsible'"+("string"!=typeof t||"system"===t?" data-collapsed='false'":"")+"><legend>"+_("System")+"</legend>",void 0!==controller.options.ntp&&(o+="<div class='ui-field-contain datetime-input'><label for='datetime'>"+_("Device Time")+"</label><button "+(controller.options.ntp?"disabled ":"")+"data-mini='true' id='datetime' value='"+(controller.settings.devt+60*new Date(1e3*controller.settings.devt).getTimezoneOffset())+"'>"+dateToString(new Date(1e3*controller.settings.devt)).slice(0,-3)+"</button></div>"),!isOSPi()&&void 0!==controller.options.tz){for(e=["-12:00","-11:30","-11:00","-10:00","-09:30","-09:00","-08:30","-08:00","-07:00","-06:00","-05:00","-04:30","-04:00","-03:30","-03:00","-02:30","-02:00","+00:00","+01:00","+02:00","+03:00","+03:30","+04:00","+04:30","+05:00","+05:30","+05:45","+06:00","+06:30","+07:00","+08:00","+08:45","+09:00","+09:30","+10:00","+10:30","+11:00","+11:30","+12:00","+12:45","+13:00","+13:45","+14:00"],i=((i=controller.options.tz-48)>=0?"+":"-")+pad(Math.abs(i)/4>>0)+":"+(Math.abs(i)%4*15/10>>0)+Math.abs(i)%4*15%10,o+="<div class='ui-field-contain'><label for='o1' class='select'>"+_("Timezone")+"</label><select "+(checkOSVersion(210)&&"object"==typeof weather?"disabled='disabled' ":"")+"data-mini='true' id='o1'>",n=0;n<e.length;n++)o+="<option "+(e[n]===i?"selected":"")+" value='"+e[n]+"'>"+e[n]+"</option>";o+="</select></div>"}if(o+="<div class='ui-field-contain'><label for='loc'>"+_("Location")+"</label><button data-mini='true' id='loc' value='"+("''"===controller.settings.loc.trim()?_("Not specified"):controller.settings.loc)+"'><span>"+controller.settings.loc+"</span><a class='ui-btn btn-no-border ui-btn-icon-notext ui-icon-delete ui-btn-corner-all clear-loc'></a></button></div>",void 0!==controller.options.lg&&(o+="<label for='o36'><input data-mini='true' id='o36' type='checkbox' "+(1===controller.options.lg?"checked='checked'":"")+">"+_("Enable Logging")+"</label>"),o+="<label for='isMetric'><input data-mini='true' id='isMetric' type='checkbox' "+(isMetric?"checked='checked'":"")+">"+_("Use Metric")+"</label>",Supported.groups()&&(o+="<label for='groupView'><input data-mini='true' id='groupView' type='checkbox' "+(groupView?"checked='checked'":"")+">"+_("Order Stations by Groups")+"</label>"),o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"master"===t?" data-collapsed='false'":"")+"><legend>"+_("Configure Master")+"</legend>",void 0!==controller.options.mas){for(o+="<div class='ui-field-contain ui-field-no-border'><label for='o18' class='select'>"+_("Master Station")+" "+(void 0!==controller.options.mas2?"1":"")+"</label><select data-mini='true' id='o18'><option value='0'>"+_("None")+"</option>",n=0;n<controller.stations.snames.length&&(o+="<option "+(1===Station.isMaster(n)?"selected":"")+" value='"+(n+1)+"'>"+controller.stations.snames[n]+"</option>",checkOSVersion(214)||7!==n);n++);o+="</select></div>",void 0!==controller.options.mton&&(o+="<div "+(0===controller.options.mas?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o19'>"+_("Master On Adjustment")+"</label><button data-mini='true' id='o19' value='"+controller.options.mton+"'>"+controller.options.mton+"s</button></div>"),void 0!==controller.options.mtof&&(o+="<div "+(0===controller.options.mas?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o20'>"+_("Master Off Adjustment")+"</label><button data-mini='true' id='o20' value='"+controller.options.mtof+"'>"+controller.options.mtof+"s</button></div>")}if(void 0!==controller.options.mas2){for(o+="<hr style='width:95%' class='content-divider'>",o+="<div class='ui-field-contain ui-field-no-border'><label for='o37' class='select'>"+_("Master Station")+" 2</label><select data-mini='true' id='o37'><option value='0'>"+_("None")+"</option>",n=0;n<controller.stations.snames.length&&(o+="<option "+(2===Station.isMaster(n)?"selected":"")+" value='"+(n+1)+"'>"+controller.stations.snames[n]+"</option>",checkOSVersion(214)||7!==n);n++);o+="</select></div>",void 0!==controller.options.mton2&&(o+="<div "+(0===controller.options.mas2?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o38'>"+_("Master On Adjustment")+"</label><button data-mini='true' id='o38' value='"+controller.options.mton2+"'>"+controller.options.mton2+"s</button></div>"),void 0!==controller.options.mtof2&&(o+="<div "+(0===controller.options.mas2?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o39'>"+_("Master Off Adjustment")+"</label><button data-mini='true' id='o39' value='"+controller.options.mtof2+"'>"+controller.options.mtof2+"s</button></div>")}if(o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"station"===t?" data-collapsed='false'":"")+"><legend>"+_("Station Handling")+"</legend>",void 0!==controller.options.ext){for(o+="<div class='ui-field-contain'><label for='o15' class='select'>"+_("Number of Stations")+("number"==typeof controller.options.dexp&&controller.options.dexp<255&&controller.options.dexp>=0?" <span class='nobr'>("+(8*controller.options.dexp+8)+" "+_("available")+")</span>":"")+"</label><select data-mini='true' id='o15'>",n=0;n<=(controller.options.mexp||5);n++)o+="<option "+(controller.options.ext===n?"selected":"")+" value='"+n+"'>"+(8*n+8)+" "+_("stations")+"</option>";o+="</select></div>"}if(void 0!==controller.options.sdt&&(o+="<div class='ui-field-contain duration-field'><label for='o17'>"+_("Station Delay")+"</label><button data-mini='true' id='o17' value='"+controller.options.sdt+"'>"+dhms2str(sec2dhms(controller.options.sdt))+"</button></div>"),o+="<label for='showDisabled'><input data-mini='true' class='noselect' id='showDisabled' type='checkbox' "+("true"===localStorage.showDisabled?"checked='checked'":"")+">"+_("Show Disabled")+" "+_("(Changes Auto-Saved)")+"</label>",void 0!==controller.options.seq&&(o+="<label for='o16'><input data-mini='true' id='o16' type='checkbox' "+(1===controller.options.seq?"checked='checked'":"")+">"+_("Sequential")+"</label>"),o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"weather"===t?" data-collapsed='false'":"")+"><legend>"+_("Weather and Sensors")+"</legend>",void 0!==controller.options.uwt){for(o+="<div class='ui-field-contain'><label for='o31' class='select'>"+_("Weather Adjustment Method")+"<button data-helptext='"+_("Weather adjustment uses DarkSky data in conjunction with the selected method to adjust the watering percentage.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><select data-mini='true' id='o31'>",n=0;n<getAdjustmentMethod().length;n++){var c=getAdjustmentMethod()[n];c.minVersion&&!checkOSVersion(c.minVersion)||(o+="<option "+(c.id===getCurrentAdjustmentMethodId()?"selected":"")+" value='"+n+"'>"+c.name+"</option>")}if(o+="</select></div>","object"==typeof controller.settings.wto&&(o+="<div class='ui-field-contain"+(0===getCurrentAdjustmentMethodId()?" hidden":"")+"'><label for='wto'>"+_("Adjustment Method Options")+"</label><button data-mini='true' id='wto' value='"+escapeJSON(controller.settings.wto)+"'>"+_("Tap to Configure")+"</button></div>"),checkOSVersion(214)){for(o+="<div class='ui-field-contain'><label for='weatherRestriction' class='select'>"+_("Weather-Based Restrictions")+"<button data-helptext='"+_("Prevents watering when the selected restriction is met.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><select data-mini='true' class='noselect' id='weatherRestriction'>",n=0;n<2;n++){var d=getRestriction(n);o+="<option "+(!0===d.isCurrent?"selected":"")+" value='"+n+"'>"+d.name+"</option>"}o+="</select></div>"}}if(void 0!==controller.options.wl&&(o+="<div class='ui-field-contain duration-field'><label for='o23'>"+_("% Watering")+"<button data-helptext='"+_("The watering percentage scales station run times by the set value.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button "+(controller.options.uwt&&getCurrentAdjustmentMethodId()>0?"disabled='disabled' ":"")+"data-mini='true' id='o23' value='"+controller.options.wl+"'>"+controller.options.wl+"%</button></div>"),void 0===controller.options.urs&&void 0===controller.options.sn1t||(void 0!==controller.options.fpr0?o+=void 0!==controller.options.urs?a(keyIndex.urs,controller.options.urs):void 0!==controller.options.sn1t?a(keyIndex.sn1t,controller.options.sn1t,1):"":o+="<label for='o21'><input data-mini='true' id='o21' type='checkbox' "+(1===controller.options.urs?"checked='checked'":"")+">"+_("Use Rain Sensor")+"</label>"),void 0!==controller.options.rso&&(o+="<label for='o22'><input "+(1===controller.options.urs||240===controller.options.urs?"":"data-wrapper-class='hidden' ")+"data-mini='true' id='o22' type='checkbox' "+(1===controller.options.rso?"checked='checked'":"")+">"+_("Normally Open")+"</label>"),void 0!==controller.options.sn1o&&(o+="<label for='o51'><input "+(1===controller.options.sn1t||3===controller.options.sn1t||240===controller.options.sn1t?"":"data-wrapper-class='hidden' ")+"data-mini='true' id='o51' type='checkbox' "+(1===controller.options.sn1o?"checked='checked'":"")+">"+_("Normally Open")+"</label>"),void 0!==controller.options.fpr0&&(o+="<div class='ui-field-contain"+(2===controller.options.urs||2===controller.options.sn1t?"":" hidden")+"'><label for='o41'>"+_("Flow Pulse Rate")+"</label><table><tr style='width:100%;vertical-align: top;'><td style='width:100%'><div class='ui-input-text controlgroup-textinput ui-btn ui-body-inherit ui-corner-all ui-mini ui-shadow-inset ui-input-has-clear'><input data-role='none' data-mini='true' type='number' pattern='^[-+]?[0-9]*.?[0-9]*$' id='o41' value='"+(256*controller.options.fpr1+controller.options.fpr0)/100+"'></div></td><td class='tight-select'><select id='o41-units' class='noselect' data-mini='true'><option selected='selected' value='liter'>L/pulse</option><option value='gallon'>Gal/pulse</option></select></td></tr></table></div>"),void 0!==controller.options.sn1on&&(o+="<div class='"+(1===controller.options.sn1t||3===controller.options.sn1t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o54'>"+_("Sensor 1 Delayed On Time")+"</label><button data-mini='true' id='o54' value='"+controller.options.sn1on+"'>"+controller.options.sn1on+"m</button></div>"),void 0!==controller.options.sn1of&&(o+="<div class='"+(1===controller.options.sn1t||3===controller.options.sn1t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o55'>"+_("Sensor 1 Delayed Off Time")+"</label><button data-mini='true' id='o55' value='"+controller.options.sn1of+"'>"+controller.options.sn1of+"m</button></div>"),checkOSVersion(217)&&(o+="<label id='prgswitch' class='center smaller"+(240===controller.options.urs||240===controller.options.sn1t||240===controller.options.sn2t?"":" hidden")+"'>"+_("When using program switch, a switch is connected to the sensor port to trigger Program 1 every time the switch is pressed for at least 1 second.")+"</label>"),void 0!==controller.options.sn2t&&checkOSVersion(219)&&(o+=a(keyIndex.sn2t,controller.options.sn2t,2)),void 0!==controller.options.sn2o&&(o+="<label for='o53'><input "+(1===controller.options.sn2t||3===controller.options.sn2t||240===controller.options.sn2t?"":"data-wrapper-class='hidden' ")+"data-mini='true' id='o53' type='checkbox' "+(1===controller.options.sn2o?"checked='checked'":"")+">"+_("Normally Open")+"</label>"),void 0!==controller.options.sn2on&&(o+="<div class='"+(1===controller.options.sn2t||3===controller.options.sn2t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o56'>"+_("Sensor 2 Delayed On Time")+"</label><button data-mini='true' id='o56' value='"+controller.options.sn2on+"'>"+controller.options.sn2on+"m</button></div>"),void 0!==controller.options.sn2of&&(o+="<div class='"+(1===controller.options.sn2t||3===controller.options.sn2t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o57'>"+_("Sensor 2 Delayed Off Time")+"</label><button data-mini='true' id='o57' value='"+controller.options.sn2of+"'>"+controller.options.sn2of+"m</button></div>"),void 0!==controller.options.sn2t&&(o+="<label id='prgswitch-2' class='center smaller"+(240===controller.options.urs||240===controller.options.sn1t||240===controller.options.sn2t?"":" hidden")+"'>"+_("When using program switch, a switch is connected to the sensor port to trigger Program 2 every time the switch is pressed for at least 1 second.")+"</label>"),void 0===controller.settings.ifkey&&void 0===controller.settings.mqtt&&void 0===controller.settings.otc||(o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"integrations"===t?" data-collapsed='false'":"")+"><legend>"+_("Integrations")+"</legend>",void 0!==controller.settings.otc&&(o+="<div class='ui-field-contain'><label for='otc'>"+_("OTC")+"<button style='display:inline-block;' data-helptext='"+_("OpenThings Cloud (OTC) allows remote access using OTC Token .")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='otc' value='"+escapeJSON(controller.settings.otc)+"'>"+_("Tap to Configure")+"</button></div>"),void 0!==controller.settings.mqtt&&(o+="<div class='ui-field-contain'><label for='mqtt'>"+_("MQTT")+"<button style='display:inline-block;' data-helptext='"+_("OpenSprinkler can send notifications to an MQTT broker at a specified host and port.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='mqtt' value='"+escapeJSON(controller.settings.mqtt)+"'>"+_("Tap to Configure")+"</button></div>"),void 0!==controller.settings.ifkey&&(o+="<div class='ui-field-contain'><label for='ifkey'>"+_("IFTTT Key")+"<button data-helptext='"+_("To enable IFTTT, a Webhooks key is required which can be obtained from https://ifttt.com")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' data-mini='true' type='text' id='ifkey' value='"+controller.settings.ifkey+"'></div>",o+="<div class='ui-field-contain'><label for='o49'>"+_("IFTTT Events")+"<button data-helptext='"+_("Select which events to send to IFTTT for use in recipes.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='o49' value='"+controller.options.ife+"'>"+_("Configure Events")+"</button></div>"),void 0!==controller.settings.dname&&(o+="<div class='ui-field-contain'><label for='dname'>"+_("Device Name")+"<button data-helptext='"+_("Device name is attached to all IFTTT notifications to help distinguish multiple devices")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' data-mini='true' type='text' id='dname' value=\""+controller.settings.dname+'"></div>')),o+="</fieldset><fieldset class='full-width-slider' data-role='collapsible'"+("string"==typeof t&&"lcd"===t?" data-collapsed='false'":"")+"><legend>"+_("LCD Screen")+"</legend>",void 0!==controller.options.con&&(o+="<div class='ui-field-contain'><label for='o27'>"+_("Contrast")+"</label><input type='range' id='o27' min='0' max='255' step='10' data-highlight='true' value='"+controller.options.con+"'></div>"),void 0!==controller.options.lit&&(o+="<div class='ui-field-contain'><label for='o28'>"+_("Brightness")+"</label><input type='range' id='o28' min='0' max='255' step='10' data-highlight='true' value='"+controller.options.lit+"'></div>"),void 0!==controller.options.dim&&(o+="<div class='ui-field-contain'><label for='o29'>"+_("Idle Brightness")+"</label><input type='range' id='o29' min='0' max='255' step='10' data-highlight='true' value='"+controller.options.dim+"'></div>"),o+="</fieldset><fieldset data-role='collapsible' data-theme='b'"+("string"==typeof t&&"advanced"===t?" data-collapsed='false'":"")+"><legend>"+_("Advanced")+"</legend>",checkOSVersion(219)&&void 0!==controller.options.uwt&&"object"==typeof controller.settings.wto&&(o+="<div class='ui-field-contain'><label for='wtkey'>"+_("Wunderground Key").replace("Wunderground","Wunder&shy;ground")+"<button data-helptext='"+_("We use DarkSky normally however with a user provided API key the weather source will switch to Weather Underground.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><table><tr style='width:100%;vertical-align: top;'><td style='width:100%'><div class='"+(controller.settings.wto.key&&""!==controller.settings.wto.key?"green ":"")+"ui-input-text controlgroup-textinput ui-btn ui-body-inherit ui-corner-all ui-mini ui-shadow-inset ui-input-has-clear'><input data-role='none' data-mini='true' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' id='wtkey' value='"+(controller.settings.wto.key||"")+"'><a href='#' tabindex='-1' aria-hidden='true' data-helptext='"+_("An invalid API key has been detected.")+"' class='hidden help-icon ui-input-clear ui-btn ui-icon-alert ui-btn-icon-notext ui-corner-all'></a></div></td><td><button class='noselect' data-mini='true' id='verify-api'>"+_("Verify")+"</button></td></tr></table></div>"),void 0!==controller.options.hp0&&(o+="<div class='ui-field-contain'><label for='o12'>"+_("HTTP Port (restart required)")+"</label><input data-mini='true' type='number' pattern='[0-9]*' id='o12' value='"+(256*controller.options.hp1+controller.options.hp0)+"'></div>"),void 0!==controller.options.devid&&(o+="<div class='ui-field-contain'><label for='o26'>"+_("Device ID (restart required)")+"<button data-helptext='"+_("Device ID modifies the last byte of the MAC address.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><input data-mini='true' type='number' pattern='[0-9]*' max='255' id='o26' value='"+controller.options.devid+"'></div>"),void 0!==controller.options.rlp?o+="<div class='ui-field-contain duration-field'><label for='o30'>"+_("Relay Pulse")+"<button data-helptext='"+_("Relay pulsing is used for special situations where rapid pulsing is needed in the output with a range from 1 to 2000 milliseconds. A zero value disables the pulsing option.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='o30' value='"+controller.options.rlp+"'>"+controller.options.rlp+"ms</button></div>":!0!==checkOSVersion(215)&&void 0!==controller.options.bst&&(o+="<div class='ui-field-contain duration-field'><label for='o30'>"+_("Boost Time")+"<button data-helptext='"+_("Boost time changes how long the boost converter is activated with a range from 0 to 1000 milliseconds.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='o30' value='"+controller.options.bst+"'>"+controller.options.bst+"ms</button></div>"),void 0!==controller.options.ntp&&checkOSVersion(210)){var u=[controller.options.ntp1,controller.options.ntp2,controller.options.ntp3,controller.options.ntp4].join(".");o+="<div class='"+(1===controller.options.ntp?"":"hidden ")+"ui-field-contain duration-field'><label for='ntp_addr'>"+_("NTP IP Address")+"</label><button data-mini='true' id='ntp_addr' value='"+u+"'>"+u+"</button></div>"}if(void 0!==controller.options.dhcp&&checkOSVersion(210)){var h=[controller.options.ip1,controller.options.ip2,controller.options.ip3,controller.options.ip4].join("."),p=[controller.options.gw1,controller.options.gw2,controller.options.gw3,controller.options.gw4].join(".");if(o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='ip_addr'>"+_("IP Address")+"</label><button data-mini='true' id='ip_addr' value='"+h+"'>"+h+"</button></div>",o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='gateway'>"+_("Gateway Address")+"</label><button data-mini='true' id='gateway' value='"+p+"'>"+p+"</button></div>",void 0!==controller.options.subn1){var f=[controller.options.subn1,controller.options.subn2,controller.options.subn3,controller.options.subn4].join(".");o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='subnet'>"+_("Subnet Mask")+"</label><button data-mini='true' id='subnet' value='"+f+"'>"+f+"</button></div>"}if(void 0!==controller.options.dns1){var m=[controller.options.dns1,controller.options.dns2,controller.options.dns3,controller.options.dns4].join(".");o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='dns'>"+_("DNS Address")+"</label><button data-mini='true' id='dns' value='"+m+"'>"+m+"</button></div>"}o+="<label for='o3'><input data-mini='true' id='o3' type='checkbox' "+(1===controller.options.dhcp?"checked='checked'":"")+">"+_("Use DHCP (restart required)")+"</label>"}void 0!==controller.options.ntp&&(o+="<label for='o2'><input data-mini='true' id='o2' type='checkbox' "+(1===controller.options.ntp?"checked='checked'":"")+">"+_("NTP Sync")+"</label>"),void 0!==controller.options.ar&&(o+="<label for='o14'><input data-mini='true' id='o14' type='checkbox' "+(1===controller.options.ar?"checked='checked'":"")+">"+_("Auto Reconnect")+"</label>"),void 0!==controller.options.ipas&&(o+="<label for='o25'><input data-mini='true' id='o25' type='checkbox' "+(1===controller.options.ipas?"checked='checked'":"")+">"+_("Ignore Password")+"</label>"),void 0!==controller.options.sar&&(o+="<label for='o48'><input data-mini='true' id='o48' type='checkbox' "+(1===controller.options.sar?"checked='checked'":"")+">"+_("Special Station Auto-Refresh")+"</label>"),o+="</fieldset><fieldset data-role='collapsible' data-theme='b'"+("string"==typeof t&&"reset"===t?" data-collapsed='false'":"")+"><legend>"+_("Reset")+"</legend>",o+="<button data-mini='true' class='center-div reset-log'>"+_("Clear Log Data")+"</button>",o+="<button data-mini='true' class='center-div reset-options'>"+_("Reset All Options")+"</button>",o+="<button data-mini='true' class='center-div reset-programs'>"+_("Delete All Programs")+"</button>",o+="<button data-mini='true' class='center-div reset-stations'>"+_("Reset Station Attributes")+"</button>",controller.options.hwv>=30&&controller.options.hwv<40&&(o+="<hr class='divider'><button data-mini='true' class='center-div reset-wireless'>"+_("Reset Wireless Settings")+"</button>"),o+="</fieldset>",s.find("#os-options-list").html(o).one("change input",":not(.noselect)",(function(){l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges")})).find("fieldset").each((function(){var t=$(this);1===t.children().length&&t.remove()})),s.find(".clear-loc").on("click",(function(t){t.stopImmediatePropagation(),areYouSure(_("Are you sure you want to clear the current location?"),"",(function(){s.find("#loc").val("''").removeClass("green").find("span").text(_("Not specified")),s.find("#o1").selectmenu("enable"),l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges")}))})),s.find("#showDisabled").on("change",(function(){return storage.set({showDisabled:this.checked}),!1})),s.find("#loc").on("click",(function(){var t=$(this);t.prop("disabled",!0),overlayMap((function(e,i){if(!1===e)""===t.val()&&(t.removeClass("green"),s.find("#o1").selectmenu("enable"));else{if(checkOSVersion(210)&&s.find("#o1").selectmenu("disable"),"string"==typeof e)t.val(e).find("span").text(e);else{e[0]=parseFloat(e[0]).toFixed(5),e[1]=parseFloat(e[1]).toFixed(5),"string"==typeof i&&validateWULocation(i,(function(e){e?t.addClass("green"):e||t.removeClass("green")}));var n=s.find("#wto");n&&void 0!==n.val()&&n.val(escapeJSON($.extend({},unescapeJSON(n.val()),{pws:i||""}))),t.val(e),coordsToLocation(e[0],e[1],(function(e){t.find("span").text(e)}))}l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges")}t.prop("disabled",!1)}))})),s.find("#wto").on("click",(function(){var t=this,e=unescapeJSON(this.value),i={pws:e.pws,key:e.key},n=parseInt(s.find("#o31").val()),o=function(){t.value=escapeJSON($.extend({},unescapeJSON(t.value),i)),l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges")};1===n?showZimmermanAdjustmentOptions(this,o):2===n?showAutoRainDelayAdjustmentOptions(this,o):3===n?showEToAdjustmentOptions(this,o):4===n&&showMonthlyAdjustmentOptions(this,o)})),s.find(".reset-log").on("click",clearLogs),s.find(".reset-programs").on("click",clearPrograms),s.find(".reset-options").on("click",(function(){resetAllOptions((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Settings have been saved"))})),goBack()}))})),s.find(".reset-stations").on("click",(function(){var t,e="";if(Supported.groups())for(t=0;t<controller.stations.snames.length;t++)e+="g"+t+"=0&";if(void 0!==controller.options.mas)for(t=0;t<controller.settings.nbrd;t++)e+="m"+t+"=255&";if(void 0!==controller.options.mas2)for(t=0;t<controller.settings.nbrd;t++)e+="n"+t+"=0&";if("object"==typeof controller.stations.ignore_rain)for(t=0;t<controller.settings.nbrd;t++)e+="i"+t+"=0&";if("object"==typeof controller.stations.ignore_sn1)for(t=0;t<controller.settings.nbrd;t++)e+="j"+t+"=0&";if("object"==typeof controller.stations.ignore_sn2)for(t=0;t<controller.settings.nbrd;t++)e+="k"+t+"=0&";if("object"==typeof controller.stations.act_relay)for(t=0;t<controller.settings.nbrd;t++)e+="a"+t+"=0&";if("object"==typeof controller.stations.stn_dis)for(t=0;t<controller.settings.nbrd;t++)e+="d"+t+"=0&";if("object"==typeof controller.stations.stn_seq)for(t=0;t<controller.settings.nbrd;t++)e+="q"+t+"=255&";if("object"==typeof controller.stations.stn_spe)for(t=0;t<controller.settings.nbrd;t++)e+="p"+t+"=0&";areYouSure(_("Are you sure you want to reset station attributes?"),_("This will reset all station attributes"),(function(){$.mobile.loading("show"),storage.get(["sites","current_site"],(function(t){var e=parseSites(t.sites);e[t.current_site].notes={},e[t.current_site].images={},e[t.current_site].lastRunTime={},storage.set({sites:JSON.stringify(e)},cloudSaveSites)})),sendToOS("/cs?pw=&"+e).done((function(){showerror(_("Stations have been updated")),updateController()}))}))})),s.find(".reset-wireless").on("click",(function(){areYouSure(_("Are you sure you want to reset the wireless settings?"),_("This will delete the stored SSID/password for your wireless network and return the device to access point mode"),(function(){sendToOS("/cv?pw=&ap=1").done((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Wireless settings have been reset. Please follow the OpenSprinkler user manual on restoring connectivity."))})),goBack()}))}))})),s.find("#o3").on("change",(function(){var t=$(this).is(":checked"),e=s.find("#ip_addr,#gateway,#dns,#subnet").parents(".ui-field-contain");t?e.addClass("hidden"):e.removeClass("hidden")})),s.find(".sensor-options input[type='radio']").on("change",(function(){var t=this.value,e=parseInt(this.id.match(/o(\d+)/)[1],10);"2"===t?s.find("#o41").parents(".ui-field-contain").removeClass("hidden"):21!==e&&50!==e||s.find("#o41").parents(".ui-field-contain").addClass("hidden"),"1"===t||"3"===t||"240"===t?s.find("#o"+(e+1)).parent().removeClass("hidden"):s.find("#o"+(e+1)).parent().addClass("hidden"),"240"===$("input[name='o21'][type='radio']:checked").val()||"240"===$("input[name='o50'][type='radio']:checked").val()?s.find("#prgswitch").removeClass("hidden"):s.find("#prgswitch").addClass("hidden"),"240"===$("input[name='o52'][type='radio']:checked").val()?s.find("#prgswitch-2").removeClass("hidden"):s.find("#prgswitch-2").addClass("hidden"),"1"===t||"3"===t?s.find("#o"+(e+4)+",#o"+(e+5)).parent().removeClass("hidden"):s.find("#o"+(e+4)+",#o"+(e+5)).parent().addClass("hidden")})),s.find("#o21").on("change",(function(){s.find("#o22").parent().toggleClass("hidden",$(this).is(":checked"))})),s.find("#verify-api").on("click",(function(){var t=s.find("#wtkey"),e=$(this);e.prop("disabled",!0),testAPIKey(t.val(),(function(i){!0===i?(t.parent().find(".ui-icon-alert").hide(),t.parent().removeClass("red").addClass("green")):(t.parent().find(".ui-icon-alert").removeClass("hidden").show(),t.parent().removeClass("green").addClass("red")),e.prop("disabled",!1)}))})),s.find(".help-icon").on("click",showHelpText),s.find(".duration-field button:not(.help-icon)").on("click",(function(){var t=$(this),e=t.attr("id"),i=s.find("label[for='"+e+"']").text(),n=t.parent().find(".help-icon").data("helptext"),o=240;if(l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges"),"ip_addr"===e||"gateway"===e||"dns"===e||"ntp_addr"===e||"subnet"===e)showIPRequest({title:i,ip:t.val().split("."),callback:function(e){t.val(e.join(".")).text(e.join("."))}});else if("o19"===e||"o38"===e)showSingleDurationInput({data:t.val(),title:i,callback:function(e){t.val(e).text(e+"s")},label:_("Seconds"),maximum:checkOSVersion(220)?600:60,minimum:checkOSVersion(220)?-600:0,helptext:n});else if("o30"===e)showSingleDurationInput({data:t.val(),title:i,callback:function(e){t.val(e).text(e+"ms")},label:_("Milliseconds"),maximum:2e3,helptext:n});else if("o20"===e||"o39"===e)showSingleDurationInput({data:t.val(),title:i,callback:function(e){t.val(e).text(e+"s")},label:_("Seconds"),maximum:checkOSVersion(220)?600:0,minimum:checkOSVersion(220)?-600:-60,helptext:n});else if("o23"===e)showSingleDurationInput({data:t.val(),title:i,callback:function(e){t.val(e).text(e+"%")},label:_("% Watering"),maximum:250,helptext:n});else if("o17"===e){var a=0;checkOSVersion(210)&&(o=checkOSVersion(214)?57600:64800),checkOSVersion(211)&&(a=-3540,o=3540),checkOSVersion(217)&&(a=-600,o=600),showSingleDurationInput({data:t.val(),title:i,label:_("Seconds"),callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e)))},maximum:o,minimum:a})}else"o54"!==e&&"o55"!==e&&"o56"!==e&&"o57"!==e||showSingleDurationInput({data:t.val(),title:i,callback:function(e){t.val(e).text(e+"m")},label:_("Minutes"),maximum:240,minimum:0,helptext:n});return!1})),s.find("#o2").on("change",(function(){var t=$(this).is(":checked");s.find(".datetime-input button").prop("disabled",t),s.find("#ntp_addr").parents(".ui-field-contain").toggleClass("hidden",!t)})),s.find("#o18,#o37").on("change",(function(){s.find("#o19,#o20").parents(".ui-field-contain").toggle(0!==parseInt(s.find("#o18").val())),void 0!==controller.options.mas2&&s.find("#o38,#o39").parents(".ui-field-contain").toggle(0!==parseInt(s.find("#o37").val()))})),s.find("#o31").on("change",(function(){s.find("#o23").prop("disabled",0!==parseInt(this.value)),s.find("#wto").click().parents(".ui-field-contain").toggleClass("hidden",0===parseInt(this.value))})),s.find("#wtkey").on("change input",(function(){s.find("#wtkey").siblings(".help-icon").hide(),s.find("#wtkey").parent().removeClass("red green")})),s.find("#o49").on("click",(function(){var t={program:_("Program Start"),sensor1:_("Sensor 1 Update"),flow:_("Flow Sensor Update"),weather:_("Weather Adjustment Update"),reboot:_("Controller Reboot"),run:_("Station Run"),sensor2:_("Sensor 2 Update"),rain:_("Rain Delay Update")},e=this,i=parseInt(e.value),n="",o=0,a=0;$.each(t,(function(t,e){n+="<label for='ifttt-"+t+"'><input class='needsclick' data-iconpos='right' id='ifttt-"+t+"' type='checkbox' "+(getBitFromByte(i,o)?"checked='checked'":"")+">"+e+"</label>",o++}));var r=$("<div data-role='popup' data-theme='a'><div data-role='controlgroup' data-mini='true' class='tight'><div class='ui-bar ui-bar-a'>"+_("Select IFTTT Events")+"</div>"+n+"<input data-wrapper-class='attrib-submit' class='submit' data-theme='b' type='submit' value='"+_("Submit")+"' /></div></div>");r.find(".submit").on("click",(function(){o=0,$.each(t,(function(t){a|=r.find("#ifttt-"+t).is(":checked")<<o,o++})),r.popup("close"),i!==a&&(e.value=a,l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges"))})),openPopup(r)})),s.find("#mqtt").on("click",(function(){var t=this,e=t.value,i=$.extend({},{en:0,host:"server",port:1883,user:"",pass:""},unescapeJSON(e));$(".ui-popup-active").find("[data-role='popup']").popup("close");var n=$("<div data-role='popup' data-theme='a' id='mqttSettings'><div data-role='header' data-theme='b'><h1>"+_("MQTT Settings")+"</h1></div><div class='ui-content'><label for='enable'>"+_("Enable")+"</label><input class='needsclick mqtt_enable' data-mini='true' data-iconpos='right' id='enable' type='checkbox' "+(i.en?"checked='checked'":"")+"><div class='ui-body'><div class='ui-grid-a' style='display:table;'><div class='ui-block-a' style='width:40%'><label for='server' style='padding-top:10px'>"+_("Broker/Server")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='text' id='server' data-mini='true' maxlength='50' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(i.en?"":"disabled='disabled'")+" placeholder='"+_("broker/server")+"' value='"+i.host+"' required /></div><div class='ui-block-a' style='width:40%'><label for='port' style='padding-top:10px'>"+_("Port")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='number' id='port' data-mini='true' pattern='[0-9]*' min='0' max='65535'"+(i.en?"":"disabled='disabled'")+" placeholder='1883' value='"+i.port+"' required /></div><div class='ui-block-a' style='width:40%'><label for='username' style='padding-top:10px'>"+_("Username")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='text' id='username' data-mini='true' maxlength='32' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(i.en?"":"disabled='disabled'")+" placeholder='"+_("username (optional)")+"' value='"+i.user+"' required /></div><div class='ui-block-a' style='width:40%'><label for='password' style='padding-top:10px'>"+_("Password")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='password' id='password' data-mini='true' maxlength='32' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(i.en?"":"disabled='disabled'")+" placeholder='"+_("password (optional)")+"' value='"+i.pass+"' required /></div></div></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");n.find("#enable").on("change",(function(){this.checked?n.find(".mqtt-input").textinput("enable"):n.find(".mqtt-input").textinput("disable")})),n.find(".submit").on("click",(function(){var i={en:n.find("#enable").prop("checked")?1:0,host:n.find("#server").val(),port:parseInt(n.find("#port").val()),user:n.find("#username").val(),pass:n.find("#password").val()};n.popup("close"),e!==escapeJSON(i)&&(t.value=escapeJSON(i),l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges"))})),n.css("max-width","380px"),openPopup(n,{positionTo:"window"})})),s.find("#otc").on("click",(function(){var t=this,e=t.value,i=$.extend({},{en:0,token:"",server:"ws.cloud.openthings.io",port:80},unescapeJSON(e));$(".ui-popup-active").find("[data-role='popup']").popup("close");var n=$("<div data-role='popup' data-theme='a' id='otcSettings'><div data-role='header' data-theme='b'><h1>"+_("OpenThings Cloud (OTC) Settings")+"</h1></div><div class='ui-content'><label for='enable'>"+_("Enable")+"</label><input class='needsclick otc_enable' data-mini='true' data-iconpos='right' id='enable' type='checkbox' "+(i.en?"checked='checked'":"")+"><div class='ui-body'><div class='ui-grid-a' style='display:table;'><div class='ui-block-a' style='width:25%'><label for='token' style='padding-top:10px'>"+_("Token")+"</label></div><div class='ui-block-b' style='width:75%'><input class='otc-input' type='text' id='token' data-mini='true' maxlength='36' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(i.en?"":"disabled='disabled'")+" placeholder='"+_("token")+"' value='"+i.token+"' required /></div><div class='ui-block-a' style='width:25%'><label for='server' style='padding-top:10px'>"+_("Server")+"</label></div><div class='ui-block-b' style='width:75%'><input class='otc-input' type='text' id='server' data-mini='true' maxlength='50' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(i.en?"":"disabled='disabled'")+" placeholder='"+_("server")+"' value='"+i.server+"' required /></div><div class='ui-block-a' style='width:25%'><label for='port' style='padding-top:10px'>"+_("Port")+"</label></div><div class='ui-block-b' style='width:75%'><input class='otc-input' type='number' id='port' data-mini='true' pattern='[0-9]*' min='0' max='65535'"+(i.en?"":"disabled='disabled'")+" placeholder='80' value='"+i.port+"' required /></div></div></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");n.find("#enable").on("change",(function(){this.checked?n.find(".otc-input").textinput("enable"):n.find(".otc-input").textinput("disable")})),n.find(".submit").on("click",(function(){if(n.find("#enable").prop("checked")&&32!==n.find("#token").val().length)showerror(_("OpenThings Token must be 32 characters long."));else{var i={en:n.find("#enable").prop("checked")?1:0,token:n.find("#token").val(),server:n.find("#server").val(),port:parseInt(n.find("#port").val())};n.popup("close"),e!==escapeJSON(i)&&(t.value=escapeJSON(i),l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges"))}})),n.css("max-width","380px"),openPopup(n,{positionTo:"window"})})),s.find(".datetime-input").on("click",(function(){var t=$(this).find("button");if(!t.prop("disabled"))return l.eq(2).prop("disabled",!1),s.find(".submit").addClass("hasChanges"),showDateTimeInput(t.val(),(function(e){t.text(dateToString(e).slice(0,-3)).val(Math.round(e.getTime()/1e3))})),!1})),s.one("pagehide",(function(){s.remove()})),l.eq(2).prop("disabled",!0),$("#os-options").remove(),$.mobile.pageContainer.append(s)}var showHomeMenu=function(){var t,e,i,n;return function(o){o=o instanceof $?o:$(o),$(".ui-popup-active").find("[data-role='popup']").popup("close"),t=$(".ui-page-active"),e=t.attr("id"),i=t.hasClass("show-hidden"),(n=$("<div data-role='popup' data-theme='a' id='mainMenu'><ul data-role='listview' data-inset='true' data-corners='false'><li data-role='list-divider'>"+_("Information")+"</li><li><a href='#preview' class='squeeze'>"+_("Preview Programs")+"</a></li>"+(checkOSVersion(206)||checkOSPiVersion("1.9")?"<li><a href='#logs'>"+_("View Logs")+"</a></li>":"")+"<li data-role='list-divider'>"+_("Programs and Settings")+"</li><li><a href='#raindelay'>"+_("Change Rain Delay")+"</a></li>"+(Supported.pausing()?StationQueue.isPaused()?"<li><a href='#globalpause'>"+_("Resume Station Runs")+"</a></li>":StationQueue.isActive()>=-1?"<li><a href='#globalpause'>"+_("Pause Station Runs")+"</a></li>":"":"")+"<li><a href='#runonce'>"+_("Run-Once Program")+"</a></li><li><a href='#programs'>"+_("Edit Programs")+"</a></li><li><a href='#os-options'>"+_("Edit Options")+"</a></li>"+(checkOSVersion(230)?"<li><a href='#analogsensorconfig'>"+_("Analog Sensor Config")+"</a></li><li><a href='#analogsensorchart'>"+_("Show Sensor Log")+"</a></li>":"")+(checkOSVersion(210)?"":"<li><a href='#manual'>"+_("Manual Control")+"</a></li>")+("sprinklers"===e||"runonce"===e||"programs"===e||"manual"===e||"addprogram"===e?"</ul><div class='ui-grid-a ui-mini tight'><div class='ui-block-a'><a class='ui-btn tight' href='#show-hidden'>"+_(i?"Hide":"Show")+" "+_("Disabled")+"</a></div><div class='ui-block-b'><a class='ui-btn red tight' href='#stop-all'>"+_("Stop All Stations")+"</a></div></div>":"<li><a class='ui-btn red' href='#stop-all'>"+_("Stop All Stations")+"</a></li></ul>")+"</div>")).on("click","a",(function(){var e=$(this).attr("href");return n.popup("close"),"#stop-all"===e?stopAllStations():"#show-hidden"===e?i?($(".station-hidden").hide(),t.removeClass("show-hidden")):($(".station-hidden").show(),t.addClass("show-hidden")):"#raindelay"===e?showRainDelay():"#globalpause"===e?showPause():checkChanges((function(){changePage(e)})),!1})),$("#mainMenu").remove(),n.one("popupafterclose",(function(){o.show()})),openPopup(n,{positionTo:o}),o.hide()}}(),showHome=function(){var t,e,i,n,o,s=$("<div data-role='page' id='sprinklers'><div class='ui-panel-wrapper'><div class='ui-content' role='main'><div class='ui-grid-a ui-body ui-corner-all info-card noweather'><div class='ui-block-a'><div id='weather' class='pointer'></div></div><div class='ui-block-b center home-info pointer'><div class='sitename bold'></div><div id='clock-s' class='nobr'></div>"+_("Water Level")+": <span class='waterlevel'></span>%</div></div><div id='os-stations-list' class='card-group center'></div><div id='os-sensor-show' class='card-group center'></div></div></div></div>"),a=function(t,e){timers["station-"+t]={val:e,station:t,update:function(){s.find("#countdown-"+t).text("("+sec2hms(this.val)+" "+_("remaining")+")")},done:function(){s.find("#countdown-"+t).parent("p").empty().siblings(".station-status").removeClass("on").addClass("off")}}},r=function(e){var n=Station.getName(e),s=Station.getPID(e)>0,r=Station.isRunning(e),l=s?pidname(Station.getPID(e)):"",c=Station.getRemainingRuntime(e),d=Supported.pausing()&&StationQueue.isPaused(),u=!!o[i].images[e];Station.getStatus(e)&&c>0&&a(e,c),t+="<div data-station='"+e+"' class='ui-corner-all card"+(Station.isDisabled(e)?" station-hidden' style='display:none":"")+"'>",t+="<div class='ui-body ui-body-a center'>",t+="<img src='"+(u?"data:image/jpeg;base64,"+o[i].images[e]:getAppURLPath()+"img/placeholder.png")+"' />",t+="<p class='station-name center inline-icon' id='station_"+e+"'>"+n+"</p>",t+="<span class='btn-no-border ui-btn ui-btn-icon-notext ui-corner-all card-icon station-status "+(r?"on":s?"wait":"off")+"'></span>",t+="<span class='btn-no-border ui-btn ui-btn-icon-notext ui-icon-wifi card-icon special-station "+(Station.isSpecial(e)?"":"hidden")+"'></span>",Supported.groups()&&(t+="<span class='btn-no-border ui-btn card-icon station-gid "+(Station.isMaster(e)?"hidden":"")+"'>"+mapGIDValueToName(Station.getGIDValue(e))+"</span>"),t+="<span class='btn-no-border ui-btn "+(Station.isMaster(e)?"ui-icon-master":"ui-icon-gear")+" card-icon ui-btn-icon-notext station-settings' data-station='"+e+"' id='attrib-"+e+"' "+(Supported.master(MASTER_STATION_1)?"data-um='"+StationAttribute.getMasterOperation(e,MASTER_STATION_1)+"' ":"")+(Supported.master(MASTER_STATION_2)?"data-um2='"+StationAttribute.getMasterOperation(e,MASTER_STATION_2)+"' ":"")+(Supported.ignoreRain()?"data-ir='"+StationAttribute.getIgnoreRain(e)+"' ":"")+(Supported.ignoreSensor(IGNORE_SENSOR_1)?"data-sn1='"+StationAttribute.getIgnoreSensor(e,IGNORE_SENSOR_1)+"' ":"")+(Supported.ignoreSensor(IGNORE_SENSOR_2)?"data-sn2='"+StationAttribute.getIgnoreSensor(e,IGNORE_SENSOR_2)+"' ":"")+(Supported.actRelay()?"data-ar='"+StationAttribute.getActRelay(e)+"' ":"")+(Supported.disabled()?"data-sd='"+StationAttribute.getDisabled(e)+"' ":"")+(Supported.sequential()?"data-us='"+StationAttribute.getSequential(e)+"' ":"")+(Supported.special()?"data-hs='"+StationAttribute.getSpecial(e)+"' ":"")+(Supported.groups()?"data-gid='"+Station.getGIDValue(e)+"' ":"")+"></span>",Station.isMaster(e)||(s||r)&&(t+="<p class='rem center'>"+(r?_("Running")+" "+l:_("Scheduled")+" "+(Station.getStartTime(e)?_("for")+" "+dateToString(new Date(1e3*Station.getStartTime(e))):l)),c>0&&(t+=" <span id="+(d?"'pause":"'countdown-")+e+"' class='nobr'>("+sec2hms(c)+" "+_("remaining")+")</span>"),t+="</p>"),t+="</div><hr style='display:none' class='content-divider'"+(Supported.groups()?"divider-gid="+Station.getGIDValue(e):"")+"></div>"},l=function(){$("#stn_attrib").popup("destroy").remove();var t=$(this),e=t.data("station"),n=t.siblings("[id='station_"+e+"']"),s=function(){var t=r.find("#http-server").val()+","+r.find("#http-port").val()+","+r.find("#http-on").val()+","+r.find("#http-off").val(),e=encodeURIComponent(t).length;r.find("#character-count").text(240-e),e>240?(r.find(".attrib-submit").addClass("ui-disabled"),r.find("#character-tracking").addClass("red-text bold")):(r.find(".attrib-submit").removeClass("ui-disabled"),r.find("#character-tracking").removeClass("red-text bold"))},a=function(s){var l=parseInt(r.find("#hs").val());if(t.data("hs",l),1===l)t.data("specialData",r.find("#rf-code").val());else if(2===l){for(var d=r.find("#remote-address").val().split("."),u=parseInt(r.find("#remote-port").val())||80,h=(r.find("#remote-station").val()||1)-1,p="",f=0;f<4;f++)p+=pad(parseInt(d[f]).toString(16));if(p+=(u<256?"00":"")+pad(u.toString(16)),p+=pad(h.toString(16)),!0!==s)return $.mobile.loading("show"),r.find(".attrib-submit").addClass("ui-disabled"),void verifyRemoteStation(p,(function(t){var e;if(!0!==t){!1===t||-1===t?e=_("Unable to reach the remote station."):-2===t?e=_("Password on remote controller does not match the password on this controller."):-3===t&&(e=_("Remote controller is not configured as an extender. Would you like to do this now?")),r.one("popupafterclose",(function(){$.mobile.loading("hide"),i.css("opacity","")})),$.mobile.loading("show",{html:"<h1>"+e+"</h1><button class='ui-btn cancel'>"+_("Cancel")+"</button><button class='ui-btn continue'>"+_("Continue")+"</button>",textVisible:!0,theme:"b"});var i=$(".ui-loader");i.css("opacity",".96"),i.find(".cancel").one("click",(function(){$.mobile.loading("hide"),i.css("opacity","")})),i.find(".continue").one("click",(function(){$.mobile.loading("hide"),i.css("opacity",""),-3===t&&convertRemoteToExtender(p),a(!0)})),r.find(".attrib-submit").removeClass("ui-disabled")}else a(!0)}));t.data("specialData",p)}else if(3===l){var m=pad(r.find("#gpio-pin").val()||"05");m+=r.find("#active-state").val()||"1",t.data("specialData",m)}else if(4===l){var g=r.find("#http-server").val();g+=","+r.find("#http-port").val(),g+=","+r.find("#http-on").val(),g+=","+r.find("#http-off").val(),t.data("specialData",g)}t.data("um",r.find("#um").is(":checked")?1:0),t.data("um2",r.find("#um2").is(":checked")?1:0),t.data("ir",r.find("#ir").is(":checked")?1:0),t.data("sn1",r.find("#sn1").is(":checked")?1:0),t.data("sn2",r.find("#sn2").is(":checked")?1:0),t.data("ar",r.find("#ar").is(":checked")?1:0),t.data("sd",r.find("#sd").is(":checked")?1:0),t.data("us",r.find("#us").is(":checked")?1:0),n.html(r.find("#stn-name").val());var v=r.find("span.seqgrp").text();t.attr("data-gid",mapGIDNameToValue(v)),o[i].notes[e]=r.find("#stn-notes").val(),storage.set({sites:JSON.stringify(o)},cloudSaveSites),c(e),r.popup("destroy").remove()},r="<div data-overlay-theme='b' data-role='popup' data-theme='a' id='stn_attrib'><fieldset style='margin:0' data-mini='true' data-corners='false' data-role='controlgroup'><form><div id='station-tabs'>";if("number"!=typeof e)return!1;if(Supported.special()&&(r+="<ul class='tabs'><li class='current' data-tab='tab-basic'>"+_("Basic")+"</li><li data-tab='tab-advanced'>"+_("Advanced")+"</li></ul>"),r+="<div id='tab-basic' class='tab-content current'>",r+="<div class='ui-bar-a ui-bar'>"+_("Station Name")+":</div><input class='bold center' data-corners='false' data-wrapper-class='tight stn-name ui-btn' id='stn-name' type='text' value=\""+n.text()+'">',void 0!==navigator.camera&&"function"==typeof navigator.camera.getPicture&&(r+="<button class='changeBackground'>"+("string"!=typeof o[i].images[e]?_("Add"):_("Change"))+" "+_("Image")+"</button>"),Station.isMaster(e)||(Supported.master(MASTER_STATION_1)&&(r+="<label for='um'><input class='needsclick' data-iconpos='right' id='um' type='checkbox' "+(1===t.data("um")?"checked='checked'":"")+">"+_("Use Master")+" "+(Supported.master(MASTER_STATION_2)?"1":"")+"</label>"),Supported.master(MASTER_STATION_2)&&(r+="<label for='um2'><input class='needsclick' data-iconpos='right' id='um2' type='checkbox' "+(1===t.data("um2")?"checked='checked'":"")+">"+_("Use Master")+" 2</label>"),Supported.ignoreRain()&&(r+="<label for='ir'><input class='needsclick' data-iconpos='right' id='ir' type='checkbox' "+(1===t.data("ir")?"checked='checked'":"")+">"+_("Ignore Rain")+"</label>"),Supported.ignoreSensor(IGNORE_SENSOR_1)&&(r+="<label for='sn1'><input class='needsclick' data-iconpos='right' id='sn1' type='checkbox' "+(1===t.data("sn1")?"checked='checked'":"")+">"+_("Ignore Sensor 1")+"</label>"),Supported.ignoreSensor(IGNORE_SENSOR_2)&&(r+="<label for='sn2'><input class='needsclick' data-iconpos='right' id='sn2' type='checkbox' "+(1===t.data("sn2")?"checked='checked'":"")+">"+_("Ignore Sensor 2")+"</label>"),Supported.actRelay()&&(r+="<label for='ar'><input class='needsclick' data-iconpos='right' id='ar' type='checkbox' "+(1===t.data("ar")?"checked='checked'":"")+">"+_("Activate Relay")+"</label>"),Supported.disabled()&&(r+="<label for='sd'><input class='needsclick' data-iconpos='right' id='sd' type='checkbox' "+(1===t.data("sd")?"checked='checked'":"")+">"+_("Disable")+"</label>"),Supported.sequential()&&!Supported.groups()&&(r+="<label for='us'><input class='needsclick' data-iconpos='right' id='us' type='checkbox' "+(1===t.data("us")?"checked='checked'":"")+">"+_("Sequential")+"</label>")),r+="<div class='ui-bar-a ui-bar'>"+_("Station Notes")+":</div><textarea data-corners='false' class='tight stn-notes' id='stn-notes'>"+(o[i].notes[e]?o[i].notes[e]:"")+"</textarea>",r+="</div>",r+="<div id='tab-advanced' class='tab-content'>",Supported.groups()&&!Station.isMaster(e)&&(r+="<div class='ui-bar-a ui-bar seq-container'>"+_("Sequential Group")+":</div><select id='gid' class='seqgrp' data-mini='true'></select><div><p id='prohibit-change' class='center hidden' style='color: #ff0033;'>Changing group designation is prohibited while station is running</p></div>"),Supported.special()&&(r+="<div class='ui-bar-a ui-bar'>"+_("Station Type")+":</div><select data-mini='true' id='hs'"+(Station.isSpecial(e)?" class='ui-disabled'":"")+"><option data-hs='0' value='0'"+(Station.isSpecial(e)?"":"selected")+">"+_("Standard")+"</option><option data-hs='1' value='1'>"+_("RF")+"</option><option data-hs='2' value='2'>"+_("Remote")+"</option><option data-hs='3' value='3'"+(checkOSVersion(217)&&(void 0!==controller.settings.gpio&&controller.settings.gpio.length>0||"OSPi"===getHWVersion()||"2.3"===getHWVersion())?">":" disabled>")+_("GPIO")+"</option><option data-hs='4' value='4'"+(checkOSVersion(217)?">":" disabled>")+_("HTTP")+"</option></select><div id='specialOpts'></div>"),r+="</div>",r+="<input data-wrapper-class='attrib-submit' data-theme='b' type='submit' value='"+_("Submit")+"' /></form></fieldset></div>",r=$(r).enhanceWithin().on("submit","form",(function(){return a(e),!1})),Supported.groups()){var l=r.find("select.seqgrp"),d=r.find("span.seqgrp"),u=Station.getGIDValue(e),h=Station.isRunning(e),p=r.find("p#prohibit-change");h?(l.addClass("ui-state-disabled"),p.removeClass("hidden")):(l.removeClass("ui-state-disabled"),p.addClass("hidden"));for(var m=0;m<=NUM_SEQ_GROUPS;m++){var g=mapIndexToGIDValue(m),v=mapGIDValueToName(g),b=$("<option data-gid='"+g+"' value='"+g+"'>"+_(v)+"</option>");g===u?(b.prop("selected",!0),d.text(v)):b.prop("selected",!1),l.append(b)}}r.find("ul.tabs li").click((function(){var t=$(this).attr("data-tab");$("ul.tabs li").removeClass("current"),$(".tab-content").removeClass("current"),$(this).addClass("current"),$("#"+t).addClass("current")})),r.find("#hs").on("change",(function(){return function(t){var i=r.find("#specialOpts"),n=controller.special&&controller.special.hasOwnProperty(e)?controller.special[e].sd:"",o=controller.special&&controller.special.hasOwnProperty(e)?controller.special[e].st:0;if(i.empty(),0===t)i.append("<p class='special-desc center small'>"+_("Select the station type using the dropdown selector above and configure the station properties.")+"</p>").enhanceWithin();else if(1===t)n=o===t?n:"0000000000000000",i.append("<div class='ui-bar-a ui-bar'>"+_("RF Code")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='rf-code' required='true' type='text' value='"+n+"'>").enhanceWithin();else if(2===t)n=parseRemoteStationData(o===t?n:"00000000005000"),i.append("<div class='ui-bar-a ui-bar'>"+_("Remote Address")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='remote-address' required='true' type='text' pattern='^(?:[0-9]{1,3}.){3}[0-9]{1,3}$' value='"+n.ip+"'><div class='ui-bar-a ui-bar'>"+_("Remote Port")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='remote-port' required='true' type='number' placeholder='80' min='0' max='65535' value='"+n.port+"'><div class='ui-bar-a ui-bar'>"+_("Remote Station (index)")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='remote-station' required='true' type='number' min='1' max='200' placeholder='1' value='"+(n.station+1)+"'>").enhanceWithin();else if(3===t){var a,l=5,c=1,d=[];if(controller.settings.gpio?d=controller.settings.gpio:"OSPi"===getHWVersion()?d=[5,6,7,8,9,10,11,12,13,16,18,19,20,21,23,24,25,26]:"2.3"===getHWVersion()&&(d=[2,10,12,13,14,15,18,19]),o===t&&(n=n.split(""),l=parseInt(n[0]+n[1]),c=parseInt(n[2])),d.length){a="<div class='ui-bar-a ui-bar'>"+_("GPIO Pin")+":</div><select class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='gpio-pin'>";for(var u=0;u<d.length;u++)a+="<option value='"+d[u]+"' "+(d[u]===l?"selected='selected'":"")+">"+d[u];a+="</select>"}else a="";a+="<div class='ui-bar-a ui-bar'>"+_("Active State")+":</div><select class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='active-state'><option value='1' "+(1===c?"selected='selected'":"")+">"+_("HIGH")+"<option value='0' "+(0===c?"selected='selected'":"")+">"+_("LOW")+"</select>",i.append(a).enhanceWithin()}else 4===t&&(n=o===t?n.split(","):["server","80","On","Off"],i.append("<div class='ui-bar-a ui-bar'>"+_("Server Name")+":</div><input class='center  validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-server' required='true' type='text' value='"+n[0]+"'><div class='ui-bar-a ui-bar'>"+_("Server Port")+":</div><input class='center  validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-port' required='true' type='number' min='0' max='65535' value='"+parseInt(n[1])+"'><div class='ui-bar-a ui-bar'>"+_("On Command")+":</div><input class='center validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-on' required='true' type='text' value='"+n[2]+"'><div class='ui-bar-a ui-bar'>"+_("Off Command")+":</div><input class='center validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-off' required='true' type='text' value='"+n[3]+"'><div class='center smaller' id='character-tracking' style='color:#999;'><p>"+_("Note: There is a limit on the number of character used to configure this station type.")+"</p><span>"+_("Characters remaining")+": </span><span id='character-count'>placeholder</span></div>").enhanceWithin(),s(),$(".validate-length").on("input",s))}(parseInt($(this).val())),!1})),Station.isSpecial(e)?updateControllerStationSpecial((function(){r.find("#hs").removeClass("ui-disabled").find("option[data-hs='"+controller.special[e].st+"']").prop("selected",!0),r.find("#hs").change()})):(r.find("#hs").removeClass("ui-disabled"),r.find("option[data-hs='0']").prop("selected",!0),r.find("#hs").change()),r.find(".changeBackground").on("click",(function(t){t.preventDefault();var n=this;takePicture((function(t){o[i].images[e]=t,storage.set({sites:JSON.stringify(o)},cloudSaveSites),f(),n.innerHTML=_("Change")+" "+_("Image")}))})),$.mobile.pageContainer.append(r);var y={history:!1};if(isiOS){var w=getPageTop();y.x=w.x,y.y=w.y}else y.positionTo="window";r.popup(y).popup("open")},c=function(t){var e,i,n,o,a,r=!0===checkOSVersion(208),l={},c={},d={},u={},h={},p={},f={},m={},g={},v={};for(i=0;i<controller.settings.nbrd;i++)for(Supported.master(MASTER_STATION_1)&&(l["m"+i]=0),Supported.master(MASTER_STATION_2)&&(c["n"+i]=0),Supported.sequential()&&(d["q"+i]=0),Supported.special()&&(u["p"+i]=0),Supported.ignoreRain()&&(h["i"+i]=0),Supported.ignoreSensor(IGNORE_SENSOR_1)&&(p["j"+i]=0),Supported.ignoreSensor(IGNORE_SENSOR_2)&&(f["k"+i]=0),Supported.actRelay()&&(m["a"+i]=0),Supported.disabled()&&(g["d"+i]=0),a=0;a<8;a++)n=8*i+a,e=s.find("#attrib-"+n),Supported.master(MASTER_STATION_1)&&(l["m"+i]=l["m"+i]+(e.data("um")<<a)),Supported.master(MASTER_STATION_2)&&(c["n"+i]=c["n"+i]+(e.data("um2")<<a)),Supported.sequential()&&(d["q"+i]=d["q"+i]+(e.data("us")<<a)),Supported.special()&&(u["p"+i]=u["p"+i]+((e.data("hs")?1:0)<<a)),Supported.ignoreRain()&&(h["i"+i]=h["i"+i]+(e.data("ir")<<a)),Supported.ignoreSensor(IGNORE_SENSOR_1)&&(p["j"+i]=p["j"+i]+(e.data("sn1")<<a)),Supported.ignoreSensor(IGNORE_SENSOR_2)&&(f["k"+i]=f["k"+i]+(e.data("sn2")<<a)),Supported.actRelay()&&(m["a"+i]=m["a"+i]+(e.data("ar")<<a)),Supported.disabled()&&(g["d"+i]=g["d"+i]+(e.data("sd")<<a)),n===t&&(v["s"+n]=r?s.find("#station_"+n).text().replace(/\s/g,"_"):s.find("#station_"+n).text(),Supported.special()&&e.data("hs")&&(u.st=e.data("hs"),u.sd=e.data("specialData"),u.sid=t),Supported.groups()&&(o=e.attr("data-gid")));$.mobile.loading("show"),sendToOS("/cs?pw=&"+$.param(v)+(Supported.master(MASTER_STATION_1)?"&"+$.param(l):"")+(Supported.master(MASTER_STATION_2)?"&"+$.param(c):"")+(Supported.sequential()?"&"+$.param(d):"")+(Supported.special()?"&"+$.param(u):"")+(Supported.ignoreRain()?"&"+$.param(h):"")+(Supported.ignoreSensor(IGNORE_SENSOR_1)?"&"+$.param(p):"")+(Supported.ignoreSensor(IGNORE_SENSOR_2)?"&"+$.param(f):"")+(Supported.actRelay()?"&"+$.param(m):"")+(Supported.disabled()?"&"+$.param(g):"")+(Supported.groups()?"&g"+t+"="+o:"")).done((function(){showerror(_("Stations have been updated")),updateController((function(){$("html").trigger("datarefresh")}))}))},d=function(){timers.clock={val:controller.settings.devt,update:function(){s.find("#clock-s").text(dateToString(new Date(1e3*this.val),null,1))}}},u=function(t,e){var i=$(t),n=$(e),o=Card.getSID(i),s=Card.getSID(n),a=Station.isMaster(o)>0?1:0,r=Station.isMaster(s)>0?1:0;if(a>r)return-1;if(a<r)return 1;var l=Station.getGIDValue(Card.getSID(i)),c=Station.getGIDValue(Card.getSID(n));if(l<c)return-1;if(l>c)return 1;var d=Station.getStatus(o),u=Station.getStatus(s);return d>u?-1:d<u?1:o<s?-1:o>s?1:0},h=function(t,e){var i=$(t),n=$(e),o=Card.getSID(i),s=Card.getSID(n),a=Station.getStatus(o),r=Station.getStatus(s);return a>r?-1:a<r?1:o<s?-1:o>s?1:0},p=function(){var t=s.find("#os-stations-list"),e=t.children(),i=groupView?u:h;e.sort(i).detach().appendTo(t),Supported.groups()&&groupView?function(t,e){var i,n,o,s,a;for(a=0;a<t.children().length;a++)i=CardList.getCardByIndex(e,a),Card.setGroupLabel(i,Card.getGIDName(i));for(a=0;a<t.children().length-1;a++)i=CardList.getCardByIndex(e,a),n=CardList.getCardByIndex(e,a+1),o=Card.getDivider(i),s=Card.getGroupLabel(i),Card.isMasterStation(i)?(Card.isMasterStation(n)?o.hide():o.show(),s.addClass("hidden")):Station.getGIDValue(Card.getSID(i))!==Station.getGIDValue(Card.getSID(n))?o.show():o.hide();Card.getDivider(n).show(),Card.setGroupLabel(n,Card.getGIDName(n))}(t,e):function(t,e){var i,n,o,s,a;for(a=0;a<t.children().length-1;a++)i=CardList.getCardByIndex(e,a),n=CardList.getCardByIndex(e,a+1),(o=Card.getDivider(i)).hide(),Card.setGroupLabel(i,mapGIDValueToName(Station.getGIDValue(a))),void 0!==(s=Card.getGroupLabel(i))&&Card.isMasterStation(i)&&s.addClass("hidden"),Station.isRunning(Card.getSID(i))&&!Station.isRunning(Card.getSID(n))&&o.show();Card.getDivider(n).hide(),Card.setGroupLabel(n,mapGIDValueToName(Station.getGIDValue(a))),void 0!==(s=Card.getGroupLabel(n))&&Card.isMasterStation(n)&&s.addClass("hidden")}(t,e)},f=function(){var n,l,c,u,h,f,g,v,b=s.find("#os-stations-list"),y=b.children();if(s.hasClass("ui-page-active")){d(),m(),updateSensorShowArea(s),s.find(".waterlevel").text(controller.options.wl),s.find(".sitename").text(e.val()),CardList.getAllCards(y).filter((function(t,e){return parseInt($(e).data("station"),10)>=controller.stations.snames.length})).remove();for(var w=0;w<controller.stations.snames.length;w++)n=Station.getPID(w)>0,l=Station.getStatus(w)>0,c=n?pidname(Station.getPID(w)):"",u=Station.getRemainingRuntime(w),h=StationQueue.isPaused(),v=!!o[i].images[w],f=CardList.getCardBySID(y,w),Card.getDivider(f),0===f.length?(t="",r(w),b.append(t)):(f.find(".ui-body > img").attr("src",v?"data:image/jpeg;base64,"+o[i].images[w]:getAppURLPath()+"img/placeholder.png"),Station.isDisabled(w)?(s.hasClass("show-hidden")||f.hide(),f.addClass("station-hidden")):f.show().removeClass("station-hidden"),f.find("#station_"+w).text(controller.stations.snames[w]),f.find(".special-station").removeClass("hidden").addClass(Station.isSpecial(w)?"":"hidden"),f.find(".station-status").removeClass("on off wait").addClass(l?"on":n?"wait":"off"),Station.isMaster(w)?f.find(".station-settings").removeClass("ui-icon-gear").addClass("ui-icon-master"):f.find(".station-settings").removeClass("ui-icon-master").addClass("ui-icon-gear"),f.find(".station-settings").data({um:Supported.master(MASTER_STATION_1)?StationAttribute.getMasterOperation(w,MASTER_STATION_1):void 0,um2:Supported.master(MASTER_STATION_2)?StationAttribute.getMasterOperation(w,MASTER_STATION_2):void 0,ir:Supported.ignoreRain()?StationAttribute.getIgnoreRain(w):void 0,sn1:Supported.ignoreSensor(IGNORE_SENSOR_1)?StationAttribute.getIgnoreSensor(w,IGNORE_SENSOR_1):void 0,sn2:Supported.ignoreSensor(IGNORE_SENSOR_2)?StationAttribute.getIgnoreSensor(w,IGNORE_SENSOR_2):void 0,ar:Supported.actRelay()?StationAttribute.getActRelay(w):void 0,sd:Supported.disabled()?StationAttribute.getDisabled(w):void 0,us:Supported.sequential()?StationAttribute.getSequential(w):void 0,hs:Supported.special()?StationAttribute.getSpecial(w):void 0,gid:Supported.groups()?Station.getGIDValue(w):void 0}),Station.isMaster(w)||!n&&!l?f.find(".rem").remove():(g=l?_("Running")+" "+c:_("Scheduled")+" "+(Station.getStartTime(w)?_("for")+" "+dateToString(new Date(1e3*Station.getStartTime(w))):c),u>0&&(g+=" <span id="+(h?"'pause":"'countdown-")+w+"' class='nobr'>("+sec2hms(u)+" "+_("remaining")+")</span>",controller.status[w]&&a(w,u)),0===f.find(".rem").length?f.find(".ui-body").append("<p class='rem center'>"+g+"</p>"):f.find(".rem").html(g)));p()}},m=function(t){t=t||function(){},i=e.val(),storage.get("sites",(function(e){"object"!=typeof(o=parseSites(e.sites))[i].images||$.isEmptyObject(o[i].images)?(o[i].images={},s.removeClass("has-images")):s.addClass("has-images"),"object"!=typeof o[i].notes&&(o[i].notes={}),"object"!=typeof o[i].lastRunTime&&(o[i].lastRunTime={}),t()}))};return s.one("pageshow",(function(){$("html").on("datarefresh",f)})),function(a){if(!isControllerConnected())return!1;t="",e=$("#site-selector"),m((function(){for(n=0;n<controller.stations.snames.length;n++)r(n);s.find("#os-stations-list").html(t),p()})),s.find(".sitename").toggleClass("hidden",!!currLocal).text(e.val()),s.find(".waterlevel").text(controller.options.wl),updateSensorShowArea(s),d(),s.on("click",".station-settings",l),s.on("click",".home-info",(function(){return changePage("#os-options",{expandItem:"weather"}),!1})),s.on("click",".card",(function(){if(!checkOSVersion(210))return!1;var t,e=$(this),n=Card.getSID(e),s=Card.getGIDValue(e),a=Station.getStatus(n),r=Station.getName(n),l={};if(Station.isMaster(n))return!1;if(l.type=dialog.REMOVE_STATION,l.station=n,l.gid=s,a)t=_("Do you want to stop the selected station?");else{if(!e.find("span.nobr").length)return void showDurationBox({title:r,incrementalUpdate:!1,maximum:65535,seconds:o[i].lastRunTime[n]>0?o[i].lastRunTime[n]:0,helptext:_("Enter a duration to manually run ")+r,callback:function(t){sendToOS("/cm?sid="+n+"&en=1&t="+t+"&pw=","json").done((function(){Station.setPID(n,MANUAL_STATION_PID),Station.setRemainingRuntime(n,t),refreshStatus(),showerror(_("Station has been queued")),o[i].lastRunTime[n]=t,storage.set({sites:JSON.stringify(o)},cloudSaveSites)}))}});t=_("Do you want to unschedule the selected station?")}areYouSure(t,Station.getName(n),(function(){var t=!0===popupData.shift?1:0;sendToOS("/cm?sid="+n+"&ssta="+t+"&en=0&pw=").done((function(){Station.setPID(n,0),Station.setRemainingRuntime(n,0),Station.setStatus(n,0),delete timers["station-"+n],refreshStatus(),showerror(_("Station has been stopped"))}))}),null,l)})).on("click","img",(function(){var t=$(this),e=t.parents(".card").data("station");return-1!==t.attr("src").indexOf("data:image/jpeg;base64")?areYouSure(_("Do you want to delete the current image?"),"",(function(){delete o[i].images[e],storage.set({sites:JSON.stringify(o)},cloudSaveSites),f()})):takePicture((function(t){o[i].images[e]=t,storage.set({sites:JSON.stringify(o)},cloudSaveSites),f()})),!1})).on({pagebeforeshow:function(){var t=changeHeader({class:"logo",leftBtn:{icon:"bullets",on:function(){return openPanel(),!1}},rightBtn:{icon:"bell",class:"notifications",text:"<span class='notificationCount ui-li-count ui-btn-corner-all'>"+notifications.length+"</span>",on:function(){return showNotifications(),!1}},animate:!a});0===notifications.length&&$(t[2]).hide()}}),$("#sprinklers").remove(),$.mobile.pageContainer.append(s),$.isEmptyObject(weather)||updateWeatherBox()}}(),showStart=function(){var t=$("<div data-role='page' id='start'><ul data-role='none' id='welcome_list' class='ui-listview ui-listview-inset ui-corner-all'><li><div class='logo' id='welcome_logo'></div></li><li class='ui-li-static ui-body-inherit ui-first-child ui-last-child ui-li-separate'><p class='rain-desc'>"+_("Welcome to the OpenSprinkler application. This app only works with the OpenSprinkler controller which must be installed and setup on your home network.")+"</p><a class='iab iabNoScale ui-btn ui-mini center' target='_blank' href='https://opensprinkler.com/product/opensprinkler/'>"+_("Purchase OpenSprinkler")+"</a></li><li class='ui-first-child ui-last-child'><a href='#' class='ui-btn center cloud-login'>"+_("OpenSprinkler.com Login")+"</a></li><hr class='content-divider'><li id='auto-scan' class='ui-first-child'><a href='#' class='ui-btn ui-btn-icon-right ui-icon-carat-r'>"+_("Scan For Device")+"</a></li><li class='ui-first-child ui-last-child'><a class='ui-btn ui-btn-icon-right ui-icon-carat-r' data-rel='popup' href='#addnew'>"+_("Add Controller")+"</a></li></ul></div>"),e=function(){updateDeviceIP((function(t){void 0!==t&&isLocalIP(t)?(o.removeClass("ui-first-child").find("a.ui-btn").text(_("Manually Add Device")),n.show()):i()}))},i=function(){o.addClass("ui-first-child").find("a.ui-btn").text(_("Add Controller")),n.hide()},n=t.find("#auto-scan"),o=n.next();return t.find("#auto-scan").find("a").on("click",(function(){return startScan(),!1})),t.find("a[href='#addnew']").on("click",(function(){showAddNew()})),t.find(".cloud-login").on("click",(function(){return requestCloudAuth(),!1})),t.on("pagehide",(function(){t.detach()})),function(){if(isControllerConnected())return!1;$("#start").remove(),$.mobile.pageContainer.append(t),e()}}();function showGuidedSetup(){}function parseRemoteStationData(t){t=t.split("");for(var e,i=[],n={},o=0;o<8;o++)e=parseInt(t[o]+t[o+1],16)||0,i.push(e),o++;return n.ip=i.join("."),n.port=parseInt(t[8]+t[9]+t[10]+t[11],16),n.station=parseInt(t[12]+t[13],16),n}function verifyRemoteStation(t,e){t=parseRemoteStationData(t),$.ajax({url:"http://"+t.ip+":"+t.port+"/jo?pw="+encodeURIComponent(currPass),type:"GET",dataType:"json"}).then((function(t){"object"==typeof t&&t.hasOwnProperty("fwv")?1===Object.keys(t).length?e(-2):t.hasOwnProperty("re")&&0!==t.re?e(!0):e(-3):e(-1)}),(function(){e(!1)}))}function convertRemoteToExtender(t){t=parseRemoteStationData(t),$.ajax({url:"http://"+t.ip+":"+t.port+"/cv?re=1&pw="+encodeURIComponent(currPass),type:"GET",dataType:"json"})}function refreshStatus(t){if(isControllerConnected()){t=t||function(){};var e=function(){$("html").trigger("datarefresh"),checkStatus(),t()};checkOSVersion(216)?updateController((function(){checkOSVersion(230)?updateAnalogSensor((function(){updateProgramAdjustments(e)})):e()}),networkFail):$.when(updateControllerStatus(),updateControllerSettings(),updateControllerOptions()).then(e,networkFail)}}function refreshData(){isControllerConnected()&&(checkOSVersion(216)?updateController(null,networkFail):$.when(updateControllerPrograms(),updateControllerStations()).fail(networkFail))}function changeStatus(t,e,i,n){var o=$("#footer-running"),s="";n=n||function(){},t>1&&(timers.statusbar={val:t,type:"statusbar",update:function(){$("#countdown").text("("+sec2hms(this.val)+" "+_("remaining")+")")}}),isControllerConnected()&&void 0!==controller.settings.curr&&(s+=_("Current")+": "+controller.settings.curr+" mA "),!isControllerConnected()||2!==controller.options.urs&&2!==controller.options.sn1t||void 0===controller.settings.flcrt||void 0===controller.settings.flwrt||(s+="<span style='padding-left:5px'>"+_("Flow")+": "+(flowCountToVolume(controller.settings.flcrt)/(controller.settings.flwrt/60)).toFixed(2)+" L/min</span>"),s=""!==s?i+"<p class='running-text smaller center'>"+s+"</p>":i,o.removeClass().addClass(e).html(s).off("click").on("click",n)}function checkStatus(){var t,e,i,n,o,s,a;if(isControllerConnected())if(1!==controller.options.re)if(controller.settings.en){if(controller.settings.pq)return n="<p class='running-text center pointer'>"+_("Stations Currently Paused"),controller.settings.pt&&(n+=" <span id='countdown' class='nobr'>("+sec2hms(controller.settings.pt)+" "+_("remaining")+")</span>"),n+="</p>",void changeStatus(controller.settings.pt||0,"yellow",n,(function(){areYouSure(_("Do you want to resume station operation?"),"",(function(){showLoading("#footer-running"),sendToOS("/pq?pw=&dur=0").done((function(){setTimeout(refreshStatus,1e3)}))}))}));for(t={},a=0;a<controller.status.length;a++)controller.status[a]&&!Station.isMaster(a)&&(t[a]=controller.status[a]);if(Object.keys(t).length>=2){for(a in e=0,t)t.hasOwnProperty(a)&&(s=Station.getRemainingRuntime(a))>e&&(e=s);return i=Object.keys(t)[0],n="<div><div class='running-icon'></div><div class='running-text pointer'>",n+=pidname(Station.getPID(i))+" "+_("is running on")+" "+Object.keys(t).length+" "+_("stations")+" ",e>0&&(n+="<span id='countdown' class='nobr'>("+sec2hms(e)+" "+_("remaining")+")</span>"),void changeStatus(e,"green",n+="</div></div>",goHome)}for(o=!1,a=0;a<controller.stations.snames.length;a++)if(controller.settings.ps[a]&&Station.getPID(a)&&Station.getStatus(a)&&!Station.isMaster(a)){o=!0,n="<div><div class='running-icon'></div><div class='running-text pointer'>",n+=pidname(Station.getPID(a))+" "+_("is running on station")+" <span class='nobr'>"+Station.getName(a)+"</span> ",Station.getRemainingRuntime(a)>0&&(n+="<span id='countdown' class='nobr'>("+sec2hms(Station.getRemainingRuntime(a))+" "+_("remaining")+")</span>"),n+="</div></div>";break}if(o)changeStatus(Station.getRemainingRuntime(a),"green",n,goHome);else if(controller.settings.rd)changeStatus(0,"red","<p class='running-text center pointer'>"+_("Rain delay until")+" "+dateToString(new Date(1e3*controller.settings.rdst))+"</p>",(function(){areYouSure(_("Do you want to turn off rain delay?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&rd=0").done((function(){refreshStatus(updateWeather)}))}))}));else if(1!==controller.options.urs||1!==controller.settings.rs)if(1!==controller.settings.sn1)if(1!==controller.settings.sn2)if(1!==controller.settings.mm){var r=controller.settings.lrun[2];if(0===r)changeStatus(0,"transparent","<p class='running-text smaller center pointer'>"+_("System Idle")+"</p>",goHome);else changeStatus(0,"transparent","<p class='running-text smaller center pointer'>"+pidname(controller.settings.lrun[1])+" "+_("last ran station")+" "+controller.stations.snames[controller.settings.lrun[0]]+" "+_("for")+" "+(r/60>>0)+"m "+r%60+"s "+_("on")+" "+dateToString(new Date(1e3*(controller.settings.lrun[3]-r)))+"</p>",goHome)}else changeStatus(0,"red","<p class='running-text center pointer'>"+_("Manual mode enabled")+"</p>",(function(){areYouSure(_("Do you want to turn off manual mode?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&mm=0").done((function(){updateController()}))}))}));else changeStatus(0,"red","<p class='running-text center'>Sensor 2 ("+(3===controller.options.sn2t?_("Soil"):_("Rain"))+_(") Activated")+"</p>");else changeStatus(0,"red","<p class='running-text center'>Sensor 1 ("+(3===controller.options.sn1t?_("Soil"):_("Rain"))+_(") Activated")+"</p>");else changeStatus(0,"red","<p class='running-text center'>"+_("Rain detected")+"</p>")}else changeStatus(0,"red","<p class='running-text center pointer'>"+_("System Disabled")+"</p>",(function(){areYouSure(_("Do you want to re-enable system operation?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&en=1").done((function(){updateController()}))}))}));else changeStatus(0,"red","<p class='running-text center pointer'>"+_("Configured as Extender")+"</p>",(function(){areYouSure(_("Do you wish to disable extender mode?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&re=0").done((function(){updateController()}))}))}));else changeStatus(0,"transparent","<p class='running-text smaller'></p>")}function calculateTotalRunningTime(t){var e,i,n=controller.options.sdt;if(Supported.groups()){e=new Array(NUM_SEQ_GROUPS).fill(0),i=0;var o=0;$.each(controller.stations.snames,(function(o){var s=t[o],a=Station.getGIDValue(o);s>0&&(a!==PARALLEL_GID_VALUE?e[a]+=s+n:s>i&&(i=s))}));for(var s=0;s<NUM_SEQ_GROUPS;s++)e[s]>n&&(e[s]-=n),e[s]>o&&(o=e[s]);return Math.max(o,i)}return e=0,i=0,$.each(controller.stations.snames,(function(o){var s=t[o];s>0&&(Station.isSequential(o)?e+=s+n:s>i&&(i=s))})),e>n&&(e-=n),Math.max(e,i)}function updateTimers(){var t=(new Date).getTime();setInterval((function(){if(!isControllerConnected())return!1;var e=(new Date).getTime();if(e-t>2e3&&(checkStatus(),refreshStatus()),t=e,!$.isEmptyObject(timers))for(var i in timers)timers.hasOwnProperty(i)&&(timers[i].val<=0?("statusbar"===i&&(showLoading("#footer-running"),refreshStatus()),"function"==typeof timers[i].done&&timers[i].done(),delete timers[i]):"clock"===i?(++timers[i].val,timers[i].update()):"statusbar"!==i&&"number"!=typeof timers[i].station||(--timers[i].val,timers[i].update()))}),1e3)}function removeStationTimers(){for(var t in timers)timers.hasOwnProperty(t)&&"clock"!==t&&delete timers[t]}var getManual=function(){var t,e,i,n=$("<div data-role='page' id='manual'><div class='ui-content' role='main'><p class='center'>"+_("With manual mode turned on, tap a station to toggle it.")+"</p><fieldset data-role='collapsible' data-collapsed='false' data-mini='true'><legend>"+_("Options")+"</legend><div class='ui-field-contain'><label for='mmm'><b>"+_("Manual Mode")+"</b></label><input type='checkbox' data-on-text='On' data-off-text='Off' data-role='flipswitch' name='mmm' id='mmm'></div><p class='rain-desc smaller center' style='padding-top:5px'>"+_("Station timer prevents a station from running indefinitely and will automatically turn it off after the set duration (or when toggled off)")+"</p><div class='ui-field-contain duration-input'><label for='auto-off'><b>"+_("Station Timer")+"</b></label><button data-mini='true' name='auto-off' id='auto-off' value='3600'>1h</button></div></fieldset><div id='manual-station-list'></div></div></div>"),o=function(t){updateControllerStatus().done((function(){var e=i.eq(t).find("a");controller.options.mas&&(controller.status[controller.options.mas-1]?i.eq(controller.options.mas-1).addClass("green"):i.eq(controller.options.mas-1).removeClass("green")),e.text(controller.stations.snames[t]),controller.status[t]?e.removeClass("yellow").addClass("green"):e.removeClass("green yellow")}))},s=function(){if(!controller.settings.mm)return showerror(_("Manual mode is not enabled. Please enable manual mode then try again.")),!1;var e=$(this),n=e.closest("li"),s=i.index(n),r=s+1,l=a.val();return e.hasClass("yellow")||(t=controller.status[s]?checkOSPiVersion("2.1")?"/sn?sid="+r+"&set_to=0&pw=":"/sn"+r+"=0":checkOSPiVersion("2.1")?"/sn?sid="+r+"&set_to=1&set_time="+l+"&pw=":"/sn"+r+"=1&t="+l,e.removeClass("green").addClass("yellow"),e.html("<p class='ui-icon ui-icon-loading mini-load'></p>"),sendToOS(t).always((function(){setTimeout(o,1e3,s)}))),!1},a=n.find("#auto-off");return n.on("pagehide",(function(){n.detach()})),storage.get("autoOff",(function(t){t.autoOff&&(a.val(t.autoOff),a.text(dhms2str(sec2dhms(t.autoOff))))})),a.on("click",(function(){var t=$(this),e=n.find("label[for='"+t.attr("id")+"']").text();return showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e))),storage.set({autoOff:e})},maximum:32768}),!1})),n.find("#mmm").on("change",flipSwitched),function(){var t="<li data-role='list-divider' data-theme='a'>"+_("Sprinkler Stations")+"</li>";n.find("#mmm").prop("checked",!!controller.settings.mm),$.each(controller.stations.snames,(function(e,i){Station.isMaster(e)?t+="<li data-icon='false' class='center"+(controller.status[e]?" green":"")+(Station.isDisabled(e)?" station-hidden' style='display:none":"")+"'>"+i+" ("+_("Master")+")</li>":t+="<li data-icon='false'><a class='mm_station center"+(controller.status[e]?" green":"")+(Station.isDisabled(e)?" station-hidden' style='display:none":"")+"'>"+i+"</a></li>"})),e=$("<ul data-role='listview' data-inset='true' id='mm_list'>"+t+"</ul>"),i=e.children("li").slice(1),e.find(".mm_station").on("vclick",s),n.find("#manual-station-list").html(e).enhanceWithin(),changeHeader({title:_("Manual Control"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#manual").remove(),$.mobile.pageContainer.append(n)}}(),getRunonce=function(){var t,e,i,n,o,s,a,r,l=$("<div data-role='page' id='runonce'><div class='ui-content' role='main' id='runonce_list'></div></div>"),c=function(t){o.l=t,$("<option value='l' selected='selected'>"+_("Last Used Program")+"</option>").insertAfter(l.find("#rprog").find("option[value='t']")),u(t)},d=function(){return l.find("[id^='zone-']").val(0).text("0s").removeClass("green"),!1},u=function(t){l.find("[id^='zone-']").each((function(e,i){if(!Station.isMaster(e)){var n=$(i);n.val(t[e]).text(getDurationText(t[e])),t[e]>0?n.addClass("green"):n.removeClass("green")}}))};return l.on("pagehide",(function(){l.detach()})),function(){if(e="<p class='center'>"+_("Zero value excludes the station from the run-once program.")+"</p>",n=[],controller.programs.pd.length)for(s=0;s<controller.programs.pd.length;s++){a=readProgram(controller.programs.pd[s]);var h=[];if(checkOSVersion(210))h=a.stations;else{var p=a.stations.split("");for(t=0;t<controller.stations.snames.length;t++)h.push(parseInt(p[t])?a.duration:0)}n.push(h)}for(o=n,i="<select data-mini='true' name='rprog' id='rprog'><option value='t'>"+_("Test All Stations")+"</option><option value='s' selected='selected'>"+_("Quick Programs")+"</option>",t=0;t<n.length;t++)r=checkOSVersion(210)?controller.programs.pd[t][5]:_("Program")+" "+(t+1),i+="<option value='"+t+"'>"+r+"</option>";if(e+=(i+="</select>")+"<form>",$.each(controller.stations.snames,(function(t,i){Station.isMaster(t)?e+="<div class='ui-field-contain duration-input"+(Station.isDisabled(t)?" station-hidden' style='display:none":"")+"'><label for='zone-"+t+"'>"+i+":</label><button disabled='true' data-mini='true' name='zone-"+t+"' id='zone-"+t+"' value='0'>Master</button></div>":e+="<div class='ui-field-contain duration-input"+(Station.isDisabled(t)?" station-hidden' style='display:none":"")+"'><label for='zone-"+t+"'>"+i+":</label><button data-mini='true' name='zone-"+t+"' id='zone-"+t+"' value='0'>0s</button></div>"})),e+="</form><a class='ui-btn ui-corner-all ui-shadow rsubmit' href='#'>"+_("Submit")+"</a><a class='ui-btn ui-btn-b ui-corner-all ui-shadow rreset' href='#'>"+_("Reset")+"</a>",l.find(".ui-content").html(e).enhanceWithin(),"object"==typeof controller.settings.rodur){var f=0;for(t=0;t<controller.settings.rodur.length;t++)f+=controller.settings.rodur[t];0!==f&&c(controller.settings.rodur)}else storage.get("runonce",(function(t){(t=t.runonce)&&(t=JSON.parse(t),c(t))}));l.find("#rprog").on("change",(function(){var t=$(this).val();"s"!==t?"t"!==t?void 0!==o[t]&&u(o[t]):u(Array.apply(null,Array(controller.stations.snames.length)).map((function(){return 60}))):d()})),l.on("click",".rsubmit",submitRunonce).on("click",".rreset",d),l.find("[id^='zone-']").on("click",(function(){var t=$(this),e=l.find("label[for='"+t.attr("id")+"']").text().slice(0,-1);return showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e),t.text(getDurationText(e)),e>0?t.addClass("green"):t.removeClass("green")},maximum:65535,showSun:!!checkOSVersion(214)}),!1})),changeHeader({title:_("Run-Once"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack},rightBtn:{icon:"check",text:_("Submit"),on:submitRunonce}}),$("#runonce").remove(),$.mobile.pageContainer.append(l)}}();function submitRunonce(t){t instanceof Array||(t=[],$("#runonce").find("[id^='zone-']").each((function(){t.push(parseInt(this.value)||0)})),t.push(0));var e=function(){$.mobile.loading("show"),storage.set({runonce:JSON.stringify(t)}),sendToOS("/cr?pw=&t="+JSON.stringify(t)).done((function(){$.mobile.loading("hide"),$.mobile.document.one("pageshow",(function(){showerror(_("Run-once program has been scheduled"))})),refreshStatus(),goBack()}))},i=StationQueue.isActive();-1!==i?areYouSure(_("Do you want to stop the currently running program?"),pidname(Station.getPID(i)),(function(){$.mobile.loading("show"),stopStations(e)})):e()}var getPreview=function(){var t,e,i,n,o,s,a,r,l,c,d,u,h,p,f,m,g,v,b=$("<div data-role='page' id='preview'><div class='ui-content' role='main'><div id='preview_header' class='input_with_buttons'><button class='preview-minus ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input class='center' type='date' name='preview_date' id='preview_date'><button class='preview-plus ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div><div id='timeline'></div><div data-role='controlgroup' data-type='horizontal' id='timeline-navigation'><a class='ui-btn ui-corner-all ui-icon-plus ui-btn-icon-notext btn-no-border' title='"+_("Zoom in")+"'></a><a class='ui-btn ui-corner-all ui-icon-minus ui-btn-icon-notext btn-no-border' title='"+_("Zoom out")+"'></a><a class='ui-btn ui-corner-all ui-icon-carat-l ui-btn-icon-notext btn-no-border' title='"+_("Move left")+"'></a><a class='ui-btn ui-corner-all ui-icon-carat-r ui-btn-icon-notext btn-no-border' title='"+_("Move right")+"'></a></div></div></div>"),y=b.find("#timeline"),w=b.find("#timeline-navigation");return b.find("#preview_date").on("change",(function(){h=this.value.split("-"),p=new Date(h[0],h[1]-1,h[2]),u()})),b.one("pagebeforeshow",(function(){holdButton(b.find(".preview-plus"),(function(){d(1)})),holdButton(b.find(".preview-minus"),(function(){d(-1)}))})),b.on({pagehide:function(){b.detach()},pageshow:function(){u()}}),e=function(e,n,o){t=[];var s,a,c,d,u,h,p,f,b,y,_,w,x=Math.floor(controller.settings.devt/86400),k=0,S=Date.UTC(o,e-1,n,0,0,0,0),T=S/1e3/3600/24>>0,C=8*controller.settings.nbrd,D=new Array(C),M=new Array(C),O=new Array(C),P=new Array(C),E=[],A=new Array(C),I=0,L=0,N=new Array(NUM_SEQ_GROUPS);for(d=0;d<C;d++)D[d]=-1,M[d]=0,O[d]=0,P[d]=0,A[d]=255;for(h=0;h<NUM_SEQ_GROUPS;h++)N[h]=0;do{s=0,a=0;for(var j=0;j<controller.programs.pd.length;j++)if(c=controller.programs.pd[j],i(c,k,S,T,x))for(d=0;d<C;d++)if(b=d>>3,_=d%8,!Station.isMaster(d))if(m){if(controller.stations.stn_dis[b]&1<<_)continue;if(c[4][d]&&0===O[d]){var R=0;(R=2&c[0]&&(controller.options.uwt>0&&T===x||0===controller.options.uwt)?getStationDuration(c[4][d],S)*controller.options.wl/100>>0:getStationDuration(c[4][d],S))>0&&(v?E.length<C&&E.push({st:-1,dur:R,sid:d,pid:j+1,gid:controller.stations.stn_grp?controller.stations.stn_grp[d]:-1,pl:1}):(O[d]=R,M[d]=j+1),a=1)}}else c[7+b]&1<<_&&(O[d]=c[6]*controller.options.wl/100>>0,M[d]=j+1,a=1);if(a){var $=60*k,B=$,F=new Array(NUM_SEQ_GROUPS);if(g){for(L>$&&(B=L+controller.options.sdt),h=0;h<NUM_SEQ_GROUPS;h++)F[h]=$,N[h]>$&&(F[h]=N[h]+controller.options.sdt);if(v)for(u=0;u<E.length;u++)(p=E[u]).st>=0||0===p.dur||(y=(d=p.sid)>>3,w=7&d,-1===p.gid?controller.stations.stn_seq[y]&1<<w?(p.st=B,B+=p.dur,B+=controller.options.sdt):(p.st=$,$++):p.gid!==PARALLEL_GID_VALUE?(p.st=F[p.gid],F[p.gid]+=p.dur,F[p.gid]+=controller.options.sdt):(p.st=$,$++),s=1);else for(d=0;d<C;d++)y=d>>3,w=7&d,0===O[d]||D[d]>=0||(controller.stations.stn_seq[y]&1<<w?(D[d]=B,B+=O[d],O[d]=B,B+=controller.options.sdt,P[d]=1):(D[d]=$,O[d]=$+O[d],P[d]=1),s=1)}else if(m&&controller.options.seq&&I>$&&($=I+controller.options.sdt),controller.options.seq)for(d=0;d<8*controller.settings.nbrd;d++)0!==O[d]&&0!==M[d]&&(D[d]=$,$+=O[d],O[d]=$,$+=controller.options.sdt,s=1);else for(d=0;d<8*controller.settings.nbrd;d++)0!==O[d]&&0!==M[d]&&(D[d]=$,O[d]=$+O[d],s=1)}if(v){for(u=0;u<E.length;u++)(f=A[d=(p=E[u]).sid])<255&&E[f].st<p.st||(A[d]=u);for(l(60*k,E,A,S),k++,d=0;d<8*controller.settings.nbrd;d++)if(255!==(f=A[d])&&(p=E[f]).st>=0&&60*k>=p.st+p.dur){var H=E.length;f<H-1&&(E[f]=E[H-1],A[E[f].sid]===H-1&&(A[E[f].sid]=f)),E.pop(),A[d]=255}for(L=0,h=0;h<NUM_SEQ_GROUPS;h++)L[h]=0;for(u=0;u<E.length;u++){y=(d=(p=E[u]).sid)>>3,w=7&d;var W=p.st+p.dur;-1===p.gid?controller.stations.stn_seq[y]&1<<w&&W>L&&(L=W):p.gid!==PARALLEL_GID_VALUE&&W>N[p.gid]&&(N[p.gid]=W)}}else if(s)if(g)for(L=r(60*k,D,M,O,P,S),k++,d=0;d<8*controller.settings.nbrd;d++)M[d]>0&&60*k>=O[d]&&(D[d]=-1,M[d]=0,O[d]=0,P[d]=0);else if(m)for(I=r(60*k,D,M,O,P,S),k++,d=0;d<8*controller.settings.nbrd;d++)D[d]=-1,M[d]=0,O[d]=0;else{var U=r(60*k,D,M,O,P,S)/60>>0;for(controller.options.seq&&k!==U?k=U:k++,d=0;d<8*controller.settings.nbrd;d++)D[d]=-1,M[d]=0,O[d]=0}else if(k++,g)for(d=0;d<8*controller.settings.nbrd;d++)M[d]>0&&60*k>=O[d]&&(D[d]=-1,M[d]=0,O[d]=0,P[d]=0)}while(k<1440)},l=function(e,i,n,o){for(var s=0;s<8*controller.settings.nbrd;s++){var a=n[s];if(255!==a){var r=i[a];if(r.pl){var l=void 0!==controller.options.mas2,d=controller.stations.masop[s>>3]&1<<s%8,u=!!l&&controller.stations.masop2[s>>3]&1<<s%8;Station.isMaster(s)||(controller.options.mas>0&&d&&t.push({start:r.st+controller.options.mton,end:r.st+r.dur+controller.options.mtof,content:"",className:"master",shortname:"M"+(l?"1":""),group:"Master",station:s}),l&&controller.options.mas2>0&&u&&t.push({start:r.st+controller.options.mton2,end:r.st+r.dur+controller.options.mtof2,content:"",className:"master",shortname:"M2",group:"Master 2",station:s})),c(s,r.st,r.pid,r.st+r.dur,o),r.pl=0}}}},r=function(e,i,n,o,s,a){for(var r=e,l=0;l<8*controller.settings.nbrd;l++)if(n[l])if(g){if(s[l]){var d=void 0!==controller.options.mas2,u=controller.stations.masop[l>>3]&1<<l%8,h=!!d&&controller.stations.masop2[l>>3]&1<<l%8;Station.isMaster(l)||(controller.options.mas>0&&u&&t.push({start:i[l]+controller.options.mton,end:o[l]+controller.options.mtof,content:"",className:"master",shortname:"M"+(d?"1":""),group:"Master",station:l}),d&&controller.options.mas2>0&&h&&t.push({start:i[l]+controller.options.mton2,end:o[l]+controller.options.mtof2,content:"",className:"master",shortname:"M2",group:"Master 2",station:l})),c(l,i[l],n[l],o[l],a),s[l]=0,controller.stations.stn_seq[l>>3]&1<<(7&l)&&(r=r>o[l]?r:o[l])}}else 1===controller.options.seq?(Station.isMaster(l)&&controller.stations.masop[l>>3]&1<<l%8&&t.push({start:i[l]+controller.options.mton,end:o[l]+controller.options.mtof,content:"",className:"master",shortname:"M",group:"Master",station:l}),c(l,i[l],n[l],o[l],a),r=o[l]):(c(l,e,n[l],o[l],a),Station.isMaster(l)&&controller.stations.masop[l>>3]&1<<l%8&&(r=r>o[l]?r:o[l]));return g||0===controller.options.seq&&controller.options.mas>0&&t.push({start:e,end:r,content:"",className:"master",shortname:"M",group:"Master",station:l}),r},c=function(e,i,n,o,s){var a="program-"+(n+3)%4,r="P"+n;(0!==controller.settings.rd&&s+i+900*(controller.options.tz-48)<=1e3*controller.settings.rdst||1===controller.options.urs&&1===controller.settings.rs)&&"object"==typeof controller.stations.ignore_rain&&0==(controller.stations.ignore_rain[e/8>>0]&1<<e%8)&&(a="delayed"),checkOSVersion(210)&&(r=controller.programs.pd[n-1][5]),t.push({start:i,end:o,className:a,content:r,pid:n-1,shortname:"S"+(e+1),group:controller.stations.snames[e],station:e})},i=function(t,e,i,s,r){return v?a(t,e,i,s,r):m?o(t,e,i,s,r):n(t,e,i,s,r)},n=function(t,e,i,n,o){if(0===t[0])return 0;if(128&t[1]&&t[2]>1){var s=t[2];if(n%s!=(o+(127&t[1]))%s)return 0}else{var a=new Date(i),r=(a.getUTCDay()+6)%7;if(0==(t[1]&1<<r))return 0;var l=a.getUTCDate();if(128&t[1]&&0===t[2]&&l%2!=0)return 0;if(128&t[1]&&1===t[2]&&(31===l||29===l&&1===a.getUTCMonth()||l%2!=1))return 0}return e<t[3]||e>t[4]||isOSPi()&&e>=t[4]||0===t[5]?0:((e-t[3])/t[5]>>0)*t[5]==e-t[3]?1:0},s=function(t,e,i,n){var o=t[0]>>2&3,s=t[0]>>4&3,a=new Date(e),r=a.getUTCDate(),l=a.getUTCMonth()+1,c=t[6];if("object"==typeof c&&c[0]){var d=(l<<5)+r;if(c[1]<=c[2]){if(d<c[1]||d>c[2])return 0}else if(d>c[2]&&d<c[1])return 0}if(3===s){var u=t[2];if(i%u!=(n+t[1])%u)return 0}else{if(0!==s)return 0;var h=(a.getUTCDay()+6)%7;if(0==(t[1]&1<<h))return 0}if(2===o){if(r%2!=0)return 0}else if(1===o&&(31===r||29===r&&1===a.getUTCMonth()||r%2!=1))return 0;return 1},o=function(t,e,i,n,o){var a=1&t[0],r=t[0]>>6&1,l=new Date(i);if(0===a)return 0;if(!s(t,i,n,o))return 0;if(0===r){var c=getStartTime(t[3][0],l),d=t[3][1],u=t[3][2];if(e<c)return 0;if(0===d)return e===c?1:0;if(0===u)return 0;var h=Math.round((e-c)/u);if(h*u==e-c&&h<=d)return 1}else for(var p=t[3],f=0;f<4;f++)if(e===getStartTime(p[f],l))return 1;return 0},a=function(t,e,i,n,o){var a=1&t[0],r=t[0]>>6&1,l=new Date(i);if(0===a)return 0;var c,d=getStartTime(t[3][0],l),u=t[3][1],h=t[3][2];if(s(t,i,n,o)){if(0!==r){for(var p=t[3],f=0;f<4;f++)if(e===getStartTime(p[f],l))return 1;return 0}if(e===d)return 1;if(e>d&&h&&(c=Math.round((e-d)/h))*h==e-d&&c<=u)return 1}return r||!h?0:s(t,i-864e5,n-1,o)&&(c=Math.round((e-d+1440)/h))*h==e-d+1440&&c<=u?1:0},d=function(t){p.setDate(p.getDate()+t);var e=pad(p.getMonth()+1),i=pad(p.getDate()),n=p.getFullYear();h=[n,e,i],b.find("#preview_date").val(h.join("-")),u()},u=function(){if(e(h[1],h[2],h[0]),w.hide(),t.length){t.sort(sortByStation);var i=[],n=new Date(h[0],h[1]-1,h[2],24);$.each(t,(function(){var t=this.start+this.end;if(this.start=new Date(h[0],h[1]-1,h[2],0,0,this.start),t>86400){var e=Math.floor(this.end/86400);this.end=new Date(h[0],h[1]-1,parseInt(h[2])+e,0,0,this.end%86400),n=n>this.end?n:this.end}else this.end=new Date(h[0],h[1]-1,h[2],0,0,this.end);i[this.group]=this.shortname}));var o={width:"100%",editable:!1,axisOnTop:!0,eventMargin:10,eventMarginAxis:0,min:new Date(h[0],h[1]-1,h[2],0),max:n,selectable:!0,showMajorLabels:!1,zoomMax:864e5,zoomMin:36e5,groupsChangeable:!1,showNavigation:!1,groupsOrder:"none",groupMinHeight:20},s=function(){a.redraw()},a=new links.Timeline(y[0],o),r=new Date(f);r.setMinutes(r.getMinutes()+r.getTimezoneOffset()),a.setCurrentTime(r),links.events.addListener(a,"select",(function(){var t=a.getSelection();t.length&&void 0!==t[0].row&&changePage("#programs",{programToExpand:parseInt(a.getItem(t[0].row).pid)})})),$.mobile.window.on("resize",s),b.one("pagehide",(function(){$.mobile.window.off("resize",s)})),a.draw(t),b.find(".timeline-groups-text").each((function(){var t=$(this),e=i[t.text()];t.attr("data-shortname",e)})),b.find(".timeline-groups-axis").children().first().html("<div class='timeline-axis-text center dayofweek' data-shortname='"+getDayName(p,"short")+"'>"+getDayName(p)+"</div>"),isAndroid?(w.find(".ui-icon-plus").off("click").on("click",(function(){return a.zoom(.4),!1})),w.find(".ui-icon-minus").off("click").on("click",(function(){return a.zoom(-.4),!1})),w.find(".ui-icon-carat-l").off("click").on("click",(function(){return a.move(-.2),!1})),w.find(".ui-icon-carat-r").off("click").on("click",(function(){return a.move(.2),!1})),w.show()):w.hide(),y.on("swiperight swipeleft",(function(t){t.stopImmediatePropagation()}))}else b.find("#timeline").html("<p align='center'>"+_("No stations set to run on this day.")+"</p>")},function(){m=checkOSVersion(210),g=checkOSVersion(211),v=checkOSVersion(216),""===b.find("#preview_date").val()&&(f=new Date(1e3*controller.settings.devt),h=f.toISOString().slice(0,10).split("-"),p=new Date(h[0],h[1]-1,h[2]),b.find("#preview_date").val(h.join("-"))),changeHeader({title:_("Program Preview"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#preview").remove(),$.mobile.pageContainer.append(b)}}();function getStationDuration(t,e){if(checkOSVersion(214)){var i=getSunTimes(e);65535===t?t=60*(i[0]+1440-i[1]):65534===t&&(t=60*(i[1]-i[0]))}return t}var getLogs=function(){var t,e,i,n=$("<div data-role='page' id='logs'><div class='ui-content' role='main'><fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' class='log_type'><input data-mini='true' type='radio' name='log_type' id='log_timeline' value='timeline'><label for='log_timeline'>"+_("Timeline")+"</label><input data-mini='true' type='radio' name='log_type' id='log_table' value='table'><label for='log_table'>"+_("Table")+"</label></fieldset><fieldset data-role='collapsible' data-mini='true' id='log_options' class='center'><legend>"+_("Options")+"</legend><fieldset data-role='controlgroup' data-type='horizontal' id='table_sort'><p class='tight'>"+_("Grouping:")+"</p><input data-mini='true' type='radio' name='table-group' id='table-sort-day' value='day' checked='checked'><label for='table-sort-day'>"+_("Day")+"</label><input data-mini='true' type='radio' name='table-group' id='table-sort-station' value='station'><label for='table-sort-station'>"+_("Station")+"</label></fieldset><div class='ui-field-contain'><label for='log_start'>"+_("Start:")+"</label><input data-mini='true' type='date' id='log_start'><label for='log_end'>"+_("End:")+"</label><input data-mini='true' type='date' id='log_end'></div><a data-role='button' data-icon='action' class='export_logs' href='#' data-mini='true'>"+_("Export")+"</a><a data-role='button' class='red clear_logs' href='#' data-mini='true' data-icon='alert'>"+_("Clear Logs")+"</a></fieldset><div id='logs_list' class='center'></div></div></div>"),o=n.find("#logs_list"),s=n.find("#table_sort"),a=n.find("#log_options"),r=[],l=[],c=[],d=function(e,n){var o=[],s={totalRuntime:0,totalCount:0};if("table"===e&&"station"===n)for(i=0;i<t.length;i++)o[i]=[];return $.each(r,(function(){var i=this[1],a=parseInt(this[2]);a<0&&(a+=65536);var r=new Date(parseInt(1e3*this[3])-1e3*a),l=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds());if("string"==typeof i)if("rd"===i)i=t.length-1;else if("s1"===i)i=t.length-3;else if("s2"===i)i=t.length-2;else{if("rs"!==i)return;i=t.length-2}else if("number"==typeof i){if(i>t.length-2||Station.isMaster(i))return;s.totalRuntime+=a,s.totalCount++}if("table"===e)switch(n){case"station":o[i].push([l,dhms2str(sec2dhms(a))]);break;case"day":var c=Math.floor(r.getTime()/1e3/60/60/24),d=[l,dhms2str(sec2dhms(a)),i];"object"!=typeof o[c]?o[c]=[d]:o[c].push(d)}else if("timeline"===e){var u,h,p,f,m=parseInt(this[0]);if("rs"===this[1])u="delayed",p=h=_("Rain Sensor"),f=_("RS");else if("rd"===this[1])u="delayed",p=h=_("Rain Delay"),f=_("RD");else if("s1"===this[1])u="delayed",p=h=3===controller.options.sn1t?_("Soil Sensor"):_("Rain Sensor"),f=_("SEN1");else if("s2"===this[1])u="delayed",p=h=3===controller.options.sn2t?_("Soil Sensor"):_("Rain Sensor"),f=_("SEN2");else{if(0===m)return;u="program-"+(m+3)%4,h=pidname(m),p=controller.stations.snames[i],f="S"+(i+1)}o.push({start:l,end:new Date(l.getTime()+1e3*a),className:u,content:h,pid:m-1,shortname:f,group:p,station:i})}})),"timeline"===e&&o.sort(sortByStation),[o,s]},u=function(t,e){var i=[],n=[];return l.length&&(t.avgWaterLevel=0,$.each(l,(function(){i[Math.floor(this[3]/60/60/24)]=this[2],t.avgWaterLevel+=this[2]})),t.avgWaterLevel=parseFloat((t.avgWaterLevel/l.length).toFixed(2))),c.length&&(t.totalVolume=0,$.each(c,(function(){var i=flowCountToVolume(this[0]);if("timeline"===e){var o=new Date(parseInt(1e3*this[3])),s=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());n.push({start:new Date(s.getTime()-parseInt(1e3*this[2])),end:s,className:"",content:i+" L",shortname:_("FS"),group:_("Flow Sensor")})}else{var a=Math.floor(this[3]/60/60/24);n[a]=n[a]?n[a]+i:i}t.totalVolume+=i}))),[i,n,t]},h=function(t,e,i){if("object"!=typeof t||t.length<1||t.result&&32===t.result)return $.mobile.loading("hide"),void v();try{c=JSON.parse(c.replace(/,\s*inf/g,""))}catch(t){c=[]}r=t,l=$.isEmptyObject(e)?[]:e,c=$.isEmptyObject(i)?[]:i,p(),exportObj(".export_logs",r),$.mobile.loading("hide")},p=function(){n.find("#log_table").prop("checked")?m():n.find("#log_timeline").prop("checked")&&f()},f=function(){if(r.length<1)v();else{s.hide(),o.show(),a.collapsible("collapse");var t=d("timeline"),e=u(t[1],"timeline"),i=t[0].concat(e[1]),l=e[2],c={width:"100%",editable:!1,axisOnTop:!0,eventMargin:10,eventMarginAxis:0,min:y().start,max:new Date(y().end.getTime()+8634e4),selectable:!1,showMajorLabels:!1,groupsChangeable:!1,showNavigation:!1,groupsOrder:"none",groupMinHeight:20,zoomMin:6e4},h=function(){m.redraw()},p=function(){$.mobile.window.off("resize",h)},f=[];o.on("swiperight swipeleft",(function(t){t.stopImmediatePropagation()})),$.each(i,(function(){f[this.group]=this.shortname}));var m=new links.Timeline(o.get(0),c);$.mobile.window.on("resize",h),n.one("pagehide",p),n.find("input:radio[name='log_type']").one("change",p),m.draw(i),o.find(".timeline-groups-text").each((function(){this.setAttribute("data-shortname",f[this.textContent])})),o.prepend(g(l))}},m=function(){if(r.length<1)v();else{s.show(),o.show();var e,i,l,c=n.find("input:radio[name='table-group']:checked").val(),h=d("table",c),p=h[0],f=u(h[1]),m=[],b=f[0],y=f[1],w=f[2],k="<table><thead><tr><th data-priority='1'>"+_("Runtime")+"</th><th data-priority='2'>"+("station"===c?_("Date/Time"):_("Time")+"</th><th>"+_("Station"))+"</th></tr></thead><tbody>",S=g(w)+"<div data-role='collapsible-set' data-inset='true' data-theme='b' data-collapsed-icon='arrow-d' data-expanded-icon='arrow-u'>",T=0;for(e in p)if(p.hasOwnProperty(e)){if(0===(i=p[e].length))continue;for(m[T]="<div data-role='collapsible' data-collapsed='true'><h2>"+(checkOSVersion(210)&&"day"===c?"<a class='ui-btn red ui-btn-corner-all delete-day day-"+e+"'>"+_("delete")+"</a>":"")+"<div class='ui-btn-up-c ui-btn-corner-all custom-count-pos'>"+i+" "+_(1===i?"run":"runs")+"</div>"+("station"===c?t[e]:dateToString(new Date(1e3*e*60*60*24)).slice(0,-9))+"</h2>",b[e]&&(m[T]+="<span style='border:none' class='"+(100!==b[e]?b[e]<100?"green ":"red ":"")+"ui-body ui-body-a'>"+_("Average")+" "+_("Water Level")+": "+b[e]+"%</span>"),y[e]&&(m[T]+="<span style='border:none' class='ui-body ui-body-a'>"+_("Total Water Used")+": "+y[e]+" L</span>"),m[T]+=k,l=0;l<p[e].length;l++){var C=new Date(p[e][l][0]);m[T]+="<tr><td>"+p[e][l][1]+"</td><td>"+("station"===c?dateToString(C,!1):pad(C.getHours())+":"+pad(C.getMinutes())+":"+pad(C.getSeconds())+"</td><td>"+t[p[e][l][2]])+"</td></tr>"}m[T]+="</tbody></table></div>",T++}"day"===c&&m.reverse(),a.collapsible("collapse"),o.html(S+m.join("")+"</div>").enhanceWithin(),o.find(".delete-day").on("click",(function(){var t,e;return $.each(this.className.split(" "),(function(){if(0===this.indexOf("day-"))return t=this.split("day-")[1],!1})),e=dateToString(new Date(1e3*t*60*60*24)).slice(0,-9),areYouSure(_("Are you sure you want to ")+_("delete")+" "+e+"?","",(function(){$.mobile.loading("show"),sendToOS("/dl?pw=&day="+t).done((function(){x(),showerror(e+" "+_("deleted"))}))})),!1})),fixInputClick(o)}},g=function(t){if(0===t.totalCount||0===t.totalRuntime)return"";var e=void 0!==t.avgWaterLevel;return"<div class='ui-body-a smaller' id='logs_summary'><div><span class='bold'>"+_("Total Station Events")+"</span>: "+t.totalCount+"</div><div><span class='bold'>"+_("Total Runtime")+"</span>: "+dhms2str(sec2dhms(t.totalRuntime))+"</div>"+(e?"<div><span class='bold'>"+_("Average")+" "+_("Water Level")+"</span>: <span class='"+(100!==t.avgWaterLevel?t.avgWaterLevel<100?"green-text":"red-text":"")+"'>"+t.avgWaterLevel+"%</span></div>":"")+(void 0!==t.totalVolume&&t.totalVolume>0?"<div><span class='bold'>"+_("Total Water Used")+"</span>: "+t.totalVolume+" L"+(e&&t.avgWaterLevel<100?" (<span class='green-text'>"+(t.totalVolume-t.totalVolume*(t.avgWaterLevel/100)).toFixed(2)+"L saved</span>)":"")+"</div>":"")+"</div>"},v=function(){r=[],a.collapsible("expand"),s.hide(),o.show().html(_("No entries found in the selected date range"))},b=function(){$.mobile.loading("hide"),s.empty().hide(),o.show().html(_("Error retrieving log data. Please refresh to try again."))},y=function(){var t=S.val().split("-"),e=T.val().split("-");return{start:new Date(t[0],t[1]-1,t[2]),end:new Date(e[0],e[1]-1,e[2])}},w=function(){return"start="+y().start.getTime()/1e3+"&end="+(y().end.getTime()/1e3+86340)},x=function(){var t=y().end.getTime()/1e3,e=y().start.getTime()/1e3;if(t<e)return v(),void showerror(_("Start time cannot be greater than end time"));var i=0;if($.mobile.loading("show"),t-e>3154e4){showerror(_("The requested time span exceeds the maxiumum of 1 year and has been adjusted"),3500);var n=y().start;n.setFullYear(n.getFullYear()+1),$("#log_end").val(n.getFullYear()+"-"+pad(n.getMonth()+1)+"-"+pad(n.getDate())),i=500}var o=$.Deferred().resolve(),s=$.Deferred().resolve();checkOSVersion(211)&&(o=sendToOS("/jl?pw=&type=wl&"+w(),"json")),checkOSVersion(216)&&(s=sendToOS("/jl?pw=&type=fl&"+w())),setTimeout((function(){$.when(sendToOS("/jl?pw=&"+w(),"json"),o,s).then(h,b)}),i)},k=window.innerWidth<640,S=n.find("#log_start"),T=n.find("#log_end");return n.find(".clear_logs").on("click",(function(){return clearLogs(x),!1})),isiOS?S.add(T).on("blur",(function(){n.hasClass("ui-page-active")&&x()})):S.add(T).change((function(){clearTimeout(e),e=setTimeout(x,1e3)})),s.find("input[name='table-group']").change((function(){m()})),n.find("input:radio[name='log_type']").change(p),n.on({pagehide:function(){n.detach()},pageshow:x}),n.find("#log_timeline").prop("checked",!k),n.find("#log_table").prop("checked",k),function(){var e=checkOSVersion(219)?[3===controller.options.sn1t?_("Soil Sensor"):_("Rain Sensor"),3===controller.options.sn2t?_("Soil Sensor"):_("Rain Sensor"),_("Rain Delay")]:[_("Rain Sensor"),_("Rain Delay")];if(t=$.merge($.merge([],controller.stations.snames),e),n.find(".clear_logs").toggleClass("hidden",!isOSPi()&&!checkOSVersion(210)),""===S.val()||""===T.val()){var i=new Date(1e3*controller.settings.devt);S.val(new Date(i.getTime()-6048e5).toISOString().slice(0,10)),T.val(i.toISOString().slice(0,10))}changeHeader({title:_("Logs"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack},rightBtn:{icon:"refresh",text:_("Refresh"),on:x}}),$("#logs").remove(),$.mobile.pageContainer.append(n)}}();function clearLogs(t){areYouSure(_("Are you sure you want to clear ALL your log data?"),"",(function(){var e=isOSPi()?"/cl?pw=":"/dl?pw=&day=all";$.mobile.loading("show"),sendToOS(e).done((function(){"function"==typeof t&&t(),showerror(_("Logs have been cleared"))}))}))}function clearPrograms(t){areYouSure(_("Are you sure you want to delete ALL programs?"),"",(function(){$.mobile.loading("show"),sendToOS("/dp?pw=&pid=-1").done((function(){"function"==typeof t&&t(),showerror(_("Programs have been deleted"))}))}))}function resetAllOptions(t){areYouSure(_("Are you sure you want to delete all settings and return to the default settings?"),"",(function(){var e;isOSPi()?e="otz=32&ontp=1&onbrd=0&osdt=0&omas=0&omton=0&omtoff=0&orst=1&owl=100&orlp=0&ouwt=0&olg=1&oloc=Boston,MA":(e="o2=1&o3=1&o12=80&o13=0&o15=0&o17=0&o18=0&o19=0&o20=0&o22=1&o23=100&o26=0&o27=110&o28=100&o29=15&o30=320&o31=0&o36=1&o37=0&o38=0&o39=0&o41=100&o42=0&o43=0&o44=8&o45=8&o46=8&o47=8&o48=0&o49=0&o50=0&o51=1&o52=0&o53=1&o54=0&o55=0&o56=0&o57=0&",checkOSVersion(2199)?e+="o32=0&o33=0&o34=0&o35=0&":e+="o32=216&o33=239&o34=35&o35=12&",e=transformKeysinString(e+="loc=Boston,MA&wto=%22key%22%3A%22%22")),sendToOS("/co?pw=&"+e).done((function(){"function"==typeof t&&t(),updateController(updateWeather)}))}))}var getPrograms=function(){var t,e=$("<div data-role='page' id='programs'><div class='ui-content' role='main' id='programs_list'></div></div>");function i(){var t=$(makeAllPrograms());t.find("[id^=program-]").on({collapsiblecollapse:function(){$(this).find(".ui-collapsible-content").empty()},collapsiblebeforecollapse:function(t){var e=$(this),i=e.find(".hasChanges");i.length&&(areYouSure(_("Do you want to save your changes?"),"",(function(){i.removeClass("hasChanges").click(),e.collapsible("collapse")}),(function(){i.removeClass("hasChanges"),e.collapsible("collapse")})),t.preventDefault())},collapsibleexpand:function(){expandProgram($(this))}}),checkOSVersion(210)&&t.find(".move-up").removeClass("hidden").on("click",(function(){var t=$(this).parents("fieldset"),i=parseInt(t.attr("id").split("-")[1]);return $.mobile.loading("show"),sendToOS("/up?pw=&pid="+i).done((function(){updateControllerPrograms((function(){$.mobile.loading("hide"),e.trigger("programrefresh")}))})),!1})),t.find(".program-copy").on("click",(function(){return changePage("#addprogram",{copyID:parseInt($(this).parents("fieldset").attr("id").split("-")[1])}),!1})),e.find("#programs_list").html(t.enhanceWithin())}return e.on("programrefresh",i).on("pagehide",(function(){e.detach()})).on("pagebeforeshow",(function(){updateProgramHeader(),"number"!=typeof t&&1===controller.programs.pd.length&&(t=0),"number"==typeof t&&(e.find("fieldset[data-collapsed='false']").collapsible("collapse"),$("#program-"+t).collapsible("expand"))})),function(n){t=n,changeHeader({title:_("Programs"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:checkChangesBeforeBack},rightBtn:{icon:"plus",text:_("Add"),on:function(){checkChanges((function(){changePage("#addprogram")}))}}}),i(),$("#programs").remove(),$.mobile.pageContainer.append(e)}}();function expandProgram(t){var e=parseInt(t.attr("id").split("-")[1]);t.find(".ui-collapsible-content").html(makeProgram(e)).enhanceWithin().on("change input click",(function(e){"click"===e.type&&"BUTTON"!==e.target.tagName||($(this).off("change input click"),t.find("[id^='submit-']").addClass("hasChanges"))})),t.find("[id^='submit-']").on("click",(function(){return submitProgram(e),!1})),t.find("[id^='delete-']").on("click",(function(){return deleteProgram(e),!1})),t.find("[id^='run-']").on("click",(function(){return areYouSure(_("Are you sure you want to start "+(checkOSVersion(210)?controller.programs.pd[e][5]:"Program "+e)+" now?"),"",(function(){var t=[],i=function(){t.push(0),submitRunonce(t)};if(checkOSVersion(210)){if(t=controller.programs.pd[e][4],controller.programs.pd[e][0]>>1&1)return areYouSure(_("Do you wish to apply the current watering level?"),"",(function(){for(var e=t.length-1;e>=0;e--)t[e]=parseInt(t[e]*(controller.options.wl/100));i()}),i),!1}else{var n=parseInt($("#duration-"+e).val()),o=$("[id^='station_'][id$='-"+e+"']");$.each(o,(function(){$(this).is(":checked")?t.push(n):t.push(0)}))}i()})),!1}))}function readProgram(t){return checkOSVersion(210)?readProgram21(t):readProgram183(t)}function readProgram183(t){var e=t[1],i=t[2],n=!1,o=!1,s=!1,a="",r="",l={};l.en=t[0];for(var c=0;c<controller.programs.nboards;c++)for(var d=t[7+c],u=0;u<8;u++)r+=d&1<<u?"1":"0";if(l.stations=r,l.duration=t[6],l.start=t[3],l.end=t[4],l.interval=t[5],128&e&&i>1)a=[i,127&e],s=!0;else{for(var h=0;h<7;h++)a+=e&1<<h?"1":"0";128&e&&0===i&&(n=!0),128&e&&1===i&&(o=!0)}return l.days=a,l.is_even=n,l.is_odd=o,l.is_interval=s,l}function readProgram21(t){var e=t[1],i=t[2],n=t[0]>>2&3,o=t[0]>>4&3,s=t[0]>>6&1,a="",r={repeat:0,interval:0};if(r.en=t[0]>>0&1,r.weather=t[0]>>1&1,r.is_even=2===n,r.is_odd=1===n,r.is_interval=3===o,r.stations=t[4],r.name=t[5],0===s?(r.start=t[3][0],r.repeat=t[3][1],r.interval=t[3][2]):1===s&&(r.start=t[3]),3===o)a=[i,e];else if(0===o)for(var l=0;l<7;l++)a+=e&1<<l?"1":"0";return r.days=a,r}function getStartTime(t,e){var i=2047&t,n=0,o=getSunTimes(e);if(t<0)return t;if(t>>13&1)n=1;else if(1&!(t>>14))return t;return t>>12&1&&(i=-i),t=o[n],(t+=i)<0?t=0:t>1440&&(t=1440),t}function readStartTime(t){var e=2047&t,i=_("Sunrise");if(t>>13&1)i=_("Sunset");else if(1&!(t>>14))return minutesToTime(t);return t>>12&1&&(e=-e),i+(0!==e?(e>0?"+":"")+dhms2str(sec2dhms(60*e)):"")}function pidname(t){var e=_("Program")+" "+t;return 255===t||99===t?e=_("Manual program"):254===t||98===t?e=_("Run-once program"):checkOSVersion(210)&&t<=controller.programs.pd.length&&(e=controller.programs.pd[t-1][5]),e}function updateProgramHeader(){$("#programs_list").find("[id^=program-]").each((function(t,e){var i=$(e).find(".ui-collapsible-heading-toggle");(checkOSVersion(210)?1&controller.programs.pd[t][0]:controller.programs.pd[t][0])?i.removeClass("red"):i.addClass("red")}))}function makeAllPrograms(){if(0===controller.programs.pd.length)return"<p class='center'>"+_("You have no programs currently added. Tap the Add button on the top right corner to get started.")+"</p>";for(var t,e="<p class='center'>"+_("Click any program below to expand/edit. Be sure to save changes.")+"</p><div data-role='collapsible-set'>",i=0;i<controller.programs.pd.length;i++)t=_("Program")+" "+(i+1),checkOSVersion(210)&&(t=controller.programs.pd[i][5]),e+="<fieldset id='program-"+i+"' data-role='collapsible'><h3><a "+(i>0?"":"style='visibility:hidden' ")+"class='hidden ui-btn ui-btn-icon-notext ui-icon-arrow-u ui-btn-corner-all move-up'></a><a class='ui-btn ui-btn-corner-all program-copy'>"+_("copy")+"</a><span class='program-name'>"+t+"</span></h3>",e+="</fieldset>";return e+"</div>"}function makeProgram(t,e){return checkOSVersion(210)?makeProgram21(t,e):makeProgram183(t,e)}function makeProgram183(t,e){var i,n,o,s,a,r,l=[_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday"),_("Sunday")],c="",d=e?"new":t;if("string"==typeof(a="new"===t?{en:0,weather:0,is_interval:0,is_even:0,is_odd:0,duration:0,interval:0,start:0,end:0,days:[0,0]}:readProgram(controller.programs.pd[t])).days)for(n=(i=a.days.split("")).length;n--;)i[n]=0|i[n];else i=[0,0,0,0,0,0,0];if(void 0!==a.stations)for(n=(s=a.stations.split("")).length-1;n>=0;n--)s[n]=0|s[n];for(c+="<label for='en-"+d+"'><input data-mini='true' type='checkbox' "+(a.en||"new"===t?"checked='checked'":"")+" name='en-"+d+"' id='en-"+d+"'>"+_("Enabled")+"</label>",c+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",c+="<input data-mini='true' type='radio' name='rad_days-"+d+"' id='days_week-"+d+"' value='days_week-"+d+"' "+(a.is_interval?"":"checked='checked'")+"><label for='days_week-"+d+"'>"+_("Weekly")+"</label>",c+="<input data-mini='true' type='radio' name='rad_days-"+d+"' id='days_n-"+d+"' value='days_n-"+d+"' "+(a.is_interval?"checked='checked'":"")+"><label for='days_n-"+d+"'>"+_("Interval")+"</label>",c+="</fieldset><div id='input_days_week-"+d+"' "+(a.is_interval?"style='display:none'":"")+">",c+="<div class='center'><p class='tight'>"+_("Restrictions")+"</p><select data-inline='true' data-iconpos='left' data-mini='true' id='days_rst-"+d+"'>",c+="<option value='none' "+(a.is_even||a.is_odd?"":"selected='selected'")+">"+_("None")+"</option>",c+="<option value='odd' "+(!a.is_even&&a.is_odd?"selected='selected'":"")+">"+_("Odd Days Only")+"</option>",c+="<option value='even' "+(!a.is_odd&&a.is_even?"selected='selected'":"")+">"+_("Even Days Only")+"</option>",c+="</select></div>",c+="<div class='center'><p class='tight'>"+_("Days of the Week")+"</p><select "+($.mobile.window.width()>560?"data-inline='true' ":"")+"data-iconpos='left' data-mini='true' multiple='multiple' data-native-menu='false' id='d-"+d+"'><option>"+_("Choose day(s)")+"</option>",o=0;o<l.length;o++)c+="<option "+(!a.is_interval&&i[o]?"selected='selected'":"")+" value='"+o+"'>"+l[o]+"</option>";for(c+="</select></div></div>",c+="<div "+(a.is_interval?"":"style='display:none'")+" id='input_days_n-"+d+"' class='ui-grid-a'>",c+="<div class='ui-block-a'><label class='center' for='every-"+d+"'>"+_("Interval (Days)")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='every-"+d+"' pattern='[0-9]*' id='every-"+d+"' value='"+a.days[0]+"'></div>",c+="<div class='ui-block-b'><label class='center' for='starting-"+d+"'>"+_("Starting In")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='starting-"+d+"' pattern='[0-9]*' id='starting-"+d+"' value='"+a.days[1]+"'></div>",c+="</div>",c+="<fieldset data-role='controlgroup'><legend>"+_("Stations:")+"</legend>",o=0;o<controller.stations.snames.length;o++)c+="<label for='station_"+o+"-"+d+"'><input "+(Station.isDisabled(o)?"data-wrapper-class='station-hidden hidden' ":"")+"data-mini='true' type='checkbox' "+(void 0!==s&&s[o]?"checked='checked'":"")+" name='station_"+o+"-"+d+"' id='station_"+o+"-"+d+"'>"+controller.stations.snames[o]+"</label>";return c+="</fieldset>",c+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",c+="<button class='ui-btn ui-mini' name='s_checkall-"+d+"' id='s_checkall-"+d+"'>"+_("Check All")+"</button>",c+="<button class='ui-btn ui-mini' name='s_uncheckall-"+d+"' id='s_uncheckall-"+d+"'>"+_("Uncheck All")+"</button>",c+="</fieldset>",c+="<div class='ui-grid-a'>",c+="<div class='ui-block-a'><label class='center' for='start-"+d+"'>"+_("Start Time")+"</label><button class='timefield pad_buttons' data-mini='true' id='start-"+d+"' value='"+a.start+"'>"+minutesToTime(a.start)+"</button></div>",c+="<div class='ui-block-b'><label class='center' for='end-"+d+"'>"+_("End Time")+"</label><button class='timefield pad_buttons' data-mini='true' id='end-"+d+"' value='"+a.end+"'>"+minutesToTime(a.end)+"</button></div>",c+="</div>",c+="<div class='ui-grid-a'>",c+="<div class='ui-block-a'><label class='pad_buttons center' for='duration-"+d+"'>"+_("Station Duration")+"</label><button class='pad_buttons' data-mini='true' name='duration-"+d+"' id='duration-"+d+"' value='"+a.duration+"'>"+dhms2str(sec2dhms(a.duration))+"</button></div>",c+="<div class='ui-block-b'><label class='pad_buttons center' for='interval-"+d+"'>"+_("Program Interval")+"</label><button class='pad_buttons' data-mini='true' name='interval-"+d+"' id='interval-"+d+"' value='"+60*a.interval+"'>"+dhms2str(sec2dhms(60*a.interval))+"</button></div>",c+="</div>",!0===e||"new"===t?c+="<input data-mini='true' data-icon='check' type='submit' data-theme='b' name='submit-"+d+"' id='submit-"+d+"' value='"+_("Save New Program")+"'>":(c+="<button data-mini='true' data-icon='check' data-theme='b' name='submit-"+d+"' id='submit-"+d+"'>"+_("Save Changes to Program")+" "+(t+1)+"</button>",c+="<button data-mini='true' data-icon='arrow-r' name='run-"+d+"' id='run-"+d+"'>"+_("Run Program")+" "+(t+1)+"</button>",c+="<button data-mini='true' data-icon='delete' class='red bold' data-theme='b' name='delete-"+d+"' id='delete-"+d+"'>"+_("Delete Program")+" "+(t+1)+"</button>"),(r=$(c)).find("input[name^='rad_days']").on("change",(function(){var t,e=$(this).val().split("-")[0];t="n"===(e=e.split("_")[1])?"week":"n",$("#input_days_"+e+"-"+d).show(),$("#input_days_"+t+"-"+d).hide()})),r.find("[id^='duration-'],[id^='interval-']").on("click",(function(){var t=$(this),e=t.attr("id").match("interval")?1:0,i=r.find("label[for='"+t.attr("id")+"']").text();showDurationBox({seconds:t.val(),title:i,callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e)))},maximum:e?86340:65535,granularity:e})})),r.find(".timefield").on("click",(function(){var t=$(this),e=r.find("label[for='"+t.attr("id")+"']").text();showTimeInput({minutes:t.val(),title:e,callback:function(e){t.val(e),t.text(minutesToTime(e))}})})),r.find("[id^='s_checkall-']").on("click",(function(){return r.find("[id^='station_'][id$='-"+d+"']").prop("checked",!0).checkboxradio("refresh"),!1})),r.find("[id^='s_uncheckall-']").on("click",(function(){return r.find("[id^='station_'][id$='-"+d+"']").prop("checked",!1).checkboxradio("refresh"),!1})),fixInputClick(r),r}function makeProgram21(t,e){var i,n,o,s,a,r,l,c,d=[_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday"),_("Sunday")],u="",h=e?"new":t;if("string"==typeof(s="new"===t?{name:"",en:0,weather:0,is_interval:0,is_even:0,is_odd:0,interval:0,start:0,days:[0,0],repeat:0,stations:[]}:readProgram(controller.programs.pd[t])).days)for(n=(i=s.days.split("")).length;n--;)i[n]=0|i[n];else i=[0,0,0,0,0,0,0];if(r="object"==typeof s.start?s.start:[s.start,-1,-1,-1],u+="<div style='margin-top:5px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Basic Settings")+"</h3></div>",u+="<div class='ui-body ui-body-a center'>",u+="<label for='name-"+h+"'>"+_("Program Name")+"</label><input data-mini='true' type='text' name='name-"+h+"' id='name-"+h+"' maxlength='"+controller.programs.pnsize+"' placeholder='"+_("Program")+" "+(controller.programs.pd.length+1)+"' value=\""+s.name+'">',u+="<label for='en-"+h+"'><input data-mini='true' type='checkbox' "+(s.en||"new"===t?"checked='checked'":"")+" name='en-"+h+"' id='en-"+h+"'>"+_("Enabled")+"</label>",u+="<label for='uwt-"+h+"'><input data-mini='true' type='checkbox' "+(s.weather?"checked='checked'":"")+" name='uwt-"+h+"' id='uwt-"+h+"'>"+_("Use Weather Adjustment")+"</label>",Supported.dateRange()){var p=Program.getDateRangeStart(h),f=Program.getDateRangeEnd(h);u+="<label for='use-dr-"+h+"'><input data-mini='true' type='checkbox' "+(Program.isDateRangeEnabled(h)?"checked='checked'":"")+" name='use-dr-"+h+"' id='use-dr-"+h+"'>"+_("Enable Date Range")+"</label>",u+="<div id='date-range-options-"+h+"'"+(Program.isDateRangeEnabled(h)?"":"style='display:none'")+">",u+="<div class='ui-grid-a' style=''><div class='ui-block-a drfrom'><label class='center' for='from-dr-"+h+"'>"+_("From (mm/dd)")+"</label><div class='dr-input'><input type='text' placeholder='MM/DD' id='from-dr-"+h+"' value="+decodeDate(p)+"></input></div></div><div class='ui-block-b drto'><label class='center' for='to-dr-"+h+"'>"+_("To (mm/dd)")+"</label><div class='dr-input'><input type='text' placeholder='MM/DD' id='to-dr-"+h+"' value="+decodeDate(f)+"></input></div></div></div></div>"}for(u+="<label class='center' for='start_1-"+h+"'>"+_("Start Time")+"</label><button class='timefield' data-mini='true' id='start_1-"+h+"' value='"+r[0]+"'>"+readStartTime(r[0])+"</button>",u+="</div></div></div></div>",u+="<div style='margin-top:10px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Program Type")+"</h3></div>",u+="<div class='ui-body ui-body-a'>",u+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",u+="<input data-mini='true' type='radio' name='rad_days-"+h+"' id='days_week-"+h+"' value='days_week-"+h+"' "+(s.is_interval?"":"checked='checked'")+"><label for='days_week-"+h+"'>"+_("Weekly")+"</label>",u+="<input data-mini='true' type='radio' name='rad_days-"+h+"' id='days_n-"+h+"' value='days_n-"+h+"' "+(s.is_interval?"checked='checked'":"")+"><label for='days_n-"+h+"'>"+_("Interval")+"</label>",u+="</fieldset>",u+="<div id='input_days_week-"+h+"' "+(s.is_interval?"style='display:none'":"")+">",u+="<div class='center'><p class='tight'>"+_("Days of the Week")+"</p><select "+($.mobile.window.width()>560?"data-inline='true' ":"")+"data-iconpos='left' data-mini='true' multiple='multiple' data-native-menu='false' id='d-"+h+"'><option>"+_("Choose day(s)")+"</option>",o=0;o<d.length;o++)u+="<option "+(!s.is_interval&&i[o]?"selected='selected'":"")+" value='"+o+"'>"+d[o]+"</option>";u+="</select></div></div>",u+="<div "+(s.is_interval?"":"style='display:none'")+" id='input_days_n-"+h+"' class='ui-grid-a'>",u+="<div class='ui-block-a'><label class='center' for='every-"+h+"'>"+_("Interval (Days)")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='every-"+h+"' pattern='[0-9]*' id='every-"+h+"' value='"+s.days[0]+"'></div>",u+="<div class='ui-block-b'><label class='center' for='starting-"+h+"'>"+_("Starting In")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='starting-"+h+"' pattern='[0-9]*' id='starting-"+h+"' value='"+s.days[1]+"'></div>",u+="</div>",u+="<div class='center'><p class='tight'>"+_("Restrictions")+"</p><select data-inline='true' data-iconpos='left' data-mini='true' id='days_rst-"+h+"'>",u+="<option value='none' "+(s.is_even||s.is_odd?"":"selected='selected'")+">"+_("None")+"</option>",u+="<option value='odd' "+(!s.is_even&&s.is_odd?"selected='selected'":"")+">"+_("Odd Days Only")+"</option>",u+="<option value='even' "+(!s.is_odd&&s.is_even?"selected='selected'":"")+">"+_("Even Days Only")+"</option>",u+="</select></div>",u+="</div></div>",u+="<div style='margin-top:10px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Stations")+"</h3></div>",u+="<div class='ui-body ui-body-a'>";var m=$("#programs").hasClass("show-hidden")?"":"' style='display:none";for(o=0;o<controller.stations.snames.length;o++)Station.isMaster(o)?u+="<div class='ui-field-contain duration-input"+(Station.isDisabled(o)?" station-hidden"+m:"")+"'><label for='station_"+o+"-"+h+"'>"+controller.stations.snames[o]+":</label><button disabled='true' data-mini='true' name='station_"+o+"-"+h+"' id='station_"+o+"-"+h+"' value='0'>"+_("Master")+"</button></div>":(l=s.stations[o]||0,u+="<div class='ui-field-contain duration-input"+(Station.isDisabled(o)?" station-hidden"+m:"")+"'><label for='station_"+o+"-"+h+"'>"+controller.stations.snames[o]+":</label><button "+(l>0?"class='green' ":"")+"data-mini='true' name='station_"+o+"-"+h+"' id='station_"+o+"-"+h+"' value='"+l+"'>"+getDurationText(l)+"</button></div>");for(u+="</div></div>",u+="<div style='margin-top:10px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Additional Start Times")+"</h3></div>",u+="<div class='ui-body ui-body-a'>",u+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",u+="<input data-mini='true' type='radio' name='stype-"+h+"' id='stype_repeat-"+h+"' value='stype_repeat-"+h+"' "+("object"==typeof s.start?"":"checked='checked'")+"><label for='stype_repeat-"+h+"'>"+_("Repeating")+"</label>",u+="<input data-mini='true' type='radio' name='stype-"+h+"' id='stype_set-"+h+"' value='stype_set-"+h+"' "+("object"==typeof s.start?"checked='checked'":"")+"><label for='stype_set-"+h+"'>"+_("Fixed")+"</label>",u+="</fieldset>",u+="<div "+("object"==typeof s.start?"style='display:none'":"")+" id='input_stype_repeat-"+h+"'>",u+="<div class='ui-grid-a'>",u+="<div class='ui-block-a'><label class='pad_buttons center' for='interval-"+h+"'>"+_("Repeat Every")+"</label><button class='pad_buttons' data-mini='true' name='interval-"+h+"' id='interval-"+h+"' value='"+60*s.interval+"'>"+dhms2str(sec2dhms(60*s.interval))+"</button></div>",u+="<div class='ui-block-b'><label class='pad_buttons center' for='repeat-"+h+"'>"+_("Repeat Count")+"</label><button class='pad_buttons' data-mini='true' name='repeat-"+h+"' id='repeat-"+h+"' value='"+s.repeat+"'>"+s.repeat+"</button></div>",u+="</div></div>",u+="<table style='width:100%;"+("object"==typeof s.start?"":"display:none")+"' id='input_stype_set-"+h+"'><tr><th class='center'>"+_("Enable")+"</th><th>"+_("Start Time")+"</th></tr>",o=1;o<4;o++)u+="<tr><td data-role='controlgroup' data-type='horizontal' class='use_master center'><label for='ust_"+(o+1)+"'><input id='ust_"+(o+1)+"' type='checkbox' "+((c=-1===r[o])?"":"checked='checked'")+"></label></td>",u+="<td><button class='timefield' data-mini='true' type='time' id='start_"+(o+1)+"-"+h+"' value='"+(c?0:r[o])+"'>"+readStartTime(c?0:r[o])+"</button></td></tr>";return u+="</table>",u+="</div></div>",!0===e||"new"===t?u+="<button data-mini='true' data-icon='check' data-theme='b' id='submit-"+h+"'>"+_("Save New Program")+"</button>":(u+="<button data-mini='true' data-icon='check' data-theme='b' id='submit-"+h+"'>"+_("Save Changes to")+" <span class='program-name'>"+s.name+"</span></button>",u+="<button data-mini='true' data-icon='arrow-r' id='run-"+h+"'>"+_("Run")+" <span class='program-name'>"+s.name+"</span></button>",u+="<button data-mini='true' data-icon='delete' class='bold red' data-theme='b' id='delete-"+h+"'>"+_("Delete")+" <span class='program-name'>"+s.name+"</span></button>"),(a=$(u)).find("input[name^='rad_days'],input[name^='stype']").on("change",(function(){var t=$(this).val().split("-")[0].split("_");$("[id^='input_"+t[0]+"_']").hide(),$("#input_"+t[0]+"_"+t[1]+"-"+h).show()})),Supported.dateRange()&&a.find("#use-dr-"+h).on("click",(function(){a.find("#date-range-options-"+h).toggle()})),a.find("[id^='interval-']").on("click",(function(){var t=$(this),e=a.find("label[for='"+t.attr("id")+"']").text();showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e)))},maximum:86340,granularity:1,preventCompression:!0})})),a.find(".timefield").on("click",(function(){var t=$(this);showTimeInput({minutes:t.val(),title:_("Start Time"),showSun:!!checkOSVersion(213),callback:function(e){t.val(e),t.text(readStartTime(e))}})})),a.find("[id^='repeat-']").on("click",(function(){var t=$(this),e=a.find("label[for='"+t.attr("id")+"']").text();showSingleDurationInput({data:t.val(),title:e,label:_("Repeat Count"),callback:function(e){t.val(e).text(e)},maximum:1440})})),a.find("[id^=station_]").on("click",(function(){var t=$(this),e=controller.stations.snames[t.attr("id").split("_")[1].split("-")[0]];showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e).addClass("green"),t.text(getDurationText(e)),0===e&&t.removeClass("green")},maximum:65535,showSun:!!checkOSVersion(214)})})),fixInputClick(a),a}function addProgram(t){t=t>=0?t:"new";var e=$("<div data-role='page' id='addprogram'><div class='ui-content' role='main' id='newprogram'><fieldset id='program-new'></fieldset></div></div>"),i=changeHeader({title:_("Add Program"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:checkChangesBeforeBack},rightBtn:{icon:"check",text:_("Submit"),on:function(){return submitProgram("new"),!1}}});e.find("#program-new").html(makeProgram(t,!0)).one("change input",(function(){i.eq(2).prop("disabled",!1).addClass("hasChanges")})),e.find("[id^='submit-']").on("click",(function(){return submitProgram("new"),!1})),e.one("pagehide",(function(){e.remove()})),"string"==typeof t&&i.eq(2).prop("disabled",!0),$("#addprogram").remove(),$.mobile.pageContainer.append(e)}function deleteProgram(t){var e=pidname(parseInt(t)+1);areYouSure(_("Are you sure you want to delete program")+" "+e+"?","",(function(){$.mobile.loading("show"),sendToOS("/dp?pw=&pid="+t).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){$("#programs").trigger("programrefresh"),showerror(_("Program")+" "+e+" "+_("deleted"))}))}))}))}function submitProgram(t){$("#program-"+t).find(".hasChanges").removeClass("hasChanges"),checkOSVersion(210)?submitProgram21(t):submitProgram183(t)}function submitProgram183(t){var e,i,n,o=[],s=[0,0],a=0,r=$("#en-"+t).is(":checked")?1:0;if(o[0]=r,$("#days_week-"+t).is(":checked")){for(e=null===(e=$("#d-"+t).val())?[]:parseIntArray(e),i=0;i<7;i++)-1!==$.inArray(i,e)&&(s[0]|=1<<i);if(0===s[0])return void showerror(_("Error: You have not selected any days of the week."));"odd"===$("#days_rst-"+t).val()?(s[0]|=128,s[1]=1):"even"===$("#days_rst-"+t).val()&&(s[0]|=128,s[1]=0)}else if($("#days_n-"+t).is(":checked")){if(s[1]=parseInt($("#every-"+t).val(),10),!(s[1]>=2&&s[1]<=128))return void showerror(_("Error: Interval days must be between 2 and 128."));if(s[0]=parseInt($("#starting-"+t).val(),10),!(s[0]>=0&&s[0]<s[1]))return void showerror(_("Error: Starting in days wrong."));s[0]|=128}if(o[1]=s[0],o[2]=s[1],o[3]=parseInt($("#start-"+t).val()),o[4]=parseInt($("#end-"+t).val()),o[3]>o[4])showerror(_("Error: Start time must be prior to end time."));else{o[5]=parseInt($("#interval-"+t).val()/60);var l=$("[id^=station_][id$=-"+t+"]").length/8;o[6]=parseInt($("#duration-"+t).val());var c,d=[0];for(c=0;c<l;c++)for(d[c]=0,n=0;n<8;n++)$("#station_"+(8*c+n)+"-"+t).is(":checked")&&(d[c]|=1<<n,a=1);o=JSON.stringify(o.concat(d)),0!==a?($.mobile.loading("show"),"new"===t?sendToOS("/cp?pw=&pid=-1&v="+o).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Program added successfully"))})),goBack()}))})):sendToOS("/cp?pw=&pid="+t+"&v="+o).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){updateProgramHeader()})),showerror(_("Program has been updated"))}))):showerror(_("Error: You have not selected any stations."))}}function submitProgram21(t,e){var i,n,o,s,a,r=[],l=[0,0],c=[0,0,0,0],d=0,u=$("#en-"+t).is(":checked")?1:0,h=$("#uwt-"+t).is(":checked")?1:0,p=0,f=checkOSVersion(2199)?1:2;if(p|=u<<0,p|=h<<1,"odd"===$("#days_rst-"+t).val()?p|=4:"even"===$("#days_rst-"+t).val()&&(p|=8),$("#days_n-"+t).is(":checked")){if(p|=48,l[1]=parseInt($("#every-"+t).val(),10),!(l[1]>=f&&l[1]<=128))return void showerror(_("Error: Interval days must be between "+f+" and 128."));if(l[0]=parseInt($("#starting-"+t).val(),10),!(l[0]>=0&&l[0]<l[1]))return void showerror(_("Error: Starting in days wrong."))}else if($("#days_week-"+t).is(":checked")){for(p|=0,i=null===(i=$("#d-"+t).val())?[]:parseIntArray(i),n=0;n<7;n++)-1!==$.inArray(n,i)&&(l[0]|=1<<n);if(0===l[0])return void showerror(_("Error: You have not selected any days of the week."))}if($("#stype_repeat-"+t).is(":checked"))p|=0,c[0]=parseInt($("#start_1-"+t).val()),c[1]=parseInt($("#repeat-"+t).val()),c[2]=parseInt($("#interval-"+t).val()/60);else if($("#stype_set-"+t).is(":checked")){p|=64,$("[id^='start_'][id$='-"+t+"']").each((function(t,e){var i=parseInt(e.value);("number"!=typeof i||t>0&&!$("#ust_"+(t+1)).is(":checked"))&&(i=-1),c[t]=i}))}var m=$("[id^=station_][id$=-"+t+"]"),g=[];if(m.each((function(){var t=parseInt(this.value);parseInt(t)>0&&(d=1),g.push(t)})),r[0]=p,r[1]=l[0],r[2]=l[1],r[3]=c,r[4]=g,o=$("#name-"+t).val(),a="",Supported.dateRange()){var v=$("#use-dr-"+t).is(":checked"),b=$("#from-dr-"+t).val(),y=$("#to-dr-"+t).val();if(!isValidDateRange(b,y))return void showerror(_("Error: date range is malformed"));a="&endr="+(v?1:0)+"&from="+encodeDate(b)+"&to="+encodeDate(y),r[0]|=v?128:0}if(s="&v="+JSON.stringify(r)+"&name="+encodeURIComponent(o),0!==d){if(!e&&$("#stype_repeat-"+t).is(":checked")&&c[1]>0){var w=calculateTotalRunningTime(g),x=60*c[2];if(w>x)return void areYouSure(_("Warning: The repeat interval ("+x+" sec) is less than the program run time ("+w+" sec)."),_("Do you want to continue?"),(function(){submitProgram21(t,!0)}))}e||3!=(p>>4&3)||1&l[1]||!((p>>2&3)>0)?($.mobile.loading("show"),"new"===t?sendToOS("/cp?pw=&pid=-1"+s+a).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Program added successfully"))})),goBack()}))})):sendToOS("/cp?pw=&pid="+t+s+a).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){updateProgramHeader(),$("#program-"+t).find(".program-name").text(o)})),showerror(_("Program has been updated"))}))):areYouSure(_("Warning: The use of odd/even restrictions with the selected interval day may result in the program not running at all."),_("Do you want to continue?"),(function(){submitProgram21(t,!0)}))}else showerror(_("Error: You have not selected any stations."))}function raindelay(t){return $.mobile.loading("show"),sendToOS("/cv?pw=&rd="+t/3600).done((function(){$.mobile.loading("hide"),showLoading("#footer-running"),refreshStatus(updateWeather),showerror(_("Rain delay has been successfully set"))})),!1}function getExportMethod(){var t=$("<div data-role='popup' data-theme='a'><div class='ui-bar ui-bar-a'>"+_("Select Export Method")+"</div><div data-role='controlgroup' class='tight'><a class='ui-btn hidden fileMethod'>"+_("File")+"</a><a class='ui-btn pasteMethod'>"+_("Email")+"</a><a class='ui-btn localMethod'>"+_("Internal (within app)")+"</a></div></div>"),e=encodeURIComponent(JSON.stringify(controller)),i="OpenSprinkler Data Export on "+dateToString(new Date);isFileCapable&&t.find(".fileMethod").removeClass("hidden").attr({href:"data:text/json;charset=utf-8,"+e,download:"backup-"+(new Date).toLocaleDateString().replace(/\//g,"-")+".json"}).on("click",(function(){t.popup("close")}));var n="mailto:?subject="+encodeURIComponent(i)+"&body="+e;t.find(".pasteMethod").attr("href",n).on("click",(function(){window.open(n,isOSXApp?"_system":void 0),t.popup("close")})),t.find(".localMethod").on("click",(function(){t.popup("close"),storage.set({backup:JSON.stringify(controller)},(function(){showerror(_("Backup saved on this device"))}))})),openPopup(t,{positionTo:$("#sprinklers-settings").find(".export_config")})}function getImportMethod(t){var e=function(){var t=$("<div data-role='popup' data-theme='a' id='paste_config'><p class='ui-bar'><textarea class='textarea' rows='10' placeholder='"+_("Paste your backup here")+"'></textarea><button data-mini='true' data-theme='b'>"+_("Import")+"</button></p></div>"),e=$.mobile.window.width();return t.find("button").on("click",(function(){var e=t.find("textarea").val();if(""!==e)try{e=JSON.parse($.trim(e).replace(/“|”|″/g,'"')),t.popup("close"),importConfig(e)}catch(e){t.find("textarea").val(""),showerror(_("Unable to read the configuration file. Please check the file and try again."))}})),t.css("width",e>600?.4*e+"px":"100%"),openPopup(t),!1},i=$("<div data-role='popup' data-theme='a'><div class='ui-bar ui-bar-a'>"+_("Select Import Method")+"</div><div data-role='controlgroup' class='tight'><button class='hidden fileMethod'>"+_("File")+"</button><button class='pasteMethod'>"+_("Email (copy/paste)")+"</button><button class='hidden localMethod'>"+_("Internal (within app)")+"</button></div></div>");if(isFileCapable)i.find(".fileMethod").removeClass("hidden").on("click",(function(){i.popup("close");var t=$("<input type='file' id='configInput' data-role='none' style='visibility:hidden;position:absolute;top:-50px;left:-50px'/>").on("change",(function(){var t=this.files[0],e=new FileReader;"object"==typeof t&&(e.onload=function(t){try{importConfig(JSON.parse($.trim(t.target.result)))}catch(t){showerror(_("Unable to read the configuration file. Please check the file and try again."))}},e.readAsText(t))}));return t.appendTo("#sprinklers-settings"),t.click(),!1}));else if(!t)return void e();i.find(".pasteMethod").on("click",(function(){return i.popup("close"),e(),!1})),t&&i.find(".localMethod").removeClass("hidden").on("click",(function(){return i.popup("close"),importConfig(JSON.parse(t)),!1})),openPopup(i,{positionTo:$("#sprinklers-settings").find(".import_config")})}function importConfig(t){var e="";"object"==typeof t&&t.settings?((checkOSVersion(210)&&"object"==typeof t.options&&(t.options.hp0!==controller.options.hp0||t.options.hp1!==controller.options.hp1)||t.options.dhcp!==controller.options.dhcp||t.options.devid!==controller.options.devid)&&(e=_("Warning: Network changes will be made and the device may no longer be accessible from this address.")),areYouSure(_("Are you sure you want to restore the configuration?"),e,(function(){$.mobile.loading("show");var e,i,n,o,s,a="/cs?pw=",r="/co?pw=",l=Math.ceil(t.stations.snames.length/16),c=new Array(l).fill("/cs?pw="),d=isOSPi(),u=function(t){return keyIndex[t]===n};for(e in t.options)if(t.options.hasOwnProperty(e)&&keyIndex.hasOwnProperty(e)){if(n=keyIndex[e],-1!==$.inArray(n,[2,14,16,21,22,25,36])&&0===t.options[e])continue;if(3===n){checkOSVersion(210)&&1===controller.options.dhcp&&(r+="&o3=1");continue}if(d&&void 0===(n=Object.keys(keyIndex).find(u)))continue;o=!0===checkOSVersion(208)&&"string"==typeof t.options[e]?t.options[e].replace(/\s/g,"_"):t.options[e],r+="&o"+n+"="+o}for(!d&&"number"==typeof t.options.fwv&&t.options.fwv<211&&checkOSVersion(211)&&(r+="&o36=1"),"object"==typeof t.settings.wto&&checkOSVersion(215)&&(r+="&wto="+escapeJSON(t.settings.wto)),"string"==typeof t.settings.ifkey&&checkOSVersion(217)&&(r+="&ifkey="+t.settings.ifkey),"string"==typeof t.settings.dname&&checkOSVersion(2191)&&(r+="&dname="+t.settings.dname),"object"==typeof t.settings.mqtt&&checkOSVersion(2191)&&(r+="&mqtt="+escapeJSON(t.settings.mqtt)),"object"==typeof t.settings.otc&&checkOSVersion(2191)&&(r+="&otc="+escapeJSON(t.settings.otc)),r+="&"+(d?"o":"")+"loc="+t.settings.loc,i=0;i<l;i++)for(e=16*i;e<16*(i+1)&&e<t.stations.snames.length;e++)s=!0===checkOSVersion(208)?t.stations.snames[e].replace(/\s/g,"_"):t.stations.snames[e],c[i]+="&s"+e+"="+encodeURIComponent(s);for(e=0;e<t.stations.masop.length;e++)a+="&m"+e+"="+t.stations.masop[e];if("object"==typeof t.stations.masop2)for(e=0;e<t.stations.masop2.length;e++)a+="&n"+e+"="+t.stations.masop2[e];if("object"==typeof t.stations.ignore_rain)for(e=0;e<t.stations.ignore_rain.length;e++)a+="&i"+e+"="+t.stations.ignore_rain[e];if("object"==typeof t.stations.ignore_sn1)for(e=0;e<t.stations.ignore_sn1.length;e++)a+="&j"+e+"="+t.stations.ignore_sn1[e];if("object"==typeof t.stations.ignore_sn2)for(e=0;e<t.stations.ignore_sn2.length;e++)a+="&k"+e+"="+t.stations.ignore_sn2[e];if("object"==typeof t.stations.stn_dis)for(e=0;e<t.stations.stn_dis.length;e++)a+="&d"+e+"="+t.stations.stn_dis[e];if("object"==typeof t.stations.stn_spe)for(e=0;e<t.stations.stn_spe.length;e++)a+="&p"+e+"="+t.stations.stn_spe[e];if("object"==typeof t.stations.stn_seq)for(e=0;e<t.stations.stn_seq.length;e++)a+="&q"+e+"="+t.stations.stn_seq[e];else if(!d&&"number"==typeof t.options.fwv&&t.options.fwv<211&&!checkOSVersion(211)){var h;for(h=0;h<t.settings.nbrd;h++)a+="&q"+h+"="+(1===t.options.seq?255:0)}if("object"==typeof t.stations.act_relay)for(e=0;e<t.stations.act_relay.length;e++)a+="&a"+e+"="+t.stations.act_relay[e];t.special=t.special||{},$.when(sendToOS(transformKeysinString(r)),sendToOS(a),sendToOS("/dp?pw=&pid=-1"),$.each(c,(function(t,e){sendToOS(e)})),$.each(t.programs.pd,(function(e,i){var n="";if(d&&"number"==typeof t.options.fwv&&t.options.fwv>=210)return showerror(_("Program data is newer than the device firmware and cannot be imported")),!1;if(!d&&"number"==typeof t.options.fwv&&t.options.fwv>=210&&!checkOSVersion(210))return showerror(_("Program data is newer than the device firmware and cannot be imported")),!1;if(!d&&"number"==typeof t.options.fwv&&t.options.fwv>=210&&checkOSVersion(210)&&(n="&name="+i[5],i=i.slice(0,5)),!d&&"number"==typeof t.options.fwv&&t.options.fwv<210&&checkOSVersion(210)){var o,s,a,r=readProgram183(i),l=i.length-7,c=[],u=0;for(u|=r.en<<0,r.is_even?u|=8:r.is_odd?u|=4:u|=0,r.is_interval?u|=48:u|=0,u|=0,i[0]=u,s=0;s<l;s++)for(o=i[7+s],a=0;a<8;a++)c.push(o&1<<a?r.duration:0);i[3]=[r.start,parseInt((r.end-r.start)/r.interval),r.interval,0],i[4]=c,i=i.slice(0,5),n="&name="+_("Program")+" "+(e+1)}sendToOS("/cp?pw=&pid=-1&v="+JSON.stringify(i)+n)})),$.each(t.special,(function(t,e){checkOSVersion(216)&&sendToOS("/cs?pw=&sid="+t+"&st="+e.st+"&sd="+encodeURIComponent(e.sd))}))).then((function(){setTimeout((function(){updateController((function(){$.mobile.loading("hide"),showerror(_("Backup restored to your device")),updateWeather(),goHome(!0)}),(function(){$.mobile.loading("hide"),networkFail()}))}),1500)}),(function(){$.mobile.loading("hide"),showerror(_("Unable to import configuration."))}))}))):showerror(_("Invalid configuration"))}var showAbout=function(){var t,e=$("<div data-role='page' id='about'><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'><li><p>"+_("User manual for OpenSprinkler is available at")+" <a class='iab' target='_blank' href='https://openthings.freshdesk.com/support/solutions/folders/5000147083'>https://support.openthings.io</a></p></li></ul><ul data-role='listview' data-inset='true'><li><p>"+_("This is open source software: source code and changelog for this application can be found at")+" <a class='iab squeeze' target='_blank' href='https://github.com/OpenSprinkler/OpenSprinkler-App/'>https://github.com/OpenSprinkler/OpenSprinkler-App/</a></p><p>"+_("Language localization is crowdsourced using Transifex available at")+" <a class='iab squeeze' target='_blank' href='https://www.transifex.com/albahra/opensprinkler/'>https://www.transifex.com/albahra/opensprinkler/</a></p><p>"+_("Open source attributions")+": <a class='iab iabNoScale squeeze' target='_blank' href='https://github.com/OpenSprinkler/OpenSprinkler-App/wiki/List-of-Integrated-Libraries'>https://github.com/OpenSprinkler/OpenSprinkler-App/wiki/List-of-Integrated-Libraries</a></p></li></ul><p class='smaller'>"+_("App Version")+": 2.3.0<br>"+_("Firmware")+": <span class='firmware'></span><br><span class='hardwareLabel'>"+_("Hardware Version")+":</span> <span class='hardware'></span></p></div></div>");return function(){t=void 0===controller.options.hwv,e.find(".hardware").toggleClass("hidden",t).text(getHWVersion()+getHWType()),e.find(".hardwareLabel").toggleClass("hidden",t),e.find(".firmware").text(getOSVersion()+getOSMinorVersion()),e.one("pagehide",(function(){e.detach()})),changeHeader({title:_("About"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#about").remove(),$.mobile.pageContainer.append(e)}}();function stopStations(t){$.mobile.loading("show"),sendToOS("/cv?pw=&rsn=1").done((function(){setTimeout((function(){$.mobile.loading("hide"),t()}),1e3)}))}function flowCountToVolume(t){return parseFloat((t*((controller.options.fpr1<<8)+controller.options.fpr0)/100).toFixed(2))}function isOSPi(){return!(!controller||"object"!=typeof controller.options||"string"!=typeof controller.options.fwv||-1===controller.options.fwv.search(/ospi/i))}function checkPW(t,e){var i="/sp?pw="+encodeURIComponent(t)+"&npw="+encodeURIComponent(t)+"&cpw="+encodeURIComponent(t);$.ajax({url:currToken?"https://cloud.openthings.io/forward/v1/"+currToken+i:currPrefix+currIp+i,cache:!1,crossDomain:!0,type:"GET"}).then((function(t){var i=t.result;e(!(void 0===i||i>1))}),(function(){e(!1)}))}function changePassword(t){t=$.extend({},{fixIncorrect:!1,name:"",callback:function(){},cancel:function(){}},t);var e=isOSPi(),i=!1,n=$("<div data-role='popup' class='modal' id='changePassword' data-theme='a' data-overlay-theme='b'><ul data-role='listview' data-inset='true'>"+(!0===t.fixIncorrect?"":"<li data-role='list-divider'>"+_("Change Password")+"</li>")+"<li>"+(!0===t.fixIncorrect?"<p class='rain-desc red-text bold'>"+_("Incorrect password for ")+t.name+". "+_("Please re-enter password to try again.")+"</p>":"")+"<form method='post' novalidate><label for='npw'>"+(!0===t.fixIncorrect?_("Password:"):_("New Password")+":")+"</label><input type='password' name='npw' id='npw' value=''"+(e?"":" maxlength='32'")+">"+(!0===t.fixIncorrect?"":"<label for='cpw'>"+_("Confirm New Password")+":</label><input type='password' name='cpw' id='cpw' value=''"+(e?"":" maxlength='32'")+">")+(!0===t.fixIncorrect?"<label for='save_pw'>"+_("Save Password")+"</label><input type='checkbox' data-wrapper-class='save_pw' name='save_pw' id='save_pw' data-mini='true'>":"")+"<input type='submit' value='"+_("Submit")+"'></form></li></ul></div>");n.find("form").on("submit",(function(){var o=n.find("#npw").val(),s=n.find("#cpw").val();return!0===t.fixIncorrect?(i=!0,storage.get(["sites"],(function(e){var i=parseSites(e.sites),s=function(e){currPass=e,i[t.name].os_pw=n.find("#save_pw").is(":checked")?e:"",storage.set({sites:JSON.stringify(i)},cloudSaveSites),n.popup("close"),t.callback()};checkPW(md5(o),(function(t){s(!0===t?md5(o):o)}))})),!1):o!==s?(showerror(_("The passwords don't match. Please try again.")),!1):""===o?(showerror(_("Password cannot be empty")),!1):(!e&&o.length>32&&showerror(_("Password cannot be longer than 32 characters")),checkOSVersion(213)&&(o=md5(o),s=md5(s)),$.mobile.loading("show"),sendToOS("/sp?pw=&npw="+encodeURIComponent(o)+"&cpw="+encodeURIComponent(s),"json").done((function(t){var e=t.result;!e||e>1?showerror(_(2===e?"Please check the current device password is correct then try again":"Unable to change password. Please try again.")):(storage.get(["sites","current_site"],(function(t){var e=parseSites(t.sites);e[t.current_site].os_pw=o,currPass=o,storage.set({sites:JSON.stringify(e)},cloudSaveSites)})),$.mobile.loading("hide"),n.popup("close"),showerror(_("Password changed successfully")))})),!1)})),n.one("popupafterclose",(function(){document.activeElement.blur(),n.remove(),t.fixIncorrect&&!i&&t.cancel()})).popup().enhanceWithin(),t.fixIncorrect?storage.get(["sites","current_site"],(function(e){var i=parseSites(e.sites),o=e.current_site,s=md5(i[o].os_pw);if(isMD5(i[o].os_pw))n.popup("open");else{var a="/jc?pw="+s;$.ajax({url:currToken?"https://cloud.openthings.io/forward/v1/"+currToken+a:currPrefix+currIp+a,type:"GET",dataType:"json"}).then((function(){i[o].os_pw=currPass=s,storage.set({sites:JSON.stringify(i)},cloudSaveSites),t.callback()}),(function(){n.popup("open")}))}})):n.popup("open")}function requestCloudAuth(t){t=t||function(){};var e=$("<div data-role='popup' class='modal' id='requestCloudAuth' data-theme='a'><ul data-role='listview' data-inset='true'><li data-role='list-divider'>"+_("OpenSprinkler.com Login")+"</li><li><p class='rain-desc tight'>"+_("Use your OpenSprinkler.com login and password to securely sync sites between all your devices.")+"<br><br>"+_("Don't have an account?")+" <a href='https://opensprinkler.com/my-account/' class='iab'>"+_("Register here")+"</a></p></li><li><form method='post' novalidate><label for='cloudUser'>"+_("Username:")+"</label><input type='text' name='cloudUser' id='cloudUser' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'><label for='cloudPass'>"+_("Password:")+"</label><input type='password' name='cloudPass' id='cloudPass'><input type='submit' value='"+_("Submit")+"'></form></li></ul></div>"),i=!1;e.find("form").on("submit",(function(){return $.mobile.loading("show"),cloudLogin(e.find("#cloudUser").val(),e.find("#cloudPass").val(),(function(t){!1!==t?($.mobile.loading("hide"),i=!0,e.popup("close")):showerror(_("Invalid username/password combination. Please try again."))})),!1})),e.one("popupafterclose",(function(){t(i),i&&cloudSyncStart()})),openPopup(e)}function cloudLogin(t,e,i){i=i||function(){},$.ajax({type:"POST",dataType:"json",url:"https://opensprinkler.com/wp-admin/admin-ajax.php",data:{action:"ajaxLogin",username:t,password:e},success:function(t){"string"==typeof t.token&&storage.set({cloudToken:t.token,cloudDataToken:sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(e))}),i(t.loggedin)},fail:function(){i(!1)}})}function cloudSaveSites(t){"function"!=typeof t&&(t=function(){}),storage.get(["cloudToken","cloudDataToken","sites"],(function(e){null!==e.cloudToken&&void 0!==e.cloudToken?$.ajax({type:"POST",dataType:"json",url:"https://opensprinkler.com/wp-admin/admin-ajax.php",data:{action:"saveSites",token:e.cloudToken,sites:encodeURIComponent(JSON.stringify(sjcl.encrypt(e.cloudDataToken,e.sites)))},success:function(e){!1===e.success?("BAD_TOKEN"===e.message&&handleExpiredLogin(),t(!1,e.message)):(storage.set({cloudToken:e.token}),t(e.success))},fail:function(){t(!1)}}):t(!1)}))}function cloudGetSites(t){t=t||function(){},storage.get(["cloudToken","cloudDataToken"],(function(e){if(void 0!==e.cloudToken&&null!==e.cloudToken)return void 0===e.cloudDataToken||null===e.cloudDataToken?(handleInvalidDataToken(),void t(!1)):void $.ajax({type:"POST",dataType:"json",url:"https://opensprinkler.com/wp-admin/admin-ajax.php",data:{action:"getSites",token:e.cloudToken},success:function(i){if(!1===i.success||""===i.sites)"BAD_TOKEN"===i.message&&handleExpiredLogin(),t(!1,i.message);else{var n;storage.set({cloudToken:i.token});try{n=sjcl.decrypt(e.cloudDataToken,i.sites)}catch(e){"ccm: tag doesn't match"===e.message&&handleInvalidDataToken(),t(!1)}try{t(JSON.parse(n))}catch(e){t(!1)}}},fail:function(){t(!1)}});t(!1)}))}function cloudSyncStart(){cloudGetSites((function(t){var e=$(".ui-page-active").attr("id");"start"===e?(Object.keys(t).length>0&&storage.set({sites:JSON.stringify(t)}),changePage("#site-control")):(updateLoginButtons(),storage.get("sites",(function(i){if(JSON.stringify(t)!==i.sites)if(i.sites=parseSites(i.sites),currLocal)findLocalSiteName(t,(function(e){!1===e?areYouSure(_("Do you wish to add this location to your cloud synced site list?"),_("This site is not found in the currently synced site list but may be added now."),(function(){t[currIp]=i.sites.Local,storage.set({sites:JSON.stringify(t)},cloudSaveSites),storage.set({current_site:currIp}),updateSiteList(Object.keys(t),currIp)}),(function(){storage.remove("cloudToken",updateLoginButtons)})):(storage.set({sites:JSON.stringify(t)},cloudSaveSites),storage.set({current_site:e}),updateSiteList(Object.keys(t),e))}));else if(Object.keys(t).length>0){var n=$("<div data-role='popup' data-theme='a' data-overlay-theme='b'><div class='ui-bar ui-bar-a'>"+_("Select Merge Method")+"</div><div data-role='controlgroup' class='tight'><button class='merge'>"+_("Merge")+"</button><button class='replaceLocal'>"+_("Replace local with cloud")+"</button><button class='replaceCloud'>"+_("Replace cloud with local")+"</button></div></div>"),o=function(){storage.set({sites:JSON.stringify(t)},cloudSaveSites),n.popup("close"),"site-control"===e&&changePage("#site-control")};n.find(".merge").on("click",(function(){t=$.extend({},i.sites,t),o()})),n.find(".replaceLocal").on("click",(function(){o()})),n.find(".replaceCloud").on("click",(function(){t=i.sites,o()})),n.one("popupafterclose",(function(){n.popup("destroy").remove()})).popup({history:!1,positionTo:"window"}).enhanceWithin().popup("open")}else cloudSaveSites()})))}))}function cloudSync(t){"function"!=typeof t&&(t=function(){}),storage.get(["cloudToken","current_site"],(function(e){"string"==typeof e.cloudToken&&cloudGetSites((function(i){!1!==i&&storage.set({sites:JSON.stringify(i)},(function(){updateSiteList(Object.keys(i),e.current_site),t(),$("html").trigger("siterefresh")}))}))}))}var corruptionNotificationShown=!1;function handleCorruptedWeatherOptions(t){corruptionNotificationShown||(addNotification({title:_("Weather Options have Corrupted"),desc:_("Click here to retrieve the partial weather option data"),on:function(){var e=$(this).parent(),i=$("<div data-role='popup' data-theme='a' class='modal ui-content' id='weatherOptionCorruption'><h3 class='center'>"+_("Weather option data has corrupted")+"</h3><h5 class='center'>"+_("Please note this may indicate other data corruption as well, please verify all settings.")+"</h5><h6 class='center'>"+_("Below is the corrupt data which could not be parsed but may be useful for restoration.")+"</h6><code>"+t[0].substr(7)+"</code><a class='ui-btn ui-corner-all ui-shadow red reset-options' style='width:80%;margin:5px auto;' href='#'>"+_("Reset All Options")+"</a><a class='ui-btn ui-corner-all ui-shadow submit' style='width:80%;margin:5px auto;' href='#'>"+_("Dismiss")+"</a></div>");return i.find(".submit").on("click",(function(){return removeNotification(e),i.popup("close"),!1})),i.find(".reset-options").on("click",(function(){return removeNotification(e),i.popup("close"),resetAllOptions((function(){showerror(_("Settings have been saved"))})),!1})),openPopup(i),!1}}),corruptionNotificationShown=!0)}function handleExpiredLogin(){storage.remove(["cloudToken"],updateLoginButtons),addNotification({title:_("OpenSprinkler.com Login Expired"),desc:_("Click here to re-login to OpenSprinkler.com"),on:function(){var t=$(this).parent();return requestCloudAuth((function(e){removeNotification(t),!0===e&&(updateLoginButtons(),cloudSync())})),!1}})}function handleInvalidDataToken(){storage.remove(["cloudDataToken"]),addNotification({title:_("Unable to read cloud data"),desc:_("Click here to enter a valid password to decrypt the data"),on:function(){var t=$(this).parent(),e=$("<div data-role='popup' data-theme='a' class='modal ui-content' id='dataPassword'><p class='tight rain-desc'>"+_("Please enter your OpenSprinkler.com password. If you have recently changed your password, you may need to enter your previous password to decrypt the data.")+"</p><form><input type='password' id='dataPasswordInput' name='dataPasswordInput' placeholder='"+_("Password")+"' /><input type='submit' data-theme='b' value='"+_("Submit")+"' /></form></div>"),i=!1;return e.find("form").on("submit",(function(){return removeNotification(t),i=!0,storage.set({cloudDataToken:sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(e.find("#dataPasswordInput").val()))},(function(){e.popup("close")})),!1})),e.one("popupafterclose",(function(){!0===i&&cloudSync()})),openPopup(e),!1}})}function getTokenUser(t){return atob(t).split("|")[0]}function detectUnusedExpansionBoards(){"number"==typeof controller.options.dexp&&controller.options.dexp<255&&controller.options.dexp>=0&&controller.options.ext<controller.options.dexp&&addNotification({title:_("Unused Expanders Detected"),desc:_("Click here to enable all connected stations."),on:function(){return removeNotification($(this).parent()),changePage("#os-options",{expandItem:"station"}),!1}})}function showUnifiedFirmwareNotification(){isOSPi()&&storage.get("ignoreUnifiedFirmware",(function(t){"1"!==t.ignoreUnifiedFirmware&&addNotification({title:_("Unified firmware is now avaialble"),desc:_("Click here for more details"),on:function(){var t=window.open("https://openthings.freshdesk.com/support/solutions/articles/5000631599","_blank","location="+(isAndroid?"yes":"no")+",enableViewportScale=yes,toolbarposition=top,closebuttoncaption="+_("Back"));return isIEMobile&&($.mobile.document.data("iabOpen",!0),t.addEventListener("exit",(function(){$.mobile.document.removeData("iabOpen")}))),!1},off:function(){return storage.set({ignoreUnifiedFirmware:"1"}),!0}})}))}function intToIP(t){return(t>>24&255)+"."+(t>>16&255)+"."+(t>>8&255)+"."+(255&t)}function checkPublicAccess(t){if(0!==t&&!currToken){var e=intToIP(t),i=currIp.match(/.*:(\d+)/),n=function(){storage.get("ignoreRemoteFailed",(function(t){"1"!==t.ignoreRemoteFailed&&addNotification({title:_("Remote access is not enabled"),desc:_("Click here to troubleshoot remote access issues"),on:function(){var t=window.open("https://openthings.freshdesk.com/support/solutions/articles/5000569763","_blank","location="+(isAndroid?"yes":"no")+",enableViewportScale=yes,toolbarposition=top,closebuttoncaption="+_("Back"));return isIEMobile&&($.mobile.document.data("iabOpen",!0),t.addEventListener("exit",(function(){$.mobile.document.removeData("iabOpen")}))),!1},off:function(){return storage.set({ignoreRemoteFailed:"1"}),!0}})}))};e!==currIp&&!isLocalIP(e)&&isLocalIP(currIp)&&(i=i?parseInt(i[1]):80,$.ajax({url:currPrefix+e+":"+i+"/jo?pw="+currPass,global:!1,dataType:"json",type:"GET"}).then((function(t){("object"!=typeof t||!t.hasOwnProperty("fwv")||t.fwv!==controller.options.fwv||checkOSVersion(214)&&controller.options.ip4!==t.ip4)&&n()}),n))}}function logout(t){"function"!=typeof t&&(t=function(){}),areYouSure(_("Are you sure you want to logout?"),"",(function(){currLocal?storage.remove(["sites","current_site","lang","provider","wapikey","runonce","cloudToken"],(function(){location.reload()})):storage.remove(["cloudToken"],(function(){updateLoginButtons(),t()}))}))}function updateLoginButtons(){var t=$(".ui-page-active");storage.get("cloudToken",(function(e){var i=$(".login-button"),n=$(".logout-button");null===e.cloudToken||void 0===e.cloudToken?(i.removeClass("hidden"),currLocal||n.addClass("hidden"),n.find("a").text(_("Logout")),"site-control"===t.attr("id")&&t.find(".logged-in-alert").remove()):(n.removeClass("hidden").find("a").text(_("Logout")+" ("+getTokenUser(e.cloudToken)+")"),i.addClass("hidden"),"site-control"===t.attr("id")&&0===t.find(".logged-in-alert").length&&t.find(".ui-content").prepend(addSyncStatus(e.cloudToken)))}))}function addNotification(t){notifications.push(t),updateNotificationBadge();var e=$("#notificationPanel");e.hasClass("ui-panel-open")&&e.find("ul").append(createNotificationItem(t)).listview("refresh")}function updateNotificationBadge(){var t=notifications.length,e=$("#header");0===t?e.find(".notifications").hide():(e.find(".notifications").show(),e.find(".notificationCount").text(t))}function createNotificationItem(t){var e=$("<li><a class='primary' href='#'><h2>"+t.title+"</h2>"+(t.desc?"<p>"+t.desc+"</p>":"")+"</a><a class='ui-btn ui-btn-icon-notext ui-icon-delete'></a></li>");return e.find(".primary").on("click",t.on),e.find(".ui-icon-delete").on("click",(function(){removeNotification($(this).parent())})),e}function showNotifications(){if(0!==notifications.length){for(var t=$("#notificationPanel"),e=$("#footer-menu"),i=[$("<li data-role='list-divider'>"+_("Notifications")+"<button class='ui-btn ui-btn-icon-notext ui-icon-delete btn-no-border clear-all delete'></button></li>").on("click",".clear-all",(function(){var t=$(this);t.hasClass("clear")?clearNotifications():(t.removeClass("delete ui-btn-icon-notext ui-icon-delete").addClass("clear").text(_("Clear")),setTimeout((function(){$.mobile.document.one("click",(function(){t.removeClass("clear").addClass("delete ui-btn-icon-notext ui-icon-delete").text("")}))}),1))}))],n=notifications.length-1;n>=0;n--)i.push(createNotificationItem(notifications[n]));t.find("ul").replaceWith($("<ul/>").append(i).listview()),t.on("panelbeforeclose",(function(){e.removeClass("moveLeft")})),t.panel().panel("option","classes.modal","needsclick ui-panel-dismiss"),e.addClass("moveLeft"),t.panel("open")}}function clearNotifications(){var t=$("#notificationPanel");notifications=[],updateNotificationBadge(),t.find("ul").empty(),t.hasClass("ui-panel-open")&&t.panel("close")}function removeNotification(t){var e=$("#notificationPanel"),i=notifications[t.index()-1].off;("function"!=typeof i||i())&&(notifications.remove(t.index()-1),t.remove(),updateNotificationBadge(),0===notifications.length&&e.hasClass("ui-panel-open")&&e.panel("close"))}function checkFirmwareUpdate(){checkOSVersion(200)&&("3.0"===getHWVersion()||isOSPi())&&$.getJSON("https://api.github.com/repos/opensprinkler/opensprinkler-firmware/releases").done((function(t){controller.options.fwv<t[0].tag_name&&storage.get("updateDismiss",(function(e){(!e.updateDismiss||e.updateDismiss<t[0].tag_name)&&addNotification({title:_("Firmware update available"),on:function(){var e=$(this).parent(),i=30===controller.options.hwv||controller.options.hwv>63&&checkOSVersion(216),n=t[0].html_url,o=$("<div data-role='popup' class='modal' data-theme='a'><h3 class='center' style='margin-bottom:0'>"+_("Latest")+" "+_("Firmware")+": "+t[0].name+"</h3><h5 class='center' style='margin:0'>"+_("This Controller")+": "+getOSVersion()+getOSMinorVersion()+"</h5><a class='iab ui-btn ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' target='_blank' href='"+n+"'>"+_("View Changelog")+"</a><a class='guide ui-btn ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' href='#'>"+_("Update Guide")+"</a>"+(i?"<a class='update ui-btn ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' href='#'>"+_("Update Now")+"</a>":"")+"<a class='dismiss ui-btn ui-btn-b ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' href='#'>"+_("Dismiss")+"</a></div>");o.find(".update").on("click",(function(){30!==controller.options.hwv?sendToOS("/cv?pw=&update=1","json").then((function(){showerror(_("Update successful")),o.find(".dismiss").click()}),(function(){$.mobile.loading("show",{html:"<div class='center'>"+_("Update did not complete.")+"<br><a class='iab ui-btn' href='https://openthings.freshdesk.com/support/solutions/articles/5000631599-installing-and-updating-the-unified-firmware#upgrade'>"+_("Update Guide")+"</a></div>",textVisible:!0,theme:"b"}),setTimeout((function(){$.mobile.loading("hide")}),3e3)})):$("<a class='hidden iab' href='"+currPrefix+currIp+"/update'></a>").appendTo(o).click()})),o.find(".guide").on("click",(function(){var t=controller.options.hwv>63?"https://openthings.freshdesk.com/support/solutions/articles/5000631599-installing-and-updating-the-unified-firmware#upgrade":"https://openthings.freshdesk.com/support/solutions/articles/5000381694-opensprinkler-firmware-update-guide";$("<a class='hidden iab' href='"+t+"'></a>").appendTo(o).click()})),o.find(".dismiss").one("click",(function(){return storage.set({updateDismiss:t[0].tag_name}),o.popup("close"),removeNotification(e),!1})),openPopup(o)}})}))}))}function stopAllStations(){if(!isControllerConnected())return!1;areYouSure(_("Are you sure you want to stop all stations?"),"",(function(){$.mobile.loading("show"),sendToOS("/cv?pw=&rsn=1").done((function(){$.mobile.loading("hide"),removeStationTimers(),refreshStatus(),showerror(_("All stations have been stopped"))}))}))}function checkOSPiVersion(t){var e;return!!isOSPi()&&((e=controller.options.fwv.split("-")[0])===t||versionCompare(e=e.split("."),t=t.split(".")))}function checkOSVersion(t){var e=controller.options.fwv;if(t>=1e3){if(isNaN(controller.options.fwm))return!1;e=10*e+controller.options.fwm}return!isOSPi()&&(t===e||versionCompare(e.toString().split(""),t.toString().split("")))}function versionCompare(t,e){for(var i,n=Math.max(t.length,e.length);t.length<n;)t.push(0);for(;e.length<n;)e.push(0);for(var o=0;o<n&&0===(i=Math.max(-1,Math.min(1,t[o]-e[o])));o++);return-1===i&&(i=!1),i}function getOSVersion(t){return t||"object"!=typeof controller.options||(t=controller.options.fwv),"string"==typeof t&&-1!==t.search(/ospi/i)?t:(t/100>>0)+"."+(t/10>>0)%10+"."+t%10}function getOSMinorVersion(){return!isOSPi()&&"object"==typeof controller.options&&"number"==typeof controller.options.fwm&&controller.options.fwm>0?" ("+controller.options.fwm+")":""}function getHWVersion(t){if(!t){if("object"!=typeof controller.options||void 0===controller.options.hwv)return!1;t=controller.options.hwv}return"string"==typeof t?t:64===t?"OSPi":128===t?"OSBo":192===t?"Linux":255===t?"Demo":(t/10>>0)%10+"."+t%10}function getHWType(){return isOSPi()||"number"!=typeof controller.options.hwt||0===controller.options.hwt?"":172===controller.options.hwt?" - AC":220===controller.options.hwt?" - DC":26===controller.options.hwt?" - Latching":""}function areYouSure(t,e,i,n,o){$("#sure").popup("destroy").remove(),i=i||function(){},n=n||function(){};var s=0;"object"==typeof o&&(s=o.type===dialog.REMOVE_STATION&&Groups.canShift(o.gid)&&Station.isSequential(o.station));var a=$("<div data-role='popup' data-theme='a' id='sure'><h3 class='sure-1 center'>"+t+"</h3><p class='sure-2 center'>"+e+"</p><a class='sure-do ui-btn ui-btn-b ui-corner-all ui-shadow' href='#'>"+_("Yes")+"</a><a class='sure-dont ui-btn ui-corner-all ui-shadow' href='#'>"+_("No")+"</a>"+(s?"<label><input id='shift-sta' type='checkbox'>Move up remaining stations in the same sequential group?</label>":"")+"</div>");a.find(".sure-do").one("click.sure",(function(){return a.popup("close"),i(),!1})),a.find(".sure-dont").one("click.sure",(function(){return a.popup("close"),n(),!1})),openPopup(a)}function showIPRequest(t){var e={title:_("Enter IP Address"),ip:[0,0,0,0],showBack:!0,callback:function(){}};t=$.extend({},e,t),$("#ipInput").popup("destroy").remove();var i=$("<div data-role='popup' id='ipInput' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'><span><fieldset class='ui-grid-c incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-d'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div></fieldset><div class='ui-grid-c inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[0]+"'></div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[1]+"'></div><div class='ui-block-c'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[2]+"'></div><div class='ui-block-d'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[3]+"'></div></div><fieldset class='ui-grid-c decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-d'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div></fieldset></span>"+(t.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),n=function(e,n){var s=i.find(".inputs input").eq(e),a=parseInt(s.val());-1===n&&0===a||1===n&&a>=255||(s.val(a+n),t.callback(o()))},o=function(){return $.makeArray(i.find(".ip_addr").map((function(){return parseInt($(this).val())})))};i.find("button.submit").on("click",(function(){t.callback(o()),i.popup("destroy").remove()})),i.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){""===this.value&&(this.value="0")})),holdButton(i.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return n(e,1),!1})),holdButton(i.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return n(e,-1),!1})),i.css("max-width","350px").one("popupafterclose",(function(){t.callback(o())})),openPopup(i)}function showDurationBox(t){var e={seconds:0,title:_("Duration"),granularity:0,preventCompression:!1,incrementalUpdate:!0,showBack:!0,showSun:!1,minimum:0,callback:function(){}},i=0;t=$.extend({},e,t),$("#durationBox").popup("destroy").remove(),t.seconds=parseInt(t.seconds),65535===t.seconds?(i=1,t.seconds=0):65534===t.seconds&&(i=2,t.seconds=0),checkOSVersion(217)&&(t.preventCompression=!0);var n,o=["days","hours","minutes","seconds"],s=[_("Days"),_("Hours"),_("Minutes"),_("Seconds")],a=[86400,3600,60,1],r=[0,23,59,59],l=4-t.granularity,c=0,d=sec2dhms(t.seconds);if(!t.preventCompression&&checkOSVersion(210)&&t.maximum>64800&&(t.maximum=checkOSVersion(214)?57600:64800),t.maximum)for(n=a.length-1;n>=0;n--)if(t.maximum<a[n]){l=a.length-(c=n+1)-t.granularity;break}var u="<fieldset class='ui-grid-"+String.fromCharCode(95+l)+" incr'>",h="<div class='ui-grid-"+String.fromCharCode(95+l)+" inputs'>",p="<fieldset class='ui-grid-"+String.fromCharCode(95+l)+" decr'>",f=$("<div data-role='popup' id='durationBox' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'>"+(t.helptext?"<p class='rain-desc center smaller'>"+t.helptext+"</p>":"")+"<span></span>"+(t.showSun?"<div class='ui-grid-a useSun'><div class='ui-block-a'><button value='65534' class='ui-mini ui-btn rise "+(2===i?"ui-btn-active":"")+"'>"+_("Sunrise to Sunset")+"</button></div><div class='ui-block-b'><button value='65535' class='ui-mini ui-btn set "+(1===i?"ui-btn-active":"")+"'>"+_("Sunset to Sunrise")+"</button></div></div>":"")+(t.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),m=function(e,i){var n=f.find(".inputs input").eq(e),o=e+c,s=parseInt(n.val());if(!n.prop("disabled")&&!(-1===i&&(g()<=t.minimum||s<=0)||1===i&&g()+a[o]>t.maximum)&&(0!==r[o]&&0!==e&&Math.abs(s)>=r[o]&&(n.val(0),n=f.find(".inputs input").eq(e-1),s=parseInt(n.val())),n.val(s+i),t.incrementalUpdate&&t.callback(g()),!t.preventCompression&&checkOSVersion(210))){var l=1===i;1===i?(g()>=60&&v("seconds",l),g()>=10800&&v("minutes",l)):-1===i&&(g()<=-60?v("seconds",!l):g()<=-10800?v("minutes",!l):g()<60?v("seconds",l):g()<10800&&v("minutes",l))}},g=function(){var t=f.find(".useSun").find("button.ui-btn-active");return 1===t.length?parseInt(t.val()):dhms2sec({days:parseInt(f.find(".days").val())||0,hours:parseInt(f.find(".hours").val())||0,minutes:parseInt(f.find(".minutes").val())||0,seconds:parseInt(f.find(".seconds").val())||0})},v=function(t,e){f.find("."+t).toggleClass("ui-state-disabled",e).prop("disabled",e).val((function(){return e?0:this.value})).parent(".ui-input-text").toggleClass("ui-state-disabled",e)};for(n=c;n<a.length-t.granularity;n++)u+="<div "+(l>1?"class='ui-block-"+String.fromCharCode(97+n-c)+"'":"")+"><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>",h+="<div "+(l>1?"class='ui-block-"+String.fromCharCode(97+n-c)+"'":"")+"><label class='center'>"+_(s[n])+"</label><input data-wrapper-class='pad_buttons' class='"+o[n]+"' type='number' pattern='[0-9]*' value='"+d[o[n]]+"'></div>",p+="<div "+(l>1?"class='ui-block-"+String.fromCharCode(97+n-c)+"'":"")+"><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>";u+="</fieldset>",h+="</div>",p+="</fieldset>",f.find("span").prepend(u+h+p),f.find("button.submit").on("click",(function(){t.callback(g()),f.popup("destroy").remove()})),!t.preventCompression&&checkOSVersion(210)&&(t.seconds<=-60&&v("seconds",!0),t.seconds<=-10800&&v("minutes",!0),t.seconds>=60&&v("seconds",!0),t.seconds>=10800&&v("minutes",!0)),f.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){""===this.value&&(this.value="0")})),holdButton(f.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return m(e,1),!1})),holdButton(f.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return m(e,-1),!1})),t.showSun&&f.find(".useSun").on("click","button",(function(){var e=$(this),i=f.find(".useSun").find("button").not(e),n=f.find("span").find(".ui-btn,input");i.removeClass("ui-btn-active"),e.hasClass("ui-btn-active")?(e.removeClass("ui-btn-active"),n.prop("disabled",!1).removeClass("ui-disabled")):(e.addClass("ui-btn-active"),n.prop("disabled",!0).addClass("ui-disabled")),t.incrementalUpdate&&t.callback(g())})),f.css("max-width","350px").one("popupafteropen",(function(){0!==i&&f.find("span").find(".ui-btn,input").prop("disabled",!0).addClass("ui-disabled")})).one("popupafterclose",(function(){t.incrementalUpdate&&t.callback(g())})),openPopup(f)}function showSingleDurationInput(t){$("#singleDuration").popup("destroy").remove();var e={data:0,title:_("Duration"),minimum:0,label:"",updateOnChange:!0,showBack:!0,callback:function(){}};t=$.extend({},e,t);var i=$("<div data-role='popup' id='singleDuration' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'>"+(t.helptext?"<p class='rain-desc center smaller'>"+t.helptext+"</p>":"")+"<label class='center'>"+t.label+"</label><div class='input_with_buttons'><button class='decr ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input type='number' pattern='[0-9]*' value='"+t.data+"'><button class='incr ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div>"+(t.updateOnChange&&!t.showBack?"":"<input type='submit' data-theme='b' value='"+_("Submit")+"'>")+"</div></div>"),n=i.find("input"),o=function(e){t.callback(parseInt(e).clamp(t.minimum,t.maximum))},s=function(e){var i=parseInt(n.val());-1===e&&i===t.minimum||1===e&&i===t.maximum||(n.val(i+e),t.updateOnChange&&o(i+e))};holdButton(i.find(".incr"),(function(){return s(1),!1})),holdButton(i.find(".decr"),(function(){return s(-1),!1})),i.find("input[type='number']").on("focus",(function(){this.value=""})).on("blur",(function(){""===this.value&&(this.value="0")})),i.find("input[type='submit']").on("click",(function(){o(n.val()),i.popup("destroy").remove()})),i.one("popupafterclose",(function(){t.updateOnChange&&o(n.val())})),openPopup(i)}function showDateTimeInput(t,e){$("#datetimeInput").popup("destroy").remove(),t instanceof Date||(t=new Date(1e3*t)).setMinutes(t.getMinutes()-t.getTimezoneOffset()),e=e||function(){};var i=["Month","Date","FullYear","Hours","Minutes"],n=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")],o=$("<div data-role='popup' id='datetimeInput' data-theme='a'><div data-role='header' data-theme='b'><h1>"+_("Enter Date/Time")+"</h1></div><div class='ui-content'></div></div>"),s=function(i,n){t["setUTC"+i](t["getUTC"+i]()+n),e(new Date(t.getTime())),a()},a=function(){var e,a,r="<fieldset class='ui-grid-d incr'>",l="<div class='ui-grid-d inputs'>",c="<fieldset class='ui-grid-d decr'>";for(a=0;a<5;a++)e=t["getUTC"+i[a]](),"",e="Month"===i[a]?"<p class='center'>"+n[e]+"</p>":"Date"===i[a]?"<p class='center'>"+e+",</p>":"Hours"===i[a]?"<p style='width:90%;display:inline-block' class='center'>"+e+"</p><p style='display:inline-block'>:</p>":"<p class='center'>"+e+"</p>",r+="<div class='ui-block-"+String.fromCharCode(97+a)+"'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>",l+="<div id='"+i[a]+"' class='ui-block-"+String.fromCharCode(97+a)+"'>"+e+"</div>",c+="<div class='ui-block-"+String.fromCharCode(97+a)+"'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>";r+="</fieldset>",l+="</div>",c+="</fieldset>",o.find(".ui-content").html("<span>"+r+l+c+"</span>").enhanceWithin(),o.find(".incr").children().on("vclick",(function(){var t=$(this).index();return s(o.find(".inputs").children().eq(t).attr("id"),1),!1})),o.find(".decr").children().on("vclick",(function(){var t=$(this).index();return s(o.find(".inputs").children().eq(t).attr("id"),-1),!1}))};a(),o.css("width","280px").one("popupafterclose",(function(){e(t)})),openPopup(o)}function showTimeInput(t){var e={minutes:0,title:_("Time"),incrementalUpdate:!0,showBack:!0,showSun:!1,callback:function(){}};t=$.extend({},e,t),$("#timeInput").popup("destroy").remove();var i=2047&t.minutes,n=0;t.minutes>>12&1&&(i=-i),t.minutes>>14&1?n=1:t.minutes>>13&1&&(n=2);var o=t.minutes>719,s=function(){return _(o?"PM":"AM")},a=$("<div data-role='popup' id='timeInput' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'>"+(t.helptext?"<p class='pad-top rain-desc center smaller'>"+t.helptext+"</p>":"")+"<span><fieldset class='ui-grid-"+(isMetric?"a":"b")+" incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>"+(isMetric?"":"<div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>")+"</fieldset><div class='ui-grid-"+(isMetric?"a":"b")+" inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='hour dontPad' type='number' pattern='[0-9]*' value='"+(isMetric?pad((t.minutes/60>>0)%24)+"'>":(parseInt(t.minutes/60)%12==0?12:parseInt(t.minutes/60)%12)+"'>")+"</div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='minute' type='number' pattern='[0-9]*' value='"+pad(t.minutes%60)+"'></div>"+(isMetric?"":"<div class='ui-block-c'><p class='center period'>"+s()+"</p></div>")+"</div><fieldset class='ui-grid-"+(isMetric?"a":"b")+" decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>"+(isMetric?"":"<div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>")+"</fieldset></span>"+(t.showSun?"<div class='ui-grid-a useSun'><div class='ui-block-a'><button class='ui-mini ui-btn rise "+(1===n?"ui-btn-active":"")+"'>"+_("Use Sunrise")+"</button></div><div class='ui-block-b'><button class='ui-mini ui-btn set "+(2===n?"ui-btn-active":"")+"'>"+_("Use Sunset")+"</button></div></div><div class='offsetInput'"+(0===n?" style='display: none;'":"")+"><h5 class='center tight'>"+_("Offset (minutes)")+"</h5><div class='input_with_buttons'><button class='decr ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input class='dontPad' type='number' pattern='[0-9]*' value='"+i+"'><button class='incr ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div></div>":"")+(t.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),r=function(e,i){if(0===e||1===e){var n=l()+i*(0===e?60:1),r=a.find(".inputs input").eq(e),c=r.hasClass("hour"),d=parseInt(r.val());if(1===i){if(c&&(isMetric&&d>=24||!isMetric&&d>=12)&&(d=0),!c&&d>=59){d=-1;var u=a.find(".hour"),h=parseInt(u.val());isMetric||(12===h&&(h=0),u.val(h+1))}}else if(c&&d<=1)d=13;else if(!c&&d<=0)return;(!o&&n>719||o&&n<721||o&&n>1439||!o&&-1===i&&n<0)&&(o=!o,a.find(".period").text(s())),d=c?d+i:pad(d+i),r.val(d)}else 2===e&&(o=!o,a.find(".period").text(s()));t.incrementalUpdate&&t.callback(l())},l=function(){var t=a.find(".useSun").find("button.ui-btn-active");if(1===t.length){var e=0,i=parseInt(a.find(".offsetInput input").val());return t.hasClass("rise")?(i>=0?e=i:(e=-i,e|=4096),e|=16384):(i>=0?e=i:(e=-i,e|=4096),e|=8192),e}var n=parseInt(a.find(".hour").val());return isMetric||(o&&12!==n&&(n+=12),o||12!==n||(n=0)),60*n+parseInt(a.find(".minute").val())};if(a.find("button.submit").on("click",(function(){t.callback(l()),a.popup("destroy").remove()})),a.on("focus","input[type='number']",(function(t){t.target.value=""})).on("blur","input[type='number']",(function(t){var e=parseInt(t.target.value)||0;t.target.value=$(t.target).hasClass("dontPad")?e:pad(e)})),holdButton(a.find(".incr").children(),(function(t){var e=$(t.currentTarget),i=e.index();return 0===e.find(".ui-disabled").length&&r(i,1),!1})),holdButton(a.find(".decr").children(),(function(t){var e=$(t.currentTarget),i=e.index();return 0===e.find(".ui-disabled").length&&r(i,-1),!1})),t.showSun){a.find(".useSun").on("click","button",(function(){var e=$(this),i=a.find(".useSun").find("button").not(e),n=a.find(".offsetInput"),o=a.find("span").find(".ui-btn,input,p");i.removeClass("ui-btn-active"),e.hasClass("ui-btn-active")?(e.removeClass("ui-btn-active"),n.slideUp(),o.prop("disabled",!1).removeClass("ui-disabled")):(e.addClass("ui-btn-active"),n.slideDown(),o.prop("disabled",!0).addClass("ui-disabled")),t.incrementalUpdate&&t.callback(l())}));var c=a.find(".offsetInput").find("input"),d=function(e){var i=parseInt(c.val());-1===e&&-240===i||1===e&&240===i||(c.val(i+e),t.incrementalUpdate&&t.callback(l()))};c.on("focus",(function(){this.value=""})).on("blur",(function(){""===this.value?this.value="0":this.value>240?this.value="240":this.value<-240&&(this.value="-240")})),holdButton(a.find(".offsetInput").find(".incr"),(function(){return d(1),!1})),holdButton(a.find(".offsetInput").find(".decr"),(function(){return d(-1),!1}))}a.css("max-width","350px").one("popupafteropen",(function(){0!==n&&a.find("span").find(".ui-btn,input,p").prop("disabled",!0).addClass("ui-disabled")})).one("popupafterclose",(function(){t.incrementalUpdate&&t.callback(l())})),openPopup(a)}function showHelpText(t){t.stopImmediatePropagation();var e=$(this),i=e.data("helptext");return openPopup($("<div data-role='popup' data-theme='a'><p>"+i+"</p></div>"),{positionTo:e}),!1}function changePage(t,e){e=e||{},0!==t.indexOf("#")&&(t="#"+t),closePanel((function(){$.mobile.pageContainer.pagecontainer("change",t,e)}))}function openPopup(t,e){e=$.extend({},{history:!1,positionTo:"window",overlayTheme:"b"},e),$.mobile.pageContainer.append(t),t.one("popupafterclose",(function(){var e=$("#shift-sta").is(":checked");void 0!==e&&(popupData.shift=e),t.popup("destroy").remove()})).popup(e).enhanceWithin(),t.popup("open")}function closePanel(t){var e=$(".ui-panel-open");if(e.length>0)return e.one("panelclose",(function(){t()})),void e.panel("close");t()}function changeHeader(t){var e=$("#header");""===(t=$.extend(!0,{},{title:"",class:"",animate:!0,leftBtn:{icon:"",class:"",text:"",on:function(){}},rightBtn:{icon:"",class:"",text:"",on:function(){}}},t)).title&&""===t.class&&(t.class="logo");var i=$("<button data-icon='"+t.leftBtn.icon+"' "+(""===t.leftBtn.text?"data-iconpos='notext' ":"")+"class='ui-btn-left "+t.leftBtn.class+"'>"+t.leftBtn.text+"</button><h3 class='"+t.class+"'>"+t.title+"</h3><button data-icon='"+t.rightBtn.icon+"' "+(""===t.rightBtn.text?"data-iconpos='notext' ":"")+"class='ui-btn-right "+t.rightBtn.class+"'>"+t.rightBtn.text+"</button>"),n=t.animate?"fast":0;return e.children().stop().fadeOut(n,(function(){e.html(i).toolbar(e.hasClass("ui-header")?"refresh":null),e.find(".ui-btn-left").on("click",t.leftBtn.on),e.find(".ui-btn-right").on("click",t.rightBtn.on)})).fadeIn(n),i}function getPageTop(){var t=$.mobile.window;return{x:(t[0].innerWidth||t.width())/2+t.scrollLeft(),y:t.scrollTop()+22.5}}function showLoading(t){(t="string"==typeof t?$(t):t).off("click").html("<p class='ui-icon ui-icon-loading mini-load'></p>");var e=t.filter("#footer-running");1===e.length&&e.find(".mini-load").addClass("bottom")}function takePicture(t){"object"==typeof navigator.camera&&"function"==typeof navigator.camera.getPicture&&navigator.camera.getPicture(t,(function(){}),{quality:50,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,allowEdit:!0,targetWidth:200,targetHeight:200})}function goHome(t){if("sprinklers"!==$(".ui-page-active").attr("id")){$.mobile.document.one("pageshow",(function(){delete $.mobile.navigate.history.getActive().transition}));var e={reverse:!0};!0===t&&(e={firstLoad:!0,showLoading:!1,transition:"none"}),changePage("#sprinklers",e)}}function goBack(){var t=$(".ui-page-active");if(1===t.length){var e="site-control"===(t=t.attr("id"))&&!isControllerConnected(),i=$(".ui-popup-active");if(i.length)i.find("[data-role='popup']").popup("close");else if("sprinklers"===t||"start"===t||e)try{navigator.app.exitApp()}catch(t){}else if(isChromeApp||"file:"===window.location.protocol){var n=$.mobile.navigate.history.getPrev().url;if("#"!==n.slice(0,1))return;changePage(n,{reverse:!0}),$.mobile.document.one("pagehide",(function(){$.mobile.navigate.history.activeIndex-=2}))}else pageHistoryCount>0&&pageHistoryCount--,0===pageHistoryCount?navigator.app.exitApp():(goingBack=!0,$.mobile.back())}}function checkChangesBeforeBack(){checkChanges(goBack)}function checkChanges(t){var e=$(".ui-page-active").find(".hasChanges");if(t=t||function(){},0!==e.length)return areYouSure(_("Do you want to save your changes?"),"",(function(){e.click(),e.hasClass("preventBack")||t()}),t),!1;t()}function showerror(t,e){e=e||2500,clearTimeout(errorTimeout),$.mobile.loading("show",{text:t,textVisible:!0,textonly:!0,theme:"b"}),errorTimeout=setTimeout((function(){$.mobile.loading("hide")}),e)}function loadLocalSettings(){storage.get("isMetric",(function(t){switch(t.isMetric){case"true":isMetric=!0;break;case"false":isMetric=!1}})),storage.get("groupView",(function(t){switch(t.groupView){case"true":groupView=!0;break;case"false":groupView=!1}}))}function fixInputClick(t){FastClick.notNeeded(document.body)||(t.find("input[type='checkbox']:not([data-role='flipswitch']),.ui-select > .ui-btn").addClass("needsclick"),t.find(".ui-collapsible-heading-toggle").on("click",(function(){var t=$(this);setTimeout((function(){t.removeClass("ui-btn-active")}),100)})))}function holdButton(t,e){var i;t.on(isTouchCapable?"tap":"click",e).on("taphold",(function(t){i=setInterval((function(){e(t)}),100)})).on("vmouseup vmouseout vmousecancel touchend",(function(){clearInterval(i)})).on("touchmove",(function(t){t.preventDefault()}))}function insertStyle(t){var e=document.createElement("style");e.innerHTML=t,document.head.appendChild(e)}function parseIntArray(t){for(var e=0;e<t.length;e++)t[e]=+t[e];return t}function getDurationText(t){return 65535===t?_("Sunset to Sunrise"):65534===t?_("Sunrise to Sunset"):dhms2str(sec2dhms(t))}function sec2hms(t){var e="",i=Math.max(0,parseInt(t/3600)%24),n=Math.max(0,parseInt(t/60)%60),o=t%60;return i&&(e+=pad(i)+":"),e+pad(n)+":"+pad(o)}function sec2dhms(t){var e=t<0?-1:1;return t=Math.abs(t),{days:Math.max(0,parseInt(t/86400))*e,hours:Math.max(0,parseInt(t%86400/3600))*e,minutes:Math.max(0,parseInt(t%86400%3600/60))*e,seconds:Math.max(0,parseInt(t%86400%3600%60))*e}}function dhms2str(t){var e="";return t.days&&(e+=t.days+_("d")+" "),t.hours&&(e+=t.hours+_("h")+" "),t.minutes&&(e+=t.minutes+_("m")+" "),t.seconds&&(e+=t.seconds+_("s")+" "),""===e&&(e="0"+_("s")),e.trim()}function dhms2sec(t){return parseInt(86400*t.days+3600*t.hours+60*t.minutes+t.seconds)}function isControllerConnected(){return!(!currIp&&!currToken||$.isEmptyObject(controller)||$.isEmptyObject(controller.options)||$.isEmptyObject(controller.programs)||$.isEmptyObject(controller.settings)||$.isEmptyObject(controller.status)||$.isEmptyObject(controller.stations))}function exportObj(t,e,i){if(e=encodeURIComponent(JSON.stringify(e)),isFileCapable)$(t).attr({href:"data:text/json;charset=utf-8,"+e,download:"backup-"+(new Date).toLocaleDateString().replace(/\//g,"-")+".json"});else{i=i||"OpenSprinkler Data Export on "+dateToString(new Date);var n="mailto:?subject="+encodeURIComponent(i)+"&body="+e;$(t).attr("href",n).on("click",(function(){window.open(n)}))}}function sortObj(t,e){var i=[];for(var n in t)t.hasOwnProperty(n)&&i.push(n);"function"==typeof e?i.sort(e):"value"===e?i.sort((function(e,i){var n=t[e],o=t[i];return n<o?-1:n>o?1:0})):i.sort();for(var o={},s=0;s<i.length;s++)o[i[s]]=t[i[s]];return o}function getDayName(t,e){var i=[_("Sunday"),_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday")],n=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thu"),_("Fri"),_("Sat")];return"short"===e?n[t.getDay()]:i[t.getDay()]}function pad(t){var e=String(t);return 1===e.length&&(e="0"+e),e}function htmlEscape(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function _(t){if("object"==typeof language&&language.hasOwnProperty(t)){var e=language[t];return e||t}return t}function setLang(){$("[data-translate]").text((function(){var t=$(this),e=t.data("translate");if(!t.is("input[type='submit']"))return _(e);t.val(_(e)),t.parent("div.ui-btn").length>0&&t.button("refresh")})),$(".ui-toolbar-back-btn").text(_("Back")),checkCurrLang()}function updateLang(t){language={},void 0!==t?(storage.set({lang:t}),currLang=t,"en"!==t?$.getJSON(getAppURLPath()+"locale/"+t+".js",(function(t){language=t.messages,setLang()})).fail(setLang):setLang()):storage.get("lang",(function(t){updateLang((t.lang||navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||"en").substring(0,2))}))}function languageSelect(){$("#localization").popup("destroy").remove();var t="<div data-role='popup' data-theme='a' id='localization' data-corners='false'><ul data-inset='true' data-role='listview' id='lang' data-corners='false'><li data-role='list-divider' data-theme='b' class='center' data-translate='Localization'>"+_("Localization")+"</li>";return $.each({af:"Afrikaans",am:"Amharic",bg:"Bulgarian",zh:"Chinese",hr:"Croatian",cs:"Czech",nl:"Dutch",en:"English",et:"Estonian",pes:"Farsi",fr:"French",de:"German",el:"Greek",he:"Hebrew",hu:"Hungarian",is:"Icelandic",it:"Italian",lv:"Latvian",mn:"Mongolian",no:"Norwegian",pl:"Polish",pt:"Portuguese",ru:"Russian",sk:"Slovak",sl:"Slovenian",es:"Spanish",ta:"Tamil",th:"Thai",tr:"Turkish",sv:"Swedish",ro:"Romanian"},(function(e,i){t+="<li><a href='#' data-lang-code='"+e+"'><span data-translate='"+i+"'>"+_(i)+"</span> ("+e.toUpperCase()+")</a></li>"})),t+="</ul></div>",(t=$(t)).find("a").on("click",(function(){updateLang($(this).data("lang-code"))})),openPopup(t),!1}function checkCurrLang(){storage.get("lang",(function(t){var e=$("#localization");e.find("a").each((function(){var e=$(this);e.data("lang-code")===t.lang?e.removeClass("ui-icon-carat-r").addClass("ui-icon-check"):e.removeClass("ui-icon-check").addClass("ui-icon-carat-r")})),e.find("li.ui-last-child").removeClass("ui-last-child")}))}function getAppURLPath(){return currLocal?$.mobile.path.parseUrl($("head").find("script[src$='app.js']").attr("src")).hrefNoHash.slice(0,-9):""}function getUrlVars(t){for(var e,i={},n=t.slice(t.indexOf("?")+1).split("&"),o=0;o<n.length;o++)i[(e=n[o].split("="))[0]]=decodeURIComponent(e[1].replace(/\+/g,"%20"));return i}function escapeJSON(t){return JSON.stringify(t).replace(/\{|\}/g,"")}function unescapeJSON(t){return JSON.parse("{"+t+"}")}function isMD5(t){return/^[a-f0-9]{32}$/i.test(t)}function sortByStation(t,e){return t.station<e.station?-1:t.station>e.station?1:0}function minutesToTime(t){var e=t>719?"PM":"AM",i=parseInt(t/60)%12;return 0===i&&(i=12),isMetric?pad((t/60>>0)%24)+":"+pad(t%60):i+":"+pad(t%60)+" "+e}function getBitFromByte(t,e){return 0!=(t&1<<e)}function getTimezoneOffset(){var t=controller.options.tz-48,e=t>=0?1:-1;return(t=60*(Math.abs(t)/4>>0)+(Math.abs(t)%4*15/10>>0)+Math.abs(t)%4*15%10)*e}function humaniseDuration(t,e){var i,n=Math.floor((e-t)/1e3),o=n>0;if((n=Math.abs(n))<10)return _("Just Now");var s=Math.floor(n/31536e3);return i=_(s>=1?s>1?"years":"year":(s=Math.floor(n/2592e3))>=1?s>1?"months":"month":(s=Math.floor(n/86400))>=1?s>1?"days":"day":(s=Math.floor(n/3600))>=1?s>1?"hours":"hour":(s=Math.floor(n/60))>=1?s>1?"minutes":"minute":(s=n)>1?"seconds":"second"),o?_("In")+" "+s+" "+i:s+" "+i+" "+_("ago")}function dateToString(t,e,i){var n=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thu"),_("Fri"),_("Sat")],o=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")];return 0===t.getTime()?"--":(!1!==e&&t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),"de"===currLang?pad(t.getDate())+"."+pad(t.getMonth()+1)+"."+t.getFullYear()+" "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()):1===i?o[t.getMonth()]+" "+pad(t.getDate())+", "+t.getFullYear()+" "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()):2===i?o[t.getMonth()]+" "+pad(t.getDate())+", "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()):n[t.getDay()]+", "+pad(t.getDate())+" "+o[t.getMonth()]+" "+t.getFullYear()+" "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()))}function transformKeys(t){if(checkOSVersion(219)){var e={};return Object.keys(t).forEach((function(i){var n=i.match(/^o(\d+)$/);n&&n[1]?e[Object.keys(keyIndex).find((function(t){return keyIndex[t]===parseInt(n[1],10)}))]=t[i]:e[i]=t[i]})),e}return t}function transformKeysinString(t){var e={};t.split("&").forEach((function(t){t=t.split("="),e[t[0]]=t[1]})),e=transformKeys(e);var i=[];return Object.keys(e).forEach((function(t){i.push(t+"="+e[t])})),t=i.join("&")}function Supported(){}function Station(){}$.fn.focusInput=function(){if(this.get(0).setSelectionRange)this.focus(),this.get(0).setSelectionRange(0,this.val().length);else if(this.get(0).createTextRange){var t=this.get(0).createTextRange();t.collapse(!0),t.moveEnd("character",this.val().length),t.moveStart("character",0),t.select()}return this},Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},Supported.master=function(t){switch(t){case MASTER_STATION_1:return!!controller.options.mas;case MASTER_STATION_2:return!!controller.options.mas2;default:return!1}},Supported.ignoreRain=function(){return"object"==typeof controller.stations.ignore_rain},Supported.ignoreSensor=function(t){switch(t){case IGNORE_SENSOR_1:return"object"==typeof controller.stations.ignore_sn1;case IGNORE_SENSOR_2:return"object"==typeof controller.stations.ignore_sn2;default:return!1}},Supported.actRelay=function(){return"object"==typeof controller.stations.act_relay},Supported.disabled=function(){return"object"==typeof controller.stations.stn_dis},Supported.sequential=function(){return!checkOSVersion(220)&&"object"==typeof controller.stations.stn_seq},Supported.special=function(){return"object"==typeof controller.stations.stn_spe},Supported.pausing=function(){return void 0!==controller.settings.pq},Supported.groups=function(){return getNumberProgramStatusOptions()>=4},Supported.dateRange=function(){return checkOSVersion(220)};var ProgramStatusOptions={PID:0,REM:1,START:2,GID:3};function getNumberProgramStatusOptions(){if(!(controller.settings.ps.length<=0))return controller.settings.ps[0].length}function StationAttribute(){}function CardList(){}function Card(){}function Groups(){}function StationQueue(){}function mapIndexToGIDValue(t){return t-NUM_SEQ_GROUPS?t:PARALLEL_GID_VALUE}function mapGIDValueToName(t){switch(t){case PARALLEL_GID_VALUE:return PARALLEL_GROUP_NAME;case MASTER_GID_VALUE:return MASTER_GROUP_NAME;default:return String.fromCharCode(65+t)}}function mapGIDNameToValue(t){switch(t){case PARALLEL_GROUP_NAME:return PARALLEL_GID_VALUE;case MASTER_GROUP_NAME:return MASTER_GID_VALUE;default:return t.charCodeAt(0)-65}}Station.getName=function(t){return controller.stations.snames[t]},Station.setName=function(t,e){controller.settings.snames[t]=e},Station.getPID=function(t){return controller.settings.ps[t][ProgramStatusOptions.PID]},Station.setPID=function(t,e){controller.settings.ps[t][ProgramStatusOptions.PID]=e},Station.getRemainingRuntime=function(t){return controller.settings.ps[t][ProgramStatusOptions.REM]},Station.setRemainingRuntime=function(t,e){controller.settings.ps[t][ProgramStatusOptions.REM]=e},Station.getStartTime=function(t){return controller.settings.ps[t][ProgramStatusOptions.START]},Station.setStartTime=function(t,e){controller.settings.ps[t][ProgramStatusOptions.START]=e},Station.getGIDValue=function(t){if(Supported.groups())return controller.settings.ps[t][ProgramStatusOptions.GID]},Station.setGIDValue=function(t,e){Supported.groups()&&(controller.settings.ps[t][ProgramStatusOptions.GID]=e)},Station.getStatus=function(t){return controller.status[t]},Station.setStatus=function(t,e){controller.status[t]=e},Station.isRunning=function(t){return Station.getStatus(t)>0},Station.isMaster=function(t){var e="number"==typeof controller.options.mas?controller.options.mas:0,i="number"==typeof controller.options.mas2?controller.options.mas2:0;return e===++t?1:i===t?2:0},Station.isSequential=function(t){return StationAttribute.getSequential(t)>0},Station.isSpecial=function(t){return StationAttribute.getSpecial(t)>0},Station.isDisabled=function(t){return StationAttribute.getDisabled(t)>0},StationAttribute.getMasterOperation=function(t,e){var i,n=t/8>>0;if(!Supported.master(e))return 0;switch(e){case MASTER_STATION_1:i=controller.stations.masop;break;case MASTER_STATION_2:i=controller.stations.masop2;break;default:return 0}return i[n]&1<<t%8?1:0},StationAttribute.getIgnoreRain=function(t){if(!Supported.ignoreRain())return 0;var e=t/8>>0;return controller.stations.ignore_rain[e]&1<<t%8?1:0},StationAttribute.getIgnoreSensor=function(t,e){var i,n=t/8>>0;if(!Supported.ignoreSensor(e))return 0;switch(e){case IGNORE_SENSOR_1:i=controller.stations.ignore_sn1;break;case IGNORE_SENSOR_2:i=controller.stations.ignore_sn2;break;default:return 0}return i[n]&1<<t%8?1:0},StationAttribute.getActRelay=function(t){if(!Supported.actRelay())return 0;var e=t/8>>0;return controller.stations.act_relay[e]&1<<t%8?1:0},StationAttribute.getDisabled=function(t){if(!Supported.disabled())return 0;var e=t/8>>0;return controller.stations.stn_dis[e]&1<<t%8?1:0},StationAttribute.getSequential=function(t){if(Supported.groups())return Station.getGIDValue!==PARALLEL_GID_VALUE?1:0;if(!Supported.sequential())return 0;var e=t/8>>0;return controller.stations.stn_seq[e]&1<<t%8?1:0},StationAttribute.getSpecial=function(t){if(!Supported.special())return 0;var e=t/8>>0;return controller.stations.stn_spe[e]&1<<t%8?1:0},CardList.getAllCards=function(t){return t.filter(".card")},CardList.getCardBySID=function(t,e){return t.filter("[data-station='"+e+"']")},CardList.getCardByIndex=function(t,e){return $(t[e])},Card.getSID=function(t){return t.data("station")},Card.getDivider=function(t){return t.find(".content-divider")},Card.getGroupLabel=function(t){if(Supported.groups())return t.find(".station-gid")},Card.setGroupLabel=function(t,e){if(Supported.groups()){var i=Card.getGroupLabel(t);i.removeClass("hidden"),i.text(e)}},Card.getGIDValue=function(t){if(!Supported.groups())return 0;var e=$(t.children()[0]).children().filter("span"),i=$(e[e.length-1]);return parseInt(i.attr("data-gid"))},Card.getGIDName=function(t){return mapGIDValueToName(Station.getGIDValue(Card.getSID(t)))},Card.isMasterStation=function(t){return Station.isMaster(Card.getSID(t))},Groups.numActiveStations=function(t){var e=$(".station-status.on, .station-status.wait").parents(".card"),i=0;return $.each(e,(function(n){var o=$(e[n]);Card.getGIDValue(o)!==t||Card.isMasterStation(o)||i++})),i},Groups.canShift=function(t){return Groups.numActiveStations(t)>1},StationQueue.isActive=function(){for(var t=0;t<controller.status.length;t++)if(Station.getStatus(t)>0&&Station.getPID(t)>0)return t;return-1},StationQueue.isPaused=function(){return controller.settings.pq},StationQueue.size=function(){return controller.settings.nq};var dateRegex=/[0-9]{1,2}[\/][0-9]{1,2}/g;function Program(){}function extractDateFromString(t){return t.match(dateRegex)}function isValidDateFormat(t){return null!==extractDateFromString(t)}function isValidDateRange(t,e){return isValidDateFormat(t)&&isValidDateFormat(e)}function encodeDate(t){var e=extractDateFromString(t);if(null===e)return-1;var i=e[0].split("/",2);return(parseInt(i[0])<<5)+parseInt(i[1])}Program.getDateRange=function(t){return controller.programs.pd[t][6]},Program.isDateRangeEnabled=function(t){return"new"===t?0:Program.getDateRange(t)[0]},Program.getDateRangeStart=function(t){return"new"===t?minEncodedDate:Program.getDateRange(t)[1]},Program.getDateRangeEnd=function(t){return"new"===t?maxEncodedDate:Program.getDateRange(t)[2]};var minEncodedDate=encodeDate("01/01"),maxEncodedDate=encodeDate("12/31");function decodeDate(t){var e,i,n=[];return minEncodedDate<=t&&t<=maxEncodedDate?(e=t>>5,i=t%32,n.push(e/10>>0,e%10,"/",i/10>>0,i%10),n.join("")):t<minEncodedDate?"01/01":"12/31"}var analogSensors={},progAdjusts={};function refresh(){setTimeout((function(){location.reload()}),100)}function updateProgramAdjustments(t){return t=t||function(){},sendToOS("/se?pw=","json").then((function(e){progAdjusts=e.progAdjust,t()}))}function updateAnalogSensor(t){return t=t||function(){},sendToOS("/sl?pw=","json").then((function(e){analogSensors=e.sensors,t()}))}function updateSensorShowArea(t){if(checkOSVersion(230)){var e,i,n=t.find("#os-sensor-show"),o="";for(e=0;e<progAdjusts.length;e++){var s=progAdjusts[e],a="";for(i=0;i<analogSensors.length;i++)analogSensors[i].nr===s.sensor&&(a=analogSensors[i].name);var r="?";s.prog>=1&&s.prog<=controller.programs.pd.length&&(r=readProgram(controller.programs.pd[s.prog-1]).name),o+="<div id='progAdjust-show-"+s.nr+"' class='ui-body ui-body-a center'>",o+="<label>"+a+" - "+r+": "+Math.round(100*s.current)+"%</label>",o+="</div>"}for(e=0;e<analogSensors.length;e++){var l=analogSensors[e];l.show&&(o+="<div id='sensor-show-"+l.nr+"' class='ui-body ui-body-a center'>",o+="<label>"+l.name+": "+Math.round(l.data)+l.unit+"</label>",o+="</div>")}for(;n.firstChild;)n.removeChild(n.firstChild);n.html(o)}}function toByteArray(t){for(var e=[],i=4;i--;)e.push(Number(t%256)),t/=256;return Uint8Array.from(e)}function intFromBytes(t){try{for(var e=0,i=t.length-1;i>=0;i--)e*=256,e+=parseInt(t[i]);return e}catch(t){return 0}}function showAdjustmentsEditor(t,e){sendToOS("/sh?pw=","json").then((function(i){var n,o=i.progTypes;$(".ui-popup-active").find("[data-role='popup']").popup("close");var s="<div data-role='popup' data-theme='a' id='progAdjustEditor'><div data-role='header' data-theme='b'><h1>"+_(t.nr>0?"Edit Program Adjustment":"New Program Adjustment")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Notice: If you want to combine multiple sensors, then build a sensor group. ")+_("See Help Documentation for details.")+"</p><div class='ui-field-contain'><label>"+_("Adjustment-Nr")+"</label><input class='nr' type='number' min='1' max='99999' value='"+t.nr+(t.nr>0?"' disabled='disabled'>":"'>")+"<div class='ui-field-contain'><label for='type' class='select'>"+_("Type")+"</label><select data-mini='true' id='type'>";for(n=0;n<o.length;n++)s+="<option "+(t.type===o[n].type?"selected":"")+" value='"+o[n].type+"'>"+o[n].name+"</option>";for(s+="</select></div><div class='ui-field-contain'><label for='sensor' class='select'>"+_("Sensor")+"</label><select data-mini='true' id='sensor'>",n=0;n<analogSensors.length;n++)s+="<option "+(t.sensor===analogSensors[n].nr?"selected":"")+" value='"+analogSensors[n].nr+"'>"+analogSensors[n].nr+" - "+analogSensors[n].name+"</option>";for(s+="</select></div><div class='ui-field-contain'><label for='prog' class='select'>"+_("Program to adjust")+"</label><select data-mini='true' id='prog'>",n=0;n<controller.programs.pd.length;n++){var a=readProgram(controller.programs.pd[n]).name,r=n+1;s+="<option "+(t.prog===r?"selected":"")+" value='"+r+"'>"+a+"</option>"}s+="</select></div><label>"+_("Factor 1 (adjustment for Min)")+"</label><input class='factor1' type='number' value='"+t.factor1+"'><label>"+_("Factor 2 (adjustment for Max)")+"</label><input class='factor2' type='number' value='"+t.factor2+"'><label>"+_("Min Sensor value")+"</label><input class='min' type='number' value='"+t.min+"'><label>"+_("Max Sensor value")+"</label><input class='max' type='number' value='"+t.max+"'></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>";var l=$(s),c=function(t,e){var i=l.find(".inputs input").eq(t),n=parseInt(i.val());-1===e&&0===n||1===e&&100===n||i.val(n+e)};l.find(".submit").on("click",(function(){var t={nr:parseInt(l.find(".nr").val()),type:parseInt(l.find("#type").val()),sensor:parseInt(l.find("#sensor").val()),prog:parseInt(l.find("#prog").val()),factor1:parseFloat(l.find(".factor1").val()),factor2:parseFloat(l.find(".factor2").val()),min:parseFloat(l.find(".min").val()),max:parseFloat(l.find(".max").val())};return e(t),l.popup("close"),!1})),l.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),holdButton(l.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return c(e,1),!1})),holdButton(l.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return c(e,-1),!1})),$("#sensorEditor").remove(),l.css("max-width","580px"),openPopup(l,{positionTo:"window"})}))}function isSmt100(t){return!!t&&(1===t||2===t)}function showSensorEditor(t,e){sendToOS("/sf?pw=","json").then((function(i){var n,o=i.sensorTypes;$(".ui-popup-active").find("[data-role='popup']").popup("close");var s="<div data-role='popup' data-theme='a' id='sensorEditor'><div data-role='header' data-theme='b'><h1>"+_(t.nr>0?"Edit Sensor":"New Sensor")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Edit Sensor Configuration. ")+_("See Help Documentation for details.")+"</p><div class='ui-field-contain'><label>"+_("Sensor-Nr")+"</label><input class='nr' type='number' min='1' max='99999' value='"+t.nr+(t.nr>0?"' disabled='disabled'>":"'>")+"<div class='ui-field-contain'><label for='type' class='select'>"+_("Type")+"</label><select data-mini='true' id='type'>";for(n=0;n<o.length;n++)s+="<option "+(t.type===o[n].type?"selected":"")+" value='"+o[n].type+"'>"+o[n].name+"</option>";s+="</select></div>",s+="<button data-mini='true' class='center-div' id='smt100id' style='display:"+(isSmt100(t.type)?"block":"none")+"'>"+_("Set SMT100 Modbus ID")+"</button>",s+="<label>"+_("Group")+"</label><input class='group' type='number'  min='0' max='99999' value='"+t.group+"'><label>"+_("Name")+"</label><input class='name' type='text'  value='"+t.name+"'><label>"+_("IP-Address")+"</label><input class='ip' type='text'  value='"+(t.ip?toByteArray(t.ip).join("."):"")+"'><label>"+_("Port")+"</label><input class='port' type='number' min='0' max='65535' value='"+t.port+"'><label>"+_("ID")+"</label><input class='id' type='number' min='0' max='65535' value='"+t.id+"'><label>"+_("Read Interval (s)")+"</label><input class='ri' type='number' min='1' max='999999' value='"+t.ri+"'><label for='enable'><input data-mini='true' id='enable' type='checkbox' "+(1===t.enable?"checked='checked'":"")+">"+_("Sensor Enabled")+"</label><label for='log'><input data-mini='true' id='log' type='checkbox' "+(1===t.log?"checked='checked'":"")+">"+_("Enable Data Logging")+"</label><label for='log'><input data-mini='true' id='show' type='checkbox' "+(1===t.show?"checked='checked'":"")+">"+_("Show on Mainpage")+"</label></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>";var a=$(s),r=function(t,e){var i=a.find(".inputs input").eq(t),n=parseInt(i.val());-1===e&&0===n||1===e&&100===n||i.val(n+e)};a.find("#smt100id").on("click",(function(){var t=parseInt(a.find(".nr").val()),e=parseInt(a.find(".id").val());a.popup("close"),areYouSure(_("This function sets the Modbus ID for one SMT100 sensor. Disconnect all other sensors on this Modbus port. Please confirm."),"new id="+e,(function(){sendToOS("/sa?pw=&nr="+t+"&id="+e).done((function(){window.alert("SMT100 id assigned!"),updateAnalogSensor(refresh)}))}))})),a.find("#type").change((function(){var t=parseInt(a.find("#type").val());document.getElementById("smt100id").style.display=isSmt100(t)?"block":"none"})),a.find(".submit").on("click",(function(){if(!t.nr)for(var i=parseInt(a.find(".nr").val()),n=0;n<analogSensors.length;n++)if(analogSensors[n].nr===i)return void window.alert(_("Sensor-Number exists!"));var o={nr:parseInt(a.find(".nr").val()),type:parseInt(a.find("#type").val()),group:parseInt(a.find(".group").val()),name:a.find(".name").val(),ip:intFromBytes(a.find(".ip").val().split(".")),port:parseInt(a.find(".port").val()),id:parseInt(a.find(".id").val()),ri:parseInt(a.find(".ri").val()),enable:a.find("#enable").is(":checked")?1:0,log:a.find("#log").is(":checked")?1:0,show:a.find("#show").is(":checked")?1:0};return e(o),a.popup("close"),!1})),a.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),holdButton(a.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return r(e,1),!1})),holdButton(a.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return r(e,-1),!1})),$("#sensorEditor").remove(),a.css("max-width","580px"),openPopup(a,{positionTo:"window"})}))}var showAnalogSensorConfig=function(){var t=$("<div data-role='page' id='analogsensorconfig'><div class='ui-content' role='main' id='analogsensorlist'></div></div>");function e(){var i=$(buildSensorConfig());i.find("#delete-sensor").on("click",(function(){var t=$(this),i=t.attr("value"),n=t.attr("row");areYouSure(_("Are you sure you want to delete the sensor?"),i,(function(){sendToOS("/sc?pw=&nr="+i+"&type=0").done((function(){analogSensors.splice(n,1),e()}))}))})),i.find("#edit-sensor").on("click",(function(){var t=$(this).attr("row"),i=analogSensors[t];showSensorEditor(i,(function(n){n.nativedata=i.nativedata,n.data=i.data,n.last=i.last,sendToOS("/sc?pw=&nr="+n.nr+"&type="+n.type+"&group="+n.group+"&name="+n.name+"&ip="+n.ip+"&port="+n.port+"&id="+n.id+"&ri="+n.ri+"&enable="+n.enable+"&log="+n.log+"&show="+n.show).done((function(){analogSensors[t]=n,e()}))}))})),i.find("#add-sensor").on("click",(function(){showSensorEditor({name:"new sensor",type:1,ri:60,enable:1,log:1},(function(t){sendToOS("/sc?pw=&nr="+t.nr+"&type="+t.type+"&group="+t.group+"&name="+t.name+"&ip="+t.ip+"&port="+t.port+"&id="+t.id+"&ri="+t.ri+"&enable="+t.enable+"&log="+t.log+"&show="+t.show).done((function(){analogSensors.push(t),e()}))}))})),i.find("#refresh-sensor").on("click",(function(){updateProgramAdjustments((function(){updateAnalogSensor((function(){e()}))}))})),i.find("#delete-progadjust").on("click",(function(){var t=$(this),i=t.attr("value");row=t.attr("row"),areYouSure(_("Are you sure you want to delete this program adjustment?"),i,(function(){sendToOS("/sb?pw=&nr="+i+"&type=0").done((function(){progAdjusts.splice(row,1),e()}))}))})),i.find("#edit-progadjust").on("click",(function(){var t=$(this).attr("row");showAdjustmentsEditor(progAdjusts[t],(function(i){sendToOS("/sb?pw=&nr="+i.nr+"&type="+i.type+"&sensor="+i.sensor+"&prog="+i.prog+"&factor1="+i.factor1+"&factor2="+i.factor2+"&min="+i.min+"&max="+i.max).done((function(){progAdjusts[t]=i,e()}))}))})),i.find("#add-progadjust").on("click",(function(){showAdjustmentsEditor({type:1},(function(t){sendToOS("/sb?pw=&nr="+t.nr+"&type="+t.type+"&sensor="+t.sensor+"&prog="+t.prog+"&factor1="+t.factor1+"&factor2="+t.factor2+"&min="+t.min+"&max="+t.max).done((function(){progAdjusts.push(t),e()}))}))})),i.find("#clear-log").on("click",(function(){areYouSure(_("Are you sure you want to clear the sensor log?"),"",(function(){sendToOS("/sn?pw=&").done((function(t){window.alert(_("Log cleared: "+t.deleted+_(" records"))),e()}))}))})),i.find("#download-log").on("click",(function(){var t=document.createElement("a");t.setAttribute("download","sensorlog-"+(new Date).toLocaleDateString().replace(/\//g,"-")+".csv"),dest="/so?pw=&csv=1",dest=dest.replace("pw=","pw="+encodeURIComponent(currPass)),t.href=currToken?"https://cloud.openthings.io/forward/v1/"+currToken+dest:currPrefix+currIp+dest,alert(t.href),document.body.appendChild(t),t.click()})),i.find("#show-log").on("click",(function(){return changePage("#analogsensorchart"),!1})),t.find("#analogsensorlist").html(i.enhanceWithin())}return t.on("sensorrefresh",e).on("pagehide",(function(){t.detach()})),function(){changeHeader({title:_("Analog Sensor Config"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),e(),$("#analogsensorconfig").remove(),$.mobile.pageContainer.append(t)}}();function buildSensorConfig(){var t='<table id=\'analog_sensor_table\'><tr style=\'width:100%;vertical-align: top;\'><tr><th>Nr</th><th class="hidecol">Type</th><th class="hidecol">Group</th><th>Name</th><th class="hidecol">IP</th><th class="hidecol">Port</th><th class="hidecol">ID</th><th class="hidecol">Read<br>Interval</th><th class="hidecol">Data</th><th>Enabled</th><th class="hidecol">Log</th><th class="hidecol">Show</th><th class="hidecol2">Last</th></tr>',e=0;return $.each(analogSensors,(function(i,n){var o=$("<tr>").append($("<td>").text(n.nr),$('<td class="hidecol">').text(n.type),$('<td class="hidecol">').text(n.group?n.group:""),$("<td>").text(n.name),$('<td class="hidecol">').text(n.ip?toByteArray(n.ip).join("."):""),$('<td class="hidecol">').text(n.port?n.port:""),$('<td class="hidecol">').text(n.type<1e3?n.id:""),$('<td class="hidecol">').text(n.ri),$('<td class="hidecol">').text(Math.round(n.data)+n.unit),$("<td>").text(n.enable),$('<td class="hidecol">').text(n.log),$('<td class="hidecol">').text(n.show),$('<td class="hidecol2">').text(dateToString(new Date(1e3*n.last)),null,2),"<td><button data-mini='true' class='center-div' id='edit-sensor' value='"+n.nr+"' row='"+e+"'>"+_("Edit")+"</button></td>","<td><button data-mini='true' class='center-div' id='delete-sensor' value='"+n.nr+"' row='"+e+"'>"+_("Delete")+"</button></td>");t+=o.wrap("<p>").html()+"</tr>",e++})),t+="</table>",t+="<p><button data-mini='true' class='center-div' id='add-sensor' value='1'>"+_("Add Sensor")+"</button></p>",t+="<p><button data-mini='true' class='center-div' id='refresh-sensor' value='2'>"+_("Refresh Sensordata")+"</button></p>",t+='<table id=\'progadjusttable\'><tr style=\'width:100%;vertical-align: top;\'><tr><th>Nr</th><th class="hidecol">Type</th><th>Sensor-Nr</th><th>Name</th><th class="hidecol2">Program-Nr</th><th>Program</th><th class="hidecol2">Factor 1</th><th class="hidecol2">Factor 2</th><th class="hidecol2">Min Value</th><th class="hidecol2">Max Value</th><th class="hidecol">Current</th></tr>',e=0,$.each(progAdjusts,(function(i,n){for(var o="",s=0;s<analogSensors.length;s++)analogSensors[s].nr===n.sensor&&(o=analogSensors[s].name);var a="?";n.prog>=1&&n.prog<=controller.programs.pd.length&&(a=readProgram(controller.programs.pd[n.prog-1]).name);var r=$("<tr>").append($("<td>").text(n.nr),$('<td class="hidecol">').text(n.type),$('<td class="hidecol">').text(n.sensor),$('<td class="hidecol2">').text(o),$("<td>").text(n.prog),$("<td>").text(a),$('<td class="hidecol2">').text(n.factor1),$('<td class="hidecol2">').text(n.factor2),$('<td class="hidecol2">').text(n.min),$('<td class="hidecol2">').text(n.max),$('<td class="hidecol">').text(Math.round(100*n.current)+"%"),"<td><button data-mini='true' class='center-div' id='edit-progadjust' value='"+n.nr+"' row='"+e+"'>"+_("Edit")+"</button></td>","<td><button data-mini='true' class='center-div' id='delete-progadjust' value='"+n.nr+"' row='"+e+"'>"+_("Delete")+"</button></td>");t+=r.wrap("<p>").html()+"</tr>",e++})),t+="</table>",t+="<p><button data-mini='true' class='center-div' id='add-progadjust' value='3'>"+_("Add program adjustment")+"</button></p>",t+="<table id='logfunctions'><tr style='width:100%;vertical-align: top;'><tr><th><button data-mini='true' class='center-div' id='clear-log'>"+_("Clear Log")+"</button></th><th><button data-mini='true' class='center-div' id='download-log'>"+_("Download Log")+"</button></th><th><a href='#analogsensorchart'><button data-mini='true' class='center-div' id='show-log'>"+_("Show Log")+"</button></a></th></tr></table>"}var showAnalogSensorCharts=function(){var t,e=$("<div data-role='page' id='analogsensorchart'><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'><h1>Analog sensor log last 24h</h1><canvas id='myChart'></canvas></div></div>");return function(){t=null,e.one("pagehide",(function(){t.destroy(),e.detach()})),changeHeader({title:_("Analog sensor log last 24h"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#analogsensorchart").remove(),$.mobile.pageContainer.append(e),sendToOS("/so?pw=&lasthours=24","json").then((function(e){var i,n,o=[],s=[],a={hour:"2-digit",minute:"2-digit",timeZone:"UTC"};for(s.x={type:"time",time:{unit:"hour",unitStepSize:1,displayFormats:{hour:"hh:mm"}},display:!0,ticks:{callback:function(t){return new Date(t).toLocaleTimeString([],a)}}},i=0;i<analogSensors.length;i++){var r=analogSensors[i].nr,l=[];for(n=0;n<e.log.length;n++)e.log[n].nr===r&&l.push({x:1e3*e.log[n].time,y:e.log[n].data});if(l.length>0){var c=analogSensors[i].unitid;o.push({label:analogSensors[i].name,data:l,fill:!1,xAxisID:"x",yAxisID:"y"+c}),s["y"+c]=1===c?{type:"linear",display:!0,position:"left",title:{display:!0,text:analogSensors[i].unit},suggestedMin:0,suggestedMax:50}:{type:"linear",display:!0,position:c%2?"left":"right",title:{display:!0,text:analogSensors[i].unit}}}}var d=document.getElementById("myChart").getContext("2d");t=new Chart(d,{type:"line",data:{datasets:o},options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:s}})}))}}();!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Chart=e()}(this,(function(){"use strict";var t=Object.freeze({__proto__:null,get Colors(){return Ms},get Decimation(){return Es},get Filler(){return Gs},get Legend(){return Qs},get SubTitle(){return ia},get Title(){return ta},get Tooltip(){return va}});function e(){}const i=(()=>{let t=0;return()=>t++})();function n(t){return null==t}function o(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function s(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function a(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function r(t,e){return a(t)?t:e}function l(t,e){return void 0===t?e:t}const c=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/e,d=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function u(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)}function h(t,e,i,n){let a,r,l;if(o(t))if(r=t.length,n)for(a=r-1;a>=0;a--)e.call(i,t[a],a);else for(a=0;a<r;a++)e.call(i,t[a],a);else if(s(t))for(l=Object.keys(t),r=l.length,a=0;a<r;a++)e.call(i,t[l[a]],l[a])}function p(t,e){let i,n,o,s;if(!t||!e||t.length!==e.length)return!1;for(i=0,n=t.length;i<n;++i)if(o=t[i],s=e[i],o.datasetIndex!==s.datasetIndex||o.index!==s.index)return!1;return!0}function f(t){if(o(t))return t.map(f);if(s(t)){const e=Object.create(null),i=Object.keys(t),n=i.length;let o=0;for(;o<n;++o)e[i[o]]=f(t[i[o]]);return e}return t}function m(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function g(t,e,i,n){if(!m(t))return;const o=e[t],a=i[t];s(o)&&s(a)?v(o,a,n):e[t]=f(a)}function v(t,e,i){const n=o(e)?e:[e],a=n.length;if(!s(t))return t;const r=(i=i||{}).merger||g;let l;for(let e=0;e<a;++e){if(l=n[e],!s(l))continue;const o=Object.keys(l);for(let e=0,n=o.length;e<n;++e)r(o[e],t,l,i)}return t}function b(t,e){return v(t,e,{merger:y})}function y(t,e,i){if(!m(t))return;const n=e[t],o=i[t];s(n)&&s(o)?b(n,o):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=f(o))}const _={"":t=>t,x:t=>t.x,y:t=>t.y};function w(t){const e=t.split("."),i=[];let n="";for(const t of e)n+=t,n.endsWith("\\")?n=n.slice(0,-1)+".":(i.push(n),n="");return i}function x(t,e){const i=_[e]||(_[e]=function(t){const e=w(t);return t=>{for(const i of e){if(""===i)break;t=t&&t[i]}return t}}(e));return i(t)}function k(t){return t.charAt(0).toUpperCase()+t.slice(1)}const S=t=>void 0!==t,T=t=>"function"==typeof t,C=(t,e)=>{if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};function D(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}const M=Math.PI,O=2*M,P=O+M,E=Number.POSITIVE_INFINITY,A=M/180,I=M/2,L=M/4,N=2*M/3,j=Math.log10,R=Math.sign;function $(t,e,i){return Math.abs(t-e)<i}function B(t){const e=Math.round(t);t=$(t,e,t/1e3)?e:t;const i=Math.pow(10,Math.floor(j(t))),n=t/i;return(n<=1?1:n<=2?2:n<=5?5:10)*i}function F(t){const e=[],i=Math.sqrt(t);let n;for(n=1;n<i;n++)t%n==0&&(e.push(n),e.push(t/n));return i===(0|i)&&e.push(i),e.sort(((t,e)=>t-e)).pop(),e}function H(t){return!isNaN(parseFloat(t))&&isFinite(t)}function W(t,e){const i=Math.round(t);return i-e<=t&&i+e>=t}function U(t,e,i){let n,o,s;for(n=0,o=t.length;n<o;n++)s=t[n][i],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function q(t){return t*(M/180)}function z(t){return t*(180/M)}function V(t){if(!a(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function Y(t,e){const i=e.x-t.x,n=e.y-t.y,o=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i);return s<-.5*M&&(s+=O),{angle:s,distance:o}}function G(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function K(t,e){return(t-e+P)%O-M}function X(t){return(t%O+O)%O}function J(t,e,i,n){const o=X(t),s=X(e),a=X(i),r=X(s-o),l=X(a-o),c=X(o-s),d=X(o-a);return o===s||o===a||n&&s===a||r>l&&c<d}function Q(t,e,i){return Math.max(e,Math.min(i,t))}function Z(t){return Q(t,-32768,32767)}function tt(t,e,i,n=1e-6){return t>=Math.min(e,i)-n&&t<=Math.max(e,i)+n}function et(t,e,i){i=i||(i=>t[i]<e);let n,o=t.length-1,s=0;for(;o-s>1;)n=s+o>>1,i(n)?s=n:o=n;return{lo:s,hi:o}}const it=(t,e,i,n)=>et(t,i,n?n=>{const o=t[n][e];return o<i||o===i&&t[n+1][e]===i}:n=>t[n][e]<i),nt=(t,e,i)=>et(t,i,(n=>t[n][e]>=i));function ot(t,e,i){let n=0,o=t.length;for(;n<o&&t[n]<e;)n++;for(;o>n&&t[o-1]>i;)o--;return n>0||o<t.length?t.slice(n,o):t}const st=["push","pop","shift","splice","unshift"];function at(t,e){t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),st.forEach((e=>{const i="_onData"+k(e),n=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...e){const o=n.apply(this,e);return t._chartjs.listeners.forEach((t=>{"function"==typeof t[i]&&t[i](...e)})),o}})})))}function rt(t,e){const i=t._chartjs;if(!i)return;const n=i.listeners,o=n.indexOf(e);-1!==o&&n.splice(o,1),n.length>0||(st.forEach((e=>{delete t[e]})),delete t._chartjs)}function lt(t){const e=new Set;let i,n;for(i=0,n=t.length;i<n;++i)e.add(t[i]);return e.size===n?t:Array.from(e)}const ct="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function dt(t,e){let i=[],n=!1;return function(...o){i=o,n||(n=!0,ct.call(window,(()=>{n=!1,t.apply(e,i)})))}}function ut(t,e){let i;return function(...n){return e?(clearTimeout(i),i=setTimeout(t,e,n)):t.apply(this,n),e}}const ht=t=>"start"===t?"left":"end"===t?"right":"center",pt=(t,e,i)=>"start"===t?e:"end"===t?i:(e+i)/2,ft=(t,e,i,n)=>t===(n?"left":"right")?i:"center"===t?(e+i)/2:e;function mt(t,e,i){const n=e.length;let o=0,s=n;if(t._sorted){const{iScale:a,_parsed:r}=t,l=a.axis,{min:c,max:d,minDefined:u,maxDefined:h}=a.getUserBounds();u&&(o=Q(Math.min(it(r,a.axis,c).lo,i?n:it(e,l,a.getPixelForValue(c)).lo),0,n-1)),s=h?Q(Math.max(it(r,a.axis,d,!0).hi+1,i?0:it(e,l,a.getPixelForValue(d),!0).hi+1),o,n)-o:n-o}return{start:o,count:s}}function gt(t){const{xScale:e,yScale:i,_scaleRanges:n}=t,o={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!n)return t._scaleRanges=o,!0;const s=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==i.min||n.ymax!==i.max;return Object.assign(n,o),s}var vt=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,n){const o=e.listeners[n],s=e.duration;o.forEach((n=>n({chart:t,initial:e.initial,numSteps:s,currentStep:Math.min(i-e.start,s)})))}_refresh(){this._request||(this._running=!0,this._request=ct.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((i,n)=>{if(!i.running||!i.items.length)return;const o=i.items;let s,a=o.length-1,r=!1;for(;a>=0;--a)s=o[a],s._active?(s._total>i.duration&&(i.duration=s._total),s.tick(t),r=!0):(o[a]=o[o.length-1],o.pop());r&&(n.draw(),this._notify(n,i,t,"progress")),o.length||(i.running=!1,this._notify(n,i,t,"complete"),i.initial=!1),e+=o.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let n=i.length-1;for(;n>=0;--n)i[n].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};function bt(t){return t+.5|0}const yt=(t,e,i)=>Math.max(Math.min(t,i),e);function _t(t){return yt(bt(2.55*t),0,255)}function wt(t){return yt(bt(255*t),0,255)}function xt(t){return yt(bt(t/2.55)/100,0,1)}function kt(t){return yt(bt(100*t),0,100)}const St={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Tt=[..."0123456789ABCDEF"],Ct=t=>Tt[15&t],Dt=t=>Tt[(240&t)>>4]+Tt[15&t],Mt=t=>(240&t)>>4==(15&t);const Ot=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Pt(t,e,i){const n=e*Math.min(i,1-i),o=(e,o=(e+t/30)%12)=>i-n*Math.max(Math.min(o-3,9-o,1),-1);return[o(0),o(8),o(4)]}function Et(t,e,i){const n=(n,o=(n+t/60)%6)=>i-i*e*Math.max(Math.min(o,4-o,1),0);return[n(5),n(3),n(1)]}function At(t,e,i){const n=Pt(t,1,.5);let o;for(e+i>1&&(o=1/(e+i),e*=o,i*=o),o=0;o<3;o++)n[o]*=1-e-i,n[o]+=e;return n}function It(t){const e=t.r/255,i=t.g/255,n=t.b/255,o=Math.max(e,i,n),s=Math.min(e,i,n),a=(o+s)/2;let r,l,c;return o!==s&&(c=o-s,l=a>.5?c/(2-o-s):c/(o+s),r=function(t,e,i,n,o){return t===o?(e-i)/n+(e<i?6:0):e===o?(i-t)/n+2:(t-e)/n+4}(e,i,n,c,o),r=60*r+.5),[0|r,l||0,a]}function Lt(t,e,i,n){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,n)).map(wt)}function Nt(t,e,i){return Lt(Pt,t,e,i)}function jt(t){return(t%360+360)%360}const Rt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},$t={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Bt;const Ft=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Ht=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Wt=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Ut(t,e,i){if(t){let n=It(t);n[e]=Math.max(0,Math.min(n[e]+n[e]*i,0===e?360:1)),n=Nt(n),t.r=n[0],t.g=n[1],t.b=n[2]}}function qt(t,e){return t?Object.assign(e||{},t):t}function zt(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=wt(t[3]))):(e=qt(t,{r:0,g:0,b:0,a:1})).a=wt(e.a),e}function Vt(t){return"r"===t.charAt(0)?function(t){const e=Ft.exec(t);let i,n,o,s=255;if(e){if(e[7]!==i){const t=+e[7];s=e[8]?_t(t):yt(255*t,0,255)}return i=+e[1],n=+e[3],o=+e[5],i=255&(e[2]?_t(i):yt(i,0,255)),n=255&(e[4]?_t(n):yt(n,0,255)),o=255&(e[6]?_t(o):yt(o,0,255)),{r:i,g:n,b:o,a:s}}}(t):function(t){const e=Ot.exec(t);let i,n=255;if(!e)return;e[5]!==i&&(n=e[6]?_t(+e[5]):wt(+e[5]));const o=jt(+e[2]),s=+e[3]/100,a=+e[4]/100;return i="hwb"===e[1]?function(t,e,i){return Lt(At,t,e,i)}(o,s,a):"hsv"===e[1]?function(t,e,i){return Lt(Et,t,e,i)}(o,s,a):Nt(o,s,a),{r:i[0],g:i[1],b:i[2],a:n}}(t)}class Yt{constructor(t){if(t instanceof Yt)return t;const e=typeof t;let i;var n,o,s;"object"===e?i=zt(t):"string"===e&&(s=(n=t).length,"#"===n[0]&&(4===s||5===s?o={r:255&17*St[n[1]],g:255&17*St[n[2]],b:255&17*St[n[3]],a:5===s?17*St[n[4]]:255}:7!==s&&9!==s||(o={r:St[n[1]]<<4|St[n[2]],g:St[n[3]]<<4|St[n[4]],b:St[n[5]]<<4|St[n[6]],a:9===s?St[n[7]]<<4|St[n[8]]:255})),i=o||function(t){Bt||(Bt=function(){const t={},e=Object.keys($t),i=Object.keys(Rt);let n,o,s,a,r;for(n=0;n<e.length;n++){for(a=r=e[n],o=0;o<i.length;o++)s=i[o],r=r.replace(s,Rt[s]);s=parseInt($t[a],16),t[r]=[s>>16&255,s>>8&255,255&s]}return t}(),Bt.transparent=[0,0,0,0]);const e=Bt[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(t)||Vt(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=qt(this._rgb);return t&&(t.a=xt(t.a)),t}set rgb(t){this._rgb=zt(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${xt(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?function(t){var e=(t=>Mt(t.r)&&Mt(t.g)&&Mt(t.b)&&Mt(t.a))(t)?Ct:Dt;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=It(t),i=e[0],n=kt(e[1]),o=kt(e[2]);return t.a<255?`hsla(${i}, ${n}%, ${o}%, ${xt(t.a)})`:`hsl(${i}, ${n}%, ${o}%)`}(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,n=t.rgb;let o;const s=e===o?.5:e,a=2*s-1,r=i.a-n.a,l=((a*r==-1?a:(a+r)/(1+a*r))+1)/2;o=1-l,i.r=255&l*i.r+o*n.r+.5,i.g=255&l*i.g+o*n.g+.5,i.b=255&l*i.b+o*n.b+.5,i.a=s*i.a+(1-s)*n.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,i){const n=Wt(xt(t.r)),o=Wt(xt(t.g)),s=Wt(xt(t.b));return{r:wt(Ht(n+i*(Wt(xt(e.r))-n))),g:wt(Ht(o+i*(Wt(xt(e.g))-o))),b:wt(Ht(s+i*(Wt(xt(e.b))-s))),a:t.a+i*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new Yt(this.rgb)}alpha(t){return this._rgb.a=wt(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=bt(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Ut(this._rgb,2,t),this}darken(t){return Ut(this._rgb,2,-t),this}saturate(t){return Ut(this._rgb,1,t),this}desaturate(t){return Ut(this._rgb,1,-t),this}rotate(t){return function(t,e){var i=It(t);i[0]=jt(i[0]+e),i=Nt(i),t.r=i[0],t.g=i[1],t.b=i[2]}(this._rgb,t),this}}function Gt(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function Kt(t){return Gt(t)?t:new Yt(t)}function Xt(t){return Gt(t)?t:new Yt(t).saturate(.5).darken(.1).hexString()}const Jt=["x","y","borderWidth","radius","tension"],Qt=["color","borderColor","backgroundColor"],Zt=new Map;function te(t,e,i){return function(t,e){e=e||{};const i=t+JSON.stringify(e);let n=Zt.get(i);return n||(n=new Intl.NumberFormat(t,e),Zt.set(i,n)),n}(e,i).format(t)}const ee={values:t=>o(t)?t:""+t,numeric(t,e,i){if(0===t)return"0";const n=this.chart.options.locale;let o,s=t;if(i.length>1){const e=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(e<1e-4||e>1e15)&&(o="scientific"),s=function(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t)),i}(t,i)}const a=j(Math.abs(s)),r=Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:o,minimumFractionDigits:r,maximumFractionDigits:r};return Object.assign(l,this.options.ticks.format),te(t,n,l)},logarithmic(t,e,i){if(0===t)return"0";const n=i[e].significand||t/Math.pow(10,Math.floor(j(t)));return[1,2,3,5,10,15].includes(n)||e>.8*i.length?ee.numeric.call(this,t,e,i):""}};var ie={formatters:ee};const ne=Object.create(null),oe=Object.create(null);function se(t,e){if(!e)return t;const i=e.split(".");for(let e=0,n=i.length;e<n;++e){const n=i[e];t=t[n]||(t[n]=Object.create(null))}return t}function ae(t,e,i){return"string"==typeof e?v(se(t,e),i):v(se(t,""),e)}var re=new class{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>Xt(e.backgroundColor),this.hoverBorderColor=(t,e)=>Xt(e.borderColor),this.hoverColor=(t,e)=>Xt(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return ae(this,t,e)}get(t){return se(this,t)}describe(t,e){return ae(oe,t,e)}override(t,e){return ae(ne,t,e)}route(t,e,i,n){const o=se(this,t),a=se(this,i),r="_"+e;Object.defineProperties(o,{[r]:{value:o[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[r],e=a[n];return s(t)?Object.assign({},e,t):l(t,e)},set(t){this[r]=t}}})}apply(t){t.forEach((t=>t(this)))}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:Qt},numbers:{type:"number",properties:Jt}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ie.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function le(){return"undefined"!=typeof window&&"undefined"!=typeof document}function ce(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function de(t,e,i){let n;return"string"==typeof t?(n=parseInt(t,10),-1!==t.indexOf("%")&&(n=n/100*e.parentNode[i])):n=t,n}const ue=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function he(t,e){return ue(t).getPropertyValue(e)}const pe=["top","right","bottom","left"];function fe(t,e,i){const n={};i=i?"-"+i:"";for(let o=0;o<4;o++){const s=pe[o];n[s]=parseFloat(t[e+"-"+s+i])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}function me(t,e){if("native"in t)return t;const{canvas:i,currentDevicePixelRatio:n}=e,o=ue(i),s="border-box"===o.boxSizing,a=fe(o,"padding"),r=fe(o,"border","width"),{x:l,y:c,box:d}=function(t,e){const i=t.touches,n=i&&i.length?i[0]:t,{offsetX:o,offsetY:s}=n;let a,r,l=!1;if(((t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot))(o,s,t.target))a=o,r=s;else{const t=e.getBoundingClientRect();a=n.clientX-t.left,r=n.clientY-t.top,l=!0}return{x:a,y:r,box:l}}(t,i),u=a.left+(d&&r.left),h=a.top+(d&&r.top);let{width:p,height:f}=e;return s&&(p-=a.width+r.width,f-=a.height+r.height),{x:Math.round((l-u)/p*i.width/n),y:Math.round((c-h)/f*i.height/n)}}const ge=t=>Math.round(10*t)/10;function ve(t,e,i,n){const o=ue(t),s=fe(o,"margin"),a=de(o.maxWidth,t,"clientWidth")||E,r=de(o.maxHeight,t,"clientHeight")||E,l=function(t,e,i){let n,o;if(void 0===e||void 0===i){const s=ce(t);if(s){const t=s.getBoundingClientRect(),a=ue(s),r=fe(a,"border","width"),l=fe(a,"padding");e=t.width-l.width-r.width,i=t.height-l.height-r.height,n=de(a.maxWidth,s,"clientWidth"),o=de(a.maxHeight,s,"clientHeight")}else e=t.clientWidth,i=t.clientHeight}return{width:e,height:i,maxWidth:n||E,maxHeight:o||E}}(t,e,i);let{width:c,height:d}=l;if("content-box"===o.boxSizing){const t=fe(o,"border","width"),e=fe(o,"padding");c-=e.width+t.width,d-=e.height+t.height}return c=Math.max(0,c-s.width),d=Math.max(0,n?c/n:d-s.height),c=ge(Math.min(c,a,l.maxWidth)),d=ge(Math.min(d,r,l.maxHeight)),c&&!d&&(d=ge(c/2)),(void 0!==e||void 0!==i)&&n&&l.height&&d>l.height&&(d=l.height,c=ge(Math.floor(d*n))),{width:c,height:d}}function be(t,e,i){const n=e||1,o=Math.floor(t.height*n),s=Math.floor(t.width*n);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const a=t.canvas;return a.style&&(i||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==n||a.height!==o||a.width!==s)&&(t.currentDevicePixelRatio=n,a.height=o,a.width=s,t.ctx.setTransform(n,0,0,n,0,0),!0)}const ye=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function _e(t,e){const i=he(t,e),n=i&&i.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function we(t){return!t||n(t.size)||n(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function xe(t,e,i,n,o){let s=e[o];return s||(s=e[o]=t.measureText(o).width,i.push(o)),s>n&&(n=s),n}function ke(t,e,i,n){let s=(n=n||{}).data=n.data||{},a=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(s=n.data={},a=n.garbageCollect=[],n.font=e),t.save(),t.font=e;let r=0;const l=i.length;let c,d,u,h,p;for(c=0;c<l;c++)if(h=i[c],null!=h&&!0!==o(h))r=xe(t,s,a,r,h);else if(o(h))for(d=0,u=h.length;d<u;d++)p=h[d],null==p||o(p)||(r=xe(t,s,a,r,p));t.restore();const f=a.length/2;if(f>i.length){for(c=0;c<f;c++)delete s[a[c]];a.splice(0,f)}return r}function Se(t,e,i){const n=t.currentDevicePixelRatio,o=0!==i?Math.max(i/2,.5):0;return Math.round((e-o)*n)/n+o}function Te(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function Ce(t,e,i,n){De(t,e,i,n,null)}function De(t,e,i,n,o){let s,a,r,l,c,d,u,h;const p=e.pointStyle,f=e.rotation,m=e.radius;let g=(f||0)*A;if(p&&"object"==typeof p&&(s=p.toString(),"[object HTMLImageElement]"===s||"[object HTMLCanvasElement]"===s))return t.save(),t.translate(i,n),t.rotate(g),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void t.restore();if(!(isNaN(m)||m<=0)){switch(t.beginPath(),p){default:o?t.ellipse(i,n,o/2,m,0,0,O):t.arc(i,n,m,0,O),t.closePath();break;case"triangle":d=o?o/2:m,t.moveTo(i+Math.sin(g)*d,n-Math.cos(g)*m),g+=N,t.lineTo(i+Math.sin(g)*d,n-Math.cos(g)*m),g+=N,t.lineTo(i+Math.sin(g)*d,n-Math.cos(g)*m),t.closePath();break;case"rectRounded":c=.516*m,l=m-c,a=Math.cos(g+L)*l,u=Math.cos(g+L)*(o?o/2-c:l),r=Math.sin(g+L)*l,h=Math.sin(g+L)*(o?o/2-c:l),t.arc(i-u,n-r,c,g-M,g-I),t.arc(i+h,n-a,c,g-I,g),t.arc(i+u,n+r,c,g,g+I),t.arc(i-h,n+a,c,g+I,g+M),t.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,d=o?o/2:l,t.rect(i-d,n-l,2*d,2*l);break}g+=L;case"rectRot":u=Math.cos(g)*(o?o/2:m),a=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(i-u,n-r),t.lineTo(i+h,n-a),t.lineTo(i+u,n+r),t.lineTo(i-h,n+a),t.closePath();break;case"crossRot":g+=L;case"cross":u=Math.cos(g)*(o?o/2:m),a=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(i-u,n-r),t.lineTo(i+u,n+r),t.moveTo(i+h,n-a),t.lineTo(i-h,n+a);break;case"star":u=Math.cos(g)*(o?o/2:m),a=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(i-u,n-r),t.lineTo(i+u,n+r),t.moveTo(i+h,n-a),t.lineTo(i-h,n+a),g+=L,u=Math.cos(g)*(o?o/2:m),a=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(i-u,n-r),t.lineTo(i+u,n+r),t.moveTo(i+h,n-a),t.lineTo(i-h,n+a);break;case"line":a=o?o/2:Math.cos(g)*m,r=Math.sin(g)*m,t.moveTo(i-a,n-r),t.lineTo(i+a,n+r);break;case"dash":t.moveTo(i,n),t.lineTo(i+Math.cos(g)*(o?o/2:m),n+Math.sin(g)*m);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}function Me(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function Oe(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Pe(t){t.restore()}function Ee(t,e,i,n,o){if(!e)return t.lineTo(i.x,i.y);if("middle"===o){const n=(e.x+i.x)/2;t.lineTo(n,e.y),t.lineTo(n,i.y)}else"after"===o!=!!n?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function Ae(t,e,i,n){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?i.cp2x:i.cp1x,n?i.cp2y:i.cp1y,i.x,i.y)}function Ie(t,e,i,s,a,r={}){const l=o(e)?e:[e],c=r.strokeWidth>0&&""!==r.strokeColor;let d,u;for(t.save(),t.font=a.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),n(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,r),d=0;d<l.length;++d)u=l[d],r.backdrop&&Ne(t,r.backdrop),c&&(r.strokeColor&&(t.strokeStyle=r.strokeColor),n(r.strokeWidth)||(t.lineWidth=r.strokeWidth),t.strokeText(u,i,s,r.maxWidth)),t.fillText(u,i,s,r.maxWidth),Le(t,i,s,u,r),s+=a.lineHeight;t.restore()}function Le(t,e,i,n,o){if(o.strikethrough||o.underline){const s=t.measureText(n),a=e-s.actualBoundingBoxLeft,r=e+s.actualBoundingBoxRight,l=i-s.actualBoundingBoxAscent,c=i+s.actualBoundingBoxDescent,d=o.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=o.decorationWidth||2,t.moveTo(a,d),t.lineTo(r,d),t.stroke()}}function Ne(t,e){const i=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=i}function je(t,e){const{x:i,y:n,w:o,h:s,radius:a}=e;t.arc(i+a.topLeft,n+a.topLeft,a.topLeft,-I,M,!0),t.lineTo(i,n+s-a.bottomLeft),t.arc(i+a.bottomLeft,n+s-a.bottomLeft,a.bottomLeft,M,I,!0),t.lineTo(i+o-a.bottomRight,n+s),t.arc(i+o-a.bottomRight,n+s-a.bottomRight,a.bottomRight,I,0,!0),t.lineTo(i+o,n+a.topRight),t.arc(i+o-a.topRight,n+a.topRight,a.topRight,0,-I,!0),t.lineTo(i+a.topLeft,n)}function Re(t,e=[""],i=t,n,o=(()=>t[0])){S(n)||(n=Ge("_fallback",t));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:n,_getTarget:o,override:o=>Re([o,...t],e,i,n)};return new Proxy(s,{deleteProperty:(e,i)=>(delete e[i],delete e._keys,delete t[0][i],!0),get:(i,n)=>We(i,n,(()=>function(t,e,i,n){let o;for(const s of e)if(o=Ge(Fe(s,t),i),S(o))return He(t,o)?Ve(i,n,t,o):o}(n,e,t,i))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>Ke(t).includes(e),ownKeys:t=>Ke(t),set(t,e,i){const n=t._storage||(t._storage=o());return t[e]=n[e]=i,delete t._keys,!0}})}function $e(t,e,i,n){const a={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:Be(t,n),setContext:e=>$e(t,e,i,n),override:o=>$e(t.override(o),e,i,n)};return new Proxy(a,{deleteProperty:(e,i)=>(delete e[i],delete t[i],!0),get:(t,e,i)=>We(t,e,(()=>function(t,e,i){const{_proxy:n,_context:a,_subProxy:r,_descriptors:l}=t;let c=n[e];return T(c)&&l.isScriptable(e)&&(c=function(t,e,i,n){const{_proxy:o,_context:s,_subProxy:a,_stack:r}=i;if(r.has(t))throw new Error("Recursion detected: "+Array.from(r).join("->")+"->"+t);return r.add(t),e=e(s,a||n),r.delete(t),He(t,e)&&(e=Ve(o._scopes,o,t,e)),e}(e,c,t,i)),o(c)&&c.length&&(c=function(t,e,i,n){const{_proxy:o,_context:a,_subProxy:r,_descriptors:l}=i;if(S(a.index)&&n(t))e=e[a.index%e.length];else if(s(e[0])){const i=e,n=o._scopes.filter((t=>t!==i));e=[];for(const s of i){const i=Ve(n,o,t,s);e.push($e(i,a,r&&r[t],l))}}return e}(e,c,t,l.isIndexable)),He(e,c)&&(c=$e(c,a,r&&r[e],l)),c}(t,e,i))),getOwnPropertyDescriptor:(e,i)=>e._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,i)=>Reflect.has(t,i),ownKeys:()=>Reflect.ownKeys(t),set:(e,i,n)=>(t[i]=n,delete e[i],!0)})}function Be(t,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:n=e.indexable,_allKeys:o=e.allKeys}=t;return{allKeys:o,scriptable:i,indexable:n,isScriptable:T(i)?i:()=>i,isIndexable:T(n)?n:()=>n}}const Fe=(t,e)=>t?t+k(e):e,He=(t,e)=>s(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function We(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const n=i();return t[e]=n,n}function Ue(t,e,i){return T(t)?t(e,i):t}const qe=(t,e)=>!0===t?e:"string"==typeof t?x(e,t):void 0;function ze(t,e,i,n,o){for(const s of e){const e=qe(i,s);if(e){t.add(e);const s=Ue(e._fallback,i,o);if(S(s)&&s!==i&&s!==n)return s}else if(!1===e&&S(n)&&i!==n)return null}return!1}function Ve(t,e,i,n){const a=e._rootScopes,r=Ue(e._fallback,i,n),l=[...t,...a],c=new Set;c.add(n);let d=Ye(c,l,i,r||i,n);return null!==d&&(!S(r)||r===i||(d=Ye(c,l,r,d,n),null!==d))&&Re(Array.from(c),[""],a,r,(()=>function(t,e,i){const n=t._getTarget();e in n||(n[e]={});const a=n[e];return o(a)&&s(i)?i:a||{}}(e,i,n)))}function Ye(t,e,i,n,o){for(;i;)i=ze(t,e,i,n,o);return i}function Ge(t,e){for(const i of e){if(!i)continue;const e=i[t];if(S(e))return e}}function Ke(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const i of t)for(const t of Object.keys(i).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function Xe(t,e,i,n){const{iScale:o}=t,{key:s="r"}=this._parsing,a=new Array(n);let r,l,c,d;for(r=0,l=n;r<l;++r)c=r+i,d=e[c],a[r]={r:o.parse(x(d,s),c)};return a}const Je=Number.EPSILON||1e-14,Qe=(t,e)=>e<t.length&&!t[e].skip&&t[e],Ze=t=>"x"===t?"y":"x";function ti(t,e,i,n){const o=t.skip?e:t,s=e,a=i.skip?e:i,r=G(s,o),l=G(a,s);let c=r/(r+l),d=l/(r+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const u=n*c,h=n*d;return{previous:{x:s.x-u*(a.x-o.x),y:s.y-u*(a.y-o.y)},next:{x:s.x+h*(a.x-o.x),y:s.y+h*(a.y-o.y)}}}function ei(t,e="x"){const i=Ze(e),n=t.length,o=Array(n).fill(0),s=Array(n);let a,r,l,c=Qe(t,0);for(a=0;a<n;++a)if(r=l,l=c,c=Qe(t,a+1),l){if(c){const t=c[e]-l[e];o[a]=0!==t?(c[i]-l[i])/t:0}s[a]=r?c?R(o[a-1])!==R(o[a])?0:(o[a-1]+o[a])/2:o[a-1]:o[a]}!function(t,e,i){const n=t.length;let o,s,a,r,l,c=Qe(t,0);for(let d=0;d<n-1;++d)l=c,c=Qe(t,d+1),l&&c&&($(e[d],0,Je)?i[d]=i[d+1]=0:(o=i[d]/e[d],s=i[d+1]/e[d],r=Math.pow(o,2)+Math.pow(s,2),r<=9||(a=3/Math.sqrt(r),i[d]=o*a*e[d],i[d+1]=s*a*e[d])))}(t,o,s),function(t,e,i="x"){const n=Ze(i),o=t.length;let s,a,r,l=Qe(t,0);for(let c=0;c<o;++c){if(a=r,r=l,l=Qe(t,c+1),!r)continue;const o=r[i],d=r[n];a&&(s=(o-a[i])/3,r[`cp1${i}`]=o-s,r[`cp1${n}`]=d-s*e[c]),l&&(s=(l[i]-o)/3,r[`cp2${i}`]=o+s,r[`cp2${n}`]=d+s*e[c])}}(t,s,e)}function ii(t,e,i){return Math.max(Math.min(t,i),e)}function ni(t,e,i,n,o){let s,a,r,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)ei(t,o);else{let i=n?t[t.length-1]:t[0];for(s=0,a=t.length;s<a;++s)r=t[s],l=ti(i,r,t[Math.min(s+1,a-(n?0:1))%a],e.tension),r.cp1x=l.previous.x,r.cp1y=l.previous.y,r.cp2x=l.next.x,r.cp2y=l.next.y,i=r}e.capBezierPoints&&function(t,e){let i,n,o,s,a,r=Me(t[0],e);for(i=0,n=t.length;i<n;++i)a=s,s=r,r=i<n-1&&Me(t[i+1],e),s&&(o=t[i],a&&(o.cp1x=ii(o.cp1x,e.left,e.right),o.cp1y=ii(o.cp1y,e.top,e.bottom)),r&&(o.cp2x=ii(o.cp2x,e.left,e.right),o.cp2y=ii(o.cp2y,e.top,e.bottom)))}(t,i)}const oi=t=>0===t||1===t,si=(t,e,i)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*O/i),ai=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*O/i)+1,ri={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*I),easeOutSine:t=>Math.sin(t*I),easeInOutSine:t=>-.5*(Math.cos(M*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>oi(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>oi(t)?t:si(t,.075,.3),easeOutElastic:t=>oi(t)?t:ai(t,.075,.3),easeInOutElastic(t){const e=.1125;return oi(t)?t:t<.5?.5*si(2*t,e,.45):.5+.5*ai(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-ri.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeInOutBounce:t=>t<.5?.5*ri.easeInBounce(2*t):.5*ri.easeOutBounce(2*t-1)+.5};function li(t,e,i,n){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function ci(t,e,i,n){return{x:t.x+i*(e.x-t.x),y:"middle"===n?i<.5?t.y:e.y:"after"===n?i<1?t.y:e.y:i>0?e.y:t.y}}function di(t,e,i,n){const o={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},a=li(t,o,i),r=li(o,s,i),l=li(s,e,i),c=li(a,r,i),d=li(r,l,i);return li(c,d,i)}const ui=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,hi=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function pi(t,e){const i=(""+t).match(ui);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t}function fi(t,e){const i={},n=s(e),o=n?Object.keys(e):e,a=s(t)?n?i=>l(t[i],t[e[i]]):e=>t[e]:()=>t;for(const t of o)i[t]=+a(t)||0;return i}function mi(t){return fi(t,{top:"y",right:"x",bottom:"y",left:"x"})}function gi(t){return fi(t,["topLeft","topRight","bottomLeft","bottomRight"])}function vi(t){const e=mi(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function bi(t,e){t=t||{},e=e||re.font;let i=l(t.size,e.size);"string"==typeof i&&(i=parseInt(i,10));let n=l(t.style,e.style);n&&!(""+n).match(hi)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const o={family:l(t.family,e.family),lineHeight:pi(l(t.lineHeight,e.lineHeight),i),size:i,style:n,weight:l(t.weight,e.weight),string:""};return o.string=we(o),o}function yi(t,e,i,n){let s,a,r,l=!0;for(s=0,a=t.length;s<a;++s)if(r=t[s],void 0!==r&&(void 0!==e&&"function"==typeof r&&(r=r(e),l=!1),void 0!==i&&o(r)&&(r=r[i%r.length],l=!1),void 0!==r))return n&&!l&&(n.cacheable=!1),r}function _i(t,e,i){const{min:n,max:o}=t,s=d(e,(o-n)/2),a=(t,e)=>i&&0===t?0:t+e;return{min:a(n,-Math.abs(s)),max:a(o,s)}}function wi(t,e){return Object.assign(Object.create(t),e)}function xi(t,e,i){return t?function(t,e){return{x:i=>t+t+e-i,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,i):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function ki(t,e){let i,n;"ltr"!==e&&"rtl"!==e||(i=t.canvas.style,n=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=n)}function Si(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Ti(t){return"angle"===t?{between:J,compare:K,normalize:X}:{between:tt,compare:(t,e)=>t-e,normalize:t=>t}}function Ci({start:t,end:e,count:i,loop:n,style:o}){return{start:t%i,end:e%i,loop:n&&(e-t+1)%i==0,style:o}}function Di(t,e,i){if(!i)return[t];const{property:n,start:o,end:s}=i,a=e.length,{compare:r,between:l,normalize:c}=Ti(n),{start:d,end:u,loop:h,style:p}=function(t,e,i){const{property:n,start:o,end:s}=i,{between:a,normalize:r}=Ti(n),l=e.length;let c,d,{start:u,end:h,loop:p}=t;if(p){for(u+=l,h+=l,c=0,d=l;c<d&&a(r(e[u%l][n]),o,s);++c)u--,h--;u%=l,h%=l}return h<u&&(h+=l),{start:u,end:h,loop:p,style:t.style}}(t,e,i),f=[];let m,g,v,b=!1,y=null;for(let t=d,i=d;t<=u;++t)g=e[t%a],g.skip||(m=c(g[n]),m!==v&&(b=l(m,o,s),null===y&&(b||l(o,v,m)&&0!==r(o,v))&&(y=0===r(m,o)?t:i),null!==y&&(!b||0===r(s,m)||l(s,v,m))&&(f.push(Ci({start:y,end:t,loop:h,count:a,style:p})),y=null),i=t,v=m));return null!==y&&f.push(Ci({start:y,end:u,loop:h,count:a,style:p})),f}function Mi(t,e){const i=[],n=t.segments;for(let o=0;o<n.length;o++){const s=Di(n[o],t.points,e);s.length&&i.push(...s)}return i}function Oi(t,e){const i=t.points,n=t.options.spanGaps,o=i.length;if(!o)return[];const s=!!t._loop,{start:a,end:r}=function(t,e,i,n){let o=0,s=e-1;if(i&&!n)for(;o<e&&!t[o].skip;)o++;for(;o<e&&t[o].skip;)o++;for(o%=e,i&&(s+=o);s>o&&t[s%e].skip;)s--;return s%=e,{start:o,end:s}}(i,o,s,n);return Pi(t,!0===n?[{start:a,end:r,loop:s}]:function(t,e,i,n){const o=t.length,s=[];let a,r=e,l=t[e];for(a=e+1;a<=i;++a){const i=t[a%o];i.skip||i.stop?l.skip||(n=!1,s.push({start:e%o,end:(a-1)%o,loop:n}),e=r=i.stop?a:null):(r=a,l.skip&&(e=a)),l=i}return null!==r&&s.push({start:e%o,end:r%o,loop:n}),s}(i,a,r<a?r+o:r,!!t._fullLoop&&0===a&&r===o-1),i,e)}function Pi(t,e,i,n){return n&&n.setContext&&i?function(t,e,i,n){const o=t._chart.getContext(),s=Ei(t.options),{_datasetIndex:a,options:{spanGaps:r}}=t,l=i.length,c=[];let d=s,u=e[0].start,h=u;function p(t,e,n,o){const s=r?-1:1;if(t!==e){for(t+=l;i[t%l].skip;)t-=s;for(;i[e%l].skip;)e+=s;t%l!=e%l&&(c.push({start:t%l,end:e%l,loop:n,style:o}),d=o,u=e%l)}}for(const t of e){u=r?u:t.start;let e,s=i[u%l];for(h=u+1;h<=t.end;h++){const r=i[h%l];e=Ei(n.setContext(wi(o,{type:"segment",p0:s,p1:r,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:a}))),Ai(e,d)&&p(u,h-1,t.loop,d),s=r,d=e}u<h-1&&p(u,h-1,t.loop,d)}return c}(t,e,i,n):e}function Ei(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Ai(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}var Ii=Object.freeze({__proto__:null,easingEffects:ri,isPatternOrGradient:Gt,color:Kt,getHoverColor:Xt,noop:e,uid:i,isNullOrUndef:n,isArray:o,isObject:s,isFinite:a,finiteOrDefault:r,valueOrDefault:l,toPercentage:c,toDimension:d,callback:u,each:h,_elementsEqual:p,clone:f,_merger:g,merge:v,mergeIf:b,_mergerIf:y,_deprecated:function(t,e,i,n){void 0!==e&&console.warn(t+': "'+i+'" is deprecated. Please use "'+n+'" instead')},_splitKey:w,resolveObjectKey:x,_capitalize:k,defined:S,isFunction:T,setsEqual:C,_isClickEvent:D,toFontString:we,_measureText:xe,_longestText:ke,_alignPixel:Se,clearCanvas:Te,drawPoint:Ce,drawPointLegend:De,_isPointInArea:Me,clipArea:Oe,unclipArea:Pe,_steppedLineTo:Ee,_bezierCurveTo:Ae,renderText:Ie,addRoundedRectPath:je,_lookup:et,_lookupByKey:it,_rlookupByKey:nt,_filterBetween:ot,listenArrayEvents:at,unlistenArrayEvents:rt,_arrayUnique:lt,_createResolver:Re,_attachContext:$e,_descriptors:Be,_parseObjectDataRadialScale:Xe,splineCurve:ti,splineCurveMonotone:ei,_updateBezierControlPoints:ni,_isDomSupported:le,_getParentNode:ce,getStyle:he,getRelativePosition:me,getMaximumSize:ve,retinaScale:be,supportsEventListenerOptions:ye,readUsedSize:_e,fontString:function(t,e,i){return e+" "+t+"px "+i},requestAnimFrame:ct,throttled:dt,debounce:ut,_toLeftRightCenter:ht,_alignStartEnd:pt,_textX:ft,_getStartAndCountOfVisiblePoints:mt,_scaleRangesChanged:gt,_pointInLine:li,_steppedInterpolation:ci,_bezierInterpolation:di,formatNumber:te,toLineHeight:pi,_readValueToProps:fi,toTRBL:mi,toTRBLCorners:gi,toPadding:vi,toFont:bi,resolve:yi,_addGrace:_i,createContext:wi,PI:M,TAU:O,PITAU:P,INFINITY:E,RAD_PER_DEG:A,HALF_PI:I,QUARTER_PI:L,TWO_THIRDS_PI:N,log10:j,sign:R,almostEquals:$,niceNum:B,_factorize:F,isNumber:H,almostWhole:W,_setMinAndMaxByKey:U,toRadians:q,toDegrees:z,_decimalPlaces:V,getAngleFromPoint:Y,distanceBetweenPoints:G,_angleDiff:K,_normalizeAngle:X,_angleBetween:J,_limitValue:Q,_int16Range:Z,_isBetween:tt,getRtlAdapter:xi,overrideTextDirection:ki,restoreTextDirection:Si,_boundSegment:Di,_boundSegments:Mi,_computeSegments:Oi});function Li(t,e,i,n){const{controller:o,data:s,_sorted:a}=t,r=o._cachedMeta.iScale;if(r&&e===r.axis&&"r"!==e&&a&&s.length){const t=r._reversePixels?nt:it;if(!n)return t(s,e,i);if(o._sharedOptions){const n=s[0],o="function"==typeof n.getRange&&n.getRange(e);if(o){const n=t(s,e,i-o),a=t(s,e,i+o);return{lo:n.lo,hi:a.hi}}}}return{lo:0,hi:s.length-1}}function Ni(t,e,i,n,o){const s=t.getSortedVisibleDatasetMetas(),a=i[e];for(let t=0,i=s.length;t<i;++t){const{index:i,data:r}=s[t],{lo:l,hi:c}=Li(s[t],e,a,o);for(let t=l;t<=c;++t){const e=r[t];e.skip||n(e,i,t)}}}function ji(t,e,i,n,o){const s=[];return o||t.isPointInArea(e)?(Ni(t,i,e,(function(i,a,r){(o||Me(i,t.chartArea,0))&&i.inRange(e.x,e.y,n)&&s.push({element:i,datasetIndex:a,index:r})}),!0),s):s}function Ri(t,e,i,n,o,s){return s||t.isPointInArea(e)?"r"!==i||n?function(t,e,i,n,o,s){let a=[];const r=function(t){const e=-1!==t.indexOf("x"),i=-1!==t.indexOf("y");return function(t,n){const o=e?Math.abs(t.x-n.x):0,s=i?Math.abs(t.y-n.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(s,2))}}(i);let l=Number.POSITIVE_INFINITY;return Ni(t,i,e,(function(i,c,d){const u=i.inRange(e.x,e.y,o);if(n&&!u)return;const h=i.getCenterPoint(o);if(!s&&!t.isPointInArea(h)&&!u)return;const p=r(e,h);p<l?(a=[{element:i,datasetIndex:c,index:d}],l=p):p===l&&a.push({element:i,datasetIndex:c,index:d})})),a}(t,e,i,n,o,s):function(t,e,i,n){let o=[];return Ni(t,i,e,(function(t,i,s){const{startAngle:a,endAngle:r}=t.getProps(["startAngle","endAngle"],n),{angle:l}=Y(t,{x:e.x,y:e.y});J(l,a,r)&&o.push({element:t,datasetIndex:i,index:s})})),o}(t,e,i,o):[]}function $i(t,e,i,n,o){const s=[],a="x"===i?"inXRange":"inYRange";let r=!1;return Ni(t,i,e,((t,n,l)=>{t[a](e[i],o)&&(s.push({element:t,datasetIndex:n,index:l}),r=r||t.inRange(e.x,e.y,o))})),n&&!r?[]:s}var Bi={evaluateInteractionItems:Ni,modes:{index(t,e,i,n){const o=me(e,t),s=i.axis||"x",a=i.includeInvisible||!1,r=i.intersect?ji(t,o,s,n,a):Ri(t,o,s,!1,n,a),l=[];return r.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=r[0].index,i=t.data[e];i&&!i.skip&&l.push({element:i,datasetIndex:t.index,index:e})})),l):[]},dataset(t,e,i,n){const o=me(e,t),s=i.axis||"xy",a=i.includeInvisible||!1;let r=i.intersect?ji(t,o,s,n,a):Ri(t,o,s,!1,n,a);if(r.length>0){const e=r[0].datasetIndex,i=t.getDatasetMeta(e).data;r=[];for(let t=0;t<i.length;++t)r.push({element:i[t],datasetIndex:e,index:t})}return r},point:(t,e,i,n)=>ji(t,me(e,t),i.axis||"xy",n,i.includeInvisible||!1),nearest(t,e,i,n){const o=me(e,t),s=i.axis||"xy",a=i.includeInvisible||!1;return Ri(t,o,s,i.intersect,n,a)},x:(t,e,i,n)=>$i(t,me(e,t),"x",i.intersect,n),y:(t,e,i,n)=>$i(t,me(e,t),"y",i.intersect,n)}};const Fi=["left","top","right","bottom"];function Hi(t,e){return t.filter((t=>t.pos===e))}function Wi(t,e){return t.filter((t=>-1===Fi.indexOf(t.pos)&&t.box.axis===e))}function Ui(t,e){return t.sort(((t,i)=>{const n=e?i:t,o=e?t:i;return n.weight===o.weight?n.index-o.index:n.weight-o.weight}))}function qi(t,e,i,n){return Math.max(t[i],e[i])+Math.max(t[n],e[n])}function zi(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Vi(t,e,i,n){const{pos:o,box:a}=i,r=t.maxPadding;if(!s(o)){i.size&&(t[o]-=i.size);const e=n[i.stack]||{size:0,count:1};e.size=Math.max(e.size,i.horizontal?a.height:a.width),i.size=e.size/e.count,t[o]+=i.size}a.getPadding&&zi(r,a.getPadding());const l=Math.max(0,e.outerWidth-qi(r,t,"left","right")),c=Math.max(0,e.outerHeight-qi(r,t,"top","bottom")),d=l!==t.w,u=c!==t.h;return t.w=l,t.h=c,i.horizontal?{same:d,other:u}:{same:u,other:d}}function Yi(t,e){const i=e.maxPadding;return function(t){const n={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{n[t]=Math.max(e[t],i[t])})),n}(t?["left","right"]:["top","bottom"])}function Gi(t,e,i,n){const o=[];let s,a,r,l,c,d;for(s=0,a=t.length,c=0;s<a;++s){r=t[s],l=r.box,l.update(r.width||e.w,r.height||e.h,Yi(r.horizontal,e));const{same:a,other:u}=Vi(e,i,r,n);c|=a&&o.length,d=d||u,l.fullSize||o.push(r)}return c&&Gi(o,e,i,n)||d}function Ki(t,e,i,n,o){t.top=i,t.left=e,t.right=e+n,t.bottom=i+o,t.width=n,t.height=o}function Xi(t,e,i,n){const o=i.padding;let{x:s,y:a}=e;for(const r of t){const t=r.box,l=n[r.stack]||{count:1,placed:0,weight:1},c=r.stackWeight/l.weight||1;if(r.horizontal){const n=e.w*c,s=l.size||t.height;S(l.start)&&(a=l.start),t.fullSize?Ki(t,o.left,a,i.outerWidth-o.right-o.left,s):Ki(t,e.left+l.placed,a,n,s),l.start=a,l.placed+=n,a=t.bottom}else{const n=e.h*c,a=l.size||t.width;S(l.start)&&(s=l.start),t.fullSize?Ki(t,s,o.top,a,i.outerHeight-o.bottom-o.top):Ki(t,s,e.top+l.placed,a,n),l.start=s,l.placed+=n,s=t.right}}e.x=s,e.y=a}var Ji={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,n){if(!t)return;const o=vi(t.options.layout.padding),s=Math.max(e-o.width,0),a=Math.max(i-o.height,0),r=function(t){const e=function(t){const e=[];let i,n,o,s,a,r;for(i=0,n=(t||[]).length;i<n;++i)o=t[i],({position:s,options:{stack:a,stackWeight:r=1}}=o),e.push({index:i,box:o,pos:s,horizontal:o.isHorizontal(),weight:o.weight,stack:a&&s+a,stackWeight:r});return e}(t),i=Ui(e.filter((t=>t.box.fullSize)),!0),n=Ui(Hi(e,"left"),!0),o=Ui(Hi(e,"right")),s=Ui(Hi(e,"top"),!0),a=Ui(Hi(e,"bottom")),r=Wi(e,"x"),l=Wi(e,"y");return{fullSize:i,leftAndTop:n.concat(s),rightAndBottom:o.concat(l).concat(a).concat(r),chartArea:Hi(e,"chartArea"),vertical:n.concat(o).concat(l),horizontal:s.concat(a).concat(r)}}(t.boxes),l=r.vertical,c=r.horizontal;h(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const d=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,u=Object.freeze({outerWidth:e,outerHeight:i,padding:o,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/d,hBoxMaxHeight:a/2}),p=Object.assign({},o);zi(p,vi(n));const f=Object.assign({maxPadding:p,w:s,h:a,x:o.left,y:o.top},o),m=function(t,e){const i=function(t){const e={};for(const i of t){const{stack:t,pos:n,stackWeight:o}=i;if(!t||!Fi.includes(n))continue;const s=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=o}return e}(t),{vBoxMaxWidth:n,hBoxMaxHeight:o}=e;let s,a,r;for(s=0,a=t.length;s<a;++s){r=t[s];const{fullSize:a}=r.box,l=i[r.stack],c=l&&r.stackWeight/l.weight;r.horizontal?(r.width=c?c*n:a&&e.availableWidth,r.height=o):(r.width=n,r.height=c?c*o:a&&e.availableHeight)}return i}(l.concat(c),u);Gi(r.fullSize,f,u,m),Gi(l,f,u,m),Gi(c,f,u,m)&&Gi(l,f,u,m),function(t){const e=t.maxPadding;function i(i){const n=Math.max(e[i]-t[i],0);return t[i]+=n,n}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}(f),Xi(r.leftAndTop,f,u,m),f.x+=f.w,f.y+=f.h,Xi(r.rightAndBottom,f,u,m),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},h(r.chartArea,(e=>{const i=e.box;Object.assign(i,t.chartArea),i.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}};class Qi{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,n){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,n?Math.floor(e/n):i)}}isAttached(t){return!0}updateConfig(t){}}class Zi extends Qi{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const tn={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},en=t=>null===t||""===t,nn=!!ye&&{passive:!0};function on(t,e,i){t.canvas.removeEventListener(e,i,nn)}function sn(t,e){for(const i of t)if(i===e||i.contains(e))return!0}function an(t,e,i){const n=t.canvas,o=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||sn(i.addedNodes,n),e=e&&!sn(i.removedNodes,n);e&&i()}));return o.observe(document,{childList:!0,subtree:!0}),o}function rn(t,e,i){const n=t.canvas,o=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||sn(i.removedNodes,n),e=e&&!sn(i.addedNodes,n);e&&i()}));return o.observe(document,{childList:!0,subtree:!0}),o}const ln=new Map;let cn=0;function dn(){const t=window.devicePixelRatio;t!==cn&&(cn=t,ln.forEach(((e,i)=>{i.currentDevicePixelRatio!==t&&e()})))}function un(t,e,i){const n=t.canvas,o=n&&ce(n);if(!o)return;const s=dt(((t,e)=>{const n=o.clientWidth;i(t,e),n<o.clientWidth&&i()}),window),a=new ResizeObserver((t=>{const e=t[0],i=e.contentRect.width,n=e.contentRect.height;0===i&&0===n||s(i,n)}));return a.observe(o),function(t,e){ln.size||window.addEventListener("resize",dn),ln.set(t,e)}(t,s),a}function hn(t,e,i){i&&i.disconnect(),"resize"===e&&function(t){ln.delete(t),ln.size||window.removeEventListener("resize",dn)}(t)}function pn(t,e,i){const n=t.canvas,o=dt((e=>{null!==t.ctx&&i(function(t,e){const i=tn[t.type]||t.type,{x:n,y:o}=me(t,e);return{type:i,chart:e,native:t,x:void 0!==n?n:null,y:void 0!==o?o:null}}(e,t))}),t);return function(t,e,i){t.addEventListener(e,i,nn)}(n,e,o),o}class fn extends Qi{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(function(t,e){const i=t.style,n=t.getAttribute("height"),o=t.getAttribute("width");if(t.$chartjs={initial:{height:n,width:o,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",en(o)){const e=_e(t,"width");void 0!==e&&(t.width=e)}if(en(n))if(""===t.style.height)t.height=t.width/(e||2);else{const e=_e(t,"height");void 0!==e&&(t.height=e)}}(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e.$chartjs)return!1;const i=e.$chartjs.initial;["height","width"].forEach((t=>{const o=i[t];n(o)?e.removeAttribute(t):e.setAttribute(t,o)}));const o=i.style||{};return Object.keys(o).forEach((t=>{e.style[t]=o[t]})),e.width=e.width,delete e.$chartjs,!0}addEventListener(t,e,i){this.removeEventListener(t,e);const n=t.$proxies||(t.$proxies={}),o={attach:an,detach:rn,resize:un}[e]||pn;n[e]=o(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),n=i[e];n&&(({attach:hn,detach:hn,resize:hn}[e]||on)(t,e,n),i[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,n){return ve(t,e,i,n)}isAttached(t){const e=ce(t);return!(!e||!e.isConnected)}}function mn(t){return!le()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?Zi:fn}var gn=Object.freeze({__proto__:null,_detectPlatform:mn,BasePlatform:Qi,BasicPlatform:Zi,DomPlatform:fn});const vn="transparent",bn={boolean:(t,e,i)=>i>.5?e:t,color(t,e,i){const n=Kt(t||vn),o=n.valid&&Kt(e||vn);return o&&o.valid?o.mix(n,i).hexString():e},number:(t,e,i)=>t+(e-t)*i};class yn{constructor(t,e,i,n){const o=e[i];n=yi([t.to,n,o,t.from]);const s=yi([t.from,o,n]);this._active=!0,this._fn=t.fn||bn[t.type||typeof s],this._easing=ri[t.easing]||ri.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=s,this._to=n,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const n=this._target[this._prop],o=i-this._start,s=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(s,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=yi([t.to,e,n,t.from]),this._from=yi([t.from,n,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,n=this._prop,o=this._from,s=this._loop,a=this._to;let r;if(this._active=o!==a&&(s||e<i),!this._active)return this._target[n]=a,void this._notify(!0);e<0?this._target[n]=o:(r=e/i%2,r=s&&r>1?2-r:r,r=this._easing(Math.min(1,Math.max(0,r))),this._target[n]=this._fn(o,a,r))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,i)=>{t.push({res:e,rej:i})}))}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let t=0;t<i.length;t++)i[t][e]()}}class _n{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!s(t))return;const e=Object.keys(re.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach((n=>{const a=t[n];if(!s(a))return;const r={};for(const t of e)r[t]=a[t];(o(a.properties)&&a.properties||[n]).forEach((t=>{t!==n&&i.has(t)||i.set(t,r)}))}))}_animateOptions(t,e){const i=e.options,n=function(t,e){if(!e)return;let i=t.options;if(i)return i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i;t.options=e}(t,i);if(!n)return[];const o=this._createAnimations(n,i);return i.$shared&&function(t,e){const i=[],n=Object.keys(e);for(let e=0;e<n.length;e++){const o=t[n[e]];o&&o.active()&&i.push(o.wait())}return Promise.all(i)}(t.options.$animations,i).then((()=>{t.options=i}),(()=>{})),o}_createAnimations(t,e){const i=this._properties,n=[],o=t.$animations||(t.$animations={}),s=Object.keys(e),a=Date.now();let r;for(r=s.length-1;r>=0;--r){const l=s[r];if("$"===l.charAt(0))continue;if("options"===l){n.push(...this._animateOptions(t,e));continue}const c=e[l];let d=o[l];const u=i.get(l);if(d){if(u&&d.active()){d.update(u,c,a);continue}d.cancel()}u&&u.duration?(o[l]=d=new yn(u,t,l,c),n.push(d)):t[l]=c}return n}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const i=this._createAnimations(t,e);return i.length?(vt.add(this._chart,i),!0):void 0}}function wn(t,e){const i=t&&t.options||{},n=i.reverse,o=void 0===i.min?e:0,s=void 0===i.max?e:0;return{start:n?s:o,end:n?o:s}}function xn(t,e){const i=[],n=t._getSortedDatasetMetas(e);let o,s;for(o=0,s=n.length;o<s;++o)i.push(n[o].index);return i}function kn(t,e,i,n={}){const o=t.keys,s="single"===n.mode;let r,l,c,d;if(null!==e){for(r=0,l=o.length;r<l;++r){if(c=+o[r],c===i){if(n.all)continue;break}d=t.values[c],a(d)&&(s||0===e||R(e)===R(d))&&(e+=d)}return e}}function Sn(t,e){const i=t&&t.options.stacked;return i||void 0===i&&void 0!==e.stack}function Tn(t,e,i){const n=t[e]||(t[e]={});return n[i]||(n[i]={})}function Cn(t,e,i,n){for(const o of e.getMatchingVisibleMetas(n).reverse()){const e=t[o.index];if(i&&e>0||!i&&e<0)return o.index}return null}function Dn(t,e){const{chart:i,_cachedMeta:n}=t,o=i._stacks||(i._stacks={}),{iScale:s,vScale:a,index:r}=n,l=s.axis,c=a.axis,d=function(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}(s,a,n),u=e.length;let h;for(let t=0;t<u;++t){const i=e[t],{[l]:s,[c]:u}=i;h=(i._stacks||(i._stacks={}))[c]=Tn(o,d,s),h[r]=u,h._top=Cn(h,a,!0,n.type),h._bottom=Cn(h,a,!1,n.type),(h._visualValues||(h._visualValues={}))[r]=u}}function Mn(t,e){const i=t.scales;return Object.keys(i).filter((t=>i[t].axis===e)).shift()}function On(t,e){const i=t.controller.index,n=t.vScale&&t.vScale.axis;if(n){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[n]||void 0===e[n][i])return;delete e[n][i],void 0!==e[n]._visualValues&&void 0!==e[n]._visualValues[i]&&delete e[n]._visualValues[i]}}}const Pn=t=>"reset"===t||"none"===t,En=(t,e)=>e?t:Object.assign({},t);class An{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Sn(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&On(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),n=(t,e,i,n)=>"x"===t?e:"r"===t?n:i,o=e.xAxisID=l(i.xAxisID,Mn(t,"x")),s=e.yAxisID=l(i.yAxisID,Mn(t,"y")),a=e.rAxisID=l(i.rAxisID,Mn(t,"r")),r=e.indexAxis,c=e.iAxisID=n(r,o,s,a),d=e.vAxisID=n(r,s,o,a);e.xScale=this.getScaleForId(o),e.yScale=this.getScaleForId(s),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&rt(this._data,this),t._stacked&&On(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(s(e))this._data=function(t){const e=Object.keys(t),i=new Array(e.length);let n,o,s;for(n=0,o=e.length;n<o;++n)s=e[n],i[n]={x:s,y:t[s]};return i}(e);else if(i!==e){if(i){rt(i,this);const t=this._cachedMeta;On(t),t._parsed=[]}e&&Object.isExtensible(e)&&at(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let n=!1;this._dataCheck();const o=e._stacked;e._stacked=Sn(e.vScale,e),e.stack!==i.stack&&(n=!0,On(e),e.stack=i.stack),this._resyncElements(t),(n||o!==e._stacked)&&Dn(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:n}=this,{iScale:a,_stacked:r}=i,l=a.axis;let c,d,u,h=0===t&&e===n.length||i._sorted,p=t>0&&i._parsed[t-1];if(!1===this._parsing)i._parsed=n,i._sorted=!0,u=n;else{u=o(n[t])?this.parseArrayData(i,n,t,e):s(n[t])?this.parseObjectData(i,n,t,e):this.parsePrimitiveData(i,n,t,e);const a=()=>null===d[l]||p&&d[l]<p[l];for(c=0;c<e;++c)i._parsed[c+t]=d=u[c],h&&(a()&&(h=!1),p=d);i._sorted=h}r&&Dn(this,u)}parsePrimitiveData(t,e,i,n){const{iScale:o,vScale:s}=t,a=o.axis,r=s.axis,l=o.getLabels(),c=o===s,d=new Array(n);let u,h,p;for(u=0,h=n;u<h;++u)p=u+i,d[u]={[a]:c||o.parse(l[p],p),[r]:s.parse(e[p],p)};return d}parseArrayData(t,e,i,n){const{xScale:o,yScale:s}=t,a=new Array(n);let r,l,c,d;for(r=0,l=n;r<l;++r)c=r+i,d=e[c],a[r]={x:o.parse(d[0],c),y:s.parse(d[1],c)};return a}parseObjectData(t,e,i,n){const{xScale:o,yScale:s}=t,{xAxisKey:a="x",yAxisKey:r="y"}=this._parsing,l=new Array(n);let c,d,u,h;for(c=0,d=n;c<d;++c)u=c+i,h=e[u],l[c]={x:o.parse(x(h,a),u),y:s.parse(x(h,r),u)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const n=this.chart,o=this._cachedMeta,s=e[t.axis];return kn({keys:xn(n,!0),values:e._stacks[t.axis]._visualValues},s,o.index,{mode:i})}updateRangeFromParsed(t,e,i,n){const o=i[e.axis];let s=null===o?NaN:o;const a=n&&i._stacks[e.axis];n&&a&&(n.values=a,s=kn(n,o,this._cachedMeta.index)),t.min=Math.min(t.min,s),t.max=Math.max(t.max,s)}getMinMax(t,e){const i=this._cachedMeta,n=i._parsed,o=i._sorted&&t===i.iScale,s=n.length,r=this._getOtherScale(t),l=((t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:xn(i,!0),values:null})(e,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:u}=function(t){const{min:e,max:i,minDefined:n,maxDefined:o}=t.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:o?i:Number.POSITIVE_INFINITY}}(r);let h,p;function f(){p=n[h];const e=p[r.axis];return!a(p[t.axis])||d>e||u<e}for(h=0;h<s&&(f()||(this.updateRangeFromParsed(c,t,p,l),!o));++h);if(o)for(h=s-1;h>=0;--h)if(!f()){this.updateRangeFromParsed(c,t,p,l);break}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let n,o,s;for(n=0,o=e.length;n<o;++n)s=e[n][t.axis],a(s)&&i.push(s);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,n=e.vScale,o=this.getParsed(t);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:n?""+n.getLabelForValue(o[n.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,i,n,o;return s(t)?(e=t.top,i=t.right,n=t.bottom,o=t.left):e=i=n=o=t,{top:e,right:i,bottom:n,left:o,disabled:!1===t}}(l(this.options.clip,function(t,e,i){if(!1===i)return!1;const n=wn(t,i),o=wn(e,i);return{top:o.end,right:n.end,bottom:o.start,left:n.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,n=i.data||[],o=e.chartArea,s=[],a=this._drawStart||0,r=this._drawCount||n.length-a,l=this.options.drawActiveElementsOnTop;let c;for(i.dataset&&i.dataset.draw(t,o,a,r),c=a;c<a+r;++c){const e=n[c];e.hidden||(e.active&&l?s.push(e):e.draw(t,o))}for(c=0;c<s.length;++c)s[c].draw(t,o)}getStyle(t,e){const i=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const n=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];o=e.$context||(e.$context=function(t,e,i){return wi(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),o.parsed=this.getParsed(t),o.raw=n.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=function(t,e){return wi(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),o.dataset=n,o.index=o.datasetIndex=this.index;return o.active=!!e,o.mode=i,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const n="active"===e,o=this._cachedDataOpts,s=t+"-"+e,a=o[s],r=this.enableOptionSharing&&S(i);if(a)return En(a,r);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),d=n?[`${t}Hover`,"hover",t,""]:[t,""],u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(re.elements[t]),p=l.resolveNamedOptions(u,h,(()=>this.getContext(i,n,e)),d);return p.$shared&&(p.$shared=r,o[s]=Object.freeze(En(p,r))),p}_resolveAnimations(t,e,i){const n=this.chart,o=this._cachedDataOpts,s=`animation-${e}`,a=o[s];if(a)return a;let r;if(!1!==n.options.animation){const n=this.chart.config,o=n.datasetAnimationScopeKeys(this._type,e),s=n.getOptionScopes(this.getDataset(),o);r=n.createResolver(s,this.getContext(t,i,e))}const l=new _n(n,r&&r.animations);return r&&r._cacheable&&(o[s]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Pn(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),n=this._sharedOptions,o=this.getSharedOptions(i),s=this.includeOptions(e,o)||o!==n;return this.updateSharedOptions(o,e,i),{sharedOptions:o,includeOptions:s}}updateElement(t,e,i,n){Pn(n)?Object.assign(t,i):this._resolveAnimations(e,n).update(t,i)}updateSharedOptions(t,e,i){t&&!Pn(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,n){t.active=n;const o=this.getStyle(e,n);this._resolveAnimations(e,i,n).update(t,{options:!n&&this.getSharedOptions(o)||o})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[t,e,i]of this._syncList)this[t](e,i);this._syncList=[];const n=i.length,o=e.length,s=Math.min(o,n);s&&this.parse(0,s),o>n?this._insertElements(n,o-n,t):o<n&&this._removeElements(o,n-o)}_insertElements(t,e,i=!0){const n=this._cachedMeta,o=n.data,s=t+e;let a;const r=t=>{for(t.length+=e,a=t.length-1;a>=s;a--)t[a]=t[a-e]};for(r(o),a=t;a<s;++a)o[a]=new this.dataElementType;this._parsing&&r(n._parsed),this.parse(t,e),i&&this.updateElements(o,t,e,"reset")}updateElements(t,e,i,n){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const n=i._parsed.splice(t,e);i._stacked&&On(i,n)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,n]=t;this[e](i,n)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}class In{static defaults={};static defaultRoutes=void 0;active=!1;tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return H(this.x)&&H(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const n={};return t.forEach((t=>{n[t]=i[t]&&i[t].active()?i[t]._to:this[t]})),n}}function Ln(t,e){const i=t.options.ticks,o=function(t){const e=t.options.offset,i=t._tickSize(),n=t._length/i+(e?0:1),o=t._maxLength/i;return Math.floor(Math.min(n,o))}(t),s=Math.min(i.maxTicksLimit||o,o),a=i.major.enabled?function(t){const e=[];let i,n;for(i=0,n=t.length;i<n;i++)t[i].major&&e.push(i);return e}(e):[],r=a.length,l=a[0],c=a[r-1],d=[];if(r>s)return function(t,e,i,n){let o,s=0,a=i[0];for(n=Math.ceil(n),o=0;o<t.length;o++)o===a&&(e.push(t[o]),s++,a=i[s*n])}(e,d,a,r/s),d;const u=function(t,e,i){const n=function(t){const e=t.length;let i,n;if(e<2)return!1;for(n=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==n)return!1;return n}(t),o=e.length/i;if(!n)return Math.max(o,1);const s=F(n);for(let t=0,e=s.length-1;t<e;t++){const e=s[t];if(e>o)return e}return Math.max(o,1)}(a,e,s);if(r>0){let t,i;const o=r>1?Math.round((c-l)/(r-1)):null;for(Nn(e,d,u,n(o)?0:l-o,l),t=0,i=r-1;t<i;t++)Nn(e,d,u,a[t],a[t+1]);return Nn(e,d,u,c,n(o)?e.length:c+o),d}return Nn(e,d,u),d}function Nn(t,e,i,n,o){const s=l(n,0),a=Math.min(l(o,t.length),t.length);let r,c,d,u=0;for(i=Math.ceil(i),o&&(r=o-n,i=r/Math.floor(r/i)),d=s;d<0;)u++,d=Math.round(s+u*i);for(c=Math.max(s,0);c<a;c++)c===d&&(e.push(t[c]),u++,d=Math.round(s+u*i))}const jn=(t,e,i)=>"top"===e||"left"===e?t[e]+i:t[e]-i,Rn=(t,e)=>Math.min(e||t,t);function $n(t,e){const i=[],n=t.length/e,o=t.length;let s=0;for(;s<o;s+=n)i.push(t[Math.floor(s)]);return i}function Bn(t,e,i){const n=t.ticks.length,o=Math.min(e,n-1),s=t._startPixel,a=t._endPixel,r=1e-6;let l,c=t.getPixelForTick(o);if(!(i&&(l=1===n?Math.max(c-s,a-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(o-1))/2,c+=o<e?l:-l,c<s-r||c>a+r)))return c}function Fn(t){return t.drawTicks?t.tickLength:0}function Hn(t,e){if(!t.display)return 0;const i=bi(t.font,e),n=vi(t.padding);return(o(t.text)?t.text.length:1)*i.lineHeight+n.height}function Wn(t,e,i){let n=ht(t);return(i&&"right"!==e||!i&&"right"===e)&&(n=(t=>"left"===t?"right":"right"===t?"left":t)(n)),n}class Un extends In{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:n}=this;return t=r(t,Number.POSITIVE_INFINITY),e=r(e,Number.NEGATIVE_INFINITY),i=r(i,Number.POSITIVE_INFINITY),n=r(n,Number.NEGATIVE_INFINITY),{min:r(t,i),max:r(e,n),minDefined:a(t),maxDefined:a(e)}}getMinMax(t){let e,{min:i,max:n,minDefined:o,maxDefined:s}=this.getUserBounds();if(o&&s)return{min:i,max:n};const a=this.getMatchingVisibleMetas();for(let r=0,l=a.length;r<l;++r)e=a[r].controller.getMinMax(this,t),o||(i=Math.min(i,e.min)),s||(n=Math.max(n,e.max));return i=s&&i>n?n:i,n=o&&i>n?i:n,{min:r(i,r(n,i)),max:r(n,r(i,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){u(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:n,grace:o,ticks:s}=this.options,a=s.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=_i(this,o,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const r=a<this.ticks.length;this._convertTicksToLabels(r?$n(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||"auto"===s.source)&&(this.ticks=Ln(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),r&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,i=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,i=!i),this._startPixel=t,this._endPixel=e,this._reversePixels=i,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){u(this.options.afterUpdate,[this])}beforeSetDimensions(){u(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){u(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),u(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){u(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,n,o;for(i=0,n=t.length;i<n;i++)o=t[i],o.label=u(e.callback,[o.value,i,t],this)}afterTickToLabelConversion(){u(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){u(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=Rn(this.ticks.length,t.ticks.maxTicksLimit),n=e.minRotation||0,o=e.maxRotation;let s,a,r,l=n;if(!this._isVisible()||!e.display||n>=o||i<=1||!this.isHorizontal())return void(this.labelRotation=n);const c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=Q(this.chart.width-d,0,this.maxWidth);s=t.offset?this.maxWidth/i:h/(i-1),d+6>s&&(s=h/(i-(t.offset?.5:1)),a=this.maxHeight-Fn(t.grid)-e.padding-Hn(t.title,this.chart.options.font),r=Math.sqrt(d*d+u*u),l=z(Math.min(Math.asin(Q((c.highest.height+6)/s,-1,1)),Math.asin(Q(a/r,-1,1))-Math.asin(Q(u/r,-1,1)))),l=Math.max(n,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){u(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){u(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:n,grid:o}}=this,s=this._isVisible(),a=this.isHorizontal();if(s){const s=Hn(n,e.options.font);if(a?(t.width=this.maxWidth,t.height=Fn(o)+s):(t.height=this.maxHeight,t.width=Fn(o)+s),i.display&&this.ticks.length){const{first:e,last:n,widest:o,highest:s}=this._getLabelSizes(),r=2*i.padding,l=q(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(a){const e=i.mirror?0:d*o.width+c*s.height;t.height=Math.min(this.maxHeight,t.height+e+r)}else{const e=i.mirror?0:c*o.width+d*s.height;t.width=Math.min(this.maxWidth,t.width+e+r)}this._calculatePadding(e,n,d,c)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,n){const{ticks:{align:o,padding:s},position:a}=this.options,r=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const a=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,u=0;r?l?(d=n*t.width,u=i*e.height):(d=i*t.height,u=n*e.width):"start"===o?u=e.width:"end"===o?d=t.width:"inner"!==o&&(d=t.width/2,u=e.width/2),this.paddingLeft=Math.max((d-a+s)*this.width/(this.width-a),0),this.paddingRight=Math.max((u-c+s)*this.width/(this.width-c),0)}else{let i=e.height/2,n=t.height/2;"start"===o?(i=0,n=t.height):"end"===o&&(i=e.height,n=0),this.paddingTop=i+s,this.paddingBottom=n+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){u(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,i;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,i=t.length;e<i;e++)n(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=$n(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:s,_longestTextCache:a}=this,r=[],l=[],c=Math.floor(e/Rn(e,i));let d,u,p,f,m,g,v,b,y,_,w,x=0,k=0;for(d=0;d<e;d+=c){if(f=t[d].label,m=this._resolveTickFontOptions(d),s.font=g=m.string,v=a[g]=a[g]||{data:{},gc:[]},b=m.lineHeight,y=_=0,n(f)||o(f)){if(o(f))for(u=0,p=f.length;u<p;++u)w=f[u],n(w)||o(w)||(y=xe(s,v.data,v.gc,y,w),_+=b)}else y=xe(s,v.data,v.gc,y,f),_=b;r.push(y),l.push(_),x=Math.max(y,x),k=Math.max(_,k)}!function(t,e){h(t,(t=>{const i=t.gc,n=i.length/2;let o;if(n>e){for(o=0;o<n;++o)delete t.data[i[o]];i.splice(0,n)}}))}(a,e);const S=r.indexOf(x),T=l.indexOf(k),C=t=>({width:r[t]||0,height:l[t]||0});return{first:C(0),last:C(e-1),widest:C(S),highest:C(T),widths:r,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Z(this._alignToPixels?Se(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=function(t,e,i){return wi(t,{tick:i,index:e,type:"tick"})}(this.getContext(),t,i))}return this.$context||(this.$context=wi(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const t=this.options.ticks,e=q(this.labelRotation),i=Math.abs(Math.cos(e)),n=Math.abs(Math.sin(e)),o=this._getLabelSizes(),s=t.autoSkipPadding||0,a=o?o.widest.width+s:0,r=o?o.highest.height+s:0;return this.isHorizontal()?r*i>a*n?a/i:r/n:r*n<a*i?r/i:a/n}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,n=this.options,{grid:o,position:a,border:r}=n,c=o.offset,d=this.isHorizontal(),u=this.ticks.length+(c?1:0),h=Fn(o),p=[],f=r.setContext(this.getContext()),m=f.display?f.width:0,g=m/2,v=function(t){return Se(i,t,m)};let b,y,_,w,x,k,S,T,C,D,M,O;if("top"===a)b=v(this.bottom),k=this.bottom-h,T=b-g,D=v(t.top)+g,O=t.bottom;else if("bottom"===a)b=v(this.top),D=t.top,O=v(t.bottom)-g,k=b+g,T=this.top+h;else if("left"===a)b=v(this.right),x=this.right-h,S=b-g,C=v(t.left)+g,M=t.right;else if("right"===a)b=v(this.left),C=t.left,M=v(t.right)-g,x=b+g,S=this.left+h;else if("x"===e){if("center"===a)b=v((t.top+t.bottom)/2+.5);else if(s(a)){const t=Object.keys(a)[0],e=a[t];b=v(this.chart.scales[t].getPixelForValue(e))}D=t.top,O=t.bottom,k=b+g,T=k+h}else if("y"===e){if("center"===a)b=v((t.left+t.right)/2);else if(s(a)){const t=Object.keys(a)[0],e=a[t];b=v(this.chart.scales[t].getPixelForValue(e))}x=b-g,S=x-h,C=t.left,M=t.right}const P=l(n.ticks.maxTicksLimit,u),E=Math.max(1,Math.ceil(u/P));for(y=0;y<u;y+=E){const t=this.getContext(y),e=o.setContext(t),n=r.setContext(t),s=e.lineWidth,a=e.color,l=n.dash||[],u=n.dashOffset,h=e.tickWidth,f=e.tickColor,m=e.tickBorderDash||[],g=e.tickBorderDashOffset;_=Bn(this,y,c),void 0!==_&&(w=Se(i,_,s),d?x=S=C=M=w:k=T=D=O=w,p.push({tx1:x,ty1:k,tx2:S,ty2:T,x1:C,y1:D,x2:M,y2:O,width:s,color:a,borderDash:l,borderDashOffset:u,tickWidth:h,tickColor:f,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=u,this._borderValue=b,p}_computeLabelItems(t){const e=this.axis,i=this.options,{position:n,ticks:a}=i,r=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:u,mirror:h}=a,p=Fn(i.grid),f=p+u,m=h?-u:f,g=-q(this.labelRotation),v=[];let b,y,_,w,x,k,S,T,C,D,M,O,P="middle";if("top"===n)k=this.bottom-m,S=this._getXAxisLabelAlignment();else if("bottom"===n)k=this.top+m,S=this._getXAxisLabelAlignment();else if("left"===n){const t=this._getYAxisLabelAlignment(p);S=t.textAlign,x=t.x}else if("right"===n){const t=this._getYAxisLabelAlignment(p);S=t.textAlign,x=t.x}else if("x"===e){if("center"===n)k=(t.top+t.bottom)/2+f;else if(s(n)){const t=Object.keys(n)[0],e=n[t];k=this.chart.scales[t].getPixelForValue(e)+f}S=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===n)x=(t.left+t.right)/2-f;else if(s(n)){const t=Object.keys(n)[0],e=n[t];x=this.chart.scales[t].getPixelForValue(e)}S=this._getYAxisLabelAlignment(p).textAlign}"y"===e&&("start"===c?P="top":"end"===c&&(P="bottom"));const E=this._getLabelSizes();for(b=0,y=l.length;b<y;++b){_=l[b],w=_.label;const t=a.setContext(this.getContext(b));T=this.getPixelForTick(b)+a.labelOffset,C=this._resolveTickFontOptions(b),D=C.lineHeight,M=o(w)?w.length:1;const e=M/2,i=t.color,s=t.textStrokeColor,c=t.textStrokeWidth;let u,p=S;if(r?(x=T,"inner"===S&&(p=b===y-1?this.options.reverse?"left":"right":0===b?this.options.reverse?"right":"left":"center"),O="top"===n?"near"===d||0!==g?-M*D+D/2:"center"===d?-E.highest.height/2-e*D+D:-E.highest.height+D/2:"near"===d||0!==g?D/2:"center"===d?E.highest.height/2-e*D:E.highest.height-M*D,h&&(O*=-1),0===g||t.showLabelBackdrop||(x+=D/2*Math.sin(g))):(k=T,O=(1-M)*D/2),t.showLabelBackdrop){const e=vi(t.backdropPadding),i=E.heights[b],n=E.widths[b];let o=O-e.top,s=0-e.left;switch(P){case"middle":o-=i/2;break;case"bottom":o-=i}switch(S){case"center":s-=n/2;break;case"right":s-=n}u={left:s,top:o,width:n+e.width,height:i+e.height,color:t.backdropColor}}v.push({label:w,font:C,textOffset:O,options:{rotation:g,color:i,strokeColor:s,strokeWidth:c,textAlign:p,textBaseline:P,translation:[x,k],backdrop:u}})}return v}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-q(this.labelRotation))return"top"===t?"left":"right";let i="center";return"start"===e.align?i="left":"end"===e.align?i="right":"inner"===e.align&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:n,padding:o}}=this.options,s=t+o,a=this._getLabelSizes().widest.width;let r,l;return"left"===e?n?(l=this.right+o,"near"===i?r="left":"center"===i?(r="center",l+=a/2):(r="right",l+=a)):(l=this.right-s,"near"===i?r="right":"center"===i?(r="center",l-=a/2):(r="left",l=this.left)):"right"===e?n?(l=this.left+o,"near"===i?r="right":"center"===i?(r="center",l-=a/2):(r="left",l-=a)):(l=this.left+s,"near"===i?r="left":"center"===i?(r="center",l+=a/2):(r="right",l=this.right)):r="right",{textAlign:r,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:n,width:o,height:s}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,n,o,s),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex((e=>e.value===t));return i>=0?e.setContext(this.getContext(i)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let o,s;const a=(t,e,n)=>{n.width&&n.color&&(i.save(),i.lineWidth=n.width,i.strokeStyle=n.color,i.setLineDash(n.borderDash||[]),i.lineDashOffset=n.borderDashOffset,i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.stroke(),i.restore())};if(e.display)for(o=0,s=n.length;o<s;++o){const t=n[o];e.drawOnChartArea&&a({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&a({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:n}}=this,o=i.setContext(this.getContext()),s=i.display?o.width:0;if(!s)return;const a=n.setContext(this.getContext(0)).lineWidth,r=this._borderValue;let l,c,d,u;this.isHorizontal()?(l=Se(t,this.left,s)-s/2,c=Se(t,this.right,a)+a/2,d=u=r):(d=Se(t,this.top,s)-s/2,u=Se(t,this.bottom,a)+a/2,l=c=r),e.save(),e.lineWidth=o.width,e.strokeStyle=o.color,e.beginPath(),e.moveTo(l,d),e.lineTo(c,u),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,i=this._computeLabelArea();i&&Oe(e,i);const n=this.getLabelItems(t);for(const t of n){const i=t.options,n=t.font;Ie(e,t.label,0,t.textOffset,n,i)}i&&Pe(e)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:n}}=this;if(!i.display)return;const a=bi(i.font),r=vi(i.padding),l=i.align;let c=a.lineHeight/2;"bottom"===e||"center"===e||s(e)?(c+=r.bottom,o(i.text)&&(c+=a.lineHeight*(i.text.length-1))):c+=r.top;const{titleX:d,titleY:u,maxWidth:h,rotation:p}=function(t,e,i,n){const{top:o,left:a,bottom:r,right:l,chart:c}=t,{chartArea:d,scales:u}=c;let h,p,f,m=0;const g=r-o,v=l-a;if(t.isHorizontal()){if(p=pt(n,a,l),s(i)){const t=Object.keys(i)[0],n=i[t];f=u[t].getPixelForValue(n)+g-e}else f="center"===i?(d.bottom+d.top)/2+g-e:jn(t,i,e);h=l-a}else{if(s(i)){const t=Object.keys(i)[0],n=i[t];p=u[t].getPixelForValue(n)-v+e}else p="center"===i?(d.left+d.right)/2-v+e:jn(t,i,e);f=pt(n,r,o),m="left"===i?-I:I}return{titleX:p,titleY:f,maxWidth:h,rotation:m}}(this,c,e,l);Ie(t,i.text,0,0,a,{color:i.color,maxWidth:h,rotation:p,textAlign:Wn(l,e,n),textBaseline:"middle",translation:[d,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=l(t.grid&&t.grid.z,-1),n=l(t.border&&t.border.z,0);return this._isVisible()&&this.draw===Un.prototype.draw?[{z:i,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",n=[];let o,s;for(o=0,s=e.length;o<s;++o){const s=e[o];s[i]!==this.id||t&&s.type!==t||n.push(s)}return n}_resolveTickFontOptions(t){return bi(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class qn{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;(function(t){return"id"in t&&"defaults"in t})(e)&&(i=this.register(e));const n=this.items,o=t.id,s=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in n||(n[o]=t,function(t,e,i){const n=v(Object.create(null),[i?re.get(i):{},re.get(e),t.defaults]);re.set(e,n),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((i=>{const n=i.split("."),o=n.pop(),s=[t].concat(n).join("."),a=e[i].split("."),r=a.pop(),l=a.join(".");re.route(s,o,l,r)}))}(e,t.defaultRoutes),t.descriptors&&re.describe(e,t.descriptors)}(t,s,i),this.override&&re.override(t.id,t.overrides)),s}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,n=this.scope;i in e&&delete e[i],n&&i in re[n]&&(delete re[n][i],this.override&&delete ne[i])}}var zn=new class{constructor(){this.controllers=new qn(An,"datasets",!0),this.elements=new qn(In,"elements"),this.plugins=new qn(Object,"plugins"),this.scales=new qn(Un,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach((e=>{const n=i||this._getRegistryForType(e);i||n.isForType(e)||n===this.plugins&&e.id?this._exec(t,n,e):h(e,(e=>{const n=i||this._getRegistryForType(e);this._exec(t,n,e)}))}))}_exec(t,e,i){const n=k(t);u(i["before"+n],[],i),e[t](i),u(i["after"+n],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const n=e.get(t);if(void 0===n)throw new Error('"'+t+'" is not a registered '+i+".");return n}};class Vn{constructor(){this._init=[]}notify(t,e,i,n){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const o=n?this._descriptors(t).filter(n):this._descriptors(t),s=this._notify(o,t,e,i);return"afterDestroy"===e&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall")),s}_notify(t,e,i,n){n=n||{};for(const o of t){const t=o.plugin;if(!1===u(t[i],[e,n,o.options],t)&&n.cancelable)return!1}return!0}invalidate(){n(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,n=l(i.options&&i.options.plugins,{}),o=function(t){const e={},i=[],n=Object.keys(zn.plugins.items);for(let t=0;t<n.length;t++)i.push(zn.getPlugin(n[t]));const o=t.plugins||[];for(let t=0;t<o.length;t++){const n=o[t];-1===i.indexOf(n)&&(i.push(n),e[n.id]=!0)}return{plugins:i,localIds:e}}(i);return!1!==n||e?function(t,{plugins:e,localIds:i},n,o){const s=[],a=t.getContext();for(const r of e){const e=r.id,l=Yn(n[e],o);null!==l&&s.push({plugin:r,options:Gn(t.config,{plugin:r,local:i[e]},l,a)})}return s}(t,o,n,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,n=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(n(e,i),t,"stop"),this._notify(n(i,e),t,"start")}}function Yn(t,e){return e||!1!==t?!0===t?{}:t:null}function Gn(t,{plugin:e,local:i},n,o){const s=t.pluginScopeKeys(e),a=t.getOptionScopes(n,s);return i&&e.defaults&&a.push(e.defaults),t.createResolver(a,o,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Kn(t,e){const i=re.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function Xn(t,e){if("x"===t||"y"===t||"r"===t)return t;var i;if(t=e.axis||("top"===(i=e.position)||"bottom"===i?"x":"left"===i||"right"===i?"y":void 0)||t.length>1&&Xn(t[0].toLowerCase(),e))return t;throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`)}function Jn(t){const e=t.options||(t.options={});e.plugins=l(e.plugins,{}),e.scales=function(t,e){const i=ne[t.type]||{scales:{}},n=e.scales||{},o=Kn(t.type,e),a=Object.create(null);return Object.keys(n).forEach((t=>{const e=n[t];if(!s(e))return console.error(`Invalid scale configuration for scale: ${t}`);if(e._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const r=Xn(t,e),l=function(t,e){return t===e?"_index_":"_value_"}(r,o),c=i.scales||{};a[t]=b(Object.create(null),[{axis:r},e,c[r],c[l]])})),t.data.datasets.forEach((i=>{const o=i.type||t.type,s=i.indexAxis||Kn(o,e),r=(ne[o]||{}).scales||{};Object.keys(r).forEach((t=>{const e=function(t,e){let i=t;return"_index_"===t?i=e:"_value_"===t&&(i="x"===e?"y":"x"),i}(t,s),o=i[e+"AxisID"]||e;a[o]=a[o]||Object.create(null),b(a[o],[{axis:e},n[o],r[t]])}))})),Object.keys(a).forEach((t=>{const e=a[t];b(e,[re.scales[e.type],re.scale])})),a}(t,e)}function Qn(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const Zn=new Map,to=new Set;function eo(t,e){let i=Zn.get(t);return i||(i=e(),Zn.set(t,i),to.add(i)),i}const io=(t,e,i)=>{const n=x(e,i);void 0!==n&&t.add(n)};class no{constructor(t){this._config=function(t){return(t=t||{}).data=Qn(t.data),Jn(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Qn(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Jn(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return eo(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return eo(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return eo(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return eo(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const i=this._scopeCache;let n=i.get(t);return n&&!e||(n=new Map,i.set(t,n)),n}getOptionScopes(t,e,i){const{options:n,type:o}=this,s=this._cachedScopes(t,i),a=s.get(e);if(a)return a;const r=new Set;e.forEach((e=>{t&&(r.add(t),e.forEach((e=>io(r,t,e)))),e.forEach((t=>io(r,n,t))),e.forEach((t=>io(r,ne[o]||{},t))),e.forEach((t=>io(r,re,t))),e.forEach((t=>io(r,oe,t)))}));const l=Array.from(r);return 0===l.length&&l.push(Object.create(null)),to.has(e)&&s.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,ne[e]||{},re.datasets[e]||{},{type:e},re,oe]}resolveNamedOptions(t,e,i,n=[""]){const s={$shared:!0},{resolver:a,subPrefixes:r}=oo(this._resolverCache,t,n);let l=a;(function(t,e){const{isScriptable:i,isIndexable:n}=Be(t);for(const s of e){const e=i(s),a=n(s),r=(a||e)&&t[s];if(e&&(T(r)||so(r))||a&&o(r))return!0}return!1})(a,e)&&(s.$shared=!1,l=$e(a,i=T(i)?i():i,this.createResolver(t,i,r)));for(const t of e)s[t]=l[t];return s}createResolver(t,e,i=[""],n){const{resolver:o}=oo(this._resolverCache,t,i);return s(e)?$e(o,e,void 0,n):o}}function oo(t,e,i){let n=t.get(e);n||(n=new Map,t.set(e,n));const o=i.join();let s=n.get(o);return s||(s={resolver:Re(e,i),subPrefixes:i.filter((t=>!t.toLowerCase().includes("hover")))},n.set(o,s)),s}const so=t=>s(t)&&Object.getOwnPropertyNames(t).reduce(((e,i)=>e||T(t[i])),!1),ao=["top","bottom","left","right","chartArea"];function ro(t,e){return"top"===t||"bottom"===t||-1===ao.indexOf(t)&&"x"===e}function lo(t,e){return function(i,n){return i[t]===n[t]?i[e]-n[e]:i[t]-n[t]}}function co(t){const e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),u(i&&i.onComplete,[t],e)}function uo(t){const e=t.chart,i=e.options.animation;u(i&&i.onProgress,[t],e)}function ho(t){return le()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const po={},fo=t=>{const e=ho(t);return Object.values(po).filter((t=>t.canvas===e)).pop()};function mo(t,e,i){const n=Object.keys(t);for(const o of n){const n=+o;if(n>=e){const s=t[o];delete t[o],(i>0||n>e)&&(t[n+i]=s)}}}class go{static defaults=re;static instances=po;static overrides=ne;static registry=zn;static version="4.2.1";static getChart=fo;static register(...t){zn.add(...t),vo()}static unregister(...t){zn.remove(...t),vo()}constructor(t,e){const n=this.config=new no(e),o=ho(t),s=fo(o);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||mn(o)),this.platform.updateConfig(n);const r=this.platform.acquireContext(o,a.aspectRatio),l=r&&r.canvas,c=l&&l.height,d=l&&l.width;this.id=i(),this.ctx=r,this.canvas=l,this.width=d,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Vn,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=ut((t=>this.update(t)),a.resizeDelay||0),this._dataChanges=[],po[this.id]=this,r&&l?(vt.listen(this,"complete",co),vt.listen(this,"progress",uo),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:o,_aspectRatio:s}=this;return n(t)?e&&s?s:o?i/o:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return zn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():be(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Te(this.canvas,this.ctx),this}stop(){return vt.stop(this),this}resize(t,e){vt.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,n=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,s=this.platform.getMaximumSize(n,t,e,o),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),r=this.width?"resize":"attach";this.width=s.width,this.height=s.height,this._aspectRatio=this.aspectRatio,be(this,a,!0)&&(this.notifyPlugins("resize",{size:s}),u(i.onResize,[this,s],this),this.attached&&this._doResize(r)&&this.render())}ensureScalesHaveIDs(){h(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,n=Object.keys(i).reduce(((t,e)=>(t[e]=!1,t)),{});let o=[];e&&(o=o.concat(Object.keys(e).map((t=>{const i=e[t],n=Xn(t,i),o="r"===n,s="x"===n;return{options:i,dposition:o?"chartArea":s?"bottom":"left",dtype:o?"radialLinear":s?"category":"linear"}})))),h(o,(e=>{const o=e.options,s=o.id,a=Xn(s,o),r=l(o.type,e.dtype);void 0!==o.position&&ro(o.position,a)===ro(e.dposition)||(o.position=e.dposition),n[s]=!0;let c=null;s in i&&i[s].type===r?c=i[s]:(c=new(zn.getScale(r))({id:s,type:r,ctx:this.ctx,chart:this}),i[c.id]=c),c.init(o,t)})),h(n,((t,e)=>{t||delete i[e]})),h(i,(t=>{Ji.configure(this,t,t.options),Ji.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort(((t,e)=>t.index-e.index)),i>e){for(let t=e;t<i;++t)this._destroyDatasetMeta(t);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(lo("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,i)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(i)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,n;for(this._removeUnreferencedMetasets(),i=0,n=e.length;i<n;i++){const n=e[i];let o=this.getDatasetMeta(i);const s=n.type||this.config.type;if(o.type&&o.type!==s&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=s,o.indexAxis=n.indexAxis||Kn(s,this.options),o.order=n.order||0,o.index=i,o.label=""+n.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const e=zn.getController(s),{datasetElementType:n,dataElementType:a}=re.datasets[s];Object.assign(e,{dataElementType:zn.getElement(a),datasetElementType:n&&zn.getElement(n)}),o.controller=new e(this,i),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){h(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let s=0;for(let t=0,e=this.data.datasets.length;t<e;t++){const{controller:e}=this.getDatasetMeta(t),i=!n&&-1===o.indexOf(e);e.buildOrUpdateElements(i),s=Math.max(+e.getMaxOverflow(),s)}s=this._minPadding=i.layout.autoPadding?s:0,this._updateLayout(s),n||h(o,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(lo("z","_idx"));const{_active:a,_lastEvent:r}=this;r?this._eventHandler(r,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){h(this.scales,(t=>{Ji.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);C(e,i)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:n,count:o}of e)mo(t,n,"_removeElements"===i?-o:o)}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),n=i(0);for(let t=1;t<e;t++)if(!C(n,i(t)))return;return Array.from(n).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Ji.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],h(this.boxes,(t=>{i&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,T(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),n={meta:i,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",n)&&(i.controller._update(e),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(vt.has(this)?this.attached&&!vt.running(this)&&vt.start(this):(this.draw(),co({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let n,o;for(n=0,o=e.length;n<o;++n){const o=e[n];t&&!o.visible||i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i=t._clip,n=!i.disabled,o=function(t){const{xScale:e,yScale:i}=t;if(e&&i)return{left:e.left,right:e.right,top:i.top,bottom:i.bottom}}(t)||this.chartArea,s={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",s)&&(n&&Oe(e,{left:!1===i.left?0:o.left-i.left,right:!1===i.right?this.width:o.right+i.right,top:!1===i.top?0:o.top-i.top,bottom:!1===i.bottom?this.height:o.bottom+i.bottom}),t.controller.draw(),n&&Pe(e),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(t){return Me(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,n){const o=Bi.modes[e];return"function"==typeof o?o(this,t,i,n):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let n=i.filter((t=>t&&t._dataset===e)).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(n)),n}getContext(){return this.$context||(this.$context=wi(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return"boolean"==typeof i.hidden?!i.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const n=i?"show":"hide",o=this.getDatasetMeta(t),s=o.controller._resolveAnimations(void 0,n);S(e)?(o.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),s.update(o,{visible:i}),this.update((e=>e.datasetIndex===t?n:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),vt.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Te(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete po[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(i,n)=>{e.addEventListener(this,i,n),t[i]=n},n=(t,e,i)=>{t.offsetX=e,t.offsetY=i,this._eventHandler(t)};h(this.options.events,(t=>i(t,n)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(i,n)=>{e.addEventListener(this,i,n),t[i]=n},n=(i,n)=>{t[i]&&(e.removeEventListener(this,i,n),delete t[i])},o=(t,e)=>{this.canvas&&this.resize(t,e)};let s;const a=()=>{n("attach",a),this.attached=!0,this.resize(),i("resize",o),i("detach",s)};s=()=>{this.attached=!1,n("resize",o),this._stop(),this._resize(0,0),i("attach",a)},e.isAttached(this.canvas)?a():s()}unbindEvents(){h(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},h(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const n=i?"set":"remove";let o,s,a,r;for("dataset"===e&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+n+"DatasetHoverStyle"]()),a=0,r=t.length;a<r;++a){s=t[a];const e=s&&this.getDatasetMeta(s.datasetIndex).controller;e&&e[n+"HoverStyle"](s.element,s.datasetIndex,s.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map((({datasetIndex:t,index:e})=>{const i=this.getDatasetMeta(t);if(!i)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:i.data[e],index:e}}));!p(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return 1===this._plugins._cache.filter((e=>e.plugin.id===t)).length}_updateHoverStyles(t,e,i){const n=this.options.hover,o=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),s=o(e,t),a=i?t:o(t,e);s.length&&this.updateHoverStyle(s,n.mode,!1),a.length&&n.mode&&this.updateHoverStyle(a,n.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},n=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",i,n))return;const o=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,n),(o||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:n=[],options:o}=this,s=e,a=this._getActiveElements(t,n,i,s),r=D(t),l=function(t,e,i,n){return i&&"mouseout"!==t.type?n?e:t:null}(t,this._lastEvent,i,r);i&&(this._lastEvent=null,u(o.onHover,[t,a,this],this),r&&u(o.onClick,[t,a,this],this));const c=!p(a,n);return(c||e)&&(this._active=a,this._updateHoverStyles(a,n,e)),this._lastEvent=l,c}_getActiveElements(t,e,i,n){if("mouseout"===t.type)return[];if(!i)return e;const o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,n)}}function vo(){return h(go.instances,(t=>t._plugins.invalidate()))}function bo(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class yo{static override(t){Object.assign(yo.prototype,t)}constructor(t){this.options=t||{}}init(){}formats(){return bo()}parse(){return bo()}format(){return bo()}add(){return bo()}diff(){return bo()}startOf(){return bo()}endOf(){return bo()}}var _o={_date:yo};function wo(t){const e=t.iScale,i=function(t,e){if(!t._cache.$bar){const i=t.getMatchingVisibleMetas(e);let n=[];for(let e=0,o=i.length;e<o;e++)n=n.concat(i[e].controller.getAllParsedValues(t));t._cache.$bar=lt(n.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let n,o,s,a,r=e._length;const l=()=>{32767!==s&&-32768!==s&&(S(a)&&(r=Math.min(r,Math.abs(s-a)||r)),a=s)};for(n=0,o=i.length;n<o;++n)s=e.getPixelForValue(i[n]),l();for(a=void 0,n=0,o=e.ticks.length;n<o;++n)s=e.getPixelForTick(n),l();return r}function xo(t,e,i,n){return o(t)?function(t,e,i,n){const o=i.parse(t[0],n),s=i.parse(t[1],n),a=Math.min(o,s),r=Math.max(o,s);let l=a,c=r;Math.abs(a)>Math.abs(r)&&(l=r,c=a),e[i.axis]=c,e._custom={barStart:l,barEnd:c,start:o,end:s,min:a,max:r}}(t,e,i,n):e[i.axis]=i.parse(t,n),e}function ko(t,e,i,n){const o=t.iScale,s=t.vScale,a=o.getLabels(),r=o===s,l=[];let c,d,u,h;for(c=i,d=i+n;c<d;++c)h=e[c],u={},u[o.axis]=r||o.parse(a[c],c),l.push(xo(h,u,s,c));return l}function So(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function To(t,e,i,n){let o=e.borderSkipped;const s={};if(!o)return void(t.borderSkipped=s);if(!0===o)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:a,end:r,reverse:l,top:c,bottom:d}=function(t){let e,i,n,o,s;return t.horizontal?(e=t.base>t.x,i="left",n="right"):(e=t.base<t.y,i="bottom",n="top"),e?(o="end",s="start"):(o="start",s="end"),{start:i,end:n,reverse:e,top:o,bottom:s}}(t);"middle"===o&&i&&(t.enableBorderRadius=!0,(i._top||0)===n?o=c:(i._bottom||0)===n?o=d:(s[Co(d,a,r,l)]=!0,o=c)),s[Co(o,a,r,l)]=!0,t.borderSkipped=s}function Co(t,e,i,n){var o,s,a;return n?(a=i,t=Do(t=(o=t)===(s=e)?a:o===a?s:o,i,e)):t=Do(t,e,i),t}function Do(t,e,i){return"start"===t?e:"end"===t?i:t}function Mo(t,{inflateAmount:e},i){t.inflateAmount="auto"===e?1===i?.33:0:e}class Oo extends An{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:n}}=t.legend.options;return e.labels.map(((e,o)=>{const s=t.getDatasetMeta(0).controller.getStyle(o);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:n,lineWidth:s.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(o),index:o}}))}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const i=this.getDataset().data,n=this._cachedMeta;if(!1===this._parsing)n._parsed=i;else{let o,a,r=t=>+i[t];if(s(i[t])){const{key:t="value"}=this._parsing;r=e=>+x(i[e],t)}for(o=t,a=t+e;o<a;++o)n._parsed[o]=r(o)}}_getRotation(){return q(this.options.rotation-90)}_getCircumference(){return q(this.options.circumference)}_getRotationExtents(){let t=O,e=-O;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const n=this.chart.getDatasetMeta(i).controller,o=n._getRotation(),s=n._getCircumference();t=Math.min(t,o),e=Math.max(e,o+s)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:i}=e,n=this._cachedMeta,o=n.data,s=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-s)/2,0),r=Math.min(c(this.options.cutout,a),1),l=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:f,offsetX:m,offsetY:g}=function(t,e,i){let n=1,o=1,s=0,a=0;if(e<O){const r=t,l=r+e,c=Math.cos(r),d=Math.sin(r),u=Math.cos(l),h=Math.sin(l),p=(t,e,n)=>J(t,r,l,!0)?1:Math.max(e,e*i,n,n*i),f=(t,e,n)=>J(t,r,l,!0)?-1:Math.min(e,e*i,n,n*i),m=p(0,c,u),g=p(I,d,h),v=f(M,c,u),b=f(M+I,d,h);n=(m-v)/2,o=(g-b)/2,s=-(m+v)/2,a=-(g+b)/2}return{ratioX:n,ratioY:o,offsetX:s,offsetY:a}}(h,u,r),v=(i.width-s)/p,b=(i.height-s)/f,y=Math.max(Math.min(v,b)/2,0),_=d(this.options.radius,y),w=(_-Math.max(_*r,0))/this._getVisibleDatasetWeightTotal();this.offsetX=m*_,this.offsetY=g*_,n.total=this.calculateTotal(),this.outerRadius=_-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*l,0),this.updateElements(o,0,o.length,t)}_circumference(t,e){const i=this.options,n=this._cachedMeta,o=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||null===n._parsed[t]||n.data[t].hidden?0:this.calculateCircumference(n._parsed[t]*o/O)}updateElements(t,e,i,n){const o="reset"===n,s=this.chart,a=s.chartArea,r=s.options.animation,l=(a.left+a.right)/2,c=(a.top+a.bottom)/2,d=o&&r.animateScale,u=d?0:this.innerRadius,h=d?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(e,n);let m,g=this._getRotation();for(m=0;m<e;++m)g+=this._circumference(m,o);for(m=e;m<e+i;++m){const e=this._circumference(m,o),i=t[m],s={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+e,circumference:e,outerRadius:h,innerRadius:u};f&&(s.options=p||this.resolveDataElementOptions(m,i.active?"active":n)),g+=e,this.updateElement(i,m,s,n)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let i,n=0;for(i=0;i<e.length;i++){const o=t._parsed[i];null===o||isNaN(o)||!this.chart.getDataVisibility(i)||e[i].hidden||(n+=Math.abs(o))}return n}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?O*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,n=i.data.labels||[],o=te(e._parsed[t],i.options.locale);return{label:n[t]||"",value:o}}getMaxBorderWidth(t){let e=0;const i=this.chart;let n,o,s,a,r;if(!t)for(n=0,o=i.data.datasets.length;n<o;++n)if(i.isDatasetVisible(n)){s=i.getDatasetMeta(n),t=s.data,a=s.controller;break}if(!t)return 0;for(n=0,o=t.length;n<o;++n)r=a.resolveDataElementOptions(n),"inner"!==r.borderAlign&&(e=Math.max(e,r.borderWidth||0,r.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let i=0,n=t.length;i<n;++i){const t=this.resolveDataElementOptions(i);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max(l(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Po extends An{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:n}}=t.legend.options;return e.labels.map(((e,o)=>{const s=t.getDatasetMeta(0).controller.getStyle(o);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,fontColor:n,lineWidth:s.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(o),index:o}}))}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,n=i.data.labels||[],o=te(e._parsed[t].r,i.options.locale);return{label:n[t]||"",value:o}}parseObjectData(t,e,i,n){return Xe.bind(this)(t,e,i,n)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,i)=>{const n=this.getParsed(i).r;!isNaN(n)&&this.chart.getDataVisibility(i)&&(n<e.min&&(e.min=n),n>e.max&&(e.max=n))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,i=t.options,n=Math.min(e.right-e.left,e.bottom-e.top),o=Math.max(n/2,0),s=(o-Math.max(i.cutoutPercentage?o/100*i.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=o-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(t,e,i,n){const o="reset"===n,s=this.chart,a=s.options.animation,r=this._cachedMeta.rScale,l=r.xCenter,c=r.yCenter,d=r.getIndexAngle(0)-.5*M;let u,h=d;const p=360/this.countVisibleElements();for(u=0;u<e;++u)h+=this._computeAngle(u,n,p);for(u=e;u<e+i;u++){const e=t[u];let i=h,f=h+this._computeAngle(u,n,p),m=s.getDataVisibility(u)?r.getDistanceFromCenterForValue(this.getParsed(u).r):0;h=f,o&&(a.animateScale&&(m=0),a.animateRotate&&(i=f=d));const g={x:l,y:c,innerRadius:0,outerRadius:m,startAngle:i,endAngle:f,options:this.resolveDataElementOptions(u,e.active?"active":n)};this.updateElement(e,u,g,n)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++})),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?q(this.resolveDataElementOptions(t,e).angle||i):0}}var Eo=Object.freeze({__proto__:null,BarController:class extends An{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,i,n){return ko(t,e,i,n)}parseArrayData(t,e,i,n){return ko(t,e,i,n)}parseObjectData(t,e,i,n){const{iScale:o,vScale:s}=t,{xAxisKey:a="x",yAxisKey:r="y"}=this._parsing,l="x"===o.axis?a:r,c="x"===s.axis?a:r,d=[];let u,h,p,f;for(u=i,h=i+n;u<h;++u)f=e[u],p={},p[o.axis]=o.parse(x(f,l),u),d.push(xo(x(f,c),p,s,u));return d}updateRangeFromParsed(t,e,i,n){super.updateRangeFromParsed(t,e,i,n);const o=i._custom;o&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:n}=e,o=this.getParsed(t),s=o._custom,a=So(s)?"["+s.start+", "+s.end+"]":""+n.getLabelForValue(o[n.axis]);return{label:""+i.getLabelForValue(o[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,o){const s="reset"===o,{index:a,_cachedMeta:{vScale:r}}=this,l=r.getBasePixel(),c=r.isHorizontal(),d=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(e,o);for(let p=e;p<e+i;p++){const e=this.getParsed(p),i=s||n(e[r.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),f=this._calculateBarIndexPixels(p,d),m=(e._stacks||{})[r.axis],g={horizontal:c,base:i.base,enableBorderRadius:!m||So(e._custom)||a===m._top||a===m._bottom,x:c?i.head:f.center,y:c?f.center:i.head,height:c?f.size:Math.abs(i.size),width:c?Math.abs(i.size):f.size};h&&(g.options=u||this.resolveDataElementOptions(p,t[p].active?"active":o));const v=g.options||t[p].options;To(g,v,m,a),Mo(g,v,d.ratio),this.updateElement(t[p],p,g,o)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,o=i.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),s=i.options.stacked,a=[],r=t=>{const i=t.controller.getParsed(e),o=i&&i[t.vScale.axis];if(n(o)||isNaN(o))return!0};for(const i of o)if((void 0===e||!r(i))&&((!1===s||-1===a.indexOf(i.stack)||void 0===s&&void 0===i.stack)&&a.push(i.stack),i.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,i){const n=this._getStacks(t,i),o=void 0!==e?n.indexOf(e):-1;return-1===o?n.length-1:o}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,n=[];let o,s;for(o=0,s=e.data.length;o<s;++o)n.push(i.getPixelForValue(this.getParsed(o)[i.axis],o));const a=t.barThickness;return{min:a||wo(e),pixels:n,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:o},options:{base:s,minBarLength:a}}=this,r=s||0,l=this.getParsed(t),c=l._custom,d=So(c);let u,h,p=l[e.axis],f=0,m=i?this.applyStack(e,l,i):p;m!==p&&(f=m-p,m=p),d&&(p=c.barStart,m=c.barEnd-c.barStart,0!==p&&R(p)!==R(c.barEnd)&&(f=0),f+=p);const g=n(s)||d?f:s;let v=e.getPixelForValue(g);if(u=this.chart.getDataVisibility(t)?e.getPixelForValue(f+m):v,h=u-v,Math.abs(h)<a){h=function(t,e,i){return 0!==t?R(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}(h,e,r)*a,p===r&&(v-=h/2);const t=e.getPixelForDecimal(0),n=e.getPixelForDecimal(1),s=Math.min(t,n),c=Math.max(t,n);v=Math.max(Math.min(v,c),s),u=v+h,i&&!d&&(l._stacks[e.axis]._visualValues[o]=e.getValueForPixel(u)-e.getValueForPixel(v))}if(v===e.getPixelForValue(r)){const t=R(h)*e.getLineWidthForValue(r)/2;v+=t,h-=t}return{size:h,base:v,head:u,center:u+h/2}}_calculateBarIndexPixels(t,e){const i=e.scale,o=this.options,s=o.skipNull,a=l(o.maxBarThickness,1/0);let r,c;if(e.grouped){const i=s?this._getStackCount(t):e.stackCount,l="flex"===o.barThickness?function(t,e,i,n){const o=e.pixels,s=o[t];let a=t>0?o[t-1]:null,r=t<o.length-1?o[t+1]:null;const l=i.categoryPercentage;null===a&&(a=s-(null===r?e.end-e.start:r-s)),null===r&&(r=s+s-a);const c=s-(s-Math.min(a,r))/2*l;return{chunk:Math.abs(r-a)/2*l/n,ratio:i.barPercentage,start:c}}(t,e,o,i):function(t,e,i,o){const s=i.barThickness;let a,r;return n(s)?(a=e.min*i.categoryPercentage,r=i.barPercentage):(a=s*o,r=1),{chunk:a/o,ratio:r,start:e.pixels[t]-a/2}}(t,e,o,i),d=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0);r=l.start+l.chunk*d+l.chunk/2,c=Math.min(a,l.chunk*l.ratio)}else r=i.getPixelForValue(this.getParsed(t)[i.axis],t),c=Math.min(a,e.min*e.ratio);return{base:r-c/2,head:r+c/2,center:r,size:c}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,n=i.length;let o=0;for(;o<n;++o)null!==this.getParsed(o)[e.axis]&&i[o].draw(this._ctx)}},BubbleController:class extends An{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,n){const o=super.parsePrimitiveData(t,e,i,n);for(let t=0;t<o.length;t++)o[t]._custom=this.resolveDataElementOptions(t+i).radius;return o}parseArrayData(t,e,i,n){const o=super.parseArrayData(t,e,i,n);for(let t=0;t<o.length;t++){const n=e[i+t];o[t]._custom=l(n[2],this.resolveDataElementOptions(t+i).radius)}return o}parseObjectData(t,e,i,n){const o=super.parseObjectData(t,e,i,n);for(let t=0;t<o.length;t++){const n=e[i+t];o[t]._custom=l(n&&n.r&&+n.r,this.resolveDataElementOptions(t+i).radius)}return o}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:o}=e,s=this.getParsed(t),a=n.getLabelForValue(s.x),r=o.getLabelForValue(s.y),l=s._custom;return{label:i[t]||"",value:"("+a+", "+r+(l?", "+l:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,n){const o="reset"===n,{iScale:s,vScale:a}=this._cachedMeta,{sharedOptions:r,includeOptions:l}=this._getSharedOptions(e,n),c=s.axis,d=a.axis;for(let u=e;u<e+i;u++){const e=t[u],i=!o&&this.getParsed(u),h={},p=h[c]=o?s.getPixelForDecimal(.5):s.getPixelForValue(i[c]),f=h[d]=o?a.getBasePixel():a.getPixelForValue(i[d]);h.skip=isNaN(p)||isNaN(f),l&&(h.options=r||this.resolveDataElementOptions(u,e.active?"active":n),o&&(h.options.radius=0)),this.updateElement(e,u,h,n)}}resolveDataElementOptions(t,e){const i=this.getParsed(t);let n=super.resolveDataElementOptions(t,e);n.$shared&&(n=Object.assign({},n,{$shared:!1}));const o=n.radius;return"active"!==e&&(n.radius=0),n.radius+=l(i&&i._custom,o),n}},DoughnutController:Oo,LineController:class extends An{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:i,data:n=[],_dataset:o}=e,s=this.chart._animationsDisabled;let{start:a,count:r}=mt(e,n,s);this._drawStart=a,this._drawCount=r,gt(e)&&(a=0,r=n.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=n;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(i,void 0,{animated:!s,options:l},t),this.updateElements(n,a,r,t)}updateElements(t,e,i,o){const s="reset"===o,{iScale:a,vScale:r,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:d,includeOptions:u}=this._getSharedOptions(e,o),h=a.axis,p=r.axis,{spanGaps:f,segment:m}=this.options,g=H(f)?f:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||s||"none"===o,b=e+i,y=t.length;let _=e>0&&this.getParsed(e-1);for(let i=0;i<y;++i){const f=t[i],y=v?f:{};if(i<e||i>=b){y.skip=!0;continue}const w=this.getParsed(i),x=n(w[p]),k=y[h]=a.getPixelForValue(w[h],i),S=y[p]=s||x?r.getBasePixel():r.getPixelForValue(l?this.applyStack(r,w,l):w[p],i);y.skip=isNaN(k)||isNaN(S)||x,y.stop=i>0&&Math.abs(w[h]-_[h])>g,m&&(y.parsed=w,y.raw=c.data[i]),u&&(y.options=d||this.resolveDataElementOptions(i,f.active?"active":o)),v||this.updateElement(f,i,y,o),_=w}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,n=t.data||[];if(!n.length)return i;const o=n[0].size(this.resolveDataElementOptions(0)),s=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(i,o,s)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}},PolarAreaController:Po,PieController:class extends Oo{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}},RadarController:class extends An{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,n){return Xe.bind(this)(t,e,i,n)}update(t){const e=this._cachedMeta,i=e.dataset,n=e.data||[],o=e.iScale.getLabels();if(i.points=n,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const s={_loop:!0,_fullLoop:o.length===n.length,options:e};this.updateElement(i,void 0,s,t)}this.updateElements(n,0,n.length,t)}updateElements(t,e,i,n){const o=this._cachedMeta.rScale,s="reset"===n;for(let a=e;a<e+i;a++){const e=t[a],i=this.resolveDataElementOptions(a,e.active?"active":n),r=o.getPointPositionForValue(a,this.getParsed(a).r),l=s?o.xCenter:r.x,c=s?o.yCenter:r.y,d={x:l,y:c,angle:r.angle,skip:isNaN(l)||isNaN(c),options:i};this.updateElement(e,a,d,n)}}},ScatterController:class extends An{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:n,yScale:o}=e,s=this.getParsed(t),a=n.getLabelForValue(s.x),r=o.getLabelForValue(s.y);return{label:i[t]||"",value:"("+a+", "+r+")"}}update(t){const e=this._cachedMeta,{data:i=[]}=e,n=this.chart._animationsDisabled;let{start:o,count:s}=mt(e,i,n);if(this._drawStart=o,this._drawCount=s,gt(e)&&(o=0,s=i.length),this.options.showLine){const{dataset:o,_dataset:s}=e;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!s._decimated,o.points=i;const a=this.resolveDatasetElementOptions(t);a.segment=this.options.segment,this.updateElement(o,void 0,{animated:!n,options:a},t)}this.updateElements(i,o,s,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,i,o){const s="reset"===o,{iScale:a,vScale:r,_stacked:l,_dataset:c}=this._cachedMeta,d=this.resolveDataElementOptions(e,o),u=this.getSharedOptions(d),h=this.includeOptions(o,u),p=a.axis,f=r.axis,{spanGaps:m,segment:g}=this.options,v=H(m)?m:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||s||"none"===o;let y=e>0&&this.getParsed(e-1);for(let d=e;d<e+i;++d){const e=t[d],i=this.getParsed(d),m=b?e:{},_=n(i[f]),w=m[p]=a.getPixelForValue(i[p],d),x=m[f]=s||_?r.getBasePixel():r.getPixelForValue(l?this.applyStack(r,i,l):i[f],d);m.skip=isNaN(w)||isNaN(x)||_,m.stop=d>0&&Math.abs(i[p]-y[p])>v,g&&(m.parsed=i,m.raw=c.data[d]),h&&(m.options=u||this.resolveDataElementOptions(d,e.active?"active":o)),b||this.updateElement(e,d,m,o),y=i}this.updateSharedOptions(u,o,d)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}const i=t.dataset,n=i.options&&i.options.borderWidth||0;if(!e.length)return n;const o=e[0].size(this.resolveDataElementOptions(0)),s=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(n,o,s)/2}}});function Ao(t,e,i,n){return{x:i+t*Math.cos(e),y:n+t*Math.sin(e)}}function Io(t,e,i,n,o,s){const{x:a,y:r,startAngle:l,pixelMargin:c,innerRadius:d}=e,u=Math.max(e.outerRadius+n+i-c,0),h=d>0?d+n+i+c:0;let p=0;const f=o-l;if(n){const t=((d>0?d-n:0)+(u>0?u-n:0))/2;p=(f-(0!==t?f*t/(t+n):f))/2}const m=(f-Math.max(.001,f*u-i/M)/u)/2,g=l+m+p,v=o-m-p,{outerStart:b,outerEnd:y,innerStart:_,innerEnd:w}=function(t,e,i,n){const o=fi(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),s=(i-e)/2,a=Math.min(s,n*e/2),r=t=>{const e=(i-Math.min(s,t))*n/2;return Q(t,0,Math.min(s,e))};return{outerStart:r(o.outerStart),outerEnd:r(o.outerEnd),innerStart:Q(o.innerStart,0,a),innerEnd:Q(o.innerEnd,0,a)}}(e,h,u,v-g),x=u-b,k=u-y,S=g+b/x,T=v-y/k,C=h+_,D=h+w,O=g+_/C,P=v-w/D;if(t.beginPath(),s){const e=(S+T)/2;if(t.arc(a,r,u,S,e),t.arc(a,r,u,e,T),y>0){const e=Ao(k,T,a,r);t.arc(e.x,e.y,y,T,v+I)}const i=Ao(D,v,a,r);if(t.lineTo(i.x,i.y),w>0){const e=Ao(D,P,a,r);t.arc(e.x,e.y,w,v+I,P+Math.PI)}const n=(v-w/h+(g+_/h))/2;if(t.arc(a,r,h,v-w/h,n,!0),t.arc(a,r,h,n,g+_/h,!0),_>0){const e=Ao(C,O,a,r);t.arc(e.x,e.y,_,O+Math.PI,g-I)}const o=Ao(x,g,a,r);if(t.lineTo(o.x,o.y),b>0){const e=Ao(x,S,a,r);t.arc(e.x,e.y,b,g-I,S)}}else{t.moveTo(a,r);const e=Math.cos(S)*u+a,i=Math.sin(S)*u+r;t.lineTo(e,i);const n=Math.cos(T)*u+a,o=Math.sin(T)*u+r;t.lineTo(n,o)}t.closePath()}function Lo(t,e,i=e){t.lineCap=l(i.borderCapStyle,e.borderCapStyle),t.setLineDash(l(i.borderDash,e.borderDash)),t.lineDashOffset=l(i.borderDashOffset,e.borderDashOffset),t.lineJoin=l(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=l(i.borderWidth,e.borderWidth),t.strokeStyle=l(i.borderColor,e.borderColor)}function No(t,e,i){t.lineTo(i.x,i.y)}function jo(t,e,i={}){const n=t.length,{start:o=0,end:s=n-1}=i,{start:a,end:r}=e,l=Math.max(o,a),c=Math.min(s,r),d=o<a&&s<a||o>r&&s>r;return{count:n,start:l,loop:e.loop,ilen:c<l&&!d?n+c-l:c-l}}function Ro(t,e,i,n){const{points:o,options:s}=e,{count:a,start:r,loop:l,ilen:c}=jo(o,i,n),d=function(t){return t.stepped?Ee:t.tension||"monotone"===t.cubicInterpolationMode?Ae:No}(s);let u,h,p,{move:f=!0,reverse:m}=n||{};for(u=0;u<=c;++u)h=o[(r+(m?c-u:u))%a],h.skip||(f?(t.moveTo(h.x,h.y),f=!1):d(t,p,h,m,s.stepped),p=h);return l&&(h=o[(r+(m?c:0))%a],d(t,p,h,m,s.stepped)),!!l}function $o(t,e,i,n){const o=e.points,{count:s,start:a,ilen:r}=jo(o,i,n),{move:l=!0,reverse:c}=n||{};let d,u,h,p,f,m,g=0,v=0;const b=t=>(a+(c?r-t:t))%s,y=()=>{p!==f&&(t.lineTo(g,f),t.lineTo(g,p),t.lineTo(g,m))};for(l&&(u=o[b(0)],t.moveTo(u.x,u.y)),d=0;d<=r;++d){if(u=o[b(d)],u.skip)continue;const e=u.x,i=u.y,n=0|e;n===h?(i<p?p=i:i>f&&(f=i),g=(v*g+e)/++v):(y(),t.lineTo(e,i),h=n,v=0,p=f=i),m=i}y()}function Bo(t){const e=t.options,i=e.borderDash&&e.borderDash.length;return t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||i?Ro:$o}const Fo="function"==typeof Path2D;class Ho extends In{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const i=this.options;if((i.tension||"monotone"===i.cubicInterpolationMode)&&!i.stepped&&!this._pointsUpdated){const n=i.spanGaps?this._loop:this._fullLoop;ni(this._points,i,t,n,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Oi(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){const i=this.options,n=t[e],o=this.points,s=Mi(this,{property:e,start:n,end:n});if(!s.length)return;const a=[],r=function(t){return t.stepped?ci:t.tension||"monotone"===t.cubicInterpolationMode?di:li}(i);let l,c;for(l=0,c=s.length;l<c;++l){const{start:c,end:d}=s[l],u=o[c],h=o[d];if(u===h){a.push(u);continue}const p=r(u,h,Math.abs((n-u[e])/(h[e]-u[e])),i.stepped);p[e]=t[e],a.push(p)}return 1===a.length?a[0]:a}pathSegment(t,e,i){return Bo(this)(t,this,e,i)}path(t,e,i){const n=this.segments,o=Bo(this);let s=this._loop;e=e||0,i=i||this.points.length-e;for(const a of n)s&=o(t,this,a,{start:e,end:e+i-1});return!!s}draw(t,e,i,n){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),function(t,e,i,n){Fo&&!e.options.segment?function(t,e,i,n){let o=e._path;o||(o=e._path=new Path2D,e.path(o,i,n)&&o.closePath()),Lo(t,e.options),t.stroke(o)}(t,e,i,n):function(t,e,i,n){const{segments:o,options:s}=e,a=Bo(e);for(const r of o)Lo(t,s,r.style),t.beginPath(),a(t,e,r,{start:i,end:i+n-1})&&t.closePath(),t.stroke()}(t,e,i,n)}(t,this,i,n),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Wo(t,e,i,n){const o=t.options,{[i]:s}=t.getProps([i],n);return Math.abs(e-s)<o.radius+o.hitRadius}function Uo(t,e){const{x:i,y:n,base:o,width:s,height:a}=t.getProps(["x","y","base","width","height"],e);let r,l,c,d,u;return t.horizontal?(u=a/2,r=Math.min(i,o),l=Math.max(i,o),c=n-u,d=n+u):(u=s/2,r=i-u,l=i+u,c=Math.min(n,o),d=Math.max(n,o)),{left:r,top:c,right:l,bottom:d}}function qo(t,e,i,n){return t?0:Q(e,i,n)}function zo(t){const e=Uo(t),i=e.right-e.left,n=e.bottom-e.top,o=function(t,e,i){const n=t.options.borderWidth,o=t.borderSkipped,s=mi(n);return{t:qo(o.top,s.top,0,i),r:qo(o.right,s.right,0,e),b:qo(o.bottom,s.bottom,0,i),l:qo(o.left,s.left,0,e)}}(t,i/2,n/2),a=function(t,e,i){const{enableBorderRadius:n}=t.getProps(["enableBorderRadius"]),o=t.options.borderRadius,a=gi(o),r=Math.min(e,i),l=t.borderSkipped,c=n||s(o);return{topLeft:qo(!c||l.top||l.left,a.topLeft,0,r),topRight:qo(!c||l.top||l.right,a.topRight,0,r),bottomLeft:qo(!c||l.bottom||l.left,a.bottomLeft,0,r),bottomRight:qo(!c||l.bottom||l.right,a.bottomRight,0,r)}}(t,i/2,n/2);return{outer:{x:e.left,y:e.top,w:i,h:n,radius:a},inner:{x:e.left+o.l,y:e.top+o.t,w:i-o.l-o.r,h:n-o.t-o.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(o.t,o.l)),topRight:Math.max(0,a.topRight-Math.max(o.t,o.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(o.b,o.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(o.b,o.r))}}}}function Vo(t,e,i,n){const o=null===e,s=null===i,a=t&&!(o&&s)&&Uo(t,n);return a&&(o||tt(e,a.left,a.right))&&(s||tt(i,a.top,a.bottom))}function Yo(t,e){t.rect(e.x,e.y,e.w,e.h)}function Go(t,e,i={}){const n=t.x!==i.x?-e:0,o=t.y!==i.y?-e:0,s=(t.x+t.w!==i.x+i.w?e:0)-n,a=(t.y+t.h!==i.y+i.h?e:0)-o;return{x:t.x+n,y:t.y+o,w:t.w+s,h:t.h+a,radius:t.radius}}var Ko=Object.freeze({__proto__:null,ArcElement:class extends In{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){const n=this.getProps(["x","y"],i),{angle:o,distance:s}=Y(n,{x:t,y:e}),{startAngle:a,endAngle:r,innerRadius:c,outerRadius:d,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),h=this.options.spacing/2,p=l(u,r-a)>=O||J(o,a,r),f=tt(s,c+h,d+h);return p&&f}getCenterPoint(t){const{x:e,y:i,startAngle:n,endAngle:o,innerRadius:s,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:r,spacing:l}=this.options,c=(n+o)/2,d=(s+a+l+r)/2;return{x:e+Math.cos(c)*d,y:i+Math.sin(c)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:i}=this,n=(e.offset||0)/4,o=(e.spacing||0)/2,s=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=i>O?Math.floor(i/O):0,0===i||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*n,Math.sin(a)*n);const r=n*(1-Math.sin(Math.min(M,i||0)));t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,function(t,e,i,n,o){const{fullCircles:s,startAngle:a,circumference:r}=e;let l=e.endAngle;if(s){Io(t,e,i,n,l,o);for(let e=0;e<s;++e)t.fill();isNaN(r)||(l=a+(r%O||O))}Io(t,e,i,n,l,o),t.fill()}(t,this,r,o,s),function(t,e,i,n,o){const{fullCircles:s,startAngle:a,circumference:r,options:l}=e,{borderWidth:c,borderJoinStyle:d}=l,u="inner"===l.borderAlign;if(!c)return;u?(t.lineWidth=2*c,t.lineJoin=d||"round"):(t.lineWidth=c,t.lineJoin=d||"bevel");let h=e.endAngle;if(s){Io(t,e,i,n,h,o);for(let e=0;e<s;++e)t.stroke();isNaN(r)||(h=a+(r%O||O))}u&&function(t,e,i){const{startAngle:n,pixelMargin:o,x:s,y:a,outerRadius:r,innerRadius:l}=e;let c=o/r;t.beginPath(),t.arc(s,a,r,n-c,i+c),l>o?(c=o/l,t.arc(s,a,l,i+c,n-c,!0)):t.arc(s,a,o,i+I,n-I),t.closePath(),t.clip()}(t,e,h),s||(Io(t,e,i,n,h,o),t.stroke())}(t,this,r,o,s),t.restore()}},LineElement:Ho,PointElement:class extends In{static id="point";static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,i){const n=this.options,{x:o,y:s}=this.getProps(["x","y"],i);return Math.pow(t-o,2)+Math.pow(e-s,2)<Math.pow(n.hitRadius+n.radius,2)}inXRange(t,e){return Wo(this,t,"x",e)}inYRange(t,e){return Wo(this,t,"y",e)}getCenterPoint(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}size(t){let e=(t=t||this.options||{}).radius||0;return e=Math.max(e,e&&t.hoverRadius||0),2*(e+(e&&t.borderWidth||0))}draw(t,e){const i=this.options;this.skip||i.radius<.1||!Me(this,e,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Ce(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}},BarElement:class extends In{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:n}}=this,{inner:o,outer:s}=zo(this),a=(r=s.radius).topLeft||r.topRight||r.bottomLeft||r.bottomRight?je:Yo;var r;t.save(),s.w===o.w&&s.h===o.h||(t.beginPath(),a(t,Go(s,e,o)),t.clip(),a(t,Go(o,-e,s)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,Go(o,e)),t.fillStyle=n,t.fill(),t.restore()}inRange(t,e,i){return Vo(this,t,e,i)}inXRange(t,e){return Vo(this,t,null,e)}inYRange(t,e){return Vo(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:n,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(e+n)/2:e,y:o?i:(i+n)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}});function Xo(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}function Jo(t,e,{horizontal:i,minRotation:n}){const o=q(n),s=(i?Math.sin(o):Math.cos(o))||.001,a=.75*e*(""+t).length;return Math.min(e/s,a)}class Qo extends Un{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return n(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:n,max:o}=this;const s=t=>n=e?n:t,a=t=>o=i?o:t;if(t){const t=R(n),e=R(o);t<0&&e<0?a(0):t>0&&e>0&&s(0)}if(n===o){let e=0===o?1:Math.abs(.05*o);a(o+e),t||s(n-e)}this.min=n,this.max=o}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:i,stepSize:n}=t;return n?(e=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),i=i||11),i&&(e=Math.min(i,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const o=function(t,e){const i=[],{bounds:o,step:s,min:a,max:r,precision:l,count:c,maxTicks:d,maxDigits:u,includeBounds:h}=t,p=s||1,f=d-1,{min:m,max:g}=e,v=!n(a),b=!n(r),y=!n(c),_=(g-m)/(u+1);let w,x,k,S,T=B((g-m)/f/p)*p;if(T<1e-14&&!v&&!b)return[{value:m},{value:g}];S=Math.ceil(g/T)-Math.floor(m/T),S>f&&(T=B(S*T/f/p)*p),n(l)||(w=Math.pow(10,l),T=Math.ceil(T*w)/w),"ticks"===o?(x=Math.floor(m/T)*T,k=Math.ceil(g/T)*T):(x=m,k=g),v&&b&&s&&W((r-a)/s,T/1e3)?(S=Math.round(Math.min((r-a)/T,d)),T=(r-a)/S,x=a,k=r):y?(x=v?a:x,k=b?r:k,S=c-1,T=(k-x)/S):(S=(k-x)/T,S=$(S,Math.round(S),T/1e3)?Math.round(S):Math.ceil(S));const C=Math.max(V(T),V(x));w=Math.pow(10,n(l)?C:l),x=Math.round(x*w)/w,k=Math.round(k*w)/w;let D=0;for(v&&(h&&x!==a?(i.push({value:a}),x<a&&D++,$(Math.round((x+D*T)*w)/w,a,Jo(a,_,t))&&D++):x<a&&D++);D<S;++D)i.push({value:Math.round((x+D*T)*w)/w});return b&&h&&k!==r?i.length&&$(i[i.length-1].value,r,Jo(r,_,t))?i[i.length-1].value=r:i.push({value:r}):b&&k!==r||i.push({value:k}),i}({maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&U(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const n=(i-e)/Math.max(t.length-1,1)/2;e-=n,i+=n}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return te(t,this.chart.options.locale,this.options.ticks.format)}}class Zo extends Qo{static id="linear";static defaults={ticks:{callback:ie.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=a(t)?t:0,this.max=a(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=q(this.options.ticks.minRotation),n=(t?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,o.lineHeight/n))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const ts=t=>Math.floor(j(t)),es=(t,e)=>Math.pow(10,ts(t)+e);function is(t){return 1==t/Math.pow(10,ts(t))}function ns(t,e,i){const n=Math.pow(10,i),o=Math.floor(t/n);return Math.ceil(e/n)-o}class os extends Un{static id="logarithmic";static defaults={ticks:{callback:ie.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=Qo.prototype.parse.apply(this,[t,e]);if(0!==i)return a(i)&&i>0?i:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=a(t)?Math.max(0,t):null,this.max=a(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!a(this._userMin)&&(this.min=t===es(this.min,0)?es(this.min,-1):es(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,n=this.max;const o=e=>i=t?i:e,s=t=>n=e?n:t;i===n&&(i<=0?(o(1),s(10)):(o(es(i,-1)),s(es(n,1)))),i<=0&&o(es(n,-1)),n<=0&&s(es(i,1)),this.min=i,this.max=n}buildTicks(){const t=this.options,e=function(t,{min:e,max:i}){e=r(t.min,e);const n=[],o=ts(e);let s=function(t,e){let i=ts(e-t);for(;ns(t,e,i)>10;)i++;for(;ns(t,e,i)<10;)i--;return Math.min(i,ts(t))}(e,i),a=s<0?Math.pow(10,Math.abs(s)):1;const l=Math.pow(10,s),c=o>s?Math.pow(10,o):0,d=Math.round((e-c)*a)/a,u=Math.floor((e-c)/l/10)*l*10;let h=Math.floor((d-u)/Math.pow(10,s)),p=r(t.min,Math.round((c+u+h*Math.pow(10,s))*a)/a);for(;p<i;)n.push({value:p,major:is(p),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(s++,h=2,a=s>=0?1:a),p=Math.round((c+u+h*Math.pow(10,s))*a)/a;const f=r(t.max,p);return n.push({value:f,major:is(f),significand:h}),n}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&U(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":te(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=j(t),this._valueRange=j(this.max)-j(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(j(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function ss(t){const e=t.ticks;if(e.display&&t.display){const t=vi(e.backdropPadding);return l(e.font&&e.font.size,re.font.size)+t.height}return 0}function as(t,e,i,n,o){return t===n||t===o?{start:e-i/2,end:e+i/2}:t<n||t>o?{start:e-i,end:e}:{start:e,end:e+i}}function rs(t,e,i,n,o){const s=Math.abs(Math.sin(i)),a=Math.abs(Math.cos(i));let r=0,l=0;n.start<e.l?(r=(e.l-n.start)/s,t.l=Math.min(t.l,e.l-r)):n.end>e.r&&(r=(n.end-e.r)/s,t.r=Math.max(t.r,e.r+r)),o.start<e.t?(l=(e.t-o.start)/a,t.t=Math.min(t.t,e.t-l)):o.end>e.b&&(l=(o.end-e.b)/a,t.b=Math.max(t.b,e.b+l))}function ls(t){return 0===t||180===t?"center":t<180?"left":"right"}function cs(t,e,i){return"right"===i?t-=e:"center"===i&&(t-=e/2),t}function ds(t,e,i){return 90===i||270===i?t-=e/2:(i>270||i<90)&&(t-=e),t}function us(t,e,i,n){const{ctx:o}=t;if(i)o.arc(t.xCenter,t.yCenter,e,0,O);else{let i=t.getPointPosition(0,e);o.moveTo(i.x,i.y);for(let s=1;s<n;s++)i=t.getPointPosition(s,e),o.lineTo(i.x,i.y)}}class hs extends Qo{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ie.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=vi(ss(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=a(t)&&!isNaN(t)?t:0,this.max=a(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/ss(this.options))}generateTickLabels(t){Qo.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const i=u(this.options.pointLabels.callback,[t,e],this);return i||0===i?i:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?function(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),n=[],s=[],a=t._pointLabels.length,r=t.options.pointLabels,l=r.centerPointLabels?M/a:0;for(let h=0;h<a;h++){const a=r.setContext(t.getPointLabelContext(h));s[h]=a.padding;const p=t.getPointPosition(h,t.drawingArea+s[h],l),f=bi(a.font),m=(c=t.ctx,d=f,u=o(u=t._pointLabels[h])?u:[u],{w:ke(c,d.string,u),h:u.length*d.lineHeight});n[h]=m;const g=X(t.getIndexAngle(h)+l),v=Math.round(z(g));rs(i,e,g,as(v,p.x,m.w,0,180),as(v,p.y,m.h,90,270))}var c,d,u;t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=function(t,e,i){const n=[],o=t._pointLabels.length,s=t.options,a=ss(s)/2,r=t.drawingArea,l=s.pointLabels.centerPointLabels?M/o:0;for(let s=0;s<o;s++){const o=t.getPointPosition(s,r+a+i[s],l),c=Math.round(z(X(o.angle+I))),d=e[s],u=ds(o.y,d.h,c),h=ls(c),p=cs(o.x,d.w,h);n.push({x:o.x,y:u,textAlign:h,left:p,top:u,right:p+d.w,bottom:u+d.h})}return n}(t,n,s)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,n){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-n)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,n))}getIndexAngle(t){return X(t*(O/(this._pointLabels.length||1))+q(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(n(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(n(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return function(t,e,i){return wi(t,{label:i,index:e,type:"pointLabel"})}(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const n=this.getIndexAngle(t)-I+i;return{x:Math.cos(n)*e+this.xCenter,y:Math.sin(n)*e+this.yCenter,angle:n}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:n,bottom:o}=this._pointLabelItems[t];return{left:e,top:i,right:n,bottom:o}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),us(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:i,grid:o,border:s}=e,a=this._pointLabels.length;let r,l,c;if(e.pointLabels.display&&function(t,e){const{ctx:i,options:{pointLabels:o}}=t;for(let s=e-1;s>=0;s--){const e=o.setContext(t.getPointLabelContext(s)),a=bi(e.font),{x:r,y:l,textAlign:c,left:d,top:u,right:h,bottom:p}=t._pointLabelItems[s],{backdropColor:f}=e;if(!n(f)){const t=gi(e.borderRadius),n=vi(e.backdropPadding);i.fillStyle=f;const o=d-n.left,s=u-n.top,a=h-d+n.width,r=p-u+n.height;Object.values(t).some((t=>0!==t))?(i.beginPath(),je(i,{x:o,y:s,w:a,h:r,radius:t}),i.fill()):i.fillRect(o,s,a,r)}Ie(i,t._pointLabels[s],r,l+a.lineHeight/2,a,{color:e.color,textAlign:c,textBaseline:"middle"})}}(this,a),o.display&&this.ticks.forEach(((t,e)=>{if(0!==e){l=this.getDistanceFromCenterForValue(t.value);const i=this.getContext(e),n=o.setContext(i),r=s.setContext(i);!function(t,e,i,n,o){const s=t.ctx,a=e.circular,{color:r,lineWidth:l}=e;!a&&!n||!r||!l||i<0||(s.save(),s.strokeStyle=r,s.lineWidth=l,s.setLineDash(o.dash),s.lineDashOffset=o.dashOffset,s.beginPath(),us(t,i,a,n),s.closePath(),s.stroke(),s.restore())}(this,n,l,a,r)}})),i.display){for(t.save(),r=a-1;r>=0;r--){const n=i.setContext(this.getPointLabelContext(r)),{color:o,lineWidth:s}=n;s&&o&&(t.lineWidth=s,t.strokeStyle=o,t.setLineDash(n.borderDash),t.lineDashOffset=n.borderDashOffset,l=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),c=this.getPointPosition(r,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const n=this.getIndexAngle(0);let o,s;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(n),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((n,a)=>{if(0===a&&!e.reverse)return;const r=i.setContext(this.getContext(a)),l=bi(r.font);if(o=this.getDistanceFromCenterForValue(this.ticks[a].value),r.showLabelBackdrop){t.font=l.string,s=t.measureText(n.label).width,t.fillStyle=r.backdropColor;const e=vi(r.backdropPadding);t.fillRect(-s/2-e.left,-o-l.size/2-e.top,s+e.width,l.size+e.height)}Ie(t,n.label,0,-o,l,{color:r.color})})),t.restore()}drawTitle(){}}const ps={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},fs=Object.keys(ps);function ms(t,e){return t-e}function gs(t,e){if(n(e))return null;const i=t._adapter,{parser:o,round:s,isoWeekday:r}=t._parseOpts;let l=e;return"function"==typeof o&&(l=o(l)),a(l)||(l="string"==typeof o?i.parse(l,o):i.parse(l)),null===l?null:(s&&(l="week"!==s||!H(r)&&!0!==r?i.startOf(l,s):i.startOf(l,"isoWeek",r)),+l)}function vs(t,e,i,n){const o=fs.length;for(let s=fs.indexOf(t);s<o-1;++s){const t=ps[fs[s]],o=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((i-e)/(o*t.size))<=n)return fs[s]}return fs[o-1]}function bs(t,e,i){if(i){if(i.length){const{lo:n,hi:o}=et(i,e);t[i[n]>=e?i[n]:i[o]]=!0}}else t[e]=!0}function ys(t,e,i){const n=[],o={},s=e.length;let a,r;for(a=0;a<s;++a)r=e[a],o[r]=a,n.push({value:r,major:!1});return 0!==s&&i?function(t,e,i,n){const o=t._adapter,s=+o.startOf(e[0].value,n),a=e[e.length-1].value;let r,l;for(r=s;r<=a;r=+o.add(r,1,n))l=i[r],l>=0&&(e[l].major=!0);return e}(t,n,o,i):n}class _s extends Un{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const i=t.time||(t.time={}),n=this._adapter=new _o._date(t.adapters.date);n.init(e),b(i.displayFormats,n.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:gs(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:n,max:o,minDefined:s,maxDefined:r}=this.getUserBounds();function l(t){s||isNaN(t.min)||(n=Math.min(n,t.min)),r||isNaN(t.max)||(o=Math.max(o,t.max))}s&&r||(l(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||l(this.getMinMax(!1))),n=a(n)&&!isNaN(n)?n:+e.startOf(Date.now(),i),o=a(o)&&!isNaN(o)?o:+e.endOf(Date.now(),i)+1,this.min=Math.min(n,o-1),this.max=Math.max(n+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,n="labels"===i.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const o=this.min,s=ot(n,o,this.max);return this._unit=e.unit||(i.autoSkip?vs(e.minUnit,this.min,this.max,this._getLabelCapacity(o)):function(t,e,i,n,o){for(let s=fs.length-1;s>=fs.indexOf(i);s--){const i=fs[s];if(ps[i].common&&t._adapter.diff(o,n,i)>=e-1)return i}return fs[i?fs.indexOf(i):0]}(this,s.length,e.minUnit,this.min,this.max)),this._majorUnit=i.major.enabled&&"year"!==this._unit?function(t){for(let e=fs.indexOf(t)+1,i=fs.length;e<i;++e)if(ps[fs[e]].common)return fs[e]}(this._unit):void 0,this.initOffsets(n),t.reverse&&s.reverse(),ys(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t=[]){let e,i,n=0,o=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),n=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,i=this.getDecimalForValue(t[t.length-1]),o=1===t.length?i:(i-this.getDecimalForValue(t[t.length-2]))/2);const s=t.length<3?.5:.25;n=Q(n,0,s),o=Q(o,0,s),this._offsets={start:n,end:o,factor:1/(n+1+o)}}_generate(){const t=this._adapter,e=this.min,i=this.max,n=this.options,o=n.time,s=o.unit||vs(o.minUnit,e,i,this._getLabelCapacity(e)),a=l(n.ticks.stepSize,1),r="week"===s&&o.isoWeekday,c=H(r)||!0===r,d={};let u,h,p=e;if(c&&(p=+t.startOf(p,"isoWeek",r)),p=+t.startOf(p,c?"day":s),t.diff(i,e,s)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+s);const f="data"===n.ticks.source&&this.getDataTimestamps();for(u=p,h=0;u<i;u=+t.add(u,a,s),h++)bs(d,u,f);return u!==i&&"ticks"!==n.bounds&&1!==h||bs(d,u,f),Object.keys(d).sort(((t,e)=>t-e)).map((t=>+t))}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const i=this.options.time.displayFormats,n=this._unit,o=e||i[n];return this._adapter.format(t,o)}_tickFormatFunction(t,e,i,n){const o=this.options,s=o.ticks.callback;if(s)return u(s,[t,e,i],this);const a=o.time.displayFormats,r=this._unit,l=this._majorUnit,c=r&&a[r],d=l&&a[l],h=i[e],p=l&&d&&h&&h.major;return this._adapter.format(t,n||(p?d:c))}generateTickLabels(t){let e,i,n;for(e=0,i=t.length;e<i;++e)n=t[e],n.label=this._tickFormatFunction(n.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,n=q(this.isHorizontal()?e.maxRotation:e.minRotation),o=Math.cos(n),s=Math.sin(n),a=this._resolveTickFontOptions(0).size;return{w:i*o+a*s,h:i*s+a*o}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,n=i[e.unit]||i.millisecond,o=this._tickFormatFunction(t,0,ys(this,[t],this._majorUnit),n),s=this._getLabelSize(o),a=Math.floor(this.isHorizontal()?this.width/s.w:this.height/s.h)-1;return a>0?a:1}getDataTimestamps(){let t,e,i=this._cache.data||[];if(i.length)return i;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(t=0,e=n.length;t<e;++t)i=i.concat(n[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const n=this.getLabels();for(e=0,i=n.length;e<i;++e)t.push(gs(this,n[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return lt(t.sort(ms))}}function ws(t,e,i){let n,o,s,a,r=0,l=t.length-1;i?(e>=t[r].pos&&e<=t[l].pos&&({lo:r,hi:l}=it(t,"pos",e)),({pos:n,time:s}=t[r]),({pos:o,time:a}=t[l])):(e>=t[r].time&&e<=t[l].time&&({lo:r,hi:l}=it(t,"time",e)),({time:n,pos:s}=t[r]),({time:o,pos:a}=t[l]));const c=o-n;return c?s+(a-s)*(e-n)/c:s}var xs=Object.freeze({__proto__:null,CategoryScale:class extends Un{static id="category";static defaults={ticks:{callback:Xo}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:i,label:n}of e)t[i]===n&&t.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(n(t))return null;const i=this.getLabels();return((t,e)=>null===t?null:Q(Math.round(t),0,e))(e=isFinite(e)&&i[e]===t?e:function(t,e,i,n){const o=t.indexOf(e);return-1===o?((t,e,i,n)=>("string"==typeof e?(i=t.push(e)-1,n.unshift({index:i,label:e})):isNaN(e)&&(i=null),i))(t,e,i,n):o!==t.lastIndexOf(e)?i:o}(i,t,l(e,t),this._addedLabels),i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:n}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(i=0),e||(n=this.getLabels().length-1)),this.min=i,this.max=n}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,n=[];let o=this.getLabels();o=0===t&&e===o.length-1?o:o.slice(t,e+1),this._valueRange=Math.max(o.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let i=t;i<=e;i++)n.push({value:i});return n}getLabelForValue(t){return Xo.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}},LinearScale:Zo,LogarithmicScale:os,RadialLinearScale:hs,TimeScale:_s,TimeSeriesScale:class extends _s{static id="timeseries";static defaults=_s.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=ws(e,this.min),this._tableRange=ws(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,n=[],o=[];let s,a,r,l,c;for(s=0,a=t.length;s<a;++s)l=t[s],l>=e&&l<=i&&n.push(l);if(n.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(s=0,a=n.length;s<a;++s)c=n[s+1],r=n[s-1],l=n[s],Math.round((c+r)/2)!==l&&o.push({time:l,pos:s/(a-1)});return o}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return t=e.length&&i.length?this.normalize(e.concat(i)):e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(ws(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return ws(this._table,i*this._tableRange+this._minPos,!0)}}});const ks=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Ss=ks.map((t=>t.replace("rgb(","rgba(").replace(")",", 0.5)")));function Ts(t){return ks[t%ks.length]}function Cs(t){return Ss[t%Ss.length]}function Ds(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}var Ms={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,i){if(!i.enabled)return;const{data:{datasets:n},options:o}=t.config,{elements:s}=o;if(!i.forceOverride&&(Ds(n)||(a=o)&&(a.borderColor||a.backgroundColor)||s&&Ds(s)))return;var a;const r=function(t){let e=0;return(i,n)=>{const o=t.getDatasetMeta(n).controller;o instanceof Oo?e=function(t,e){return t.backgroundColor=t.data.map((()=>Ts(e++))),e}(i,e):o instanceof Po?e=function(t,e){return t.backgroundColor=t.data.map((()=>Cs(e++))),e}(i,e):o&&(e=function(t,e){return t.borderColor=Ts(e),t.backgroundColor=Cs(e),++e}(i,e))}}(t);n.forEach(r)}};function Os(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Ps(t){t.data.datasets.forEach((t=>{Os(t)}))}var Es={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,i)=>{if(!i.enabled)return void Ps(t);const o=t.width;t.data.datasets.forEach(((e,s)=>{const{_data:a,indexAxis:r}=e,l=t.getDatasetMeta(s),c=a||e.data;if("y"===yi([r,t.options.indexAxis]))return;if(!l.controller.supportsDecimation)return;const d=t.scales[l.xAxisID];if("linear"!==d.type&&"time"!==d.type)return;if(t.options.parsing)return;let u,{start:h,count:p}=function(t,e){const i=e.length;let n,o=0;const{iScale:s}=t,{min:a,max:r,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(o=Q(it(e,s.axis,a).lo,0,i-1)),n=c?Q(it(e,s.axis,r).hi+1,o,i)-o:i-o,{start:o,count:n}}(l,c);if(p<=(i.threshold||4*o))Os(e);else{switch(n(a)&&(e._data=c,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),i.algorithm){case"lttb":u=function(t,e,i,n,o){const s=o.samples||n;if(s>=i)return t.slice(e,e+i);const a=[],r=(i-2)/(s-2);let l=0;const c=e+i-1;let d,u,h,p,f,m=e;for(a[l++]=t[m],d=0;d<s-2;d++){let n,o=0,s=0;const c=Math.floor((d+1)*r)+1+e,g=Math.min(Math.floor((d+2)*r)+1,i)+e,v=g-c;for(n=c;n<g;n++)o+=t[n].x,s+=t[n].y;o/=v,s/=v;const b=Math.floor(d*r)+1+e,y=Math.min(Math.floor((d+1)*r)+1,i)+e,{x:_,y:w}=t[m];for(h=p=-1,n=b;n<y;n++)p=.5*Math.abs((_-o)*(t[n].y-w)-(_-t[n].x)*(s-w)),p>h&&(h=p,u=t[n],f=n);a[l++]=u,m=f}return a[l++]=t[c],a}(c,h,p,o,i);break;case"min-max":u=function(t,e,i,o){let s,a,r,l,c,d,u,h,p,f,m=0,g=0;const v=[],b=e+i-1,y=t[e].x,_=t[b].x-y;for(s=e;s<e+i;++s){a=t[s],r=(a.x-y)/_*o,l=a.y;const e=0|r;if(e===c)l<p?(p=l,d=s):l>f&&(f=l,u=s),m=(g*m+a.x)/++g;else{const i=s-1;if(!n(d)&&!n(u)){const e=Math.min(d,u),n=Math.max(d,u);e!==h&&e!==i&&v.push({...t[e],x:m}),n!==h&&n!==i&&v.push({...t[n],x:m})}s>0&&i!==h&&v.push(t[i]),v.push(a),c=e,g=0,p=f=l,d=u=h=s}}return v}(c,h,p,o);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}e._decimated=u}}))},destroy(t){Ps(t)}};function As(t,e,i,n){if(n)return;let o=e[t],s=i[t];return"angle"===t&&(o=X(o),s=X(s)),{property:t,start:o,end:s}}function Is(t,e,i){for(;e>t;e--){const t=i[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function Ls(t,e,i,n){return t&&e?n(t[i],e[i]):t?t[i]:e?e[i]:0}function Ns(t,e){let i=[],n=!1;return o(t)?(n=!0,i=t):i=function(t,e){const{x:i=null,y:n=null}=t||{},o=e.points,s=[];return e.segments.forEach((({start:t,end:e})=>{e=Is(t,e,o);const a=o[t],r=o[e];null!==n?(s.push({x:a.x,y:n}),s.push({x:r.x,y:n})):null!==i&&(s.push({x:i,y:a.y}),s.push({x:i,y:r.y}))})),s}(t,e),i.length?new Ho({points:i,options:{tension:0},_loop:n,_fullLoop:n}):null}function js(t){return t&&!1!==t.fill}function Rs(t,e,i){let n=t[e].fill;const o=[e];let s;if(!i)return n;for(;!1!==n&&-1===o.indexOf(n);){if(!a(n))return n;if(s=t[n],!s)return!1;if(s.visible)return n;o.push(n),n=s.fill}return!1}function $s(t,e,i){const n=function(t){const e=t.options,i=e.fill;let n=l(i&&i.target,i);return void 0===n&&(n=!!e.backgroundColor),!1!==n&&null!==n&&(!0===n?"origin":n)}(t);if(s(n))return!isNaN(n.value)&&n;let o=parseFloat(n);return a(o)&&Math.floor(o)===o?function(t,e,i,n){return"-"!==t&&"+"!==t||(i=e+i),!(i===e||i<0||i>=n)&&i}(n[0],e,o,i):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function Bs(t,e,i){const n=[];for(let o=0;o<i.length;o++){const s=i[o],{first:a,last:r,point:l}=Fs(s,e,"x");if(!(!l||a&&r))if(a)n.unshift(l);else if(t.push(l),!r)break}t.push(...n)}function Fs(t,e,i){const n=t.interpolate(e,i);if(!n)return{};const o=n[i],s=t.segments,a=t.points;let r=!1,l=!1;for(let t=0;t<s.length;t++){const e=s[t],n=a[e.start][i],c=a[e.end][i];if(tt(o,n,c)){r=o===n,l=o===c;break}}return{first:r,last:l,point:n}}class Hs{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:n,y:o,radius:s}=this;return e=e||{start:0,end:O},t.arc(n,o,s,e.end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:n}=this,o=t.angle;return{x:e+Math.cos(o)*n,y:i+Math.sin(o)*n,angle:o}}}function Ws(t){const{chart:e,fill:i,line:n}=t;if(a(i))return function(t,e){const i=t.getDatasetMeta(e);return i&&t.isDatasetVisible(e)?i.dataset:null}(e,i);if("stack"===i)return function(t){const{scale:e,index:i,line:n}=t,o=[],s=n.segments,a=n.points,r=function(t,e){const i=[],n=t.getMatchingVisibleMetas("line");for(let t=0;t<n.length;t++){const o=n[t];if(o.index===e)break;o.hidden||i.unshift(o.dataset)}return i}(e,i);r.push(Ns({x:null,y:e.bottom},n));for(let t=0;t<s.length;t++){const e=s[t];for(let t=e.start;t<=e.end;t++)Bs(o,a[t],r)}return new Ho({points:o,options:{}})}(t);if("shape"===i)return!0;const o=function(t){return(t.scale||{}).getPointPositionForValue?function(t){const{scale:e,fill:i}=t,n=e.options,o=e.getLabels().length,a=n.reverse?e.max:e.min,r=function(t,e,i){let n;return n="start"===t?i:"end"===t?e.options.reverse?e.min:e.max:s(t)?t.value:e.getBaseValue(),n}(i,e,a),l=[];if(n.grid.circular){const t=e.getPointPositionForValue(0,a);return new Hs({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(r)})}for(let t=0;t<o;++t)l.push(e.getPointPositionForValue(t,r));return l}(t):function(t){const{scale:e={},fill:i}=t,n=function(t,e){let i=null;return"start"===t?i=e.bottom:"end"===t?i=e.top:s(t)?i=e.getPixelForValue(t.value):e.getBasePixel&&(i=e.getBasePixel()),i}(i,e);if(a(n)){const t=e.isHorizontal();return{x:t?n:null,y:t?null:n}}return null}(t)}(t);return o instanceof Hs?o:Ns(o,n)}function Us(t,e,i){const n=Ws(e),{line:o,scale:s,axis:a}=e,r=o.options,l=r.fill,c=r.backgroundColor,{above:d=c,below:u=c}=l||{};n&&o.points.length&&(Oe(t,i),function(t,e){const{line:i,target:n,above:o,below:s,area:a,scale:r}=e,l=i._loop?"angle":e.axis;t.save(),"x"===l&&s!==o&&(qs(t,n,a.top),zs(t,{line:i,target:n,color:o,scale:r,property:l}),t.restore(),t.save(),qs(t,n,a.bottom)),zs(t,{line:i,target:n,color:s,scale:r,property:l}),t.restore()}(t,{line:o,target:n,above:d,below:u,area:i,scale:s,axis:a}),Pe(t))}function qs(t,e,i){const{segments:n,points:o}=e;let s=!0,a=!1;t.beginPath();for(const r of n){const{start:n,end:l}=r,c=o[n],d=o[Is(n,l,o)];s?(t.moveTo(c.x,c.y),s=!1):(t.lineTo(c.x,i),t.lineTo(c.x,c.y)),a=!!e.pathSegment(t,r,{move:a}),a?t.closePath():t.lineTo(d.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function zs(t,e){const{line:i,target:n,property:o,color:s,scale:a}=e,r=function(t,e,i){const n=t.segments,o=t.points,s=e.points,a=[];for(const t of n){let{start:n,end:r}=t;r=Is(n,r,o);const l=As(i,o[n],o[r],t.loop);if(!e.segments){a.push({source:t,target:l,start:o[n],end:o[r]});continue}const c=Mi(e,l);for(const e of c){const n=As(i,s[e.start],s[e.end],e.loop),r=Di(t,o,n);for(const t of r)a.push({source:t,target:e,start:{[i]:Ls(l,n,"start",Math.max)},end:{[i]:Ls(l,n,"end",Math.min)}})}}return a}(i,n,o);for(const{source:e,target:l,start:c,end:d}of r){const{style:{backgroundColor:r=s}={}}=e,u=!0!==n;t.save(),t.fillStyle=r,Vs(t,a,u&&As(o,c,d)),t.beginPath();const h=!!i.pathSegment(t,e);let p;if(u){h?t.closePath():Ys(t,n,d,o);const e=!!n.pathSegment(t,l,{move:h,reverse:!0});p=h&&e,p||Ys(t,n,c,o)}t.closePath(),t.fill(p?"evenodd":"nonzero"),t.restore()}}function Vs(t,e,i){const{top:n,bottom:o}=e.chart.chartArea,{property:s,start:a,end:r}=i||{};"x"===s&&(t.beginPath(),t.rect(a,n,r-a,o-n),t.clip())}function Ys(t,e,i,n){const o=e.interpolate(i,n);o&&t.lineTo(o.x,o.y)}var Gs={id:"filler",afterDatasetsUpdate(t,e,i){const n=(t.data.datasets||[]).length,o=[];let s,a,r,l;for(a=0;a<n;++a)s=t.getDatasetMeta(a),r=s.dataset,l=null,r&&r.options&&r instanceof Ho&&(l={visible:t.isDatasetVisible(a),index:a,fill:$s(r,a,n),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:r}),s.$filler=l,o.push(l);for(a=0;a<n;++a)l=o[a],l&&!1!==l.fill&&(l.fill=Rs(o,a,i.propagate))},beforeDraw(t,e,i){const n="beforeDraw"===i.drawTime,o=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let e=o.length-1;e>=0;--e){const i=o[e].$filler;i&&(i.line.updateControlPoints(s,i.axis),n&&i.fill&&Us(t.ctx,i,s))}},beforeDatasetsDraw(t,e,i){if("beforeDatasetsDraw"!==i.drawTime)return;const n=t.getSortedVisibleDatasetMetas();for(let e=n.length-1;e>=0;--e){const i=n[e].$filler;js(i)&&Us(t.ctx,i,t.chartArea)}},beforeDatasetDraw(t,e,i){const n=e.meta.$filler;js(n)&&"beforeDatasetDraw"===i.drawTime&&Us(t.ctx,n,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Ks=(t,e)=>{let{boxHeight:i=e,boxWidth:n=e}=t;return t.usePointStyle&&(i=Math.min(i,e),n=t.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:i,itemHeight:Math.max(e,i)}};class Xs extends In{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=u(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,i)=>t.sort(e,i,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const i=t.labels,n=bi(i.font),o=n.size,s=this._computeTitleHeight(),{boxWidth:a,itemHeight:r}=Ks(i,o);let l,c;e.font=n.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(s,o,a,r)+10):(c=this.maxHeight,l=this._fitCols(s,n,a,r)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,n){const{ctx:o,maxWidth:s,options:{labels:{padding:a}}}=this,r=this.legendHitBoxes=[],l=this.lineWidths=[0],c=n+a;let d=t;o.textAlign="left",o.textBaseline="middle";let u=-1,h=-c;return this.legendItems.forEach(((t,p)=>{const f=i+e/2+o.measureText(t.text).width;(0===p||l[l.length-1]+f+2*a>s)&&(d+=c,l[l.length-(p>0?0:1)]=0,h+=c,u++),r[p]={left:0,top:h,row:u,width:f,height:n},l[l.length-1]+=f+a})),d}_fitCols(t,e,i,n){const{ctx:o,maxHeight:s,options:{labels:{padding:a}}}=this,r=this.legendHitBoxes=[],l=this.columnSizes=[],c=s-t;let d=a,u=0,h=0,p=0,f=0;return this.legendItems.forEach(((t,s)=>{const{itemWidth:m,itemHeight:g}=function(t,e,i,n,o){const s=function(t,e,i,n){let o=t.text;return o&&"string"!=typeof o&&(o=o.reduce(((t,e)=>t.length>e.length?t:e))),e+i.size/2+n.measureText(o).width}(n,t,e,i),a=function(t,e,i){let n=t;return"string"!=typeof e.text&&(n=Js(e,i)),n}(o,n,e.lineHeight);return{itemWidth:s,itemHeight:a}}(i,e,o,t,n);s>0&&h+g+2*a>c&&(d+=u+a,l.push({width:u,height:h}),p+=u+a,f++,u=h=0),r[s]={left:p,top:h,col:f,width:m,height:g},u=Math.max(u,m),h+=g+a})),d+=u,l.push({width:u,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:n},rtl:o}}=this,s=xi(o,this.left,this.width);if(this.isHorizontal()){let o=0,a=pt(i,this.left+n,this.right-this.lineWidths[o]);for(const r of e)o!==r.row&&(o=r.row,a=pt(i,this.left+n,this.right-this.lineWidths[o])),r.top+=this.top+t+n,r.left=s.leftForLtr(s.x(a),r.width),a+=r.width+n}else{let o=0,a=pt(i,this.top+t+n,this.bottom-this.columnSizes[o].height);for(const r of e)r.col!==o&&(o=r.col,a=pt(i,this.top+t+n,this.bottom-this.columnSizes[o].height)),r.top=a,r.left+=this.left+n,r.left=s.leftForLtr(s.x(r.left),r.width),a+=r.height+n}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;Oe(t,this),this._draw(),Pe(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:n}=this,{align:o,labels:s}=t,a=re.color,r=xi(t.rtl,this.left,this.width),c=bi(s.font),{padding:d}=s,u=c.size,h=u/2;let p;this.drawTitle(),n.textAlign=r.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=c.string;const{boxWidth:f,boxHeight:m,itemHeight:g}=Ks(s,u),v=this.isHorizontal(),b=this._computeTitleHeight();p=v?{x:pt(o,this.left+d,this.right-i[0]),y:this.top+d+b,line:0}:{x:this.left+d,y:pt(o,this.top+b+d,this.bottom-e[0].height),line:0},ki(this.ctx,t.textDirection);const y=g+d;this.legendItems.forEach(((_,w)=>{n.strokeStyle=_.fontColor,n.fillStyle=_.fontColor;const x=n.measureText(_.text).width,k=r.textAlign(_.textAlign||(_.textAlign=s.textAlign)),S=f+h+x;let T=p.x,C=p.y;if(r.setWidth(this.width),v?w>0&&T+S+d>this.right&&(C=p.y+=y,p.line++,T=p.x=pt(o,this.left+d,this.right-i[p.line])):w>0&&C+y>this.bottom&&(T=p.x=T+e[p.line].width+d,p.line++,C=p.y=pt(o,this.top+b+d,this.bottom-e[p.line].height)),function(t,e,i){if(isNaN(f)||f<=0||isNaN(m)||m<0)return;n.save();const o=l(i.lineWidth,1);if(n.fillStyle=l(i.fillStyle,a),n.lineCap=l(i.lineCap,"butt"),n.lineDashOffset=l(i.lineDashOffset,0),n.lineJoin=l(i.lineJoin,"miter"),n.lineWidth=o,n.strokeStyle=l(i.strokeStyle,a),n.setLineDash(l(i.lineDash,[])),s.usePointStyle){const a={radius:m*Math.SQRT2/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:o},l=r.xPlus(t,f/2);De(n,a,l,e+h,s.pointStyleWidth&&f)}else{const s=e+Math.max((u-m)/2,0),a=r.leftForLtr(t,f),l=gi(i.borderRadius);n.beginPath(),Object.values(l).some((t=>0!==t))?je(n,{x:a,y:s,w:f,h:m,radius:l}):n.rect(a,s,f,m),n.fill(),0!==o&&n.stroke()}n.restore()}(r.x(T),C,_),T=ft(k,T+f+h,v?T+S:this.right,t.rtl),function(t,e,i){Ie(n,i.text,t,e+g/2,c,{strikethrough:i.hidden,textAlign:r.textAlign(i.textAlign)})}(r.x(T),C,_),v)p.x+=S+d;else if("string"!=typeof _.text){const t=c.lineHeight;p.y+=Js(_,t)}else p.y+=y})),Si(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=bi(e.font),n=vi(e.padding);if(!e.display)return;const o=xi(t.rtl,this.left,this.width),s=this.ctx,a=e.position,r=i.size/2,l=n.top+r;let c,d=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,d=pt(t.align,d,this.right-u);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);c=l+pt(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const h=pt(a,d,d+u);s.textAlign=o.textAlign(ht(a)),s.textBaseline="middle",s.strokeStyle=e.color,s.fillStyle=e.color,s.font=i.string,Ie(s,e.text,h,c,i)}_computeTitleHeight(){const t=this.options.title,e=bi(t.font),i=vi(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,n,o;if(tt(t,this.left,this.right)&&tt(e,this.top,this.bottom))for(o=this.legendHitBoxes,i=0;i<o.length;++i)if(n=o[i],tt(t,n.left,n.left+n.width)&&tt(e,n.top,n.top+n.height))return this.legendItems[i];return null}handleEvent(t){const e=this.options;if(!function(t,e){return!("mousemove"!==t&&"mouseout"!==t||!e.onHover&&!e.onLeave)||!(!e.onClick||"click"!==t&&"mouseup"!==t)}(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const s=this._hoveredItem,a=(o=i,null!==(n=s)&&null!==o&&n.datasetIndex===o.datasetIndex&&n.index===o.index);s&&!a&&u(e.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!a&&u(e.onHover,[t,i,this],this)}else i&&u(e.onClick,[t,i,this],this);var n,o}}function Js(t,e){return e*(t.text?t.text.length+.5:0)}var Qs={id:"legend",_element:Xs,start(t,e,i){const n=t.legend=new Xs({ctx:t.ctx,options:i,chart:t});Ji.configure(t,n,i),Ji.addBox(t,n)},stop(t){Ji.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){const n=t.legend;Ji.configure(t,n,i),n.options=i},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){const n=e.datasetIndex,o=i.chart;o.isDatasetVisible(n)?(o.hide(n),e.hidden=!0):(o.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:n,textAlign:o,color:s,useBorderRadius:a,borderRadius:r}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const l=t.controller.getStyle(i?0:void 0),c=vi(l.borderWidth);return{text:e[t.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!t.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:n||l.pointStyle,rotation:l.rotation,textAlign:o||l.textAlign,borderRadius:a&&(r||l.borderRadius),datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Zs extends In{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const n=o(i.text)?i.text.length:1;this._padding=vi(i.padding);const s=n*bi(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:i,bottom:n,right:o,options:s}=this,a=s.align;let r,l,c,d=0;return this.isHorizontal()?(l=pt(a,i,o),c=e+t,r=o-i):("left"===s.position?(l=i+t,c=pt(a,n,e),d=-.5*M):(l=o-t,c=pt(a,e,n),d=.5*M),r=n-e),{titleX:l,titleY:c,maxWidth:r,rotation:d}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=bi(e.font),n=i.lineHeight/2+this._padding.top,{titleX:o,titleY:s,maxWidth:a,rotation:r}=this._drawArgs(n);Ie(t,e.text,0,0,i,{color:e.color,maxWidth:a,rotation:r,textAlign:ht(e.align),textBaseline:"middle",translation:[o,s]})}}var ta={id:"title",_element:Zs,start(t,e,i){!function(t,e){const i=new Zs({ctx:t.ctx,options:e,chart:t});Ji.configure(t,i,e),Ji.addBox(t,i),t.titleBlock=i}(t,i)},stop(t){const e=t.titleBlock;Ji.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){const n=t.titleBlock;Ji.configure(t,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ea=new WeakMap;var ia={id:"subtitle",start(t,e,i){const n=new Zs({ctx:t.ctx,options:i,chart:t});Ji.configure(t,n,i),Ji.addBox(t,n),ea.set(t,n)},stop(t){Ji.removeBox(t,ea.get(t)),ea.delete(t)},beforeUpdate(t,e,i){const n=ea.get(t);Ji.configure(t,n,i),n.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const na={average(t){if(!t.length)return!1;let e,i,n=0,o=0,s=0;for(e=0,i=t.length;e<i;++e){const i=t[e].element;if(i&&i.hasValue()){const t=i.tooltipPosition();n+=t.x,o+=t.y,++s}}return{x:n/s,y:o/s}},nearest(t,e){if(!t.length)return!1;let i,n,o,s=e.x,a=e.y,r=Number.POSITIVE_INFINITY;for(i=0,n=t.length;i<n;++i){const n=t[i].element;if(n&&n.hasValue()){const t=G(e,n.getCenterPoint());t<r&&(r=t,o=n)}}if(o){const t=o.tooltipPosition();s=t.x,a=t.y}return{x:s,y:a}}};function oa(t,e){return e&&(o(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function sa(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function aa(t,e){const{element:i,datasetIndex:n,index:o}=e,s=t.getDatasetMeta(n).controller,{label:a,value:r}=s.getLabelAndValue(o);return{chart:t,label:a,parsed:s.getParsed(o),raw:t.data.datasets[n].data[o],formattedValue:r,dataset:s.getDataset(),dataIndex:o,datasetIndex:n,element:i}}function ra(t,e){const i=t.chart.ctx,{body:n,footer:o,title:s}=t,{boxWidth:a,boxHeight:r}=e,l=bi(e.bodyFont),c=bi(e.titleFont),d=bi(e.footerFont),u=s.length,p=o.length,f=n.length,m=vi(e.padding);let g=m.height,v=0,b=n.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);b+=t.beforeBody.length+t.afterBody.length,u&&(g+=u*c.lineHeight+(u-1)*e.titleSpacing+e.titleMarginBottom),b&&(g+=f*(e.displayColors?Math.max(r,l.lineHeight):l.lineHeight)+(b-f)*l.lineHeight+(b-1)*e.bodySpacing),p&&(g+=e.footerMarginTop+p*d.lineHeight+(p-1)*e.footerSpacing);let y=0;const _=function(t){v=Math.max(v,i.measureText(t).width+y)};return i.save(),i.font=c.string,h(t.title,_),i.font=l.string,h(t.beforeBody.concat(t.afterBody),_),y=e.displayColors?a+2+e.boxPadding:0,h(n,(t=>{h(t.before,_),h(t.lines,_),h(t.after,_)})),y=0,i.font=d.string,h(t.footer,_),i.restore(),v+=m.width,{width:v,height:g}}function la(t,e,i,n){const{x:o,width:s}=i,{width:a,chartArea:{left:r,right:l}}=t;let c="center";return"center"===n?c=o<=(r+l)/2?"left":"right":o<=s/2?c="left":o>=a-s/2&&(c="right"),function(t,e,i,n){const{x:o,width:s}=n,a=i.caretSize+i.caretPadding;return"left"===t&&o+s+a>e.width||"right"===t&&o-s-a<0||void 0}(c,t,e,i)&&(c="center"),c}function ca(t,e,i){const n=i.yAlign||e.yAlign||function(t,e){const{y:i,height:n}=e;return i<n/2?"top":i>t.height-n/2?"bottom":"center"}(t,i);return{xAlign:i.xAlign||e.xAlign||la(t,e,i,n),yAlign:n}}function da(t,e,i,n){const{caretSize:o,caretPadding:s,cornerRadius:a}=t,{xAlign:r,yAlign:l}=i,c=o+s,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=gi(a);let f=function(t,e){let{x:i,width:n}=t;return"right"===e?i-=n:"center"===e&&(i-=n/2),i}(e,r);const m=function(t,e,i){let{y:n,height:o}=t;return"top"===e?n+=i:n-="bottom"===e?o+i:o/2,n}(e,l,c);return"center"===l?"left"===r?f+=c:"right"===r&&(f-=c):"left"===r?f-=Math.max(d,h)+o:"right"===r&&(f+=Math.max(u,p)+o),{x:Q(f,0,n.width-e.width),y:Q(m,0,n.height-e.height)}}function ua(t,e,i){const n=vi(i.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-n.right:t.x+n.left}function ha(t){return oa([],sa(t))}function pa(t,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}const fa={beforeTitle:e,title(t){if(t.length>0){const e=t[0],i=e.chart.data.labels,n=i?i.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return i[e.dataIndex]}return""},afterTitle:e,beforeBody:e,beforeLabel:e,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const i=t.formattedValue;return n(i)||(e+=i),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:e,afterBody:e,beforeFooter:e,footer:e,afterFooter:e};function ma(t,e,i,n){const o=t[e].call(i,n);return void 0===o?fa[e].call(i,n):o}class ga extends In{static positioners=na;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),n=i.enabled&&e.options.animation&&i.animations,o=new _n(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=(this,wi(this.chart.getContext(),{tooltip:this,tooltipItems:this._tooltipItems,type:"tooltip"})))}getTitle(t,e){const{callbacks:i}=e,n=ma(i,"beforeTitle",this,t),o=ma(i,"title",this,t),s=ma(i,"afterTitle",this,t);let a=[];return a=oa(a,sa(n)),a=oa(a,sa(o)),a=oa(a,sa(s)),a}getBeforeBody(t,e){return ha(ma(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,n=[];return h(t,(t=>{const e={before:[],lines:[],after:[]},o=pa(i,t);oa(e.before,sa(ma(o,"beforeLabel",this,t))),oa(e.lines,ma(o,"label",this,t)),oa(e.after,sa(ma(o,"afterLabel",this,t))),n.push(e)})),n}getAfterBody(t,e){return ha(ma(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,n=ma(i,"beforeFooter",this,t),o=ma(i,"footer",this,t),s=ma(i,"afterFooter",this,t);let a=[];return a=oa(a,sa(n)),a=oa(a,sa(o)),a=oa(a,sa(s)),a}_createItems(t){const e=this._active,i=this.chart.data,n=[],o=[],s=[];let a,r,l=[];for(a=0,r=e.length;a<r;++a)l.push(aa(this.chart,e[a]));return t.filter&&(l=l.filter(((e,n,o)=>t.filter(e,n,o,i)))),t.itemSort&&(l=l.sort(((e,n)=>t.itemSort(e,n,i)))),h(l,(e=>{const i=pa(t.callbacks,e);n.push(ma(i,"labelColor",this,e)),o.push(ma(i,"labelPointStyle",this,e)),s.push(ma(i,"labelTextColor",this,e))})),this.labelColors=n,this.labelPointStyles=o,this.labelTextColors=s,this.dataPoints=l,l}update(t,e){const i=this.options.setContext(this.getContext()),n=this._active;let o,s=[];if(n.length){const t=na[i.position].call(this,n,this._eventPosition);s=this._createItems(i),this.title=this.getTitle(s,i),this.beforeBody=this.getBeforeBody(s,i),this.body=this.getBody(s,i),this.afterBody=this.getAfterBody(s,i),this.footer=this.getFooter(s,i);const e=this._size=ra(this,i),a=Object.assign({},t,e),r=ca(this.chart,i,a),l=da(i,a,r,this.chart);this.xAlign=r.xAlign,this.yAlign=r.yAlign,o={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(o={opacity:0});this._tooltipItems=s,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,n){const o=this.getCaretPosition(t,i,n);e.lineTo(o.x1,o.y1),e.lineTo(o.x2,o.y2),e.lineTo(o.x3,o.y3)}getCaretPosition(t,e,i){const{xAlign:n,yAlign:o}=this,{caretSize:s,cornerRadius:a}=i,{topLeft:r,topRight:l,bottomLeft:c,bottomRight:d}=gi(a),{x:u,y:h}=t,{width:p,height:f}=e;let m,g,v,b,y,_;return"center"===o?(y=h+f/2,"left"===n?(m=u,g=m-s,b=y+s,_=y-s):(m=u+p,g=m+s,b=y-s,_=y+s),v=m):(g="left"===n?u+Math.max(r,c)+s:"right"===n?u+p-Math.max(l,d)-s:this.caretX,"top"===o?(b=h,y=b-s,m=g-s,v=g+s):(b=h+f,y=b+s,m=g+s,v=g-s),_=b),{x1:m,x2:g,x3:v,y1:b,y2:y,y3:_}}drawTitle(t,e,i){const n=this.title,o=n.length;let s,a,r;if(o){const l=xi(i.rtl,this.x,this.width);for(t.x=ua(this,i.titleAlign,i),e.textAlign=l.textAlign(i.titleAlign),e.textBaseline="middle",s=bi(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=s.string,r=0;r<o;++r)e.fillText(n[r],l.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+a,r+1===o&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,n,o){const a=this.labelColors[i],r=this.labelPointStyles[i],{boxHeight:l,boxWidth:c,boxPadding:d}=o,u=bi(o.bodyFont),h=ua(this,"left",o),p=n.x(h),f=l<u.lineHeight?(u.lineHeight-l)/2:0,m=e.y+f;if(o.usePointStyle){const e={radius:Math.min(c,l)/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:1},i=n.leftForLtr(p,c)+c/2,s=m+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,Ce(t,e,i,s),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,Ce(t,e,i,s)}else{t.lineWidth=s(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const e=n.leftForLtr(p,c-d),i=n.leftForLtr(n.xPlus(p,1),c-d-2),r=gi(a.borderRadius);Object.values(r).some((t=>0!==t))?(t.beginPath(),t.fillStyle=o.multiKeyBackground,je(t,{x:e,y:m,w:c,h:l,radius:r}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),je(t,{x:i,y:m+1,w:c-2,h:l-2,radius:r}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(e,m,c,l),t.strokeRect(e,m,c,l),t.fillStyle=a.backgroundColor,t.fillRect(i,m+1,c-2,l-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:n}=this,{bodySpacing:o,bodyAlign:s,displayColors:a,boxHeight:r,boxWidth:l,boxPadding:c}=i,d=bi(i.bodyFont);let u=d.lineHeight,p=0;const f=xi(i.rtl,this.x,this.width),m=function(i){e.fillText(i,f.x(t.x+p),t.y+u/2),t.y+=u+o},g=f.textAlign(s);let v,b,y,_,w,x,k;for(e.textAlign=s,e.textBaseline="middle",e.font=d.string,t.x=ua(this,g,i),e.fillStyle=i.bodyColor,h(this.beforeBody,m),p=a&&"right"!==g?"center"===s?l/2+c:l+2+c:0,_=0,x=n.length;_<x;++_){for(v=n[_],b=this.labelTextColors[_],e.fillStyle=b,h(v.before,m),y=v.lines,a&&y.length&&(this._drawColorBox(e,t,_,f,i),u=Math.max(d.lineHeight,r)),w=0,k=y.length;w<k;++w)m(y[w]),u=d.lineHeight;h(v.after,m)}p=0,u=d.lineHeight,h(this.afterBody,m),t.y-=o}drawFooter(t,e,i){const n=this.footer,o=n.length;let s,a;if(o){const r=xi(i.rtl,this.x,this.width);for(t.x=ua(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=r.textAlign(i.footerAlign),e.textBaseline="middle",s=bi(i.footerFont),e.fillStyle=i.footerColor,e.font=s.string,a=0;a<o;++a)e.fillText(n[a],r.x(t.x),t.y+s.lineHeight/2),t.y+=s.lineHeight+i.footerSpacing}}drawBackground(t,e,i,n){const{xAlign:o,yAlign:s}=this,{x:a,y:r}=t,{width:l,height:c}=i,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=gi(n.cornerRadius);e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.beginPath(),e.moveTo(a+d,r),"top"===s&&this.drawCaret(t,e,i,n),e.lineTo(a+l-u,r),e.quadraticCurveTo(a+l,r,a+l,r+u),"center"===s&&"right"===o&&this.drawCaret(t,e,i,n),e.lineTo(a+l,r+c-p),e.quadraticCurveTo(a+l,r+c,a+l-p,r+c),"bottom"===s&&this.drawCaret(t,e,i,n),e.lineTo(a+h,r+c),e.quadraticCurveTo(a,r+c,a,r+c-h),"center"===s&&"left"===o&&this.drawCaret(t,e,i,n),e.lineTo(a,r+d),e.quadraticCurveTo(a,r,a+d,r),e.closePath(),e.fill(),n.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,n=i&&i.x,o=i&&i.y;if(n||o){const i=na[t.position].call(this,this._active,this._eventPosition);if(!i)return;const s=this._size=ra(this,t),a=Object.assign({},i,this._size),r=ca(e,t,a),l=da(t,a,r,e);n._to===l.x&&o._to===l.y||(this.xAlign=r.xAlign,this.yAlign=r.yAlign,this.width=s.width,this.height=s.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const n={width:this.width,height:this.height},o={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const s=vi(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(o,t,n,e),ki(t,e.textDirection),o.y+=s.top,this.drawTitle(o,t,e),this.drawBody(o,t,e),this.drawFooter(o,t,e),Si(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,n=t.map((({datasetIndex:t,index:e})=>{const i=this.chart.getDatasetMeta(t);if(!i)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[e],index:e}})),o=!p(i,n),s=this._positionChanged(n,e);(o||s)&&(this._active=n,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,o=this._active||[],s=this._getActiveElements(t,o,e,i),a=this._positionChanged(s,t),r=e||!p(s,o)||a;return r&&(this._active=s,(n.enabled||n.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),r}_getActiveElements(t,e,i,n){const o=this.options;if("mouseout"===t.type)return[];if(!n)return e;const s=this.chart.getElementsAtEventForMode(t,o.mode,o,i);return o.reverse&&s.reverse(),s}_positionChanged(t,e){const{caretX:i,caretY:n,options:o}=this,s=na[o.position].call(this,t,e);return!1!==s&&(i!==s.x||n!==s.y)}}var va={id:"tooltip",_element:ga,positioners:na,afterInit(t,e,i){i&&(t.tooltip=new ga({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){const i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fa},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};return go.register(Eo,xs,Ko,t),go.helpers={...Ii},go._adapters=_o,go.Animation=yn,go.Animations=_n,go.animator=vt,go.controllers=zn.controllers.items,go.DatasetController=An,go.Element=In,go.elements=Ko,go.Interaction=Bi,go.layouts=Ji,go.platforms=gn,go.Scale=Un,go.Ticks=ie,Object.assign(go,Eo,xs,Ko,t,gn),go.Chart=go,"undefined"!=typeof window&&(window.Chart=go),go})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Chart)}(this,(function(t){"use strict";function e(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function i(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function n(t){i(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function o(t,o){i(2,arguments);var s=n(t),a=e(o);return isNaN(a)?new Date(NaN):a?(s.setDate(s.getDate()+a),s):s}function s(t,o){i(2,arguments);var s=n(t),a=e(o);if(isNaN(a))return new Date(NaN);if(!a)return s;var r=s.getDate(),l=new Date(s.getTime());return l.setMonth(s.getMonth()+a+1,0),r>=l.getDate()?l:(s.setFullYear(l.getFullYear(),l.getMonth(),r),s)}function a(t,o){i(2,arguments);var s=n(t).getTime(),a=e(o);return new Date(s+a)}var r=36e5;function l(t,o){i(1,arguments);var s=o||{},a=s.locale,r=a&&a.options&&a.options.weekStartsOn,l=null==r?0:e(r),c=null==s.weekStartsOn?l:e(s.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=n(t),u=d.getDay(),h=(u<c?7:0)+u-c;return d.setDate(d.getDate()-h),d.setHours(0,0,0,0),d}function c(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function d(t){i(1,arguments);var e=n(t);return e.setHours(0,0,0,0),e}var u=864e5;function h(t,e){i(2,arguments);var n=d(t),o=d(e),s=n.getTime()-c(n),a=o.getTime()-c(o);return Math.round((s-a)/u)}function p(t,e){i(2,arguments);var o=n(t),s=n(e),a=o.getTime()-s.getTime();return a<0?-1:a>0?1:a}function f(t){i(1,arguments);var e=n(t);return!isNaN(e)}function m(t,e){var i=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return i<0?-1:i>0?1:i}function g(t,e){i(2,arguments);var o=n(t),s=n(e),a=m(o,s),r=Math.abs(h(o,s));o.setDate(o.getDate()-a*r);var l=a*(r-(m(o,s)===-a));return 0===l?0:l}function v(t,e){i(2,arguments);var o=n(t),s=n(e);return o.getTime()-s.getTime()}var b=36e5;function y(t){i(1,arguments);var e=n(t);return e.setHours(23,59,59,999),e}function _(t){i(1,arguments);var e=n(t),o=e.getMonth();return e.setFullYear(e.getFullYear(),o+1,0),e.setHours(23,59,59,999),e}function w(t,e){i(2,arguments);var o,s=n(t),a=n(e),r=p(s,a),l=Math.abs(function(t,e){i(2,arguments);var o=n(t),s=n(e);return 12*(o.getFullYear()-s.getFullYear())+(o.getMonth()-s.getMonth())}(s,a));if(l<1)o=0;else{1===s.getMonth()&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-r*l);var c=p(s,a)===-r;(function(t){i(1,arguments);var e=n(t);return y(e).getTime()===_(e).getTime()})(n(t))&&1===l&&1===p(t,a)&&(c=!1),o=r*(l-c)}return 0===o?0:o}var x={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function k(t){return function(e){var i=e||{},n=i.width?String(i.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}var S={date:k({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:k({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:k({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},T={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function C(t){return function(e,i){var n,o=i||{};if("formatting"===(o.context?String(o.context):"standalone")&&t.formattingValues){var s=t.defaultFormattingWidth||t.defaultWidth,a=o.width?String(o.width):s;n=t.formattingValues[a]||t.formattingValues[s]}else{var r=t.defaultWidth,l=o.width?String(o.width):t.defaultWidth;n=t.values[l]||t.values[r]}return n[t.argumentCallback?t.argumentCallback(e):e]}}function D(t){return function(e,i){var n=String(e),o=i||{},s=o.width,a=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],r=n.match(a);if(!r)return null;var l,c=r[0],d=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth];return l="[object Array]"===Object.prototype.toString.call(d)?function(t,e){for(var i=0;i<t.length;i++)if(e(t[i]))return i}(d,(function(t){return t.test(c)})):function(t,e){for(var i in t)if(t.hasOwnProperty(i)&&e(t[i]))return i}(d,(function(t){return t.test(c)})),l=t.valueCallback?t.valueCallback(l):l,{value:l=o.valueCallback?o.valueCallback(l):l,rest:n.slice(c.length)}}}var M,O={code:"en-US",formatDistance:function(t,e,i){var n;return i=i||{},n="string"==typeof x[t]?x[t]:1===e?x[t].one:x[t].other.replace("{{count}}",e),i.addSuffix?i.comparison>0?"in "+n:n+" ago":n},formatLong:S,formatRelative:function(t,e,i,n){return T[t]},localize:{ordinalNumber:function(t,e){var i=Number(t),n=i%100;if(n>20||n<10)switch(n%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},era:C({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:C({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(t){return Number(t)-1}}),month:C({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:C({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:C({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(M={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}},function(t,e){var i=String(t),n=e||{},o=i.match(M.matchPattern);if(!o)return null;var s=o[0],a=i.match(M.parsePattern);if(!a)return null;var r=M.valueCallback?M.valueCallback(a[0]):a[0];return{value:r=n.valueCallback?n.valueCallback(r):r,rest:i.slice(s.length)}}),era:D({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:D({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:D({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:D({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:D({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function P(t,n){return i(2,arguments),a(t,-e(n))}function E(t,e){for(var i=t<0?"-":"",n=Math.abs(t).toString();n.length<e;)n="0"+n;return i+n}var A=function(t,e){var i=t.getUTCFullYear(),n=i>0?i:1-i;return E("yy"===e?n%100:n,e.length)},I=function(t,e){var i=t.getUTCMonth();return"M"===e?String(i+1):E(i+1,2)},L=function(t,e){return E(t.getUTCDate(),e.length)},N=function(t,e){return E(t.getUTCHours()%12||12,e.length)},j=function(t,e){return E(t.getUTCHours(),e.length)},R=function(t,e){return E(t.getUTCMinutes(),e.length)},$=function(t,e){return E(t.getUTCSeconds(),e.length)},B=function(t,e){var i=e.length,n=t.getUTCMilliseconds();return E(Math.floor(n*Math.pow(10,i-3)),e.length)},F=864e5;function H(t){i(1,arguments);var e=n(t),o=e.getUTCDay(),s=(o<1?7:0)+o-1;return e.setUTCDate(e.getUTCDate()-s),e.setUTCHours(0,0,0,0),e}function W(t){i(1,arguments);var e=n(t),o=e.getUTCFullYear(),s=new Date(0);s.setUTCFullYear(o+1,0,4),s.setUTCHours(0,0,0,0);var a=H(s),r=new Date(0);r.setUTCFullYear(o,0,4),r.setUTCHours(0,0,0,0);var l=H(r);return e.getTime()>=a.getTime()?o+1:e.getTime()>=l.getTime()?o:o-1}var U=6048e5;function q(t){i(1,arguments);var e=n(t),o=H(e).getTime()-function(t){i(1,arguments);var e=W(t),n=new Date(0);return n.setUTCFullYear(e,0,4),n.setUTCHours(0,0,0,0),H(n)}(e).getTime();return Math.round(o/U)+1}function z(t,o){i(1,arguments);var s=o||{},a=s.locale,r=a&&a.options&&a.options.weekStartsOn,l=null==r?0:e(r),c=null==s.weekStartsOn?l:e(s.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=n(t),u=d.getUTCDay(),h=(u<c?7:0)+u-c;return d.setUTCDate(d.getUTCDate()-h),d.setUTCHours(0,0,0,0),d}function V(t,o){i(1,arguments);var s=n(t,o),a=s.getUTCFullYear(),r=o||{},l=r.locale,c=l&&l.options&&l.options.firstWeekContainsDate,d=null==c?1:e(c),u=null==r.firstWeekContainsDate?d:e(r.firstWeekContainsDate);if(!(u>=1&&u<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=new Date(0);h.setUTCFullYear(a+1,0,u),h.setUTCHours(0,0,0,0);var p=z(h,o),f=new Date(0);f.setUTCFullYear(a,0,u),f.setUTCHours(0,0,0,0);var m=z(f,o);return s.getTime()>=p.getTime()?a+1:s.getTime()>=m.getTime()?a:a-1}function Y(t,n){i(1,arguments);var o=n||{},s=o.locale,a=s&&s.options&&s.options.firstWeekContainsDate,r=null==a?1:e(a),l=null==o.firstWeekContainsDate?r:e(o.firstWeekContainsDate),c=V(t,n),d=new Date(0);return d.setUTCFullYear(c,0,l),d.setUTCHours(0,0,0,0),z(d,n)}var G=6048e5;function K(t,e){i(1,arguments);var o=n(t),s=z(o,e).getTime()-Y(o,e).getTime();return Math.round(s/G)+1}var X={G:function(t,e,i){var n=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return i.era(n,{width:"abbreviated"});case"GGGGG":return i.era(n,{width:"narrow"});default:return i.era(n,{width:"wide"})}},y:function(t,e,i){if("yo"===e){var n=t.getUTCFullYear(),o=n>0?n:1-n;return i.ordinalNumber(o,{unit:"year"})}return A(t,e)},Y:function(t,e,i,n){var o=V(t,n),s=o>0?o:1-o;return"YY"===e?E(s%100,2):"Yo"===e?i.ordinalNumber(s,{unit:"year"}):E(s,e.length)},R:function(t,e){return E(W(t),e.length)},u:function(t,e){return E(t.getUTCFullYear(),e.length)},Q:function(t,e,i){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return E(n,2);case"Qo":return i.ordinalNumber(n,{unit:"quarter"});case"QQQ":return i.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(n,{width:"narrow",context:"formatting"});default:return i.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,i){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return E(n,2);case"qo":return i.ordinalNumber(n,{unit:"quarter"});case"qqq":return i.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(n,{width:"narrow",context:"standalone"});default:return i.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,i){var n=t.getUTCMonth();switch(e){case"M":case"MM":return I(t,e);case"Mo":return i.ordinalNumber(n+1,{unit:"month"});case"MMM":return i.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(n,{width:"narrow",context:"formatting"});default:return i.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,i){var n=t.getUTCMonth();switch(e){case"L":return String(n+1);case"LL":return E(n+1,2);case"Lo":return i.ordinalNumber(n+1,{unit:"month"});case"LLL":return i.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(n,{width:"narrow",context:"standalone"});default:return i.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,i,n){var o=K(t,n);return"wo"===e?i.ordinalNumber(o,{unit:"week"}):E(o,e.length)},I:function(t,e,i){var n=q(t);return"Io"===e?i.ordinalNumber(n,{unit:"week"}):E(n,e.length)},d:function(t,e,i){return"do"===e?i.ordinalNumber(t.getUTCDate(),{unit:"date"}):L(t,e)},D:function(t,e,o){var s=function(t){i(1,arguments);var e=n(t),o=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var s=o-e.getTime();return Math.floor(s/F)+1}(t);return"Do"===e?o.ordinalNumber(s,{unit:"dayOfYear"}):E(s,e.length)},E:function(t,e,i){var n=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return i.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(n,{width:"short",context:"formatting"});default:return i.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,i,n){var o=t.getUTCDay(),s=(o-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return E(s,2);case"eo":return i.ordinalNumber(s,{unit:"day"});case"eee":return i.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(o,{width:"short",context:"formatting"});default:return i.day(o,{width:"wide",context:"formatting"})}},c:function(t,e,i,n){var o=t.getUTCDay(),s=(o-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return E(s,e.length);case"co":return i.ordinalNumber(s,{unit:"day"});case"ccc":return i.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(o,{width:"narrow",context:"standalone"});case"cccccc":return i.day(o,{width:"short",context:"standalone"});default:return i.day(o,{width:"wide",context:"standalone"})}},i:function(t,e,i){var n=t.getUTCDay(),o=0===n?7:n;switch(e){case"i":return String(o);case"ii":return E(o,e.length);case"io":return i.ordinalNumber(o,{unit:"day"});case"iii":return i.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(n,{width:"short",context:"formatting"});default:return i.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,i){var n=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(n,{width:"narrow",context:"formatting"});default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,e,i){var n,o=t.getUTCHours();switch(n=12===o?"noon":0===o?"midnight":o/12>=1?"pm":"am",e){case"b":case"bb":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(n,{width:"narrow",context:"formatting"});default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,e,i){var n,o=t.getUTCHours();switch(n=o>=17?"evening":o>=12?"afternoon":o>=4?"morning":"night",e){case"B":case"BB":case"BBB":return i.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(n,{width:"narrow",context:"formatting"});default:return i.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,e,i){if("ho"===e){var n=t.getUTCHours()%12;return 0===n&&(n=12),i.ordinalNumber(n,{unit:"hour"})}return N(t,e)},H:function(t,e,i){return"Ho"===e?i.ordinalNumber(t.getUTCHours(),{unit:"hour"}):j(t,e)},K:function(t,e,i){var n=t.getUTCHours()%12;return"Ko"===e?i.ordinalNumber(n,{unit:"hour"}):E(n,e.length)},k:function(t,e,i){var n=t.getUTCHours();return 0===n&&(n=24),"ko"===e?i.ordinalNumber(n,{unit:"hour"}):E(n,e.length)},m:function(t,e,i){return"mo"===e?i.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):R(t,e)},s:function(t,e,i){return"so"===e?i.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):$(t,e)},S:function(t,e){return B(t,e)},X:function(t,e,i,n){var o=(n._originalDate||t).getTimezoneOffset();if(0===o)return"Z";switch(e){case"X":return Q(o);case"XXXX":case"XX":return Z(o);default:return Z(o,":")}},x:function(t,e,i,n){var o=(n._originalDate||t).getTimezoneOffset();switch(e){case"x":return Q(o);case"xxxx":case"xx":return Z(o);default:return Z(o,":")}},O:function(t,e,i,n){var o=(n._originalDate||t).getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+J(o,":");default:return"GMT"+Z(o,":")}},z:function(t,e,i,n){var o=(n._originalDate||t).getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+J(o,":");default:return"GMT"+Z(o,":")}},t:function(t,e,i,n){var o=n._originalDate||t;return E(Math.floor(o.getTime()/1e3),e.length)},T:function(t,e,i,n){return E((n._originalDate||t).getTime(),e.length)}};function J(t,e){var i=t>0?"-":"+",n=Math.abs(t),o=Math.floor(n/60),s=n%60;if(0===s)return i+String(o);var a=e||"";return i+String(o)+a+E(s,2)}function Q(t,e){return t%60==0?(t>0?"-":"+")+E(Math.abs(t)/60,2):Z(t,e)}function Z(t,e){var i=e||"",n=t>0?"-":"+",o=Math.abs(t);return n+E(Math.floor(o/60),2)+i+E(o%60,2)}var tt=X;function et(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}}function it(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}}var nt={p:it,P:function(t,e){var i,n=t.match(/(P+)(p+)?/),o=n[1],s=n[2];if(!s)return et(t,e);switch(o){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;default:i=e.dateTime({width:"full"})}return i.replace("{{date}}",et(o,e)).replace("{{time}}",it(s,e))}},ot=nt,st=["D","DD"],at=["YY","YYYY"];function rt(t){return-1!==st.indexOf(t)}function lt(t){return-1!==at.indexOf(t)}function ct(t,e,i){if("YYYY"===t)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(i,"`; see: https://git.io/fxCyr"));if("YY"===t)throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(i,"`; see: https://git.io/fxCyr"));if("D"===t)throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(i,"`; see: https://git.io/fxCyr"));if("DD"===t)throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(i,"`; see: https://git.io/fxCyr"))}var dt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ut=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ht=/^'([^]*?)'?$/,pt=/''/g,ft=/[a-zA-Z]/;function mt(t,e){if(null==t)throw new TypeError("assign requires that input parameter not be null or undefined");for(var i in e=e||{})e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function gt(t,o,s){i(2,arguments);var a=s||{},r=a.locale,l=r&&r.options&&r.options.weekStartsOn,c=null==l?0:e(l),d=null==a.weekStartsOn?c:e(a.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=n(t),h=e(o),p=((h%7+7)%7<d?7:0)+h-u.getUTCDay();return u.setUTCDate(u.getUTCDate()+p),u}var vt=/^(1[0-2]|0?\d)/,bt=/^(3[0-1]|[0-2]?\d)/,yt=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,_t=/^(5[0-3]|[0-4]?\d)/,wt=/^(2[0-3]|[0-1]?\d)/,xt=/^(2[0-4]|[0-1]?\d)/,kt=/^(1[0-1]|0?\d)/,St=/^(1[0-2]|0?\d)/,Tt=/^[0-5]?\d/,Ct=/^[0-5]?\d/,Dt=/^\d/,Mt=/^\d{1,2}/,Ot=/^\d{1,3}/,Pt=/^\d{1,4}/,Et=/^-?\d+/,At=/^-?\d/,It=/^-?\d{1,2}/,Lt=/^-?\d{1,3}/,Nt=/^-?\d{1,4}/,jt=/^([+-])(\d{2})(\d{2})?|Z/,Rt=/^([+-])(\d{2})(\d{2})|Z/,$t=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Bt=/^([+-])(\d{2}):(\d{2})|Z/,Ft=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Ht(t,e,i){var n=e.match(t);if(!n)return null;var o=parseInt(n[0],10);return{value:i?i(o):o,rest:e.slice(n[0].length)}}function Wt(t,e){var i=e.match(t);return i?"Z"===i[0]?{value:0,rest:e.slice(1)}:{value:("+"===i[1]?1:-1)*(36e5*(i[2]?parseInt(i[2],10):0)+6e4*(i[3]?parseInt(i[3],10):0)+1e3*(i[5]?parseInt(i[5],10):0)),rest:e.slice(i[0].length)}:null}function Ut(t,e){return Ht(Et,t,e)}function qt(t,e,i){switch(t){case 1:return Ht(Dt,e,i);case 2:return Ht(Mt,e,i);case 3:return Ht(Ot,e,i);case 4:return Ht(Pt,e,i);default:return Ht(new RegExp("^\\d{1,"+t+"}"),e,i)}}function zt(t,e,i){switch(t){case 1:return Ht(At,e,i);case 2:return Ht(It,e,i);case 3:return Ht(Lt,e,i);case 4:return Ht(Nt,e,i);default:return Ht(new RegExp("^-?\\d{1,"+t+"}"),e,i)}}function Vt(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function Yt(t,e){var i,n=e>0,o=n?e:1-e;if(o<=50)i=t||100;else{var s=o+50;i=t+100*Math.floor(s/100)-(t>=s%100?100:0)}return n?i:1-i}var Gt=[31,28,31,30,31,30,31,31,30,31,30,31],Kt=[31,29,31,30,31,30,31,31,30,31,30,31];function Xt(t){return t%400==0||t%4==0&&t%100!=0}var Jt={G:{priority:140,parse:function(t,e,i,n){switch(e){case"G":case"GG":case"GGG":return i.era(t,{width:"abbreviated"})||i.era(t,{width:"narrow"});case"GGGGG":return i.era(t,{width:"narrow"});default:return i.era(t,{width:"wide"})||i.era(t,{width:"abbreviated"})||i.era(t,{width:"narrow"})}},set:function(t,e,i,n){return e.era=i,t.setUTCFullYear(i,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(t,e,i,n){var o=function(t){return{year:t,isTwoDigitYear:"yy"===e}};switch(e){case"y":return qt(4,t,o);case"yo":return i.ordinalNumber(t,{unit:"year",valueCallback:o});default:return qt(e.length,t,o)}},validate:function(t,e,i){return e.isTwoDigitYear||e.year>0},set:function(t,e,i,n){var o=t.getUTCFullYear();if(i.isTwoDigitYear){var s=Yt(i.year,o);return t.setUTCFullYear(s,0,1),t.setUTCHours(0,0,0,0),t}var a="era"in e&&1!==e.era?1-i.year:i.year;return t.setUTCFullYear(a,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(t,e,i,n){var o=function(t){return{year:t,isTwoDigitYear:"YY"===e}};switch(e){case"Y":return qt(4,t,o);case"Yo":return i.ordinalNumber(t,{unit:"year",valueCallback:o});default:return qt(e.length,t,o)}},validate:function(t,e,i){return e.isTwoDigitYear||e.year>0},set:function(t,e,i,n){var o=V(t,n);if(i.isTwoDigitYear){var s=Yt(i.year,o);return t.setUTCFullYear(s,0,n.firstWeekContainsDate),t.setUTCHours(0,0,0,0),z(t,n)}var a="era"in e&&1!==e.era?1-i.year:i.year;return t.setUTCFullYear(a,0,n.firstWeekContainsDate),t.setUTCHours(0,0,0,0),z(t,n)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(t,e,i,n){return zt("R"===e?4:e.length,t)},set:function(t,e,i,n){var o=new Date(0);return o.setUTCFullYear(i,0,4),o.setUTCHours(0,0,0,0),H(o)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(t,e,i,n){return zt("u"===e?4:e.length,t)},set:function(t,e,i,n){return t.setUTCFullYear(i,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(t,e,i,n){switch(e){case"Q":case"QQ":return qt(e.length,t);case"Qo":return i.ordinalNumber(t,{unit:"quarter"});case"QQQ":return i.quarter(t,{width:"abbreviated",context:"formatting"})||i.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(t,{width:"narrow",context:"formatting"});default:return i.quarter(t,{width:"wide",context:"formatting"})||i.quarter(t,{width:"abbreviated",context:"formatting"})||i.quarter(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,i){return e>=1&&e<=4},set:function(t,e,i,n){return t.setUTCMonth(3*(i-1),1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(t,e,i,n){switch(e){case"q":case"qq":return qt(e.length,t);case"qo":return i.ordinalNumber(t,{unit:"quarter"});case"qqq":return i.quarter(t,{width:"abbreviated",context:"standalone"})||i.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(t,{width:"narrow",context:"standalone"});default:return i.quarter(t,{width:"wide",context:"standalone"})||i.quarter(t,{width:"abbreviated",context:"standalone"})||i.quarter(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,i){return e>=1&&e<=4},set:function(t,e,i,n){return t.setUTCMonth(3*(i-1),1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(t,e,i,n){var o=function(t){return t-1};switch(e){case"M":return Ht(vt,t,o);case"MM":return qt(2,t,o);case"Mo":return i.ordinalNumber(t,{unit:"month",valueCallback:o});case"MMM":return i.month(t,{width:"abbreviated",context:"formatting"})||i.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(t,{width:"narrow",context:"formatting"});default:return i.month(t,{width:"wide",context:"formatting"})||i.month(t,{width:"abbreviated",context:"formatting"})||i.month(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,i){return e>=0&&e<=11},set:function(t,e,i,n){return t.setUTCMonth(i,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(t,e,i,n){var o=function(t){return t-1};switch(e){case"L":return Ht(vt,t,o);case"LL":return qt(2,t,o);case"Lo":return i.ordinalNumber(t,{unit:"month",valueCallback:o});case"LLL":return i.month(t,{width:"abbreviated",context:"standalone"})||i.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(t,{width:"narrow",context:"standalone"});default:return i.month(t,{width:"wide",context:"standalone"})||i.month(t,{width:"abbreviated",context:"standalone"})||i.month(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,i){return e>=0&&e<=11},set:function(t,e,i,n){return t.setUTCMonth(i,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(t,e,i,n){switch(e){case"w":return Ht(_t,t);case"wo":return i.ordinalNumber(t,{unit:"week"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=1&&e<=53},set:function(t,o,s,a){return z(function(t,o,s){i(2,arguments);var a=n(t),r=e(o),l=K(a,s)-r;return a.setUTCDate(a.getUTCDate()-7*l),a}(t,s,a),a)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(t,e,i,n){switch(e){case"I":return Ht(_t,t);case"Io":return i.ordinalNumber(t,{unit:"week"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=1&&e<=53},set:function(t,o,s,a){return H(function(t,o){i(2,arguments);var s=n(t),a=e(o),r=q(s)-a;return s.setUTCDate(s.getUTCDate()-7*r),s}(t,s,a),a)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(t,e,i,n){switch(e){case"d":return Ht(bt,t);case"do":return i.ordinalNumber(t,{unit:"date"});default:return qt(e.length,t)}},validate:function(t,e,i){var n=Xt(t.getUTCFullYear()),o=t.getUTCMonth();return n?e>=1&&e<=Kt[o]:e>=1&&e<=Gt[o]},set:function(t,e,i,n){return t.setUTCDate(i),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(t,e,i,n){switch(e){case"D":case"DD":return Ht(yt,t);case"Do":return i.ordinalNumber(t,{unit:"date"});default:return qt(e.length,t)}},validate:function(t,e,i){return Xt(t.getUTCFullYear())?e>=1&&e<=366:e>=1&&e<=365},set:function(t,e,i,n){return t.setUTCMonth(0,i),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(t,e,i,n){switch(e){case"E":case"EE":case"EEE":return i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});default:return i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,i){return e>=0&&e<=6},set:function(t,e,i,n){return(t=gt(t,i,n)).setUTCHours(0,0,0,0),t},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(t,e,i,n){var o=function(t){var e=7*Math.floor((t-1)/7);return(t+n.weekStartsOn+6)%7+e};switch(e){case"e":case"ee":return qt(e.length,t,o);case"eo":return i.ordinalNumber(t,{unit:"day",valueCallback:o});case"eee":return i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"eeeee":return i.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});default:return i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,i){return e>=0&&e<=6},set:function(t,e,i,n){return(t=gt(t,i,n)).setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(t,e,i,n){var o=function(t){var e=7*Math.floor((t-1)/7);return(t+n.weekStartsOn+6)%7+e};switch(e){case"c":case"cc":return qt(e.length,t,o);case"co":return i.ordinalNumber(t,{unit:"day",valueCallback:o});case"ccc":return i.day(t,{width:"abbreviated",context:"standalone"})||i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"});case"ccccc":return i.day(t,{width:"narrow",context:"standalone"});case"cccccc":return i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"});default:return i.day(t,{width:"wide",context:"standalone"})||i.day(t,{width:"abbreviated",context:"standalone"})||i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,i){return e>=0&&e<=6},set:function(t,e,i,n){return(t=gt(t,i,n)).setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(t,e,i,n){var o=function(t){return 0===t?7:t};switch(e){case"i":case"ii":return qt(e.length,t);case"io":return i.ordinalNumber(t,{unit:"day"});case"iii":return i.day(t,{width:"abbreviated",context:"formatting",valueCallback:o})||i.day(t,{width:"short",context:"formatting",valueCallback:o})||i.day(t,{width:"narrow",context:"formatting",valueCallback:o});case"iiiii":return i.day(t,{width:"narrow",context:"formatting",valueCallback:o});case"iiiiii":return i.day(t,{width:"short",context:"formatting",valueCallback:o})||i.day(t,{width:"narrow",context:"formatting",valueCallback:o});default:return i.day(t,{width:"wide",context:"formatting",valueCallback:o})||i.day(t,{width:"abbreviated",context:"formatting",valueCallback:o})||i.day(t,{width:"short",context:"formatting",valueCallback:o})||i.day(t,{width:"narrow",context:"formatting",valueCallback:o})}},validate:function(t,e,i){return e>=1&&e<=7},set:function(t,o,s,a){return t=function(t,o){i(2,arguments);var s=e(o);s%7==0&&(s-=7);var a=n(t),r=((s%7+7)%7<1?7:0)+s-a.getUTCDay();return a.setUTCDate(a.getUTCDate()+r),a}(t,s,a),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(t,e,i,n){switch(e){case"a":case"aa":case"aaa":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(t,{width:"narrow",context:"formatting"});default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,i,n){return t.setUTCHours(Vt(i),0,0,0),t},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(t,e,i,n){switch(e){case"b":case"bb":case"bbb":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(t,{width:"narrow",context:"formatting"});default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,i,n){return t.setUTCHours(Vt(i),0,0,0),t},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(t,e,i,n){switch(e){case"B":case"BB":case"BBB":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(t,{width:"narrow",context:"formatting"});default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,i,n){return t.setUTCHours(Vt(i),0,0,0),t},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(t,e,i,n){switch(e){case"h":return Ht(St,t);case"ho":return i.ordinalNumber(t,{unit:"hour"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=1&&e<=12},set:function(t,e,i,n){var o=t.getUTCHours()>=12;return o&&i<12?t.setUTCHours(i+12,0,0,0):o||12!==i?t.setUTCHours(i,0,0,0):t.setUTCHours(0,0,0,0),t},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(t,e,i,n){switch(e){case"H":return Ht(wt,t);case"Ho":return i.ordinalNumber(t,{unit:"hour"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=0&&e<=23},set:function(t,e,i,n){return t.setUTCHours(i,0,0,0),t},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(t,e,i,n){switch(e){case"K":return Ht(kt,t);case"Ko":return i.ordinalNumber(t,{unit:"hour"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=0&&e<=11},set:function(t,e,i,n){return t.getUTCHours()>=12&&i<12?t.setUTCHours(i+12,0,0,0):t.setUTCHours(i,0,0,0),t},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(t,e,i,n){switch(e){case"k":return Ht(xt,t);case"ko":return i.ordinalNumber(t,{unit:"hour"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=1&&e<=24},set:function(t,e,i,n){var o=i<=24?i%24:i;return t.setUTCHours(o,0,0,0),t},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(t,e,i,n){switch(e){case"m":return Ht(Tt,t);case"mo":return i.ordinalNumber(t,{unit:"minute"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=0&&e<=59},set:function(t,e,i,n){return t.setUTCMinutes(i,0,0),t},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(t,e,i,n){switch(e){case"s":return Ht(Ct,t);case"so":return i.ordinalNumber(t,{unit:"second"});default:return qt(e.length,t)}},validate:function(t,e,i){return e>=0&&e<=59},set:function(t,e,i,n){return t.setUTCSeconds(i,0),t},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(t,e,i,n){return qt(e.length,t,(function(t){return Math.floor(t*Math.pow(10,3-e.length))}))},set:function(t,e,i,n){return t.setUTCMilliseconds(i),t},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(t,e,i,n){switch(e){case"X":return Wt(jt,t);case"XX":return Wt(Rt,t);case"XXXX":return Wt($t,t);case"XXXXX":return Wt(Ft,t);default:return Wt(Bt,t)}},set:function(t,e,i,n){return e.timestampIsSet?t:new Date(t.getTime()-i)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(t,e,i,n){switch(e){case"x":return Wt(jt,t);case"xx":return Wt(Rt,t);case"xxxx":return Wt($t,t);case"xxxxx":return Wt(Ft,t);default:return Wt(Bt,t)}},set:function(t,e,i,n){return e.timestampIsSet?t:new Date(t.getTime()-i)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(t,e,i,n){return Ut(t)},set:function(t,e,i,n){return[new Date(1e3*i),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(t,e,i,n){return Ut(t)},set:function(t,e,i,n){return[new Date(i),{timestampIsSet:!0}]},incompatibleTokens:"*"}},Qt=Jt,Zt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,te=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ee=/^'([^]*?)'?$/,ie=/''/g,ne=/\S/,oe=/[a-zA-Z]/;function se(t,e){if(e.timestampIsSet)return t;var i=new Date(0);return i.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),i.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),i}function ae(t){return t.match(ee)[1].replace(ie,"'")}var re=36e5,le={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ce=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,de=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ue=/^([+-])(\d{2})(?::?(\d{2}))?$/;function he(t){return t?parseInt(t):1}function pe(t){return t&&parseFloat(t.replace(",","."))||0}var fe=[31,null,31,30,31,30,31,31,30,31,30,31];function me(t){return t%400==0||t%4==0&&t%100}const ge={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};t._adapters._date.override({_id:"date-fns",formats:function(){return ge},parse:function(t,o){if(null==t)return null;const s=typeof t;return"number"===s||t instanceof Date?t=n(t):"string"===s&&(t="string"==typeof o?function(t,o,s,a){i(3,arguments);var r=String(t),l=String(o),d=a||{},u=d.locale||O;if(!u.match)throw new RangeError("locale must contain match property");var h=u.options&&u.options.firstWeekContainsDate,p=null==h?1:e(h),f=null==d.firstWeekContainsDate?p:e(d.firstWeekContainsDate);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=u.options&&u.options.weekStartsOn,g=null==m?0:e(m),v=null==d.weekStartsOn?g:e(d.weekStartsOn);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===l)return""===r?n(s):new Date(NaN);var b,y={firstWeekContainsDate:f,weekStartsOn:v,locale:u},_=[{priority:10,subPriority:-1,set:se,index:0}],w=l.match(te).map((function(t){var e=t[0];return"p"===e||"P"===e?(0,ot[e])(t,u.formatLong,y):t})).join("").match(Zt),x=[];for(b=0;b<w.length;b++){var k=w[b];!d.useAdditionalWeekYearTokens&&lt(k)&&ct(k,l,t),!d.useAdditionalDayOfYearTokens&&rt(k)&&ct(k,l,t);var S=k[0],T=Qt[S];if(T){var C=T.incompatibleTokens;if(Array.isArray(C)){for(var D=void 0,M=0;M<x.length;M++){var E=x[M].token;if(-1!==C.indexOf(E)||E===S){D=x[M];break}}if(D)throw new RangeError("The format string mustn't contain `".concat(D.fullToken,"` and `").concat(k,"` at the same time"))}else if("*"===T.incompatibleTokens&&x.length)throw new RangeError("The format string mustn't contain `".concat(k,"` and any other token at the same time"));x.push({token:S,fullToken:k});var A=T.parse(r,k,u.match,y);if(!A)return new Date(NaN);_.push({priority:T.priority,subPriority:T.subPriority||0,set:T.set,validate:T.validate,value:A.value,index:_.length}),r=A.rest}else{if(S.match(oe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");if("''"===k?k="'":"'"===S&&(k=ae(k)),0!==r.indexOf(k))return new Date(NaN);r=r.slice(k.length)}}if(r.length>0&&ne.test(r))return new Date(NaN);var I=_.map((function(t){return t.priority})).sort((function(t,e){return e-t})).filter((function(t,e,i){return i.indexOf(t)===e})).map((function(t){return _.filter((function(e){return e.priority===t})).sort((function(t,e){return e.subPriority-t.subPriority}))})).map((function(t){return t[0]})),L=n(s);if(isNaN(L))return new Date(NaN);var N=P(L,c(L)),j={};for(b=0;b<I.length;b++){var R=I[b];if(R.validate&&!R.validate(N,R.value,y))return new Date(NaN);var $=R.set(N,j,R.value,y);$[0]?(N=$[0],mt(j,$[1])):N=$}return N}(t,o,new Date,this.options):function(t,n){i(1,arguments);var o=n||{},s=null==o.additionalDigits?2:e(o.additionalDigits);if(2!==s&&1!==s&&0!==s)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof t&&"[object String]"!==Object.prototype.toString.call(t))return new Date(NaN);var a,r=function(t){var e,i={},n=t.split(le.dateTimeDelimiter);if(n.length>2)return i;if(/:/.test(n[0])?(i.date=null,e=n[0]):(i.date=n[0],e=n[1],le.timeZoneDelimiter.test(i.date)&&(i.date=t.split(le.timeZoneDelimiter)[0],e=t.substr(i.date.length,t.length))),e){var o=le.timezone.exec(e);o?(i.time=e.replace(o[1],""),i.timezone=o[1]):i.time=e}return i}(t);if(r.date){var l=function(t,e){var i=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=t.match(i);if(!n)return{year:null};var o=n[1]&&parseInt(n[1]),s=n[2]&&parseInt(n[2]);return{year:null==s?o:100*s,restDateString:t.slice((n[1]||n[2]).length)}}(r.date,s);a=function(t,e){if(null===e)return null;var i=t.match(ce);if(!i)return null;var n=!!i[4],o=he(i[1]),s=he(i[2])-1,a=he(i[3]),r=he(i[4]),l=he(i[5])-1;if(n)return function(t,e,i){return e>=1&&e<=53&&i>=0&&i<=6}(0,r,l)?function(t,e,i){var n=new Date(0);n.setUTCFullYear(t,0,4);var o=7*(e-1)+i+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+o),n}(e,r,l):new Date(NaN);var c=new Date(0);return function(t,e,i){return e>=0&&e<=11&&i>=1&&i<=(fe[e]||(me(t)?29:28))}(e,s,a)&&function(t,e){return e>=1&&e<=(me(t)?366:365)}(e,o)?(c.setUTCFullYear(e,s,Math.max(o,a)),c):new Date(NaN)}(l.restDateString,l.year)}if(isNaN(a)||!a)return new Date(NaN);var c,d=a.getTime(),u=0;if(r.time&&(u=function(t){var e=t.match(de);if(!e)return null;var i=pe(e[1]),n=pe(e[2]),o=pe(e[3]);return function(t,e,i){return 24===t?0===e&&0===i:i>=0&&i<60&&e>=0&&e<60&&t>=0&&t<25}(i,n,o)?i*re+6e4*n+1e3*o:NaN}(r.time),isNaN(u)||null===u))return new Date(NaN);if(!r.timezone){var h=new Date(d+u),p=new Date(0);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return c=function(t){if("Z"===t)return 0;var e=t.match(ue);if(!e)return 0;var i="+"===e[1]?-1:1,n=parseInt(e[2]),o=e[3]&&parseInt(e[3])||0;return function(t,e){return e>=0&&e<=59}(0,o)?i*(n*re+6e4*o):NaN}(r.timezone),isNaN(c)?new Date(NaN):new Date(d+u+c)}(t,this.options)),f(t)?t.getTime():null},format:function(t,o){return function(t,o,s){i(2,arguments);var a=String(o),r=s||{},l=r.locale||O,d=l.options&&l.options.firstWeekContainsDate,u=null==d?1:e(d),h=null==r.firstWeekContainsDate?u:e(r.firstWeekContainsDate);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=l.options&&l.options.weekStartsOn,m=null==p?0:e(p),g=null==r.weekStartsOn?m:e(r.weekStartsOn);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!l.localize)throw new RangeError("locale must contain localize property");if(!l.formatLong)throw new RangeError("locale must contain formatLong property");var v=n(t);if(!f(v))throw new RangeError("Invalid time value");var b=P(v,c(v)),y={firstWeekContainsDate:h,weekStartsOn:g,locale:l,_originalDate:v},_=a.match(ut).map((function(t){var e=t[0];return"p"===e||"P"===e?(0,ot[e])(t,l.formatLong,y):t})).join("").match(dt).map((function(e){if("''"===e)return"'";var i=e[0];if("'"===i)return function(t){return t.match(ht)[1].replace(pt,"'")}(e);var n=tt[i];if(n)return!r.useAdditionalWeekYearTokens&&lt(e)&&ct(e,o,t),!r.useAdditionalDayOfYearTokens&&rt(e)&&ct(e,o,t),n(b,e,l.localize,y);if(i.match(ft))throw new RangeError("Format string contains an unescaped latin alphabet character `"+i+"`");return e})).join("");return _}(t,o,this.options)},add:function(t,n,l){switch(l){case"millisecond":return a(t,n);case"second":return function(t,n){return i(2,arguments),a(t,1e3*e(n))}(t,n);case"minute":return function(t,n){return i(2,arguments),a(t,6e4*e(n))}(t,n);case"hour":return function(t,n){return i(2,arguments),a(t,e(n)*r)}(t,n);case"day":return o(t,n);case"week":return function(t,n){return i(2,arguments),o(t,7*e(n))}(t,n);case"month":return s(t,n);case"quarter":return function(t,n){return i(2,arguments),s(t,3*e(n))}(t,n);case"year":return function(t,n){return i(2,arguments),s(t,12*e(n))}(t,n);default:return t}},diff:function(t,e,o){switch(o){case"millisecond":return v(t,e);case"second":return function(t,e){i(2,arguments);var n=v(t,e)/1e3;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"minute":return function(t,e){i(2,arguments);var n=v(t,e)/6e4;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"hour":return function(t,e){i(2,arguments);var n=v(t,e)/b;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"day":return g(t,e);case"week":return function(t,e){i(2,arguments);var n=g(t,e)/7;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"month":return w(t,e);case"quarter":return function(t,e){i(2,arguments);var n=w(t,e)/3;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"year":return function(t,e){i(2,arguments);var o=n(t),s=n(e),a=p(o,s),r=Math.abs(function(t,e){i(2,arguments);var o=n(t),s=n(e);return o.getFullYear()-s.getFullYear()}(o,s));o.setFullYear("1584"),s.setFullYear("1584");var l=a*(r-(p(o,s)===-a));return 0===l?0:l}(t,e);default:return 0}},startOf:function(t,e,o){switch(e){case"second":return function(t){i(1,arguments);var e=n(t);return e.setMilliseconds(0),e}(t);case"minute":return function(t){i(1,arguments);var e=n(t);return e.setSeconds(0,0),e}(t);case"hour":return function(t){i(1,arguments);var e=n(t);return e.setMinutes(0,0,0),e}(t);case"day":return d(t);case"week":return l(t);case"isoWeek":return l(t,{weekStartsOn:+o});case"month":return function(t){i(1,arguments);var e=n(t);return e.setDate(1),e.setHours(0,0,0,0),e}(t);case"quarter":return function(t){i(1,arguments);var e=n(t),o=e.getMonth(),s=o-o%3;return e.setMonth(s,1),e.setHours(0,0,0,0),e}(t);case"year":return function(t){i(1,arguments);var e=n(t),o=new Date(0);return o.setFullYear(e.getFullYear(),0,1),o.setHours(0,0,0,0),o}(t);default:return t}},endOf:function(t,o){switch(o){case"second":return function(t){i(1,arguments);var e=n(t);return e.setMilliseconds(999),e}(t);case"minute":return function(t){i(1,arguments);var e=n(t);return e.setSeconds(59,999),e}(t);case"hour":return function(t){i(1,arguments);var e=n(t);return e.setMinutes(59,59,999),e}(t);case"day":return y(t);case"week":return function(t,o){i(1,arguments);var s=o||{},a=s.locale,r=a&&a.options&&a.options.weekStartsOn,l=null==r?0:e(r),c=null==s.weekStartsOn?l:e(s.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=n(t),u=d.getDay(),h=6+(u<c?-7:0)-(u-c);return d.setDate(d.getDate()+h),d.setHours(23,59,59,999),d}(t);case"month":return _(t);case"quarter":return function(t){i(1,arguments);var e=n(t),o=e.getMonth(),s=o-o%3+3;return e.setMonth(s,0),e.setHours(23,59,59,999),e}(t);case"year":return function(t){i(1,arguments);var e=n(t),o=e.getFullYear();return e.setFullYear(o+1,0,0),e.setHours(23,59,59,999),e}(t);default:return t}}})})),function(t,e,i){"function"==typeof define&&define.amd?define(["jquery"],(function(n){return i(n,t,e),n.mobile})):i(t.jQuery,t,e)}(this,document,(function(t,e,i){!function(t){t.mobile={}}(t),function(t,e){function n(e,i){var n,s,a,r=e.nodeName.toLowerCase();return"area"===r?(s=(n=e.parentNode).name,!(!e.href||!s||"map"!==n.nodeName.toLowerCase())&&(!!(a=t("img[usemap=#"+s+"]")[0])&&o(a))):(/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r&&e.href||i)&&o(e)}function o(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter((function(){return"hidden"===t.css(this,"visibility")})).length}var s=0,a=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each((function(){var e=this;setTimeout((function(){t(e).focus(),n&&n.call(e)}),i)})):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter((function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))})).eq(0):this.parents().filter((function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))})).eq(0),/fixed/.test(this.css("position"))||!e.length?t(this[0].ownerDocument||i):e},uniqueId:function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++s)}))},removeUniqueId:function(){return this.each((function(){a.test(this.id)&&t(this).removeAttr("id")}))}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo((function(e){return function(i){return!!t.data(i,e)}})):function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return n(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var i=t.attr(e,"tabindex"),o=isNaN(i);return(o||i>=0)&&n(e,!o)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],(function(i,n){function o(e,i,n,o){return t.each(s,(function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)})),i}var s="Width"===n?["Left","Right"]:["Top","Bottom"],a=n.toLowerCase(),r={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(i){return i===e?r["inner"+n].call(this):this.each((function(){t(this).css(a,o(this,i)+"px")}))},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?r["outer"+n].call(this,e):this.each((function(){t(this).css(a,o(this,e,!0,i)+"px")}))}})),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in i.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",(function(t){t.preventDefault()}))},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(n){if(n!==e)return this.css("zIndex",n);if(this.length)for(var o,s,a=t(this[0]);a.length&&a[0]!==i;){if(("absolute"===(o=a.css("position"))||"relative"===o||"fixed"===o)&&(s=parseInt(a.css("zIndex"),10),!isNaN(s)&&0!==s))return s;a=a.parent()}return 0}}),t.ui.plugin={add:function(e,i,n){var o,s=t.ui[e].prototype;for(o in n)s.plugins[o]=s.plugins[o]||[],s.plugins[o].push([i,n[o]])},call:function(t,e,i,n){var o,s=t.plugins[e];if(s&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(o=0;o<s.length;o++)t.options[s[o][0]]&&s[o][1].apply(t.element,i)}}}(t),function(t,e){t.extend(t.mobile,{window:t(e),document:t(i),keyCode:t.ui.keyCode,behaviors:{},silentScroll:function(i){"number"!==t.type(i)&&(i=t.mobile.defaultHomeScroll),t.event.special.scrollstart.enabled=!1,setTimeout((function(){e.scrollTo(0,i),t.mobile.document.trigger("silentscroll",{x:0,y:i})}),20),setTimeout((function(){t.event.special.scrollstart.enabled=!0}),150)},getClosestBaseUrl:function(e){var i=t(e).closest(".ui-page").jqmData("url"),n=t.mobile.path.documentBase.hrefNoHash;return t.mobile.dynamicBaseEnabled&&i&&t.mobile.path.isPath(i)||(i=n),t.mobile.path.makeUrlAbsolute(i,n)},removeActiveLinkClass:function(e){!t.mobile.activeClickedLink||t.mobile.activeClickedLink.closest("."+t.mobile.activePageClass).length&&!e||t.mobile.activeClickedLink.removeClass(t.mobile.activeBtnClass),t.mobile.activeClickedLink=null},getInheritedTheme:function(t,e){for(var i,n,o=t[0],s="",a=/ui-(bar|body|overlay)-([a-z])\b/;o&&!((i=o.className||"")&&(n=a.exec(i))&&(s=n[2]));)o=o.parentNode;return s||e||"a"},enhanceable:function(t){return this.haveParents(t,"enhance")},hijackable:function(t){return this.haveParents(t,"ajax")},haveParents:function(e,i){if(!t.mobile.ignoreContentEnabled)return e;var n,o,s,a,r=e.length,l=t();for(a=0;r>a;a++){for(o=e.eq(a),s=!1,n=e[a];n;){if("false"===(n.getAttribute?n.getAttribute("data-"+t.mobile.ns+i):"")){s=!0;break}n=n.parentNode}s||(l=l.add(o))}return l},getScreenHeight:function(){return e.innerHeight||t.mobile.window.height()},resetActivePageHeight:function(e){var i=t("."+t.mobile.activePageClass),n=i.height(),o=i.outerHeight(!0);e=function(e,i){var n=e.parent(),o=[],s=function(){var e=t(this),i=t.mobile.toolbar&&e.data("mobile-toolbar")?e.toolbar("option"):{position:e.attr("data-"+t.mobile.ns+"position"),updatePagePadding:!1!==e.attr("data-"+t.mobile.ns+"update-page-padding")};return!("fixed"===i.position&&!0===i.updatePagePadding)},a=n.children(":jqmData(role='header')").filter(s),r=e.children(":jqmData(role='header')"),l=n.children(":jqmData(role='footer')").filter(s),c=e.children(":jqmData(role='footer')");return 0===r.length&&a.length>0&&(o=o.concat(a.toArray())),0===c.length&&l.length>0&&(o=o.concat(l.toArray())),t.each(o,(function(e,n){i-=t(n).outerHeight()})),Math.max(0,i)}(i,"number"==typeof e?e:t.mobile.getScreenHeight()),i.css("min-height",""),i.height()<e&&i.css("min-height",e-(o-n))},loading:function(){var e=this.loading._widget||t(t.mobile.loader.prototype.defaultHtml).loader(),i=e.loader.apply(e,arguments);return this.loading._widget=e,i}}),t.addDependents=function(e,i){var n=t(e),o=n.jqmData("dependents")||t();n.jqmData("dependents",t(o).add(i))},t.fn.extend({removeWithDependents:function(){t.removeWithDependents(this)},enhanceWithin:function(){var e,i={},n=t.mobile.page.prototype.keepNativeSelector(),o=this;for(e in t.mobile.nojs&&t.mobile.nojs(this),t.mobile.links&&t.mobile.links(this),t.mobile.degradeInputsWithin&&t.mobile.degradeInputsWithin(this),t.fn.buttonMarkup&&this.find(t.fn.buttonMarkup.initSelector).not(n).jqmEnhanceable().buttonMarkup(),t.fn.fieldcontain&&this.find(":jqmData(role='fieldcontain')").not(n).jqmEnhanceable().fieldcontain(),t.each(t.mobile.widgets,(function(e,s){if(s.initSelector){var a=t.mobile.enhanceable(o.find(s.initSelector));a.length>0&&(a=a.not(n)),a.length>0&&(i[s.prototype.widgetName]=a)}})),i)i[e][e]();return this},addDependents:function(e){t.addDependents(this,e)},getEncodedText:function(){return t("<a>").text(this.text()).html()},jqmEnhanceable:function(){return t.mobile.enhanceable(this)},jqmHijackable:function(){return t.mobile.hijackable(this)}}),t.removeWithDependents=function(e){var i=t(e);(i.jqmData("dependents")||t()).remove(),i.remove()},t.addDependents=function(e,i){var n=t(e),o=n.jqmData("dependents")||t();n.jqmData("dependents",t(o).add(i))},t.find.matches=function(e,i){return t.find(e,null,null,i)},t.find.matchesSelector=function(e,i){return t.find(i,null,null,[e]).length>0}}(t,this),function(t){t.extend(t.mobile,{version:"1.4.5",subPageUrlKey:"ui-page",hideUrlBar:!0,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"a",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:!0,pageContainer:t(),allowCrossDomainPages:!1,dialogHashKey:"&ui-state=dialog"})}(t),function(t,e){var i=0,n=Array.prototype.slice,o=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(t){}o(e)},t.widget=function(e,i,n){var o,s,a,r,l={},c=e.split(".")[0];return e=e.split(".")[1],o=c+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][o.toLowerCase()]=function(e){return!!t.data(e,o)},t[c]=t[c]||{},s=t[c][e],a=t[c][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,s,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),(r=new i).options=t.widget.extend({},r.options),t.each(n,(function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},o=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,s=this._superApply;return this._super=t,this._superApply=o,e=n.apply(this,arguments),this._super=i,this._superApply=s,e}}()):void(l[e]=n)})),a.prototype=t.widget.extend(r,{widgetEventPrefix:s&&r.widgetEventPrefix||e},l,{constructor:a,namespace:c,widgetName:e,widgetFullName:o}),s?(t.each(s._childConstructors,(function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,a,i._proto)})),delete s._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(i){for(var o,s,a=n.call(arguments,1),r=0,l=a.length;l>r;r++)for(o in a[r])s=a[r][o],a[r].hasOwnProperty(o)&&s!==e&&(i[o]=t.isPlainObject(s)?t.isPlainObject(i[o])?t.widget.extend({},i[o],s):t.widget.extend({},s):s);return i},t.widget.bridge=function(i,o){var s=o.prototype.widgetFullName||i;t.fn[i]=function(a){var r="string"==typeof a,l=n.call(arguments,1),c=this;return a=!r&&l.length?t.widget.extend.apply(null,[a].concat(l)):a,this.each(r?function(){var n,o=t.data(this,s);return"instance"===a?(c=o,!1):o?t.isFunction(o[a])&&"_"!==a.charAt(0)?(n=o[a].apply(o,l))!==o&&n!==e?(c=n&&n.jquery?c.pushStack(n.get()):n,!1):void 0:t.error("no such method '"+a+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+a+"'")}:function(){var e=t.data(this,s);e?e.option(a||{})._init():t.data(this,s,new o(a,this))}),c}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var o,s,a,r=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(r={},o=i.split("."),i=o.shift(),o.length){for(s=r[i]=t.widget.extend({},this.options[i]),a=0;a<o.length-1;a++)s[o[a]]=s[o[a]]||{},s=s[o[a]];if(i=o.pop(),n===e)return s[i]===e?null:s[i];s[i]=n}else{if(n===e)return this.options[i]===e?null:this.options[i];r[i]=n}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,n){var o,s=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=o=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),t.each(n,(function(n,a){function r(){return e||!0!==s.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?s[a]:a).apply(s,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+s.eventNamespace,d=l[2];d?o.delegate(d,c,r):i.bind(c,r)}))},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){var i=this;return setTimeout((function(){return("string"==typeof t?i[t]:t).apply(i,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var o,s,a=this.options[e];if(n=n||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(o in s)o in i||(i[o]=s[o]);return this.element.trigger(i,n),!(t.isFunction(a)&&!1===a.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,i){t.Widget.prototype["_"+e]=function(n,o,s){"string"==typeof o&&(o={effect:o});var a,r=o?!0===o||"number"==typeof o?i:o.effect||i:e;"number"==typeof(o=o||{})&&(o={duration:o}),a=!t.isEmptyObject(o),o.complete=s,o.delay&&n.delay(o.delay),a&&t.effects&&t.effects.effect[r]?n[e](o):r!==e&&n[r]?n[r](o.duration,o.easing,s):n.queue((function(i){t(this)[e](),s&&s.call(n[0]),i()}))}}))}(t),function(t,e,i){var n={},o=t.find,s=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,a=/:jqmData\(([^)]*)\)/g;t.extend(t.mobile,{ns:"",getAttribute:function(e,i){var n;(e=e.jquery?e[0]:e)&&e.getAttribute&&(n=e.getAttribute("data-"+t.mobile.ns+i));try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:s.test(n)?JSON.parse(n):n)}catch(t){}return n},nsNormalizeDict:n,nsNormalize:function(e){return n[e]||(n[e]=t.camelCase(t.mobile.ns+e))},closestPageData:function(t){return t.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),t.fn.jqmData=function(e,n){var o;return void 0!==e&&(e&&(e=t.mobile.nsNormalize(e)),o=arguments.length<2||n===i?this.data(e):this.data(e,n)),o},t.jqmData=function(e,i,n){var o;return void 0!==i&&(o=t.data(e,i?t.mobile.nsNormalize(i):i,n)),o},t.fn.jqmRemoveData=function(e){return this.removeData(t.mobile.nsNormalize(e))},t.jqmRemoveData=function(e,i){return t.removeData(e,t.mobile.nsNormalize(i))},t.find=function(e,i,n,s){return e.indexOf(":jqmData")>-1&&(e=e.replace(a,"[data-"+(t.mobile.ns||"")+"$1]")),o.call(this,e,i,n,s)},t.extend(t.find,o)}(t),function(t){var e=/[A-Z]/g,i=function(t){return"-"+t.toLowerCase()};t.extend(t.Widget.prototype,{_getCreateOptions:function(){var n,o,s=this.element[0],a={};if(!t.mobile.getAttribute(s,"defaults"))for(n in this.options)null!=(o=t.mobile.getAttribute(s,n.replace(e,i)))&&(a[n]=o);return a}}),t.mobile.widget=t.Widget}(t),function(t){var e="ui-loader",i=t("html");t.widget("mobile.loader",{options:{theme:"a",textVisible:!1,html:"",text:"loading"},defaultHtml:"<div class='"+e+"'><span class='ui-icon-loading'></span><h1></h1></div>",fakeFixLoader:function(){var e=t("."+t.mobile.activeBtnClass).first();this.element.css({top:t.support.scrollTop&&this.window.scrollTop()+this.window.height()/2||e.length&&e.offset().top||100})},checkLoaderPosition:function(){var e=this.element.offset(),i=this.window.scrollTop(),n=t.mobile.getScreenHeight();(e.top<i||e.top-i>n)&&(this.element.addClass("ui-loader-fakefix"),this.fakeFixLoader(),this.window.unbind("scroll",this.checkLoaderPosition).bind("scroll",t.proxy(this.fakeFixLoader,this)))},resetHtml:function(){this.element.html(t(this.defaultHtml).html())},show:function(n,o,s){var a,r,l;this.resetHtml(),"object"===t.type(n)?n=(l=t.extend({},this.options,n)).theme:(l=this.options,n=n||l.theme),r=o||(!1===l.text?"":l.text),i.addClass("ui-loading"),a=l.textVisible,this.element.attr("class",e+" ui-corner-all ui-body-"+n+" ui-loader-"+(a||o||n.text?"verbose":"default")+(l.textonly||s?" ui-loader-textonly":"")),l.html?this.element.html(l.html):this.element.find("h1").text(r),this.element.appendTo(t(t.mobile.pagecontainer?":mobile-pagecontainer":"body")),this.checkLoaderPosition(),this.window.bind("scroll",t.proxy(this.checkLoaderPosition,this))},hide:function(){i.removeClass("ui-loading"),this.options.text&&this.element.removeClass("ui-loader-fakefix"),this.window.unbind("scroll",this.fakeFixLoader),this.window.unbind("scroll",this.checkLoaderPosition)}})}(t),function(t,e,n){function o(t){return"#"+(t=t||location.href).replace(/^[^#]*#?(.*)$/,"$1")}var s,a="hashchange",r=i,l=t.event.special,c=r.documentMode,d="on"+a in e&&(c===n||c>7);t.fn[a]=function(t){return t?this.bind(a,t):this.trigger(a)},t.fn[a].delay=50,l[a]=t.extend(l[a],{setup:function(){return!d&&void t(s.start)},teardown:function(){return!d&&void t(s.stop)}}),s=function(){function i(){var n=o(),r=p(c);n!==c?(h(c=n,r),t(e).trigger(a)):r!==c&&(location.href=location.href.replace(/#.*/,"")+r),s=setTimeout(i,t.fn[a].delay)}var s,l={},c=o(),u=function(t){return t},h=u,p=u;return l.start=function(){s||i()},l.stop=function(){s&&clearTimeout(s),s=n},e.attachEvent&&!e.addEventListener&&!d&&function(){var e,n;l.start=function(){e||(n=(n=t.fn[a].src)&&n+o(),e=t('<iframe tabindex="-1" title="empty"/>').hide().one("load",(function(){n||h(o()),i()})).attr("src",n||"javascript:0").insertAfter("body")[0].contentWindow,r.onpropertychange=function(){try{"title"===event.propertyName&&(e.document.title=r.title)}catch(t){}})},l.stop=u,p=function(){return o(e.location.href)},h=function(i,n){var o=e.document,s=t.fn[a].domain;i!==n&&(o.title=r.title,o.open(),s&&o.write('<script>document.domain="'+s+'"<\/script>'),o.close(),e.location.hash=i)}}(),l}()}(t,this),function(t){e.matchMedia=e.matchMedia||function(t){var e,i=t.documentElement,n=i.firstElementChild||i.firstChild,o=t.createElement("body"),s=t.createElement("div");return s.id="mq-test-1",s.style.cssText="position:absolute;top:-100em",o.style.background="none",o.appendChild(s),function(t){return s.innerHTML='&shy;<style media="'+t+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(o,n),e=42===s.offsetWidth,i.removeChild(o),{matches:e,media:t}}}(i),t.mobile.media=function(t){return e.matchMedia(t).matches}}(t),function(t){var e={touch:"ontouchend"in i};t.mobile.support=t.mobile.support||{},t.extend(t.support,e),t.extend(t.mobile.support,e)}(t),function(t){t.extend(t.support,{orientation:"orientation"in e&&"onorientationchange"in e})}(t),function(t,n){function o(t){var e,i=t.charAt(0).toUpperCase()+t.substr(1),o=(t+" "+l.join(i+" ")+i).split(" ");for(e in o)if(r[o[e]]!==n)return!0}var s,a=t("<body>").prependTo("html"),r=a[0].style,l=["Webkit","Moz","O"],c="palmGetResource"in e,d=e.operamini&&"[object OperaMini]"==={}.toString.call(e.operamini),u=e.blackberry&&!o("-webkit-transform");t.extend(t.mobile,{browser:{}}),t.mobile.browser.oldIE=function(){var t=3,e=i.createElement("div"),n=e.all||[];do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><br><![endif]--\x3e"}while(n[0]);return t>4?t:!t}(),t.extend(t.support,{pushState:"pushState"in history&&"replaceState"in history&&!(e.navigator.userAgent.indexOf("Firefox")>=0&&e.top!==e)&&-1===e.navigator.userAgent.search(/CriOS/),mediaquery:t.mobile.media("only all"),cssPseudoElement:!!o("content"),touchOverflow:!!o("overflowScrolling"),cssTransform3d:function(){var o,s,r,c="transform-3d",d=t.mobile.media("(-"+l.join("-"+c+"),(-")+"-"+c+"),("+c+")");if(d)return!!d;for(r in o=i.createElement("div"),s={MozTransform:"-moz-transform",transform:"transform"},a.append(o),s)o.style[r]!==n&&(o.style[r]="translate3d( 100px, 1px, 1px )",d=e.getComputedStyle(o).getPropertyValue(s[r]));return!!d&&"none"!==d}(),boxShadow:!!o("boxShadow")&&!u,fixedPosition:function(){var t=e,i=navigator.userAgent,n=navigator.platform,o=i.match(/AppleWebKit\/([0-9]+)/),s=!!o&&o[1],a=i.match(/Fennec\/([0-9]+)/),r=!!a&&a[1],l=i.match(/Opera Mobi\/([0-9]+)/),c=!!l&&l[1];return!((n.indexOf("iPhone")>-1||n.indexOf("iPad")>-1||n.indexOf("iPod")>-1)&&s&&534>s||t.operamini&&"[object OperaMini]"==={}.toString.call(t.operamini)||l&&7458>c||i.indexOf("Android")>-1&&s&&533>s||r&&6>r||"palmGetResource"in e&&s&&534>s||i.indexOf("MeeGo")>-1&&i.indexOf("NokiaBrowser/8.5.0")>-1)}(),scrollTop:("pageXOffset"in e||"scrollTop"in i.documentElement||"scrollTop"in a[0])&&!c&&!d,dynamicBaseTag:function(){var e,i=location.protocol+"//"+location.host+location.pathname+"ui-dir/",n=t("head base"),o=null,s="";return n.length?s=n.attr("href"):n=o=t("<base>",{href:i}).appendTo("head"),e=t("<a href='testurl' />").prependTo(a)[0].href,n[0].href=s||location.pathname,o&&o.remove(),0===e.indexOf(i)}(),cssPointerEvents:function(){var t,n=i.createElement("x"),o=i.documentElement,s=e.getComputedStyle;return"pointerEvents"in n.style&&(n.style.pointerEvents="auto",n.style.pointerEvents="x",o.appendChild(n),t=s&&"auto"===s(n,"").pointerEvents,o.removeChild(n),!!t)}(),boundingRect:void 0!==i.createElement("div").getBoundingClientRect,inlineSVG:function(){var i=e,n=!(!i.document.createElementNS||!i.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||i.opera&&-1===navigator.userAgent.indexOf("Chrome")),o=function(e){e&&n||t("html").addClass("ui-nosvg")},s=new i.Image;s.onerror=function(){o(!1)},s.onload=function(){o(1===s.width&&1===s.height)},s.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}}),a.remove(),s=function(){var t=e.navigator.userAgent;return t.indexOf("Nokia")>-1&&(t.indexOf("Symbian/3")>-1||t.indexOf("Series60/5")>-1)&&t.indexOf("AppleWebKit")>-1&&t.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/)}(),t.mobile.gradeA=function(){return(t.support.mediaquery&&t.support.cssPseudoElement||t.mobile.browser.oldIE&&t.mobile.browser.oldIE>=8)&&(t.support.boundingRect||null!==t.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/))},t.mobile.ajaxBlacklist=e.blackberry&&!e.WebKitPoint||d||s,s&&t((function(){t("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")})),t.support.boxShadow||t("html").addClass("ui-noboxshadow")}(t),function(t,e){var i,n=t.mobile.window,o=function(){};t.event.special.beforenavigate={setup:function(){n.on("navigate",o)},teardown:function(){n.off("navigate",o)}},t.event.special.navigate=i={bound:!1,pushStateEnabled:!0,originalEventName:void 0,isPushStateEnabled:function(){return t.support.pushState&&!0===t.mobile.pushStateEnabled&&this.isHashChangeEnabled()},isHashChangeEnabled:function(){return!0===t.mobile.hashListeningEnabled},popstate:function(e){var i=new t.Event("navigate"),o=new t.Event("beforenavigate"),s=e.originalEvent.state||{};o.originalEvent=e,n.trigger(o),o.isDefaultPrevented()||(e.historyState&&t.extend(s,e.historyState),i.originalEvent=e,setTimeout((function(){n.trigger(i,{state:s})}),0))},hashchange:function(e){var i=new t.Event("navigate"),o=new t.Event("beforenavigate");o.originalEvent=e,n.trigger(o),o.isDefaultPrevented()||(i.originalEvent=e,n.trigger(i,{state:e.hashchangeState||{}}))},setup:function(){i.bound||(i.bound=!0,i.isPushStateEnabled()?(i.originalEventName="popstate",n.bind("popstate.navigate",i.popstate)):i.isHashChangeEnabled()&&(i.originalEventName="hashchange",n.bind("hashchange.navigate",i.hashchange)))}}}(t),function(t,i){var n,o,s="&ui-state=dialog";t.mobile.path=n={uiStateKey:"&ui-state",urlParseRE:/^\s*(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,getLocation:function(t){var e=this.parseUrl(t||location.href),i=t?e:location,n=e.hash;return n="#"===n?"":n,i.protocol+e.doubleSlash+i.host+(""!==i.protocol&&"/"!==i.pathname.substring(0,1)?"/":"")+i.pathname+i.search+n},getDocumentUrl:function(e){return e?t.extend({},n.documentUrl):n.documentUrl.href},parseLocation:function(){return this.parseUrl(this.getLocation())},parseUrl:function(e){if("object"===t.type(e))return e;var i=n.urlParseRE.exec(e||"")||[];return{href:i[0]||"",hrefNoHash:i[1]||"",hrefNoSearch:i[2]||"",domain:i[3]||"",protocol:i[4]||"",doubleSlash:i[5]||"",authority:i[6]||"",username:i[8]||"",password:i[9]||"",host:i[10]||"",hostname:i[11]||"",port:i[12]||"",pathname:i[13]||"",directory:i[14]||"",filename:i[15]||"",search:i[16]||"",hash:i[17]||""}},makePathAbsolute:function(t,e){var i,n,o,s;if(t&&"/"===t.charAt(0))return t;for(t=t||"",i=(e=e?e.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"")?e.split("/"):[],n=t.split("/"),o=0;o<n.length;o++)switch(s=n[o]){case".":break;case"..":i.length&&i.pop();break;default:i.push(s)}return"/"+i.join("/")},isSameDomain:function(t,e){return n.parseUrl(t).domain.toLowerCase()===n.parseUrl(e).domain.toLowerCase()},isRelativeUrl:function(t){return""===n.parseUrl(t).protocol},isAbsoluteUrl:function(t){return""!==n.parseUrl(t).protocol},makeUrlAbsolute:function(t,e){if(!n.isRelativeUrl(t))return t;e===i&&(e=this.documentBase);var o=n.parseUrl(t),s=n.parseUrl(e),a=o.protocol||s.protocol,r=o.protocol?o.doubleSlash:o.doubleSlash||s.doubleSlash,l=o.authority||s.authority,c=""!==o.pathname;return a+r+l+n.makePathAbsolute(o.pathname||s.filename,s.pathname)+(o.search||!c&&s.search||"")+o.hash},addSearchParams:function(e,i){var o=n.parseUrl(e),s="object"==typeof i?t.param(i):i,a=o.search||"?";return o.hrefNoSearch+a+("?"!==a.charAt(a.length-1)?"&":"")+s+(o.hash||"")},convertUrlToDataUrl:function(t){var i=t,o=n.parseUrl(t);return n.isEmbeddedPage(o)?i=o.hash.split(s)[0].replace(/^#/,"").replace(/\?.*$/,""):n.isSameDomain(o,this.documentBase)&&(i=o.hrefNoHash.replace(this.documentBase.domain,"").split(s)[0]),e.decodeURIComponent(i)},get:function(t){return t===i&&(t=n.parseLocation().hash),n.stripHash(t).replace(/[^\/]*\.[^\/*]+$/,"")},set:function(t){location.hash=t},isPath:function(t){return/\//.test(t)},clean:function(t){return t.replace(this.documentBase.domain,"")},stripHash:function(t){return t.replace(/^#/,"")},stripQueryParams:function(t){return t.replace(/\?.*$/,"")},cleanHash:function(t){return n.stripHash(t.replace(/\?.*$/,"").replace(s,""))},isHashValid:function(t){return/^#[^#]+$/.test(t)},isExternal:function(t){var e=n.parseUrl(t);return!(!e.protocol||e.domain.toLowerCase()===this.documentUrl.domain.toLowerCase())},hasProtocol:function(t){return/^(:?\w+:)/.test(t)},isEmbeddedPage:function(t){var e=n.parseUrl(t);return""!==e.protocol?!this.isPath(e.hash)&&e.hash&&(e.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&e.hrefNoHash===this.documentBase.hrefNoHash):/^#/.test(e.href)},squash:function(t,e){var i,o,s,a,r,l=this.isPath(t),c=this.parseUrl(t),d=c.hash,u="";return e||(l?e=n.getLocation():(r=n.getDocumentUrl(!0),e=n.isPath(r.hash)?n.squash(r.href):r.href)),o=l?n.stripHash(t):t,(a=(o=n.isPath(c.hash)?n.stripHash(c.hash):o).indexOf(this.uiStateKey))>-1&&(u=o.slice(a),o=o.slice(0,a)),i=n.makeUrlAbsolute(o,e),s=this.parseUrl(i).search,l?((n.isPath(d)||0===d.replace("#","").indexOf(this.uiStateKey))&&(d=""),u&&-1===d.indexOf(this.uiStateKey)&&(d+=u),-1===d.indexOf("#")&&""!==d&&(d="#"+d),i=(i=n.parseUrl(i)).protocol+i.doubleSlash+i.host+i.pathname+s+d):i+=i.indexOf("#")>-1?u:"#"+u,i},isPreservableHash:function(t){return 0===t.replace("#","").indexOf(this.uiStateKey)},hashToSelector:function(t){var e="#"===t.substring(0,1);return e&&(t=t.substring(1)),(e?"#":"")+t.replace(/([!"#$%&'()*+,./:;<=>?@[\]^`{|}~])/g,"\\$1")},getFilePath:function(t){return t&&t.split(s)[0]},isFirstPageUrl:function(e){var o=n.parseUrl(n.makeUrlAbsolute(e,this.documentBase)),s=o.hrefNoHash===this.documentUrl.hrefNoHash||this.documentBaseDiffers&&o.hrefNoHash===this.documentBase.hrefNoHash,a=t.mobile.firstPage,r=a&&a[0]?a[0].id:i;return s&&(!o.hash||"#"===o.hash||r&&o.hash.replace(/^#/,"")===r)},isPermittedCrossDomainRequest:function(e,i){return t.mobile.allowCrossDomainPages&&("file:"===e.protocol||"content:"===e.protocol)&&-1!==i.search(/^https?:/)}},n.documentUrl=n.parseLocation(),o=t("head").find("base"),n.documentBase=o.length?n.parseUrl(n.makeUrlAbsolute(o.attr("href"),n.documentUrl.href)):n.documentUrl,n.documentBaseDiffers=n.documentUrl.hrefNoHash!==n.documentBase.hrefNoHash,n.getDocumentBase=function(e){return e?t.extend({},n.documentBase):n.documentBase.href},t.extend(t.mobile,{getDocumentUrl:n.getDocumentUrl,getDocumentBase:n.getDocumentBase})}(t),function(t,e){t.mobile.History=function(t,e){this.stack=t||[],this.activeIndex=e||0},t.extend(t.mobile.History.prototype,{getActive:function(){return this.stack[this.activeIndex]},getLast:function(){return this.stack[this.previousIndex]},getNext:function(){return this.stack[this.activeIndex+1]},getPrev:function(){return this.stack[this.activeIndex-1]},add:function(t,e){e=e||{},this.getNext()&&this.clearForward(),e.hash&&-1===e.hash.indexOf("#")&&(e.hash="#"+e.hash),e.url=t,this.stack.push(e),this.activeIndex=this.stack.length-1},clearForward:function(){this.stack=this.stack.slice(0,this.activeIndex+1)},find:function(t,e,i){var n,o,s,a=(e=e||this.stack).length;for(o=0;a>o;o++)if(n=e[o],(decodeURIComponent(t)===decodeURIComponent(n.url)||decodeURIComponent(t)===decodeURIComponent(n.hash))&&(s=o,i))return s;return s},closest:function(t){var i,n=this.activeIndex;return(i=this.find(t,this.stack.slice(0,n)))===e&&(i=(i=this.find(t,this.stack.slice(n),!0))===e?i:i+n),i},direct:function(i){var n=this.closest(i.url),o=this.activeIndex;n!==e&&(this.activeIndex=n,this.previousIndex=o),o>n?(i.present||i.back||t.noop)(this.getActive(),"back"):n>o?(i.present||i.forward||t.noop)(this.getActive(),"forward"):n===e&&i.missing&&i.missing(this.getActive())}})}(t),function(t){var n=t.mobile.path,o=location.href;t.mobile.Navigator=function(e){this.history=e,this.ignoreInitialHashChange=!0,t.mobile.window.bind({"popstate.history":t.proxy(this.popstate,this),"hashchange.history":t.proxy(this.hashchange,this)})},t.extend(t.mobile.Navigator.prototype,{squash:function(o,s){var a,r,l=n.isPath(o)?n.stripHash(o):o;return r=n.squash(o),a=t.extend({hash:l,url:r},s),e.history.replaceState(a,a.title||i.title,r),a},hash:function(t,e){var i,o,s,a;return i=n.parseUrl(t),(o=n.parseLocation()).pathname+o.search===i.pathname+i.search?s=i.hash?i.hash:i.pathname+i.search:n.isPath(t)?s=(a=n.parseUrl(e)).pathname+a.search+(n.isPreservableHash(a.hash)?a.hash.replace("#",""):""):s=t,s},go:function(o,s,a){var r,l,c,d,u=t.event.special.navigate.isPushStateEnabled();l=n.squash(o),c=this.hash(o,l),a&&c!==n.stripHash(n.parseLocation().hash)&&(this.preventNextHashChange=a),this.preventHashAssignPopState=!0,e.location.hash=c,this.preventHashAssignPopState=!1,r=t.extend({url:l,hash:c,title:i.title},s),u&&((d=new t.Event("popstate")).originalEvent={type:"popstate",state:null},this.squash(o,r),a||(this.ignorePopState=!0,t.mobile.window.trigger(d))),this.history.add(r.url,r)},popstate:function(e){var i,s;if(t.event.special.navigate.isPushStateEnabled())return this.preventHashAssignPopState?(this.preventHashAssignPopState=!1,void e.stopImmediatePropagation()):this.ignorePopState?void(this.ignorePopState=!1):!e.originalEvent.state&&1===this.history.stack.length&&this.ignoreInitialHashChange&&(this.ignoreInitialHashChange=!1,location.href===o)?void e.preventDefault():(i=n.parseLocation().hash,!e.originalEvent.state&&i?(s=this.squash(i),this.history.add(s.url,s),void(e.historyState=s)):void this.history.direct({url:(e.originalEvent.state||{}).url||i,present:function(i,n){e.historyState=t.extend({},i),e.historyState.direction=n}}))},hashchange:function(e){var o,s;if(t.event.special.navigate.isHashChangeEnabled()&&!t.event.special.navigate.isPushStateEnabled()){if(this.preventNextHashChange)return this.preventNextHashChange=!1,void e.stopImmediatePropagation();o=this.history,s=n.parseLocation().hash,this.history.direct({url:s,present:function(i,n){e.hashchangeState=t.extend({},i),e.hashchangeState.direction=n},missing:function(){o.add(s,{hash:s,title:i.title})}})}}})}(t),function(t){t.mobile.navigate=function(e,i,n){t.mobile.navigate.navigator.go(e,i,n)},t.mobile.navigate.history=new t.mobile.History,t.mobile.navigate.navigator=new t.mobile.Navigator(t.mobile.navigate.history);var e=t.mobile.path.parseLocation();t.mobile.navigate.history.add(e.href,{hash:e.hash})}(t),function(t,e){var n={animation:{},transition:{}},o=i.createElement("a"),s=["","webkit-","moz-","o-"];t.each(["animation","transition"],(function(i,a){var r=0===i?a+"-name":a;t.each(s,(function(i,s){return o.style[t.camelCase(s+r)]!==e?(n[a].prefix=s,!1):void 0})),n[a].duration=t.camelCase(n[a].prefix+a+"-duration"),n[a].event=t.camelCase(n[a].prefix+a+"-end"),""===n[a].prefix&&(n[a].event=n[a].event.toLowerCase())})),t.support.cssTransitions=n.transition.prefix!==e,t.support.cssAnimations=n.animation.prefix!==e,t(o).remove(),t.fn.animationComplete=function(o,s,a){var r,l,c=this,d=function(){clearTimeout(r),o.apply(this,arguments)},u=s&&"animation"!==s?"transition":"animation";return t.support.cssTransitions&&"transition"===u||t.support.cssAnimations&&"animation"===u?(a===e&&(t(this).context!==i&&(l=3e3*parseFloat(t(this).css(n[u].duration))),(0===l||l===e||isNaN(l))&&(l=t.fn.animationComplete.defaultDuration)),r=setTimeout((function(){t(c).off(n[u].event,d),o.apply(c)}),l),t(this).one(n[u].event,d)):(setTimeout(t.proxy(o,this),0),t(this))},t.fn.animationComplete.defaultDuration=1e3}(t),function(t,e,i,n){function o(t){for(;t&&void 0!==t.originalEvent;)t=t.originalEvent;return t}function s(e,i){var s,a,r,l,c,d,u,h,p,f=e.type;if((e=t.Event(e)).type=i,s=e.originalEvent,a=t.event.props,f.search(/^(mouse|click)/)>-1&&(a=D),s)for(u=a.length;u;)e[l=a[--u]]=s[l];if(f.search(/mouse(down|up)|click/)>-1&&!e.which&&(e.which=1),-1!==f.search(/^touch/)&&(f=(r=o(s)).touches,c=r.changedTouches,d=f&&f.length?f[0]:c&&c.length?c[0]:n))for(h=0,p=T.length;p>h;h++)e[l=T[h]]=d[l];return e}function a(e){for(var i,n,o={};e;){for(n in i=t.data(e,x))i[n]&&(o[n]=o.hasVirtualBinding=!0);e=e.parentNode}return o}function r(){N=!0}function l(){N=!1}function c(){d(),O=setTimeout((function(){O=0,B=0,I.length=0,L=!1,r()}),t.vmouse.resetTimerDuration)}function d(){O&&(clearTimeout(O),O=0)}function u(e,i,n){var o;return(n&&n[e]||!n&&function(e,i){for(var n;e;){if((n=t.data(e,x))&&(!i||n[i]))return e;e=e.parentNode}return null}(i.target,e))&&(o=s(i,e),t(i.target).trigger(o)),o}function h(e){var i,n=t.data(e.target,k);L||B&&B===n||(i=u("v"+e.type,e))&&(i.isDefaultPrevented()&&e.preventDefault(),i.isPropagationStopped()&&e.stopPropagation(),i.isImmediatePropagationStopped()&&e.stopImmediatePropagation())}function p(e){var i,n,s,r=o(e).touches;r&&1===r.length&&((n=a(i=e.target)).hasVirtualBinding&&(B=$++,t.data(i,k,B),d(),l(),A=!1,s=o(e).touches[0],P=s.pageX,E=s.pageY,u("vmouseover",e,n),u("vmousedown",e,n)))}function f(t){N||(A||u("vmousecancel",t,a(t.target)),A=!0,c())}function m(e){if(!N){var i=o(e).touches[0],n=A,s=t.vmouse.moveDistanceThreshold,r=a(e.target);(A=A||Math.abs(i.pageX-P)>s||Math.abs(i.pageY-E)>s)&&!n&&u("vmousecancel",e,r),u("vmousemove",e,r),c()}}function g(t){if(!N){r();var e,i,n=a(t.target);u("vmouseup",t,n),A||(e=u("vclick",t,n))&&e.isDefaultPrevented()&&(i=o(t).changedTouches[0],I.push({touchID:B,x:i.clientX,y:i.clientY}),L=!0),u("vmouseout",t,n),A=!1,c()}}function v(e){var i,n=t.data(e,x);if(n)for(i in n)if(n[i])return!0;return!1}function b(){}function y(e){var i=e.substr(1);return{setup:function(){v(this)||t.data(this,x,{}),t.data(this,x)[e]=!0,M[e]=(M[e]||0)+1,1===M[e]&&R.bind(i,h),t(this).bind(i,b),j&&(M.touchstart=(M.touchstart||0)+1,1===M.touchstart&&R.bind("touchstart",p).bind("touchend",g).bind("touchmove",m).bind("scroll",f))},teardown:function(){--M[e],M[e]||R.unbind(i,h),j&&(--M.touchstart,M.touchstart||R.unbind("touchstart",p).unbind("touchmove",m).unbind("touchend",g).unbind("scroll",f));var n=t(this),o=t.data(this,x);o&&(o[e]=!1),n.unbind(i,b),v(this)||n.removeData(x)}}}var _,w,x="virtualMouseBindings",k="virtualTouchID",S="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),T="clientX clientY pageX pageY screenX screenY".split(" "),C=t.event.mouseHooks?t.event.mouseHooks.props:[],D=t.event.props.concat(C),M={},O=0,P=0,E=0,A=!1,I=[],L=!1,N=!1,j="addEventListener"in i,R=t(i),$=1,B=0;for(t.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},w=0;w<S.length;w++)t.event.special[S[w]]=y(S[w]);j&&i.addEventListener("click",(function(e){var i,n,o,s,a,r=I.length,l=e.target;if(r)for(i=e.clientX,n=e.clientY,_=t.vmouse.clickDistanceThreshold,o=l;o;){for(s=0;r>s;s++)if(a=I[s],0,o===l&&Math.abs(a.x-i)<_&&Math.abs(a.y-n)<_||t.data(o,k)===a.touchID)return e.preventDefault(),void e.stopPropagation();o=o.parentNode}}),!0)}(t,0,i),function(t,e,n){function o(e,i,o,s){var a=o.type;o.type=i,s?t.event.trigger(o,n,e):t.event.dispatch.call(e,o),o.type=a}var s=t(i),a=t.mobile.support.touch,r="touchmove scroll",l=a?"touchstart":"mousedown",c=a?"touchend":"mouseup",d=a?"touchmove":"mousemove";t.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),(function(e,i){t.fn[i]=function(t){return t?this.bind(i,t):this.trigger(i)},t.attrFn&&(t.attrFn[i]=!0)})),t.event.special.scrollstart={enabled:!0,setup:function(){function e(t,e){o(s,(i=e)?"scrollstart":"scrollstop",t)}var i,n,s=this;t(s).bind(r,(function(o){t.event.special.scrollstart.enabled&&(i||e(o,!0),clearTimeout(n),n=setTimeout((function(){e(o,!1)}),50))}))},teardown:function(){t(this).unbind(r)}},t.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var e=this,i=t(e),n=!1;i.bind("vmousedown",(function(a){function r(){clearTimeout(d)}function l(){r(),i.unbind("vclick",c).unbind("vmouseup",r),s.unbind("vmousecancel",l)}function c(t){l(),n||u!==t.target?n&&t.preventDefault():o(e,"tap",t)}if(n=!1,a.which&&1!==a.which)return!1;var d,u=a.target;i.bind("vmouseup",r).bind("vclick",c),s.bind("vmousecancel",l),d=setTimeout((function(){t.event.special.tap.emitTapOnTaphold||(n=!0),o(e,"taphold",t.Event("taphold",{target:u}))}),t.event.special.tap.tapholdThreshold)}))},teardown:function(){t(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),s.unbind("vmousecancel")}},t.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(t){var i=e.pageXOffset,n=e.pageYOffset,o=t.clientX,s=t.clientY;return 0===t.pageY&&Math.floor(s)>Math.floor(t.pageY)||0===t.pageX&&Math.floor(o)>Math.floor(t.pageX)?(o-=i,s-=n):(s<t.pageY-n||o<t.pageX-i)&&(o=t.pageX-i,s=t.pageY-n),{x:o,y:s}},start:function(e){var i=e.originalEvent.touches?e.originalEvent.touches[0]:e,n=t.event.special.swipe.getLocation(i);return{time:(new Date).getTime(),coords:[n.x,n.y],origin:t(e.target)}},stop:function(e){var i=e.originalEvent.touches?e.originalEvent.touches[0]:e,n=t.event.special.swipe.getLocation(i);return{time:(new Date).getTime(),coords:[n.x,n.y]}},handleSwipe:function(e,i,n,s){if(i.time-e.time<t.event.special.swipe.durationThreshold&&Math.abs(e.coords[0]-i.coords[0])>t.event.special.swipe.horizontalDistanceThreshold&&Math.abs(e.coords[1]-i.coords[1])<t.event.special.swipe.verticalDistanceThreshold){var a=e.coords[0]>i.coords[0]?"swipeleft":"swiperight";return o(n,"swipe",t.Event("swipe",{target:s,swipestart:e,swipestop:i}),!0),o(n,a,t.Event(a,{target:s,swipestart:e,swipestop:i}),!0),!0}return!1},eventInProgress:!1,setup:function(){var e,i=this,n=t(i),o={};(e=t.data(this,"mobile-events"))||(e={length:0},t.data(this,"mobile-events",e)),e.length++,e.swipe=o,o.start=function(e){if(!t.event.special.swipe.eventInProgress){t.event.special.swipe.eventInProgress=!0;var n,a=t.event.special.swipe.start(e),r=e.target,l=!1;o.move=function(e){a&&!e.isDefaultPrevented()&&(n=t.event.special.swipe.stop(e),l||(l=t.event.special.swipe.handleSwipe(a,n,i,r))&&(t.event.special.swipe.eventInProgress=!1),Math.abs(a.coords[0]-n.coords[0])>t.event.special.swipe.scrollSupressionThreshold&&e.preventDefault())},o.stop=function(){l=!0,t.event.special.swipe.eventInProgress=!1,s.off(d,o.move),o.move=null},s.on(d,o.move).one(c,o.stop)}},n.on(l,o.start)},teardown:function(){var e,i;(e=t.data(this,"mobile-events"))&&(i=e.swipe,delete e.swipe,e.length--,0===e.length&&t.removeData(this,"mobile-events")),i&&(i.start&&t(this).off(l,i.start),i.move&&s.off(d,i.move),i.stop&&s.off(c,i.stop))}},t.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},(function(e,i){t.event.special[e]={setup:function(){t(this).bind(i,t.noop)},teardown:function(){t(this).unbind(i)}}}))}(t,this),function(t){t.event.special.throttledresize={setup:function(){t(this).bind("resize",o)},teardown:function(){t(this).unbind("resize",o)}};var e,i,n,o=function(){i=(new Date).getTime(),(n=i-s)>=250?(s=i,t(this).trigger("throttledresize")):(e&&clearTimeout(e),e=setTimeout(o,250-n))},s=0}(t),function(t,e){function n(){var t=o();t!==s&&(s=t,d.trigger(u))}var o,s,a,r,l,c,d=t(e),u="orientationchange",h={0:!0,180:!0};t.support.orientation&&(50,a=(l=e.innerWidth||d.width())>(c=e.innerHeight||d.height())&&l-c>50,r=h[e.orientation],(a&&r||!a&&!r)&&(h={"-90":!0,90:!0})),t.event.special.orientationchange=t.extend({},t.event.special.orientationchange,{setup:function(){return!(t.support.orientation&&!t.event.special.orientationchange.disabled)&&(s=o(),void d.bind("throttledresize",n))},teardown:function(){return!(t.support.orientation&&!t.event.special.orientationchange.disabled)&&void d.unbind("throttledresize",n)},add:function(t){var e=t.handler;t.handler=function(t){return t.orientation=o(),e.apply(this,arguments)}}}),t.event.special.orientationchange.orientation=o=function(){var n=i.documentElement;return(t.support.orientation?h[e.orientation]:n&&n.clientWidth/n.clientHeight<1.1)?"portrait":"landscape"},t.fn[u]=function(t){return t?this.bind(u,t):this.trigger(u)},t.attrFn&&(t.attrFn[u]=!0)}(t,this),function(t){var e=t("head").children("base"),i={element:e.length?e:t("<base>",{href:t.mobile.path.documentBase.hrefNoHash}).prependTo(t("head")),linkSelector:"[src], link[href], a[rel='external'], :jqmData(ajax='false'), a[target]",set:function(e){t.mobile.dynamicBaseEnabled&&t.support.dynamicBaseTag&&i.element.attr("href",t.mobile.path.makeUrlAbsolute(e,t.mobile.path.documentBase))},rewrite:function(e,n){var o=t.mobile.path.get(e);n.find(i.linkSelector).each((function(e,i){var n=t(i).is("[href]")?"href":t(i).is("[src]")?"src":"action",s=t.mobile.path.parseLocation(),a=t(i).attr(n);a=a.replace(s.protocol+s.doubleSlash+s.host+s.pathname,""),/^(\w+:|#|\/)/.test(a)||t(i).attr(n,o+a)}))},reset:function(){i.element.attr("href",t.mobile.path.documentBase.hrefNoSearch)}};t.mobile.base=i}(t),function(t,e){t.mobile.widgets={};var i=t.widget,n=t.mobile.keepNative;t.widget=function(i){return function(){var n=i.apply(this,arguments),o=n.prototype.widgetName;return n.initSelector=n.prototype.initSelector!==e?n.prototype.initSelector:":jqmData(role='"+o+"')",t.mobile.widgets[o]=n,n}}(t.widget),t.extend(t.widget,i),t.mobile.document.on("create",(function(e){t(e.target).enhanceWithin()})),t.widget("mobile.page",{options:{theme:"a",domCache:!1,keepNativeDefault:t.mobile.keepNative,contentTheme:null,enhanced:!1},_createWidget:function(){t.Widget.prototype._createWidget.apply(this,arguments),this._trigger("init")},_create:function(){return!1!==this._trigger("beforecreate")&&(this.options.enhanced||this._enhance(),this._on(this.element,{pagebeforehide:"removeContainerBackground",pagebeforeshow:"_handlePageBeforeShow"}),this.element.enhanceWithin(),void("dialog"===t.mobile.getAttribute(this.element[0],"role")&&t.mobile.dialog&&this.element.dialog()))},_enhance:function(){var i="data-"+t.mobile.ns,n=this;this.options.role&&this.element.attr("data-"+t.mobile.ns+"role",this.options.role),this.element.attr("tabindex","0").addClass("ui-page ui-page-theme-"+this.options.theme),this.element.find("["+i+"role='content']").each((function(){var o=t(this),s=this.getAttribute(i+"theme")||e;n.options.contentTheme=s||n.options.contentTheme||n.options.dialog&&n.options.theme||"dialog"===n.element.jqmData("role")&&n.options.theme,o.addClass("ui-content"),n.options.contentTheme&&o.addClass("ui-body-"+n.options.contentTheme),o.attr("role","main").addClass("ui-content")}))},bindRemove:function(e){var i=this.element;!i.data("mobile-page").options.domCache&&i.is(":jqmData(external-page='true')")&&i.bind("pagehide.remove",e||function(e,i){if(!i.samePage){var n=t(this),o=new t.Event("pageremove");n.trigger(o),o.isDefaultPrevented()||n.removeWithDependents()}})},_setOptions:function(i){i.theme!==e&&this.element.removeClass("ui-page-theme-"+this.options.theme).addClass("ui-page-theme-"+i.theme),i.contentTheme!==e&&this.element.find("[data-"+t.mobile.ns+"='content']").removeClass("ui-body-"+this.options.contentTheme).addClass("ui-body-"+i.contentTheme)},_handlePageBeforeShow:function(){this.setContainerBackground()},removeContainerBackground:function(){this.element.closest(":mobile-pagecontainer").pagecontainer({theme:"none"})},setContainerBackground:function(t){this.element.parent().pagecontainer({theme:t||this.options.theme})},keepNativeSelector:function(){var e=this.options,i=t.trim(e.keepNative||""),o=t.trim(t.mobile.keepNative),s=t.trim(e.keepNativeDefault),a=n===o?"":o,r=""===a?s:"";return(i?[i]:[]).concat(a?[a]:[]).concat(r?[r]:[]).join(", ")}})}(t),function(t,n){t.widget("mobile.pagecontainer",{options:{theme:"a"},initSelector:!1,_create:function(){this._trigger("beforecreate"),this.setLastScrollEnabled=!0,this._on(this.window,{navigate:"_disableRecordScroll",scrollstop:"_delayedRecordScroll"}),this._on(this.window,{navigate:"_filterNavigateEvents"}),this._on({pagechange:"_afterContentChange"}),this.window.one("navigate",t.proxy((function(){this.setLastScrollEnabled=!0}),this))},_setOptions:function(t){t.theme!==n&&"none"!==t.theme?this.element.removeClass("ui-overlay-"+this.options.theme).addClass("ui-overlay-"+t.theme):t.theme!==n&&this.element.removeClass("ui-overlay-"+this.options.theme),this._super(t)},_disableRecordScroll:function(){this.setLastScrollEnabled=!1},_enableRecordScroll:function(){this.setLastScrollEnabled=!0},_afterContentChange:function(){this.setLastScrollEnabled=!0,this._off(this.window,"scrollstop"),this._on(this.window,{scrollstop:"_delayedRecordScroll"})},_recordScroll:function(){if(this.setLastScrollEnabled){var t,e,i,n=this._getActiveHistory();n&&(t=this._getScroll(),e=this._getMinScroll(),i=this._getDefaultScroll(),n.lastScroll=e>t?i:t)}},_delayedRecordScroll:function(){setTimeout(t.proxy(this,"_recordScroll"),100)},_getScroll:function(){return this.window.scrollTop()},_getMinScroll:function(){return t.mobile.minScrollBack},_getDefaultScroll:function(){return t.mobile.defaultHomeScroll},_filterNavigateEvents:function(e,i){var n;e.originalEvent&&e.originalEvent.isDefaultPrevented()||((n=e.originalEvent.type.indexOf("hashchange")>-1?i.state.hash:i.state.url)||(n=this._getHash()),n&&"#"!==n&&0!==n.indexOf("#"+t.mobile.path.uiStateKey)||(n=location.href),this._handleNavigate(n,i.state))},_getHash:function(){return t.mobile.path.parseLocation().hash},getActivePage:function(){return this.activePage},_getInitialContent:function(){return t.mobile.firstPage},_getHistory:function(){return t.mobile.navigate.history},_getActiveHistory:function(){return this._getHistory().getActive()},_getDocumentBase:function(){return t.mobile.path.documentBase},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(i){if(t.mobile.hashListeningEnabled)e.history.go(i);else{var n=t.mobile.navigate.history.activeIndex,o=n+parseInt(i,10),s=t.mobile.navigate.history.stack[o].url,a=i>=1?"forward":"back";t.mobile.navigate.history.activeIndex=o,t.mobile.navigate.history.previousIndex=n,this.change(s,{direction:a,changeHash:!1,fromHashChange:!0})}},_handleDestination:function(e){return"string"===t.type(e)&&(e=t.mobile.path.stripHash(e)),e&&(this._getHistory(),e=t.mobile.path.isPath(e)?e:t.mobile.path.makeUrlAbsolute("#"+e,this._getDocumentBase())),e||this._getInitialContent()},_transitionFromHistory:function(t,e){var i=this._getHistory(),n="back"===t?i.getLast():i.getActive();return n&&n.transition||e},_handleDialog:function(e,i){var n,o,s=this.getActivePage();return s&&!s.data("mobile-dialog")?("back"===i.direction?this.back():this.forward(),!1):(n=i.pageUrl,o=this._getActiveHistory(),t.extend(e,{role:o.role,transition:this._transitionFromHistory(i.direction,e.transition),reverse:"back"===i.direction}),n)},_handleNavigate:function(e,i){var n=t.mobile.path.stripHash(e),o=this._getHistory(),s=0===o.stack.length?"none":this._transitionFromHistory(i.direction),a={changeHash:!1,fromHashChange:!0,reverse:"back"===i.direction};t.extend(a,i,{transition:s}),o.activeIndex>0&&n.indexOf(t.mobile.dialogHashKey)>-1&&!1===(n=this._handleDialog(a,i))||this._changeContent(this._handleDestination(n),a)},_changeContent:function(e,i){t.mobile.changePage(e,i)},_getBase:function(){return t.mobile.base},_getNs:function(){return t.mobile.ns},_enhance:function(t,e){return t.page({role:e})},_include:function(t,e){t.appendTo(this.element),this._enhance(t,e.role),t.page("bindRemove")},_find:function(e){var i,n=this._createFileUrl(e),o=this._createDataUrl(e),s=this._getInitialContent();return 0===(i=this.element.children("[data-"+this._getNs()+"url='"+t.mobile.path.hashToSelector(o)+"']")).length&&o&&!t.mobile.path.isPath(o)&&(i=this.element.children(t.mobile.path.hashToSelector("#"+o)).attr("data-"+this._getNs()+"url",o).jqmData("url",o)),0===i.length&&t.mobile.path.isFirstPageUrl(n)&&s&&s.parent().length&&(i=t(s)),i},_getLoader:function(){return t.mobile.loading()},_showLoading:function(e,i,n,o){this._loadMsg||(this._loadMsg=setTimeout(t.proxy((function(){this._getLoader().loader("show",i,n,o),this._loadMsg=0}),this),e))},_hideLoading:function(){clearTimeout(this._loadMsg),this._loadMsg=0,this._getLoader().loader("hide")},_showError:function(){this._hideLoading(),this._showLoading(0,t.mobile.pageLoadErrorMessageTheme,t.mobile.pageLoadErrorMessage,!0),setTimeout(t.proxy(this,"_hideLoading"),1500)},_parse:function(e,i){var n,o=t("<div></div>");return o.get(0).innerHTML=e,(n=o.find(":jqmData(role='page'), :jqmData(role='dialog')").first()).length||(n=t("<div data-"+this._getNs()+"role='page'>"+(e.split(/<\/?body[^>]*>/gim)[1]||"")+"</div>")),n.attr("data-"+this._getNs()+"url",this._createDataUrl(i)).attr("data-"+this._getNs()+"external-page",!0),n},_setLoadedTitle:function(e,i){var n=i.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;n&&!e.jqmData("title")&&(n=t("<div>"+n+"</div>").text(),e.jqmData("title",n))},_isRewritableBaseTag:function(){return t.mobile.dynamicBaseEnabled&&!t.support.dynamicBaseTag},_createDataUrl:function(e){return t.mobile.path.convertUrlToDataUrl(e)},_createFileUrl:function(e){return t.mobile.path.getFilePath(e)},_triggerWithDeprecated:function(e,i,n){var o=t.Event("page"+e),s=t.Event(this.widgetName+e);return(n||this.element).trigger(o,i),this._trigger(e,s,i),{deprecatedEvent:o,event:s}},_loadSuccess:function(e,i,o,s){var a=this._createFileUrl(e);return t.proxy((function(r,l,c){var d,u=new RegExp("(<[^>]+\\bdata-"+this._getNs()+"role=[\"']?page[\"']?[^>]*>)"),h=new RegExp("\\bdata-"+this._getNs()+"url=[\"']?([^\"'>]*)[\"']?");u.test(r)&&RegExp.$1&&h.test(RegExp.$1)&&RegExp.$1&&(a=t.mobile.path.getFilePath(t("<div>"+RegExp.$1+"</div>").text()),a=this.window[0].encodeURIComponent(a)),o.prefetch===n&&this._getBase().set(a),d=this._parse(r,a),this._setLoadedTitle(d,r),i.xhr=c,i.textStatus=l,i.page=d,i.content=d,i.toPage=d,this._triggerWithDeprecated("load",i).event.isDefaultPrevented()||(this._isRewritableBaseTag()&&d&&this._getBase().rewrite(a,d),this._include(d,o),o.showLoadMsg&&this._hideLoading(),s.resolve(e,o,d))}),this)},_loadDefaults:{type:"get",data:n,reloadPage:!1,reload:!1,role:n,showLoadMsg:!1,loadMsgDelay:50},load:function(e,i){var o,s,a,r,l,c=i&&i.deferred||t.Deferred(),d=i&&i.reload===n&&i.reloadPage!==n?{reload:i.reloadPage}:{},u=t.extend({},this._loadDefaults,i,d),h=t.mobile.path.makeUrlAbsolute(e,this._findBaseWithDefault());return u.data&&"get"===u.type&&(h=t.mobile.path.addSearchParams(h,u.data),u.data=n),u.data&&"post"===u.type&&(u.reload=!0),o=this._createFileUrl(h),s=this._createDataUrl(h),0===(l=this._find(h)).length&&t.mobile.path.isEmbeddedPage(o)&&!t.mobile.path.isFirstPageUrl(o)?(c.reject(h,u),c.promise()):(this._getBase().reset(),l.length&&!u.reload?(this._enhance(l,u.role),c.resolve(h,u,l),u.prefetch||this._getBase().set(e),c.promise()):(r={url:e,absUrl:h,toPage:e,prevPage:i?i.fromPage:n,dataUrl:s,deferred:c,options:u},(a=this._triggerWithDeprecated("beforeload",r)).deprecatedEvent.isDefaultPrevented()||a.event.isDefaultPrevented()?c.promise():(u.showLoadMsg&&this._showLoading(u.loadMsgDelay),u.prefetch===n&&this._getBase().reset(),t.mobile.allowCrossDomainPages||t.mobile.path.isSameDomain(t.mobile.path.documentUrl,h)?(t.ajax({url:o,type:u.type,data:u.data,contentType:u.contentType,dataType:"html",success:this._loadSuccess(h,r,u,c),error:this._loadError(h,r,u,c)}),c.promise()):(c.reject(h,u),c.promise()))))},_loadError:function(e,i,n,o){return t.proxy((function(s,a,r){this._getBase().set(t.mobile.path.get()),i.xhr=s,i.textStatus=a,i.errorThrown=r;var l=this._triggerWithDeprecated("loadfailed",i);l.deprecatedEvent.isDefaultPrevented()||l.event.isDefaultPrevented()||(n.showLoadMsg&&this._showError(),o.reject(e,n))}),this)},_getTransitionHandler:function(e){return e=t.mobile._maybeDegradeTransition(e),t.mobile.transitionHandlers[e]||t.mobile.defaultTransitionHandler},_triggerCssTransitionEvents:function(e,i,n){var o=!1;n=n||"",i&&(e[0]===i[0]&&(o=!0),this._triggerWithDeprecated(n+"hide",{nextPage:e,toPage:e,prevPage:i,samePage:o},i)),this._triggerWithDeprecated(n+"show",{prevPage:i||t(""),toPage:e},e)},_cssTransition:function(e,i,n){var o,s=n.transition,a=n.reverse,r=n.deferred;this._triggerCssTransitionEvents(e,i,"before"),this._hideLoading(),(o=new(this._getTransitionHandler(s))(s,a,e,i).transition()).done(t.proxy((function(){this._triggerCssTransitionEvents(e,i)}),this)),o.done((function(){r.resolve.apply(r,arguments)}))},_releaseTransitionLock:function(){s=!1,o.length>0&&t.mobile.changePage.apply(null,o.pop())},_removeActiveLinkClass:function(e){t.mobile.removeActiveLinkClass(e)},_loadUrl:function(e,i,n){n.target=e,n.deferred=t.Deferred(),this.load(e,n),n.deferred.done(t.proxy((function(t,e,n){s=!1,e.absUrl=i.absUrl,this.transition(n,i,e)}),this)),n.deferred.fail(t.proxy((function(){this._removeActiveLinkClass(!0),this._releaseTransitionLock(),this._triggerWithDeprecated("changefailed",i)}),this))},_triggerPageBeforeChange:function(e,i,n){var o;return i.prevPage=this.activePage,t.extend(i,{toPage:e,options:n}),i.absUrl="string"===t.type(e)?t.mobile.path.makeUrlAbsolute(e,this._findBaseWithDefault()):n.absUrl,!(o=this._triggerWithDeprecated("beforechange",i)).event.isDefaultPrevented()&&!o.deprecatedEvent.isDefaultPrevented()},change:function(e,i){if(s)o.unshift(arguments);else{var n=t.extend({},t.mobile.changePage.defaults,i),a={};n.fromPage=n.fromPage||this.activePage,this._triggerPageBeforeChange(e,a,n)&&(e=a.toPage,"string"===t.type(e)?(s=!0,this._loadUrl(e,a,n)):this.transition(e,a,n))}},transition:function(e,a,r){var l,c,d,u,h,p,f,m,g,v,b,y,_;if(s)o.unshift([e,r]);else if(this._triggerPageBeforeChange(e,a,r)&&(a.prevPage=r.fromPage,!(_=this._triggerWithDeprecated("beforetransition",a)).deprecatedEvent.isDefaultPrevented()&&!_.event.isDefaultPrevented())){if(s=!0,e[0]!==t.mobile.firstPage[0]||r.dataUrl||(r.dataUrl=t.mobile.path.documentUrl.hrefNoHash),l=r.fromPage,d=c=r.dataUrl&&t.mobile.path.convertUrlToDataUrl(r.dataUrl)||e.jqmData("url"),t.mobile.path.getFilePath(c),u=t.mobile.navigate.history.getActive(),h=0===t.mobile.navigate.history.activeIndex,p=0,f=i.title,m=("dialog"===r.role||"dialog"===e.jqmData("role"))&&!0!==e.jqmData("dialog"),l&&l[0]===e[0]&&!r.allowSamePageTransition)return s=!1,this._triggerWithDeprecated("transition",a),this._triggerWithDeprecated("change",a),void(r.fromHashChange&&t.mobile.navigate.history.direct({url:c}));e.page({role:r.role}),r.fromHashChange&&(p="back"===r.direction?-1:1);try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()?t(i.activeElement).blur():t("input:focus, textarea:focus, select:focus").blur()}catch(t){}g=!1,m&&u&&(u.url&&u.url.indexOf(t.mobile.dialogHashKey)>-1&&this.activePage&&!this.activePage.hasClass("ui-dialog")&&t.mobile.navigate.history.activeIndex>0&&(r.changeHash=!1,g=!0),c=u.url||"",c+=!g&&c.indexOf("#")>-1?t.mobile.dialogHashKey:"#"+t.mobile.dialogHashKey),(v=u?e.jqmData("title")||e.children(":jqmData(role='header')").find(".ui-title").text():f)&&f===i.title&&(f=v),e.jqmData("title")||e.jqmData("title",f),r.transition=r.transition||(p&&!h?u.transition:n)||(m?t.mobile.defaultDialogTransition:t.mobile.defaultPageTransition),!p&&g&&(t.mobile.navigate.history.getActive().pageUrl=d),c&&!r.fromHashChange&&(!t.mobile.path.isPath(c)&&c.indexOf("#")<0&&(c="#"+c),b={transition:r.transition,title:f,pageUrl:d,role:r.role},!1!==r.changeHash&&t.mobile.hashListeningEnabled?t.mobile.navigate(this.window[0].encodeURI(c),b,!0):e[0]!==t.mobile.firstPage[0]&&t.mobile.navigate.history.add(c,b)),i.title=f,t.mobile.activePage=e,this.activePage=e,r.reverse=r.reverse||0>p,y=t.Deferred(),this._cssTransition(e,l,{transition:r.transition,reverse:r.reverse,deferred:y}),y.done(t.proxy((function(i,n,o,s,l){t.mobile.removeActiveLinkClass(),r.duplicateCachedPage&&r.duplicateCachedPage.remove(),l||t.mobile.focusPage(e),this._releaseTransitionLock(),this._triggerWithDeprecated("transition",a),this._triggerWithDeprecated("change",a)}),this))}},_findBaseWithDefault:function(){return this.activePage&&t.mobile.getClosestBaseUrl(this.activePage)||t.mobile.path.documentBase.hrefNoHash}}),t.mobile.navreadyDeferred=t.Deferred();var o=[],s=!1}(t),function(t,n){function o(t){for(;t&&("string"!=typeof t.nodeName||"a"!==t.nodeName.toLowerCase());)t=t.parentNode;return t}var s=t.Deferred(),a=t.Deferred(),r=function(){a.resolve(),a=null},l=t.mobile.path.documentUrl,c=null;t.mobile.loadPage=function(e,i){var n;return n=(i=i||{}).pageContainer||t.mobile.pageContainer,i.deferred=t.Deferred(),n.pagecontainer("load",e,i),i.deferred.promise()},t.mobile.back=function(){var i=e.navigator;this.phonegapNavigationEnabled&&i&&i.app&&i.app.backHistory?i.app.backHistory():t.mobile.pageContainer.pagecontainer("back")},t.mobile.focusPage=function(t){var e=t.find("[autofocus]"),i=t.find(".ui-title:eq(0)");return e.length?void e.focus():void(i.length?i.focus():t.focus())},t.mobile._maybeDegradeTransition=t.mobile._maybeDegradeTransition||function(t){return t},t.mobile.changePage=function(e,i){t.mobile.pageContainer.pagecontainer("change",e,i)},t.mobile.changePage.defaults={transition:n,reverse:!1,changeHash:!0,fromHashChange:!1,role:n,duplicateCachedPage:n,pageContainer:n,showLoadMsg:!0,dataUrl:n,fromPage:n,allowSamePageTransition:!1},t.mobile._registerInternalEvents=function(){var i=function(e,i){var n,o,s,a,r=!0;return!(!t.mobile.ajaxEnabled||e.is(":jqmData(ajax='false')")||!e.jqmHijackable().length||e.attr("target"))&&(n=c&&c.attr("formaction")||e.attr("action"),a=(e.attr("method")||"get").toLowerCase(),n||(n=t.mobile.getClosestBaseUrl(e),"get"===a&&(n=t.mobile.path.parseUrl(n).hrefNoSearch),n===t.mobile.path.documentBase.hrefNoHash&&(n=l.hrefNoSearch)),n=t.mobile.path.makeUrlAbsolute(n,t.mobile.getClosestBaseUrl(e)),!(t.mobile.path.isExternal(n)&&!t.mobile.path.isPermittedCrossDomainRequest(l,n))&&(i||(o=e.serializeArray(),c&&c[0].form===e[0]&&((s=c.attr("name"))&&(t.each(o,(function(t,e){return e.name===s?(s="",!1):void 0})),s&&o.push({name:s,value:c.attr("value")}))),r={url:n,options:{type:a,data:t.param(o),transition:e.jqmData("transition"),reverse:"reverse"===e.jqmData("direction"),reloadPage:!0}}),r))};t.mobile.document.delegate("form","submit",(function(e){var n;e.isDefaultPrevented()||(n=i(t(this)))&&(t.mobile.changePage(n.url,n.options),e.preventDefault())})),t.mobile.document.bind("vclick",(function(e){var n,s,a=e.target,r=!1;if(!(e.which>1)&&t.mobile.linkBindingEnabled){if(c=t(a),t.data(a,"mobile-button")){if(!i(t(a).closest("form"),!0))return;a.parentNode&&(a=a.parentNode)}else{if(!(a=o(a))||"#"===t.mobile.path.parseUrl(a.getAttribute("href")||"#").hash)return;if(!t(a).jqmHijackable().length)return}~a.className.indexOf("ui-link-inherit")?a.parentNode&&(s=t.data(a.parentNode,"buttonElements")):s=t.data(a,"buttonElements"),s?a=s.outer:r=!0,n=t(a),r&&(n=n.closest(".ui-btn")),n.length>0&&!n.hasClass("ui-state-disabled")&&(t.mobile.removeActiveLinkClass(!0),t.mobile.activeClickedLink=n,t.mobile.activeClickedLink.addClass(t.mobile.activeBtnClass))}})),t.mobile.document.bind("click",(function(i){if(t.mobile.linkBindingEnabled&&!i.isDefaultPrevented()){var s,a,r,c,d,u=o(i.target),h=t(u),p=function(){e.setTimeout((function(){t.mobile.removeActiveLinkClass(!0)}),200)};if(t.mobile.activeClickedLink&&t.mobile.activeClickedLink[0]===i.target.parentNode&&p(),u&&!(i.which>1)&&h.jqmHijackable().length){if(h.is(":jqmData(rel='back')"))return t.mobile.back(),!1;if(s=t.mobile.getClosestBaseUrl(h),a=t.mobile.path.makeUrlAbsolute(h.attr("href")||"#",s),!t.mobile.ajaxEnabled&&!t.mobile.path.isEmbeddedPage(a))return void p();if(!(-1===a.search("#")||t.mobile.path.isExternal(a)&&t.mobile.path.isAbsoluteUrl(a))){if(!(a=a.replace(/[^#]*#/,"")))return void i.preventDefault();a=t.mobile.path.isPath(a)?t.mobile.path.makeUrlAbsolute(a,s):t.mobile.path.makeUrlAbsolute("#"+a,l.hrefNoHash)}if(h.is("[rel='external']")||h.is(":jqmData(ajax='false')")||h.is("[target]")||t.mobile.path.isExternal(a)&&!t.mobile.path.isPermittedCrossDomainRequest(l,a))return void p();r=h.jqmData("transition"),c="reverse"===h.jqmData("direction")||h.jqmData("back"),d=h.attr("data-"+t.mobile.ns+"rel")||n,t.mobile.changePage(a,{transition:r,reverse:c,role:d,link:h}),i.preventDefault()}}})),t.mobile.document.delegate(".ui-page","pageshow.prefetch",(function(){var e=[];t(this).find("a:jqmData(prefetch)").each((function(){var i=t(this),n=i.attr("href");n&&-1===t.inArray(n,e)&&(e.push(n),t.mobile.loadPage(n,{role:i.attr("data-"+t.mobile.ns+"rel"),prefetch:!0}))}))})),t.mobile.pageContainer.pagecontainer(),t.mobile.document.bind("pageshow",(function(){a?a.done(t.mobile.resetActivePageHeight):t.mobile.resetActivePageHeight()})),t.mobile.window.bind("throttledresize",t.mobile.resetActivePageHeight)},t((function(){s.resolve()})),"complete"===i.readyState?r():t.mobile.window.load(r),t.when(s,t.mobile.navreadyDeferred).done((function(){t.mobile._registerInternalEvents()}))}(t),function(t,e){t.mobile.Transition=function(){this.init.apply(this,arguments)},t.extend(t.mobile.Transition.prototype,{toPreClass:" ui-page-pre-in",init:function(e,i,n,o){t.extend(this,{name:e,reverse:i,$to:n,$from:o,deferred:new t.Deferred})},cleanFrom:function(){this.$from.removeClass(t.mobile.activePageClass+" out in reverse "+this.name).height("")},beforeDoneIn:function(){},beforeDoneOut:function(){},beforeStartOut:function(){},doneIn:function(){this.beforeDoneIn(),this.$to.removeClass("out in reverse "+this.name).height(""),this.toggleViewportClass(),t.mobile.window.scrollTop()!==this.toScroll&&this.scrollPage(),this.sequential||this.$to.addClass(t.mobile.activePageClass),this.deferred.resolve(this.name,this.reverse,this.$to,this.$from,!0)},doneOut:function(t,e,i,n){this.beforeDoneOut(),this.startIn(t,e,i,n)},hideIn:function(t){this.$to.css("z-index",-10),t.call(this),this.$to.css("z-index","")},scrollPage:function(){t.event.special.scrollstart.enabled=!1,(t.mobile.hideUrlBar||this.toScroll!==t.mobile.defaultHomeScroll)&&e.scrollTo(0,this.toScroll),setTimeout((function(){t.event.special.scrollstart.enabled=!0}),150)},startIn:function(e,i,n,o){this.hideIn((function(){this.$to.addClass(t.mobile.activePageClass+this.toPreClass),o||t.mobile.focusPage(this.$to),this.$to.height(e+this.toScroll),n||this.scrollPage()})),this.$to.removeClass(this.toPreClass).addClass(this.name+" in "+i),n?this.doneIn():this.$to.animationComplete(t.proxy((function(){this.doneIn()}),this))},startOut:function(e,i,n){this.beforeStartOut(e,i,n),this.$from.height(e+t.mobile.window.scrollTop()).addClass(this.name+" out"+i)},toggleViewportClass:function(){t.mobile.pageContainer.toggleClass("ui-mobile-viewport-transitioning viewport-"+this.name)},transition:function(){var e,i=this.reverse?" reverse":"",n=t.mobile.getScreenHeight(),o=!1!==t.mobile.maxTransitionWidth&&t.mobile.window.width()>t.mobile.maxTransitionWidth;return this.toScroll=t.mobile.navigate.history.getActive().lastScroll||t.mobile.defaultHomeScroll,e=!t.support.cssTransitions||!t.support.cssAnimations||o||!this.name||"none"===this.name||Math.max(t.mobile.window.scrollTop(),this.toScroll)>t.mobile.getMaxScrollForTransition(),this.toggleViewportClass(),this.$from&&!e?this.startOut(n,i,e):this.doneOut(n,i,e,!0),this.deferred.promise()}})}(t,this),function(t){t.mobile.SerialTransition=function(){this.init.apply(this,arguments)},t.extend(t.mobile.SerialTransition.prototype,t.mobile.Transition.prototype,{sequential:!0,beforeDoneOut:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(e,i,n){this.$from.animationComplete(t.proxy((function(){this.doneOut(e,i,n)}),this))}})}(t),function(t){t.mobile.ConcurrentTransition=function(){this.init.apply(this,arguments)},t.extend(t.mobile.ConcurrentTransition.prototype,t.mobile.Transition.prototype,{sequential:!1,beforeDoneIn:function(){this.$from&&this.cleanFrom()},beforeStartOut:function(t,e,i){this.doneOut(t,e,i)}})}(t),function(t){t.mobile.transitionHandlers={sequential:t.mobile.SerialTransition,simultaneous:t.mobile.ConcurrentTransition},t.mobile.defaultTransitionHandler=t.mobile.transitionHandlers.sequential,t.mobile.transitionFallbacks={},t.mobile._maybeDegradeTransition=function(e){return e&&!t.support.cssTransform3d&&t.mobile.transitionFallbacks[e]&&(e=t.mobile.transitionFallbacks[e]),e},t.mobile.getMaxScrollForTransition=t.mobile.getMaxScrollForTransition||function(){return 3*t.mobile.getScreenHeight()}}(t),function(t){t.mobile.transitionFallbacks.flip="fade"}(t),function(t){t.mobile.transitionFallbacks.flow="fade"}(t),function(t){t.mobile.transitionFallbacks.pop="fade"}(t),function(t){t.mobile.transitionHandlers.slide=t.mobile.transitionHandlers.simultaneous,t.mobile.transitionFallbacks.slide="fade"}(t),function(t){t.mobile.transitionFallbacks.slidedown="fade"}(t),function(t){t.mobile.transitionFallbacks.slidefade="fade"}(t),function(t){t.mobile.transitionFallbacks.slideup="fade"}(t),function(t){t.mobile.transitionFallbacks.turn="fade"}(t),function(t){t.mobile.degradeInputs={color:!1,date:!1,datetime:!1,"datetime-local":!1,email:!1,month:!1,number:!1,range:"number",search:"text",tel:!1,time:!1,url:!1,week:!1},t.mobile.page.prototype.options.degradeInputs=t.mobile.degradeInputs,t.mobile.degradeInputsWithin=function(e){(e=t(e)).find("input").not(t.mobile.page.prototype.keepNativeSelector()).each((function(){var e,i,n,o,s=t(this),a=this.getAttribute("type"),r=t.mobile.degradeInputs[a]||"text";t.mobile.degradeInputs[a]&&(n=(i=(e=t("<div>").html(s.clone()).html()).indexOf(" type=")>-1)?/\s+type=["']?\w+['"]?/:/\/?>/,o=' type="'+r+'" data-'+t.mobile.ns+'type="'+a+'"'+(i?"":">"),s.replaceWith(e.replace(n,o)))}))}}(t),function(t,e,i){t.widget("mobile.page",t.mobile.page,{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0,dialog:!1},_create:function(){this._super(),this.options.dialog&&(t.extend(this,{_inner:this.element.children(),_headerCloseButton:null}),this.options.enhanced||this._setCloseBtn(this.options.closeBtn))},_enhance:function(){this._super(),this.options.dialog&&this.element.addClass("ui-dialog").wrapInner(t("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(this.options.corners?" ui-corner-all":"")}))},_setOptions:function(e){var n,o,s=this.options;e.corners!==i&&this._inner.toggleClass("ui-corner-all",!!e.corners),e.overlayTheme!==i&&t.mobile.activePage[0]===this.element[0]&&(s.overlayTheme=e.overlayTheme,this._handlePageBeforeShow()),e.closeBtnText!==i&&(n=s.closeBtn,o=e.closeBtnText),e.closeBtn!==i&&(n=e.closeBtn),n&&this._setCloseBtn(n,o),this._super(e)},_handlePageBeforeShow:function(){this.options.overlayTheme&&this.options.dialog?(this.removeContainerBackground(),this.setContainerBackground(this.options.overlayTheme)):this._super()},_setCloseBtn:function(e,i){var n,o=this._headerCloseButton;"none"===(e="left"===e?"left":"right"===e?"right":"none")?o&&(o.remove(),o=null):o?(o.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+e),i&&o.text(i)):(n=this._inner.find(":jqmData(role='header')").first(),o=t("<a></a>",{href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+e}).attr("data-"+t.mobile.ns+"rel","back").text(i||this.options.closeBtnText||"").prependTo(n)),this._headerCloseButton=o}})}(t),function(t,e,i){t.widget("mobile.dialog",{options:{closeBtn:"left",closeBtnText:"Close",overlayTheme:"a",corners:!0},_handlePageBeforeShow:function(){this._isCloseable=!0,this.options.overlayTheme&&this.element.page("removeContainerBackground").page("setContainerBackground",this.options.overlayTheme)},_handlePageBeforeHide:function(){this._isCloseable=!1},_handleVClickSubmit:function(e){var i,n=t(e.target).closest("vclick"===e.type?"a":"form");n.length&&!n.jqmData("transition")&&((i={})["data-"+t.mobile.ns+"transition"]=(t.mobile.navigate.history.getActive()||{}).transition||t.mobile.defaultDialogTransition,i["data-"+t.mobile.ns+"direction"]="reverse",n.attr(i))},_create:function(){var e=this.element,i=this.options;e.addClass("ui-dialog").wrapInner(t("<div/>",{role:"dialog",class:"ui-dialog-contain ui-overlay-shadow"+(i.corners?" ui-corner-all":"")})),t.extend(this,{_isCloseable:!1,_inner:e.children(),_headerCloseButton:null}),this._on(e,{vclick:"_handleVClickSubmit",submit:"_handleVClickSubmit",pagebeforeshow:"_handlePageBeforeShow",pagebeforehide:"_handlePageBeforeHide"}),this._setCloseBtn(i.closeBtn)},_setOptions:function(e){var n,o,s=this.options;e.corners!==i&&this._inner.toggleClass("ui-corner-all",!!e.corners),e.overlayTheme!==i&&t.mobile.activePage[0]===this.element[0]&&(s.overlayTheme=e.overlayTheme,this._handlePageBeforeShow()),e.closeBtnText!==i&&(n=s.closeBtn,o=e.closeBtnText),e.closeBtn!==i&&(n=e.closeBtn),n&&this._setCloseBtn(n,o),this._super(e)},_setCloseBtn:function(e,i){var n,o=this._headerCloseButton;"none"===(e="left"===e?"left":"right"===e?"right":"none")?o&&(o.remove(),o=null):o?(o.removeClass("ui-btn-left ui-btn-right").addClass("ui-btn-"+e),i&&o.text(i)):(n=this._inner.find(":jqmData(role='header')").first(),o=t("<a></a>",{role:"button",href:"#",class:"ui-btn ui-corner-all ui-icon-delete ui-btn-icon-notext ui-btn-"+e}).text(i||this.options.closeBtnText||"").prependTo(n),this._on(o,{click:"close"})),this._headerCloseButton=o},close:function(){var e=t.mobile.navigate.history;this._isCloseable&&(this._isCloseable=!1,t.mobile.hashListeningEnabled&&e.activeIndex>0?t.mobile.back():t.mobile.pageContainer.pagecontainer("back"))}})}(t),function(t,e){var i=/([A-Z])/g,n=function(t){return"ui-btn-icon-"+(null===t?"left":t)};t.widget("mobile.collapsible",{options:{enhanced:!1,expandCueText:null,collapseCueText:null,collapsed:!0,heading:"h1,h2,h3,h4,h5,h6,legend",collapsedIcon:null,expandedIcon:null,iconpos:null,theme:null,contentTheme:null,inset:null,corners:null,mini:null},_create:function(){var e=this.element,i={accordion:e.closest(":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')"+(t.mobile.collapsibleset?", :mobile-collapsibleset":"")).addClass("ui-collapsible-set")};this._ui=i,this._renderedOptions=this._getOptions(this.options),this.options.enhanced?(i.heading=this.element.children(".ui-collapsible-heading"),i.content=i.heading.next(),i.anchor=i.heading.children(),i.status=i.anchor.children(".ui-collapsible-heading-status")):this._enhance(e,i),this._on(i.heading,{tap:function(){i.heading.find("a").first().addClass(t.mobile.activeBtnClass)},click:function(t){this._handleExpandCollapse(!i.heading.hasClass("ui-collapsible-heading-collapsed")),t.preventDefault(),t.stopPropagation()}})},_getOptions:function(e){var n,o=this._ui.accordion,s=this._ui.accordionWidget;for(n in e=t.extend({},e),o.length&&!s&&(this._ui.accordionWidget=s=o.data("mobile-collapsibleset")),e)e[n]=null!=e[n]?e[n]:s?s.options[n]:o.length?t.mobile.getAttribute(o[0],n.replace(i,"-$1").toLowerCase()):null,null==e[n]&&(e[n]=t.mobile.collapsible.defaults[n]);return e},_themeClassFromOption:function(t,e){return e?"none"===e?"":t+e:""},_enhance:function(e,i){var o,s=this._renderedOptions,a=this._themeClassFromOption("ui-body-",s.contentTheme);return e.addClass("ui-collapsible "+(s.inset?"ui-collapsible-inset ":"")+(s.inset&&s.corners?"ui-corner-all ":"")+(a?"ui-collapsible-themed-content ":"")),i.originalHeading=e.children(this.options.heading).first(),i.content=e.wrapInner("<div class='ui-collapsible-content "+a+"'></div>").children(".ui-collapsible-content"),i.heading=i.originalHeading,i.heading.is("legend")&&(i.heading=t("<div role='heading'>"+i.heading.html()+"</div>"),i.placeholder=t("<div>\x3c!-- placeholder for legend --\x3e</div>").insertBefore(i.originalHeading),i.originalHeading.remove()),o=s.collapsed?s.collapsedIcon?"ui-icon-"+s.collapsedIcon:"":s.expandedIcon?"ui-icon-"+s.expandedIcon:"",i.status=t("<span class='ui-collapsible-heading-status'></span>"),i.anchor=i.heading.detach().addClass("ui-collapsible-heading").append(i.status).wrapInner("<a href='#' class='ui-collapsible-heading-toggle'></a>").find("a").first().addClass("ui-btn "+(o?o+" ":"")+(o?n(s.iconpos)+" ":"")+this._themeClassFromOption("ui-btn-",s.theme)+" "+(s.mini?"ui-mini ":"")),i.heading.insertBefore(i.content),this._handleExpandCollapse(this.options.collapsed),i},refresh:function(){this._applyOptions(this.options),this._renderedOptions=this._getOptions(this.options)},_applyOptions:function(t){var i,o,s,a,r,l=this.element,c=this._renderedOptions,d=this._ui,u=d.anchor,h=d.status,p=this._getOptions(t);t.collapsed!==e&&this._handleExpandCollapse(t.collapsed),(i=l.hasClass("ui-collapsible-collapsed"))?p.expandCueText!==e&&h.text(p.expandCueText):p.collapseCueText!==e&&h.text(p.collapseCueText),r=p.collapsedIcon!==e?!1!==p.collapsedIcon:!1!==c.collapsedIcon,(p.iconpos!==e||p.collapsedIcon!==e||p.expandedIcon!==e)&&(u.removeClass([n(c.iconpos)].concat(c.expandedIcon?["ui-icon-"+c.expandedIcon]:[]).concat(c.collapsedIcon?["ui-icon-"+c.collapsedIcon]:[]).join(" ")),r&&u.addClass([n(p.iconpos!==e?p.iconpos:c.iconpos)].concat(i?["ui-icon-"+(p.collapsedIcon!==e?p.collapsedIcon:c.collapsedIcon)]:["ui-icon-"+(p.expandedIcon!==e?p.expandedIcon:c.expandedIcon)]).join(" "))),p.theme!==e&&(s=this._themeClassFromOption("ui-btn-",c.theme),o=this._themeClassFromOption("ui-btn-",p.theme),u.removeClass(s).addClass(o)),p.contentTheme!==e&&(s=this._themeClassFromOption("ui-body-",c.contentTheme),o=this._themeClassFromOption("ui-body-",p.contentTheme),d.content.removeClass(s).addClass(o)),p.inset!==e&&(l.toggleClass("ui-collapsible-inset",p.inset),a=!(!p.inset||!p.corners&&!c.corners)),p.corners!==e&&(a=!(!p.corners||!p.inset&&!c.inset)),a!==e&&l.toggleClass("ui-corner-all",a),p.mini!==e&&u.toggleClass("ui-mini",p.mini)},_setOptions:function(t){this._applyOptions(t),this._super(t),this._renderedOptions=this._getOptions(this.options)},_handleExpandCollapse:function(e){var i=this._renderedOptions,n=this._ui;n.status.text(e?i.expandCueText:i.collapseCueText),n.heading.toggleClass("ui-collapsible-heading-collapsed",e).find("a").first().toggleClass("ui-icon-"+i.expandedIcon,!e).toggleClass("ui-icon-"+i.collapsedIcon,e||i.expandedIcon===i.collapsedIcon).removeClass(t.mobile.activeBtnClass),this.element.toggleClass("ui-collapsible-collapsed",e),n.content.toggleClass("ui-collapsible-content-collapsed",e).attr("aria-hidden",e).trigger("updatelayout"),this.options.collapsed=e,this._trigger(e?"collapse":"expand")},expand:function(){this._handleExpandCollapse(!1)},collapse:function(){this._handleExpandCollapse(!0)},_destroy:function(){var t=this._ui;this.options.enhanced||(t.placeholder?(t.originalHeading.insertBefore(t.placeholder),t.placeholder.remove(),t.heading.remove()):(t.status.remove(),t.heading.removeClass("ui-collapsible-heading ui-collapsible-heading-collapsed").children().contents().unwrap()),t.anchor.contents().unwrap(),t.content.contents().unwrap(),this.element.removeClass("ui-collapsible ui-collapsible-collapsed ui-collapsible-themed-content ui-collapsible-inset ui-corner-all"))}}),t.mobile.collapsible.defaults={expandCueText:" click to expand contents",collapseCueText:" click to collapse contents",collapsedIcon:"plus",contentTheme:"inherit",expandedIcon:"minus",iconpos:"left",inset:!0,corners:!0,theme:"inherit",mini:!1}}(t),function(t){function e(e){var n,o=e.length,s=[];for(n=0;o>n;n++)e[n].className.match(i)||s.push(e[n]);return t(s)}var i=/\bui-screen-hidden\b/;t.mobile.behaviors.addFirstLastClasses={_getVisibles:function(t,i){var n;return i?n=e(t):0===(n=t.filter(":visible")).length&&(n=e(t)),n},_addFirstLastClasses:function(t,e,i){t.removeClass("ui-first-child ui-last-child"),e.eq(0).addClass("ui-first-child").end().last().addClass("ui-last-child"),i||this.element.trigger("updatelayout")},_removeFirstLastClasses:function(t){t.removeClass("ui-first-child ui-last-child")}}}(t),function(t,e){var i=":mobile-collapsible, "+t.mobile.collapsible.initSelector;t.widget("mobile.collapsibleset",t.extend({initSelector:":jqmData(role='collapsible-set'),:jqmData(role='collapsibleset')",options:t.extend({enhanced:!1},t.mobile.collapsible.defaults),_handleCollapsibleExpand:function(e){var i=t(e.target).closest(".ui-collapsible");i.parent().is(":mobile-collapsibleset, :jqmData(role='collapsible-set')")&&i.siblings(".ui-collapsible:not(.ui-collapsible-collapsed)").collapsible("collapse")},_create:function(){var e=this.element,i=this.options;t.extend(this,{_classes:""}),i.enhanced||(e.addClass("ui-collapsible-set "+this._themeClassFromOption("ui-group-theme-",i.theme)+" "+(i.corners&&i.inset?"ui-corner-all ":"")),this.element.find(t.mobile.collapsible.initSelector).collapsible()),this._on(e,{collapsibleexpand:"_handleCollapsibleExpand"})},_themeClassFromOption:function(t,e){return e?"none"===e?"":t+e:""},_init:function(){this._refresh(!0),this.element.children(i).filter(":jqmData(collapsed='false')").collapsible("expand")},_setOptions:function(t){var i,n,o=this.element,s=this._themeClassFromOption("ui-group-theme-",t.theme);return s&&o.removeClass(this._themeClassFromOption("ui-group-theme-",this.options.theme)).addClass(s),t.inset!==e&&(n=!(!t.inset||!t.corners&&!this.options.corners)),t.corners!==e&&(n=!(!t.corners||!t.inset&&!this.options.inset)),n!==e&&o.toggleClass("ui-corner-all",n),i=this._super(t),this.element.children(":mobile-collapsible").collapsible("refresh"),i},_destroy:function(){var t=this.element;this._removeFirstLastClasses(t.children(i)),t.removeClass("ui-collapsible-set ui-corner-all "+this._themeClassFromOption("ui-group-theme-",this.options.theme)).children(":mobile-collapsible").collapsible("destroy")},_refresh:function(e){var n=this.element.children(i);this.element.find(t.mobile.collapsible.initSelector).not(".ui-collapsible").collapsible(),this._addFirstLastClasses(n,this._getVisibles(n,e),e)},refresh:function(){this._refresh(!1)}},t.mobile.behaviors.addFirstLastClasses))}(t),function(t){t.fn.fieldcontain=function(){return this.addClass("ui-field-contain")}}(t),function(t){t.fn.grid=function(e){return this.each((function(){var i,n,o=t(this),s=t.extend({grid:null},e),a=o.children(),r={solo:1,a:2,b:3,c:4,d:5},l=s.grid;if(!l)if(a.length<=5)for(n in r)r[n]===a.length&&(l=n);else l="a",o.addClass("ui-grid-duo");i=r[l],o.addClass("ui-grid-"+l),a.filter(":nth-child("+i+"n+1)").addClass("ui-block-a"),i>1&&a.filter(":nth-child("+i+"n+2)").addClass("ui-block-b"),i>2&&a.filter(":nth-child("+i+"n+3)").addClass("ui-block-c"),i>3&&a.filter(":nth-child("+i+"n+4)").addClass("ui-block-d"),i>4&&a.filter(":nth-child("+i+"n+5)").addClass("ui-block-e")}))}}(t),function(t,e){t.widget("mobile.navbar",{options:{iconpos:"top",grid:null},_create:function(){var e=this.element,n=e.find("a, button"),o=n.filter(":jqmData(icon)").length?this.options.iconpos:undefined;e.addClass("ui-navbar").attr("role","navigation").find("ul").jqmEnhanceable().grid({grid:this.options.grid}),n.each((function(){var e=t.mobile.getAttribute(this,"icon"),i=t.mobile.getAttribute(this,"theme"),n="ui-btn";i&&(n+=" ui-btn-"+i),e&&(n+=" ui-icon-"+e+" ui-btn-icon-"+o),t(this).addClass(n)})),e.delegate("a","vclick",(function(){var e=t(this);e.hasClass("ui-state-disabled")||e.hasClass("ui-disabled")||e.hasClass(t.mobile.activeBtnClass)||(n.removeClass(t.mobile.activeBtnClass),e.addClass(t.mobile.activeBtnClass),t(i).one("pagehide",(function(){e.removeClass(t.mobile.activeBtnClass)})))})),e.closest(".ui-page").bind("pagebeforeshow",(function(){n.filter(".ui-state-persist").addClass(t.mobile.activeBtnClass)}))}})}(t),function(t){var e=t.mobile.getAttribute;t.widget("mobile.listview",t.extend({options:{theme:null,countTheme:null,dividerTheme:null,icon:"carat-r",splitIcon:"carat-r",splitTheme:null,corners:!0,shadow:!0,inset:!1},_create:function(){var t=this,e="";e+=t.options.inset?" ui-listview-inset":"",t.options.inset&&(e+=t.options.corners?" ui-corner-all":"",e+=t.options.shadow?" ui-shadow":""),t.element.addClass(" ui-listview"+e),t.refresh(!0)},_findFirstElementByTagName:function(t,e,i,n){var o={};for(o[i]=o[n]=!0;t;){if(o[t.nodeName])return t;t=t[e]}return null},_addThumbClasses:function(e){var i,n,o=e.length;for(i=0;o>i;i++)(n=t(this._findFirstElementByTagName(e[i].firstChild,"nextSibling","img","IMG"))).length&&t(this._findFirstElementByTagName(n[0].parentNode,"parentNode","li","LI")).addClass(n.hasClass("ui-li-icon")?"ui-li-has-icon":"ui-li-has-thumb")},_getChildrenByTagName:function(e,i,n){var o=[],s={};for(s[i]=s[n]=!0,e=e.firstChild;e;)s[e.nodeName]&&o.push(e),e=e.nextSibling;return t(o)},_beforeListviewRefresh:t.noop,_afterListviewRefresh:t.noop,refresh:function(i){var n,o,s,a,r,l,c,d,u,h,p,f,m,g,v,b,y,_,w=this.options,x=this.element,k=!!t.nodeName(x[0],"ol"),S=x.attr("start"),T={},C=x.find(".ui-li-count"),D=e(x[0],"counttheme")||this.options.countTheme,M=D?"ui-body-"+D:"ui-body-inherit";for(w.theme&&x.addClass("ui-group-theme-"+w.theme),k&&(S||0===S)&&(p=parseInt(S,10)-1,x.css("counter-reset","listnumbering "+p)),this._beforeListviewRefresh(),o=0,s=(_=this._getChildrenByTagName(x[0],"li","LI")).length;s>o;o++)a=_.eq(o),r="",(i||a[0].className.search(/\bui-li-static\b|\bui-li-divider\b/)<0)&&(u=this._getChildrenByTagName(a[0],"a","A"),h="list-divider"===e(a[0],"role"),m=a.attr("value"),l=e(a[0],"theme"),u.length&&u[0].className.search(/\bui-btn\b/)<0&&!h?(d=!1!==(c=e(a[0],"icon"))&&(c||w.icon),u.removeClass("ui-link"),n="ui-btn",l&&(n+=" ui-btn-"+l),u.length>1?(r="ui-li-has-alt",g=u.last(),b=(v=e(g[0],"theme")||w.splitTheme||e(a[0],"theme",!0))?" ui-btn-"+v:"",y="ui-btn ui-btn-icon-notext ui-icon-"+(e(g[0],"icon")||e(a[0],"icon")||w.splitIcon)+b,g.attr("title",t.trim(g.getEncodedText())).addClass(y).empty(),u=u.first()):d&&(n+=" ui-btn-icon-right ui-icon-"+d),u.addClass(n)):h?(r="ui-li-divider ui-bar-"+(e(a[0],"theme")||w.dividerTheme||w.theme||"inherit"),a.attr("role","heading")):u.length<=0&&(r="ui-li-static ui-body-"+(l||"inherit")),k&&m&&(f=parseInt(m,10)-1,a.css("counter-reset","listnumbering "+f))),T[r]||(T[r]=[]),T[r].push(a[0]);for(r in T)t(T[r]).addClass(r);C.each((function(){t(this).closest("li").addClass("ui-li-has-count")})),M&&C.not("[class*='ui-body-']").addClass(M),this._addThumbClasses(_),this._addThumbClasses(_.find(".ui-btn")),this._afterListviewRefresh(),this._addFirstLastClasses(_,this._getVisibles(_,i),i)}},t.mobile.behaviors.addFirstLastClasses))}(t),function(t){t.widget("mobile.listview",t.mobile.listview,{options:{autodividers:!1,autodividersSelector:function(e){var i=t.trim(e.text())||null;return i?i=i.slice(0,1).toUpperCase():null}},_beforeListviewRefresh:function(){this.options.autodividers&&(this._replaceDividers(),this._superApply(arguments))},_replaceDividers:function(){var e,n,o,s,a,r=null,l=this.element;for(l.children("li:jqmData(role='list-divider')").remove(),n=l.children("li"),e=0;e<n.length;e++)o=n[e],(s=this.options.autodividersSelector(t(o)))&&r!==s&&((a=i.createElement("li")).appendChild(i.createTextNode(s)),a.setAttribute("data-"+t.mobile.ns+"role","list-divider"),o.parentNode.insertBefore(a,o)),r=s}})}(t),function(t){var e=/(^|\s)ui-li-divider($|\s)/,i=/(^|\s)ui-screen-hidden($|\s)/;t.widget("mobile.listview",t.mobile.listview,{options:{hideDividers:!1},_afterListviewRefresh:function(){var t,n,o,s=!0;if(this._superApply(arguments),this.options.hideDividers)for(n=(t=this._getChildrenByTagName(this.element[0],"li","LI")).length-1;n>-1;n--)(o=t[n]).className.match(e)?(s&&(o.className=o.className+" ui-screen-hidden"),s=!0):o.className.match(i)||(s=!1)}})}(t),function(t){t.mobile.nojs=function(e){t(":jqmData(role='nojs')",e).addClass("ui-nojs")}}(t),function(t){t.mobile.behaviors.formReset={_handleFormReset:function(){this._on(this.element.closest("form"),{reset:function(){this._delay("_reset")}})}}}(t),function(t,e){var i=t.mobile.path.hashToSelector;t.widget("mobile.checkboxradio",t.extend({initSelector:"input:not( :jqmData(role='flipswitch' ) )[type='checkbox'],input[type='radio']:not( :jqmData(role='flipswitch' ))",options:{theme:"inherit",mini:!1,wrapperClass:null,enhanced:!1,iconpos:"left"},_create:function(){var e=this.element,i=this.options,n=function(t,e){return t.jqmData(e)||t.closest("form, fieldset").jqmData(e)},o=this.options.enhanced?{element:this.element.siblings("label"),isParent:!1}:this._findLabel(),s=e[0].type,a="ui-"+s+"-on",r="ui-"+s+"-off";("checkbox"===s||"radio"===s)&&(this.element[0].disabled&&(this.options.disabled=!0),i.iconpos=n(e,"iconpos")||o.element.attr("data-"+t.mobile.ns+"iconpos")||i.iconpos,i.mini=n(e,"mini")||i.mini,t.extend(this,{input:e,label:o.element,labelIsParent:o.isParent,inputtype:s,checkedClass:a,uncheckedClass:r}),this.options.enhanced||this._enhance(),this._on(o.element,{vmouseover:"_handleLabelVMouseOver",vclick:"_handleLabelVClick"}),this._on(e,{vmousedown:"_cacheVals",vclick:"_handleInputVClick",focus:"_handleInputFocus",blur:"_handleInputBlur"}),this._handleFormReset(),this.refresh())},_findLabel:function(){var e,n,o,s=this.element,a=s[0].labels;return a&&a.length>0?(n=t(a[0]),o=t.contains(n[0],s[0])):n=(o=(e=s.closest("label")).length>0)?e:t(this.document[0].getElementsByTagName("label")).filter("[for='"+i(s[0].id)+"']").first(),{element:n,isParent:o}},_enhance:function(){this.label.addClass("ui-btn ui-corner-all"),this.labelIsParent?this.input.add(this.label).wrapAll(this._wrapper()):(this.element.wrap(this._wrapper()),this.element.parent().prepend(this.label)),this._setOptions({theme:this.options.theme,iconpos:this.options.iconpos,mini:this.options.mini})},_wrapper:function(){return t("<div class='"+(this.options.wrapperClass?this.options.wrapperClass:"")+" ui-"+this.inputtype+(this.options.disabled?" ui-state-disabled":"")+"' ></div>")},_handleInputFocus:function(){this.label.addClass(t.mobile.focusClass)},_handleInputBlur:function(){this.label.removeClass(t.mobile.focusClass)},_handleInputVClick:function(){this.element.prop("checked",this.element.is(":checked")),this._getInputSet().not(this.element).prop("checked",!1),this._updateAll(!0)},_handleLabelVMouseOver:function(t){this.label.parent().hasClass("ui-state-disabled")&&t.stopPropagation()},_handleLabelVClick:function(t){var e=this.element;return e.is(":disabled")?void t.preventDefault():(this._cacheVals(),e.prop("checked","radio"===this.inputtype||!e.prop("checked")),e.triggerHandler("click"),this._getInputSet().not(e).prop("checked",!1),this._updateAll(),!1)},_cacheVals:function(){this._getInputSet().each((function(){t(this).attr("data-"+t.mobile.ns+"cacheVal",this.checked)}))},_getInputSet:function(){var e,n,o=this.element[0],s=o.name,a=o.form,r=this.element.parents().last().get(0),l=this.element;return s&&"radio"===this.inputtype&&r&&(e="input[type='radio'][name='"+i(s)+"']",a?((n=a.getAttribute("id"))&&(l=t(e+"[form='"+i(n)+"']",r)),l=t(a).find(e).filter((function(){return this.form===a})).add(l)):l=t(e,r).filter((function(){return!this.form}))),l},_updateAll:function(e){var i=this;this._getInputSet().each((function(){var n=t(this);!this.checked&&"checkbox"!==i.inputtype||e||n.trigger("change")})).checkboxradio("refresh")},_reset:function(){this.refresh()},_hasIcon:function(){var e,i,n=t.mobile.controlgroup;return!(n&&(e=this.element.closest(":mobile-controlgroup,"+n.prototype.initSelector),e.length>0))||"horizontal"!==((i=t.data(e[0],"mobile-controlgroup"))?i.options.type:e.attr("data-"+t.mobile.ns+"type"))},refresh:function(){var e=this.element[0].checked,i=t.mobile.activeBtnClass,n="ui-btn-icon-"+this.options.iconpos,o=[],s=[];this._hasIcon()?(s.push(i),o.push(n)):(s.push(n),(e?o:s).push(i)),e?(o.push(this.checkedClass),s.push(this.uncheckedClass)):(o.push(this.uncheckedClass),s.push(this.checkedClass)),this.widget().toggleClass("ui-state-disabled",this.element.prop("disabled")),this.label.addClass(o.join(" ")).removeClass(s.join(" "))},widget:function(){return this.label.parent()},_setOptions:function(t){var i=this.label,n=this.options,o=this.widget(),s=this._hasIcon();t.disabled!==e&&(this.input.prop("disabled",!!t.disabled),o.toggleClass("ui-state-disabled",!!t.disabled)),t.mini!==e&&o.toggleClass("ui-mini",!!t.mini),t.theme!==e&&i.removeClass("ui-btn-"+n.theme).addClass("ui-btn-"+t.theme),t.wrapperClass!==e&&o.removeClass(n.wrapperClass).addClass(t.wrapperClass),t.iconpos!==e&&s?i.removeClass("ui-btn-icon-"+n.iconpos).addClass("ui-btn-icon-"+t.iconpos):s||i.removeClass("ui-btn-icon-"+n.iconpos),this._super(t)}},t.mobile.behaviors.formReset))}(t),function(t,e){t.widget("mobile.button",{initSelector:"input[type='button'], input[type='submit'], input[type='reset']",options:{theme:null,icon:null,iconpos:"left",iconshadow:!1,corners:!0,shadow:!0,inline:null,mini:null,wrapperClass:null,enhanced:!1},_create:function(){this.element.is(":disabled")&&(this.options.disabled=!0),this.options.enhanced||this._enhance(),t.extend(this,{wrapper:this.element.parent()}),this._on({focus:function(){this.widget().addClass(t.mobile.focusClass)},blur:function(){this.widget().removeClass(t.mobile.focusClass)}}),this.refresh(!0)},_enhance:function(){this.element.wrap(this._button())},_button:function(){var e=this.options,i=this._getIconClasses(this.options);return t("<div class='ui-btn ui-input-btn"+(e.wrapperClass?" "+e.wrapperClass:"")+(e.theme?" ui-btn-"+e.theme:"")+(e.corners?" ui-corner-all":"")+(e.shadow?" ui-shadow":"")+(e.inline?" ui-btn-inline":"")+(e.mini?" ui-mini":"")+(e.disabled?" ui-state-disabled":"")+(i?" "+i:"")+"' >"+this.element.val()+"</div>")},widget:function(){return this.wrapper},_destroy:function(){this.element.insertBefore(this.wrapper),this.wrapper.remove()},_getIconClasses:function(t){return t.icon?"ui-icon-"+t.icon+(t.iconshadow?" ui-shadow-icon":"")+" ui-btn-icon-"+t.iconpos:""},_setOptions:function(i){var n=this.widget();i.theme!==e&&n.removeClass(this.options.theme).addClass("ui-btn-"+i.theme),i.corners!==e&&n.toggleClass("ui-corner-all",i.corners),i.shadow!==e&&n.toggleClass("ui-shadow",i.shadow),i.inline!==e&&n.toggleClass("ui-btn-inline",i.inline),i.mini!==e&&n.toggleClass("ui-mini",i.mini),i.disabled!==e&&(this.element.prop("disabled",i.disabled),n.toggleClass("ui-state-disabled",i.disabled)),(i.icon!==e||i.iconshadow!==e||i.iconpos!==e)&&n.removeClass(this._getIconClasses(this.options)).addClass(this._getIconClasses(t.extend({},this.options,i))),this._super(i)},refresh:function(e){var i,n=this.element.prop("disabled");this.options.icon&&"notext"===this.options.iconpos&&this.element.attr("title")&&this.element.attr("title",this.element.val()),e||(i=this.element.detach(),t(this.wrapper).text(this.element.val()).append(i)),this.options.disabled!==n&&this._setOptions({disabled:n})}})}(t),function(t){var e=t("meta[name=viewport]"),i=e.attr("content"),n=i+",maximum-scale=1, user-scalable=no",o=i+",maximum-scale=10, user-scalable=yes",s=/(user-scalable[\s]*=[\s]*no)|(maximum-scale[\s]*=[\s]*1)[$,\s]/.test(i);t.mobile.zoom=t.extend({},{enabled:!s,locked:!1,disable:function(i){s||t.mobile.zoom.locked||(e.attr("content",n),t.mobile.zoom.enabled=!1,t.mobile.zoom.locked=i||!1)},enable:function(i){s||t.mobile.zoom.locked&&!0!==i||(e.attr("content",o),t.mobile.zoom.enabled=!0,t.mobile.zoom.locked=!1)},restore:function(){s||(e.attr("content",i),t.mobile.zoom.enabled=!0)}})}(t),function(t,e){t.widget("mobile.textinput",{initSelector:"input[type='text'],input[type='search'],:jqmData(type='search'),input[type='number'],:jqmData(type='number'),input[type='password'],input[type='email'],input[type='url'],input[type='tel'],textarea,input[type='time'],input[type='date'],input[type='month'],input[type='week'],input[type='datetime'],input[type='datetime-local'],input[type='color'],input:not([type]),input[type='file']",options:{theme:null,corners:!0,mini:!1,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,wrapperClass:"",enhanced:!1},_create:function(){var e=this.options,i=this.element.is("[type='search'], :jqmData(type='search')"),n="TEXTAREA"===this.element[0].tagName,o=this.element.is("[data-"+(t.mobile.ns||"")+"type='range']"),s=(this.element.is("input")||this.element.is("[data-"+(t.mobile.ns||"")+"type='search']"))&&!o;this.element.prop("disabled")&&(e.disabled=!0),t.extend(this,{classes:this._classesFromOptions(),isSearch:i,isTextarea:n,isRange:o,inputNeedsWrap:s}),this._autoCorrect(),e.enhanced||this._enhance(),this._on({focus:"_handleFocus",blur:"_handleBlur"})},refresh:function(){this.setOptions({disabled:this.element.is(":disabled")})},_enhance:function(){var t=[];this.isTextarea&&t.push("ui-input-text"),(this.isTextarea||this.isRange)&&t.push("ui-shadow-inset"),this.inputNeedsWrap?this.element.wrap(this._wrap()):t=t.concat(this.classes),this.element.addClass(t.join(" "))},widget:function(){return this.inputNeedsWrap?this.element.parent():this.element},_classesFromOptions:function(){var t=this.options,e=[];return e.push("ui-body-"+(null===t.theme?"inherit":t.theme)),t.corners&&e.push("ui-corner-all"),t.mini&&e.push("ui-mini"),t.disabled&&e.push("ui-state-disabled"),t.wrapperClass&&e.push(t.wrapperClass),e},_wrap:function(){return t("<div class='"+(this.isSearch?"ui-input-search ":"ui-input-text ")+this.classes.join(" ")+" ui-shadow-inset'></div>")},_autoCorrect:function(){void 0===this.element[0].autocorrect||t.support.touchOverflow||(this.element[0].setAttribute("autocorrect","off"),this.element[0].setAttribute("autocomplete","off"))},_handleBlur:function(){this.widget().removeClass(t.mobile.focusClass),this.options.preventFocusZoom&&t.mobile.zoom.enable(!0)},_handleFocus:function(){this.options.preventFocusZoom&&t.mobile.zoom.disable(!0),this.widget().addClass(t.mobile.focusClass)},_setOptions:function(t){var i=this.widget();this._super(t),(t.disabled!==e||t.mini!==e||t.corners!==e||t.theme!==e||t.wrapperClass!==e)&&(i.removeClass(this.classes.join(" ")),this.classes=this._classesFromOptions(),i.addClass(this.classes.join(" "))),t.disabled!==e&&this.element.prop("disabled",!!t.disabled)},_destroy:function(){this.options.enhanced||(this.inputNeedsWrap&&this.element.unwrap(),this.element.removeClass("ui-input-text "+this.classes.join(" ")))}})}(t),function(t,n){t.widget("mobile.slider",t.extend({initSelector:"input[type='range'], :jqmData(type='range'), :jqmData(role='slider')",widgetEventPrefix:"slide",options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!1},_create:function(){var o,s,a,r,l,c,d,u,h,p,f=this.element,m=this.options.trackTheme||t.mobile.getAttribute(f[0],"theme"),g=m?" ui-bar-"+m:" ui-bar-inherit",v=this.options.corners||f.jqmData("corners")?" ui-corner-all":"",b=this.options.mini||f.jqmData("mini")?" ui-mini":"",y=f[0].nodeName.toLowerCase(),_="select"===y,w=f.parent().is(":jqmData(role='rangeslider')"),x=_?"ui-slider-switch":"",k=f.attr("id"),S=t("[for='"+k+"']"),T=S.attr("id")||k+"-label",C=_?0:parseFloat(f.attr("min")),D=_?f.find("option").length-1:parseFloat(f.attr("max")),M=e.parseFloat(f.attr("step")||1),O=i.createElement("a"),P=t(O),E=i.createElement("div"),A=t(E),I=!(!this.options.highlight||_)&&function(){var e=i.createElement("div");return e.className="ui-slider-bg "+t.mobile.activeBtnClass,t(e).prependTo(A)}();if(S.attr("id",T),this.isToggleSwitch=_,O.setAttribute("href","#"),E.setAttribute("role","application"),E.className=[this.isToggleSwitch?"ui-slider ui-slider-track ui-shadow-inset ":"ui-slider-track ui-shadow-inset ",x,g,v,b].join(""),O.className="ui-slider-handle",E.appendChild(O),P.attr({role:"slider","aria-valuemin":C,"aria-valuemax":D,"aria-valuenow":this._value(),"aria-valuetext":this._value(),title:this._value(),"aria-labelledby":T}),t.extend(this,{slider:A,handle:P,control:f,type:y,step:M,max:D,min:C,valuebg:I,isRangeslider:w,dragging:!1,beforeStart:null,userModified:!1,mouseMoved:!1}),_){for((d=f.attr("tabindex"))&&P.attr("tabindex",d),f.attr("tabindex","-1").focus((function(){t(this).blur(),P.focus()})),(s=i.createElement("div")).className="ui-slider-inneroffset",a=0,r=E.childNodes.length;r>a;a++)s.appendChild(E.childNodes[a]);for(E.appendChild(s),P.addClass("ui-slider-handle-snapping"),l=0,c=(o=f.find("option")).length;c>l;l++)u=l?"a":"b",h=l?" "+t.mobile.activeBtnClass:"",(p=i.createElement("span")).className=["ui-slider-label ui-slider-label-",u,h].join(""),p.setAttribute("role","img"),p.appendChild(i.createTextNode(o[l].innerHTML)),t(p).prependTo(A);this._labels=t(".ui-slider-label",A)}f.addClass(_?"ui-slider-switch":"ui-slider-input"),this._on(f,{change:"_controlChange",keyup:"_controlKeyup",blur:"_controlBlur",vmouseup:"_controlVMouseUp"}),A.bind("vmousedown",t.proxy(this._sliderVMouseDown,this)).bind("vclick",!1),this._on(i,{vmousemove:"_preventDocumentDrag"}),this._on(A.add(i),{vmouseup:"_sliderVMouseUp"}),A.insertAfter(f),_||w||(s=this.options.mini?"<div class='ui-slider ui-mini'>":"<div class='ui-slider'>",f.add(A).wrapAll(s)),this._on(this.handle,{vmousedown:"_handleVMouseDown",keydown:"_handleKeydown",keyup:"_handleKeyup"}),this.handle.bind("vclick",!1),this._handleFormReset(),this.refresh(n,n,!0)},_setOptions:function(t){t.theme!==n&&this._setTheme(t.theme),t.trackTheme!==n&&this._setTrackTheme(t.trackTheme),t.corners!==n&&this._setCorners(t.corners),t.mini!==n&&this._setMini(t.mini),t.highlight!==n&&this._setHighlight(t.highlight),t.disabled!==n&&this._setDisabled(t.disabled),this._super(t)},_controlChange:function(t){return!1!==this._trigger("controlchange",t)&&void(this.mouseMoved||this.refresh(this._value(),!0))},_controlKeyup:function(){this.refresh(this._value(),!0,!0)},_controlBlur:function(){this.refresh(this._value(),!0)},_controlVMouseUp:function(){this._checkedRefresh()},_handleVMouseDown:function(){this.handle.focus()},_handleKeydown:function(e){var i=this._value();if(!this.options.disabled){switch(e.keyCode){case t.mobile.keyCode.HOME:case t.mobile.keyCode.END:case t.mobile.keyCode.PAGE_UP:case t.mobile.keyCode.PAGE_DOWN:case t.mobile.keyCode.UP:case t.mobile.keyCode.RIGHT:case t.mobile.keyCode.DOWN:case t.mobile.keyCode.LEFT:e.preventDefault(),this._keySliding||(this._keySliding=!0,this.handle.addClass("ui-state-active"))}switch(e.keyCode){case t.mobile.keyCode.HOME:this.refresh(this.min);break;case t.mobile.keyCode.END:this.refresh(this.max);break;case t.mobile.keyCode.PAGE_UP:case t.mobile.keyCode.UP:case t.mobile.keyCode.RIGHT:this.refresh(i+this.step);break;case t.mobile.keyCode.PAGE_DOWN:case t.mobile.keyCode.DOWN:case t.mobile.keyCode.LEFT:this.refresh(i-this.step)}}},_handleKeyup:function(){this._keySliding&&(this._keySliding=!1,this.handle.removeClass("ui-state-active"))},_sliderVMouseDown:function(t){return this.options.disabled||1!==t.which&&0!==t.which&&t.which!==n||!1===this._trigger("beforestart",t)||(this.dragging=!0,this.userModified=!1,this.mouseMoved=!1,this.isToggleSwitch&&(this.beforeStart=this.element[0].selectedIndex),this.refresh(t),this._trigger("start")),!1},_sliderVMouseUp:function(){return this.dragging?(this.dragging=!1,this.isToggleSwitch&&(this.handle.addClass("ui-slider-handle-snapping"),this.refresh(this.mouseMoved?this.userModified?0===this.beforeStart?1:0:this.beforeStart:0===this.beforeStart?1:0)),this.mouseMoved=!1,this._trigger("stop"),!1):void 0},_preventDocumentDrag:function(t){return!1!==this._trigger("drag",t)&&(this.dragging&&!this.options.disabled?(this.mouseMoved=!0,this.isToggleSwitch&&this.handle.removeClass("ui-slider-handle-snapping"),this.refresh(t),this.userModified=this.beforeStart!==this.element[0].selectedIndex,!1):void 0)},_checkedRefresh:function(){this.value!==this._value()&&this.refresh(this._value())},_value:function(){return this.isToggleSwitch?this.element[0].selectedIndex:parseFloat(this.element.val())},_reset:function(){this.refresh(n,!1,!0)},refresh:function(e,n,o){var s,a,r,l,c,d,u,h,p,f,m,g,v,b,y,_,w,x,k,S=this,T=t.mobile.getAttribute(this.element[0],"theme"),C=this.options.theme||T,D=C?" ui-btn-"+C:"",M=this.options.trackTheme||T,O=M?" ui-bar-"+M:" ui-bar-inherit",P=this.options.corners?" ui-corner-all":"",E=this.options.mini?" ui-mini":"";if(S.slider[0].className=[this.isToggleSwitch?"ui-slider ui-slider-switch ui-slider-track ui-shadow-inset":"ui-slider-track ui-shadow-inset",O,P,E].join(""),(this.options.disabled||this.element.prop("disabled"))&&this.disable(),this.value=this._value(),this.options.highlight&&!this.isToggleSwitch&&0===this.slider.find(".ui-slider-bg").length&&(this.valuebg=function(){var e=i.createElement("div");return e.className="ui-slider-bg "+t.mobile.activeBtnClass,t(e).prependTo(S.slider)}()),this.handle.addClass("ui-btn"+D+" ui-shadow"),d=this.element,h=(u=!this.isToggleSwitch)?[]:d.find("option"),p=u?parseFloat(d.attr("min")):0,f=u?parseFloat(d.attr("max")):h.length-1,m=u&&parseFloat(d.attr("step"))>0?parseFloat(d.attr("step")):1,"object"==typeof e){if(r=e,8,s=this.slider.offset().left,l=(a=this.slider.width())/((f-p)/m),!this.dragging||r.pageX<s-8||r.pageX>s+a+8)return;c=l>1?(r.pageX-s)/a*100:Math.round((r.pageX-s)/a*100)}else null==e&&(e=u?parseFloat(d.val()||0):d[0].selectedIndex),c=(parseFloat(e)-p)/(f-p)*100;if(!isNaN(c)&&(b=(g=c/100*(f-p)+p)-(v=(g-p)%m),2*Math.abs(v)>=m&&(b+=v>0?m:-m),y=100/((f-p)/m),g=parseFloat(b.toFixed(5)),void 0===l&&(l=a/((f-p)/m)),l>1&&u&&(c=(g-p)*y*(1/m)),0>c&&(c=0),c>100&&(c=100),p>g&&(g=p),g>f&&(g=f),this.handle.css("left",c+"%"),this.handle[0].setAttribute("aria-valuenow",u?g:h.eq(g).attr("value")),this.handle[0].setAttribute("aria-valuetext",u?g:h.eq(g).getEncodedText()),this.handle[0].setAttribute("title",u?g:h.eq(g).getEncodedText()),this.valuebg&&this.valuebg.css("width",c+"%"),this._labels&&(_=this.handle.width()/this.slider.width()*100,w=c&&_+(100-_)*c/100,x=100===c?0:Math.min(_+100-w,100),this._labels.each((function(){var e=t(this).hasClass("ui-slider-label-a");t(this).width((e?w:x)+"%")}))),!o)){if(k=!1,u?(k=parseFloat(d.val())!==g,d.val(g)):(k=d[0].selectedIndex!==g,d[0].selectedIndex=g),!1===this._trigger("beforechange",e))return!1;!n&&k&&d.trigger("change")}},_setHighlight:function(t){(t=!!t)?(this.options.highlight=!!t,this.refresh()):this.valuebg&&(this.valuebg.remove(),this.valuebg=!1)},_setTheme:function(t){this.handle.removeClass("ui-btn-"+this.options.theme).addClass("ui-btn-"+t);var e=this.options.theme?this.options.theme:"inherit",i=t||"inherit";this.control.removeClass("ui-body-"+e).addClass("ui-body-"+i)},_setTrackTheme:function(t){var e=this.options.trackTheme?this.options.trackTheme:"inherit",i=t||"inherit";this.slider.removeClass("ui-body-"+e).addClass("ui-body-"+i)},_setMini:function(t){t=!!t,this.isToggleSwitch||this.isRangeslider||(this.slider.parent().toggleClass("ui-mini",t),this.element.toggleClass("ui-mini",t)),this.slider.toggleClass("ui-mini",t)},_setCorners:function(t){this.slider.toggleClass("ui-corner-all",t),this.isToggleSwitch||this.control.toggleClass("ui-corner-all",t)},_setDisabled:function(t){t=!!t,this.element.prop("disabled",t),this.slider.toggleClass("ui-state-disabled",t).attr("aria-disabled",t),this.element.toggleClass("ui-state-disabled",t)}},t.mobile.behaviors.formReset))}(t),function(t){function e(){return i||(i=t("<div></div>",{class:"ui-slider-popup ui-shadow ui-corner-all"})),i.clone()}var i;t.widget("mobile.slider",t.mobile.slider,{options:{popupEnabled:!1,showValue:!1},_create:function(){this._super(),t.extend(this,{_currentValue:null,_popup:null,_popupVisible:!1}),this._setOption("popupEnabled",this.options.popupEnabled),this._on(this.handle,{vmousedown:"_showPopup"}),this._on(this.slider.add(this.document),{vmouseup:"_hidePopup"}),this._refresh()},_positionPopup:function(){var t=this.handle.offset();this._popup.offset({left:t.left+(this.handle.width()-this._popup.width())/2,top:t.top-this._popup.outerHeight()-5})},_setOption:function(t,i){this._super(t,i),"showValue"===t?this.handle.html(i&&!this.options.mini?this._value():""):"popupEnabled"===t&&i&&!this._popup&&(this._popup=e().addClass("ui-body-"+(this.options.theme||"a")).hide().insertBefore(this.element))},refresh:function(){this._super.apply(this,arguments),this._refresh()},_refresh:function(){var t,e=this.options;e.popupEnabled&&this.handle.removeAttr("title"),(t=this._value())!==this._currentValue&&(this._currentValue=t,e.popupEnabled&&this._popup&&(this._positionPopup(),this._popup.html(t)),e.showValue&&!this.options.mini&&this.handle.html(t))},_showPopup:function(){this.options.popupEnabled&&!this._popupVisible&&(this.handle.html(""),this._popup.show(),this._positionPopup(),this._popupVisible=!0)},_hidePopup:function(){var t=this.options;t.popupEnabled&&this._popupVisible&&(t.showValue&&!t.mini&&this.handle.html(this._value()),this._popup.hide(),this._popupVisible=!1)}})}(t),function(t,e){t.widget("mobile.flipswitch",t.extend({options:{onText:"On",offText:"Off",theme:null,enhanced:!1,wrapperClass:null,corners:!0,mini:!1},_create:function(){this.options.enhanced?t.extend(this,{flipswitch:this.element.parent(),on:this.element.find(".ui-flipswitch-on").eq(0),off:this.element.find(".ui-flipswitch-off").eq(0),type:this.element.get(0).tagName}):this._enhance(),this._handleFormReset(),this._originalTabIndex=this.element.attr("tabindex"),null!=this._originalTabIndex&&this.on.attr("tabindex",this._originalTabIndex),this.element.attr("tabindex","-1"),this._on({focus:"_handleInputFocus"}),this.element.is(":disabled")&&this._setOptions({disabled:!0}),this._on(this.flipswitch,{click:"_toggle",swipeleft:"_left",swiperight:"_right"}),this._on(this.on,{keydown:"_keydown"}),this._on({change:"refresh"})},_handleInputFocus:function(){this.on.focus()},widget:function(){return this.flipswitch},_left:function(){this.flipswitch.removeClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=0:this.element.prop("checked",!1),this.element.trigger("change")},_right:function(){this.flipswitch.addClass("ui-flipswitch-active"),"SELECT"===this.type?this.element.get(0).selectedIndex=1:this.element.prop("checked",!0),this.element.trigger("change")},_enhance:function(){var e=t("<div>"),i=this.options,n=this.element,o=i.theme?i.theme:"inherit",s=t("<a></a>",{href:"#"}),a=t("<span></span>"),r=n.get(0).tagName,l="INPUT"===r?i.onText:n.find("option").eq(1).text(),c="INPUT"===r?i.offText:n.find("option").eq(0).text();s.addClass("ui-flipswitch-on ui-btn ui-shadow ui-btn-inherit").text(l),a.addClass("ui-flipswitch-off").text(c),e.addClass("ui-flipswitch ui-shadow-inset ui-bar-"+o+" "+(i.wrapperClass?i.wrapperClass:"")+" "+(n.is(":checked")||n.find("option").eq(1).is(":selected")?"ui-flipswitch-active":"")+(n.is(":disabled")?" ui-state-disabled":"")+(i.corners?" ui-corner-all":"")+(i.mini?" ui-mini":"")).append(s,a),n.addClass("ui-flipswitch-input").after(e).appendTo(e),t.extend(this,{flipswitch:e,on:s,off:a,type:r})},_reset:function(){this.refresh()},refresh:function(){var t,e=this.flipswitch.hasClass("ui-flipswitch-active")?"_right":"_left";(t="SELECT"===this.type?this.element.get(0).selectedIndex>0?"_right":"_left":this.element.prop("checked")?"_right":"_left")!==e&&this[t]()},_toggle:function(){this[this.flipswitch.hasClass("ui-flipswitch-active")?"_left":"_right"]()},_keydown:function(e){e.which===t.mobile.keyCode.LEFT?this._left():e.which===t.mobile.keyCode.RIGHT?this._right():e.which===t.mobile.keyCode.SPACE&&(this._toggle(),e.preventDefault())},_setOptions:function(t){if(t.theme!==e){var i=t.theme?t.theme:"inherit",n=t.theme?t.theme:"inherit";this.widget().removeClass("ui-bar-"+i).addClass("ui-bar-"+n)}t.onText!==e&&this.on.text(t.onText),t.offText!==e&&this.off.text(t.offText),t.disabled!==e&&this.widget().toggleClass("ui-state-disabled",t.disabled),t.mini!==e&&this.widget().toggleClass("ui-mini",t.mini),t.corners!==e&&this.widget().toggleClass("ui-corner-all",t.corners),this._super(t)},_destroy:function(){this.options.enhanced||(null!=this._originalTabIndex?this.element.attr("tabindex",this._originalTabIndex):this.element.removeAttr("tabindex"),this.on.remove(),this.off.remove(),this.element.unwrap(),this.flipswitch.remove(),this.removeClass("ui-flipswitch-input"))}},t.mobile.behaviors.formReset))}(t),function(t,e){t.widget("mobile.rangeslider",t.extend({options:{theme:null,trackTheme:null,corners:!0,mini:!1,highlight:!0},_create:function(){var e=this.element,i=this.options.mini?"ui-rangeslider ui-mini":"ui-rangeslider",n=e.find("input").first(),o=e.find("input").last(),s=e.find("label").first(),a=t.data(n.get(0),"mobile-slider")||t.data(n.slider().get(0),"mobile-slider"),r=t.data(o.get(0),"mobile-slider")||t.data(o.slider().get(0),"mobile-slider"),l=a.slider,c=r.slider,d=a.handle,u=t("<div class='ui-rangeslider-sliders' />").appendTo(e);n.addClass("ui-rangeslider-first"),o.addClass("ui-rangeslider-last"),e.addClass(i),l.appendTo(u),c.appendTo(u),s.insertBefore(e),d.prependTo(c),t.extend(this,{_inputFirst:n,_inputLast:o,_sliderFirst:l,_sliderLast:c,_label:s,_targetVal:null,_sliderTarget:!1,_sliders:u,_proxy:!1}),this.refresh(),this._on(this.element.find("input.ui-slider-input"),{slidebeforestart:"_slidebeforestart",slidestop:"_slidestop",slidedrag:"_slidedrag",slidebeforechange:"_change",blur:"_change",keyup:"_change"}),this._on({mousedown:"_change"}),this._on(this.element.closest("form"),{reset:"_handleReset"}),this._on(d,{vmousedown:"_dragFirstHandle"})},_handleReset:function(){var t=this;setTimeout((function(){t._updateHighlight()}),0)},_dragFirstHandle:function(e){return t.data(this._inputFirst.get(0),"mobile-slider").dragging=!0,t.data(this._inputFirst.get(0),"mobile-slider").refresh(e),t.data(this._inputFirst.get(0),"mobile-slider")._trigger("start"),!1},_slidedrag:function(e){var i=t(e.target).is(this._inputFirst),n=i?this._inputLast:this._inputFirst;return this._sliderTarget=!1,"first"===this._proxy&&i||"last"===this._proxy&&!i?(t.data(n.get(0),"mobile-slider").dragging=!0,t.data(n.get(0),"mobile-slider").refresh(e),!1):void 0},_slidestop:function(e){var i=t(e.target).is(this._inputFirst);this._proxy=!1,this.element.find("input").trigger("vmouseup"),this._sliderFirst.css("z-index",i?1:"")},_slidebeforestart:function(e){this._sliderTarget=!1,t(e.originalEvent.target).hasClass("ui-slider-track")&&(this._sliderTarget=!0,this._targetVal=t(e.target).val())},_setOptions:function(t){t.theme!==e&&this._setTheme(t.theme),t.trackTheme!==e&&this._setTrackTheme(t.trackTheme),t.mini!==e&&this._setMini(t.mini),t.highlight!==e&&this._setHighlight(t.highlight),t.disabled!==e&&this._setDisabled(t.disabled),this._super(t),this.refresh()},refresh:function(){var t=this.element,e=this.options;(this._inputFirst.is(":disabled")||this._inputLast.is(":disabled"))&&(this.options.disabled=!0),t.find("input").slider({theme:e.theme,trackTheme:e.trackTheme,disabled:e.disabled,corners:e.corners,mini:e.mini,highlight:e.highlight}).slider("refresh"),this._updateHighlight()},_change:function(e){if("keyup"===e.type)return this._updateHighlight(),!1;var i=this,n=parseFloat(this._inputFirst.val(),10),o=parseFloat(this._inputLast.val(),10),s=t(e.target).hasClass("ui-rangeslider-first"),a=s?this._inputFirst:this._inputLast,r=s?this._inputLast:this._inputFirst;if(this._inputFirst.val()>this._inputLast.val()&&"mousedown"===e.type&&!t(e.target).hasClass("ui-slider-handle"))a.blur();else if("mousedown"===e.type)return;return n>o&&!this._sliderTarget?(a.val(s?o:n).slider("refresh"),this._trigger("normalize")):n>o&&(a.val(this._targetVal).slider("refresh"),setTimeout((function(){r.val(s?n:o).slider("refresh"),t.data(r.get(0),"mobile-slider").handle.focus(),i._sliderFirst.css("z-index",s?"":1),i._trigger("normalize")}),0),this._proxy=s?"first":"last"),n===o?(t.data(a.get(0),"mobile-slider").handle.css("z-index",1),t.data(r.get(0),"mobile-slider").handle.css("z-index",0)):(t.data(r.get(0),"mobile-slider").handle.css("z-index",""),t.data(a.get(0),"mobile-slider").handle.css("z-index","")),this._updateHighlight(),!(n>=o)&&void 0},_updateHighlight:function(){var e=parseInt(t.data(this._inputFirst.get(0),"mobile-slider").handle.get(0).style.left,10),i=parseInt(t.data(this._inputLast.get(0),"mobile-slider").handle.get(0).style.left,10)-e;this.element.find(".ui-slider-bg").css({"margin-left":e+"%",width:i+"%"})},_setTheme:function(t){this._inputFirst.slider("option","theme",t),this._inputLast.slider("option","theme",t)},_setTrackTheme:function(t){this._inputFirst.slider("option","trackTheme",t),this._inputLast.slider("option","trackTheme",t)},_setMini:function(t){this._inputFirst.slider("option","mini",t),this._inputLast.slider("option","mini",t),this.element.toggleClass("ui-mini",!!t)},_setHighlight:function(t){this._inputFirst.slider("option","highlight",t),this._inputLast.slider("option","highlight",t)},_setDisabled:function(t){this._inputFirst.prop("disabled",t),this._inputLast.prop("disabled",t)},_destroy:function(){this._label.prependTo(this.element),this.element.removeClass("ui-rangeslider ui-mini"),this._inputFirst.after(this._sliderFirst),this._inputLast.after(this._sliderLast),this._sliders.remove(),this.element.find("input").removeClass("ui-rangeslider-first ui-rangeslider-last").slider("destroy")}},t.mobile.behaviors.formReset))}(t),function(t,e){t.widget("mobile.textinput",t.mobile.textinput,{options:{clearBtn:!1,clearBtnText:"Clear text"},_create:function(){this._super(),this.isSearch&&(this.options.clearBtn=!0),this.options.clearBtn&&this.inputNeedsWrap&&this._addClearBtn()},clearButton:function(){return t("<a href='#' tabindex='-1' aria-hidden='true' class='ui-input-clear ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all'></a>").attr("title",this.options.clearBtnText).text(this.options.clearBtnText)},_clearBtnClick:function(t){this.element.val("").focus().trigger("change"),this._clearBtn.addClass("ui-input-clear-hidden"),t.preventDefault()},_addClearBtn:function(){this.options.enhanced||this._enhanceClear(),t.extend(this,{_clearBtn:this.widget().find("a.ui-input-clear")}),this._bindClearEvents(),this._toggleClear()},_enhanceClear:function(){this.clearButton().appendTo(this.widget()),this.widget().addClass("ui-input-has-clear")},_bindClearEvents:function(){this._on(this._clearBtn,{click:"_clearBtnClick"}),this._on({keyup:"_toggleClear",change:"_toggleClear",input:"_toggleClear",focus:"_toggleClear",blur:"_toggleClear",cut:"_toggleClear",paste:"_toggleClear"})},_unbindClear:function(){this._off(this._clearBtn,"click"),this._off(this.element,"keyup change input focus blur cut paste")},_setOptions:function(t){this._super(t),t.clearBtn===e||this.element.is("textarea, :jqmData(type='range')")||(t.clearBtn?this._addClearBtn():this._destroyClear()),t.clearBtnText!==e&&this._clearBtn!==e&&this._clearBtn.text(t.clearBtnText).attr("title",t.clearBtnText)},_toggleClear:function(){this._delay("_toggleClearClass",0)},_toggleClearClass:function(){this._clearBtn.toggleClass("ui-input-clear-hidden",!this.element.val())},_destroyClear:function(){this.widget().removeClass("ui-input-has-clear"),this._unbindClear(),this._clearBtn.remove()},_destroy:function(){this._super(),this.options.clearBtn&&this._destroyClear()}})}(t),function(t,e){t.widget("mobile.textinput",t.mobile.textinput,{options:{autogrow:!0,keyupTimeoutBuffer:100},_create:function(){this._super(),this.options.autogrow&&this.isTextarea&&this._autogrow()},_autogrow:function(){this.element.addClass("ui-textinput-autogrow"),this._on({keyup:"_timeout",change:"_timeout",input:"_timeout",paste:"_timeout"}),this._on(!0,this.document,{pageshow:"_handleShow",popupbeforeposition:"_handleShow",updatelayout:"_handleShow",panelopen:"_handleShow"})},_handleShow:function(e){t.contains(e.target,this.element[0])&&this.element.is(":visible")&&("popupbeforeposition"!==e.type&&this.element.addClass("ui-textinput-autogrow-resize").animationComplete(t.proxy((function(){this.element.removeClass("ui-textinput-autogrow-resize")}),this),"transition"),this._prepareHeightUpdate())},_unbindAutogrow:function(){this.element.removeClass("ui-textinput-autogrow"),this._off(this.element,"keyup change input paste"),this._off(this.document,"pageshow popupbeforeposition updatelayout panelopen")},keyupTimeout:null,_prepareHeightUpdate:function(t){this.keyupTimeout&&clearTimeout(this.keyupTimeout),t===e?this._updateHeight():this.keyupTimeout=this._delay("_updateHeight",t)},_timeout:function(){this._prepareHeightUpdate(this.options.keyupTimeoutBuffer)},_updateHeight:function(){var t,e,i,n=this.window.scrollTop();this.keyupTimeout=0,"onpage"in this.element[0]||this.element.css({height:0,"min-height":0,"max-height":0}),t=this.element[0].scrollHeight,e=this.element[0].clientHeight,i=t+(parseFloat(this.element.css("border-top-width"))+parseFloat(this.element.css("border-bottom-width")))+15,0===e&&(i+=parseFloat(this.element.css("padding-top"))+parseFloat(this.element.css("padding-bottom"))),this.element.css({height:i,"min-height":"","max-height":""}),this.window.scrollTop(n)},refresh:function(){this.options.autogrow&&this.isTextarea&&this._updateHeight()},_setOptions:function(t){this._super(t),t.autogrow!==e&&this.isTextarea&&(t.autogrow?this._autogrow():this._unbindAutogrow())}})}(t),function(t){t.widget("mobile.selectmenu",t.extend({initSelector:"select:not( :jqmData(role='slider')):not( :jqmData(role='flipswitch') )",options:{theme:null,icon:"carat-d",iconpos:"right",inline:!1,corners:!0,shadow:!0,iconshadow:!1,overlayTheme:null,dividerTheme:null,hidePlaceholderMenuItems:!0,closeText:"Close",nativeMenu:!0,preventFocusZoom:/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1,mini:!1},_button:function(){return t("<div/>")},_setDisabled:function(t){return this.element.attr("disabled",t),this.button.attr("aria-disabled",t),this._setOption("disabled",t)},_focusButton:function(){var t=this;setTimeout((function(){t.button.focus()}),40)},_selectOptions:function(){return this.select.find("option")},_preExtension:function(){var e=this.options.inline||this.element.jqmData("inline"),i=this.options.mini||this.element.jqmData("mini"),n="";~this.element[0].className.indexOf("ui-btn-left")&&(n=" ui-btn-left"),~this.element[0].className.indexOf("ui-btn-right")&&(n=" ui-btn-right"),e&&(n+=" ui-btn-inline"),i&&(n+=" ui-mini"),this.select=this.element.removeClass("ui-btn-left ui-btn-right").wrap("<div class='ui-select"+n+"'>"),this.selectId=this.select.attr("id")||"select-"+this.uuid,this.buttonId=this.selectId+"-button",this.label=t("label[for='"+this.selectId+"']"),this.isMultiple=this.select[0].multiple},_destroy:function(){var t=this.element.parents(".ui-select");t.length>0&&(t.is(".ui-btn-left, .ui-btn-right")&&this.element.addClass(t.hasClass("ui-btn-left")?"ui-btn-left":"ui-btn-right"),this.element.insertAfter(t),t.remove())},_create:function(){this._preExtension(),this.button=this._button();var i=this,n=this.options,o=!!n.icon&&(n.iconpos||this.select.jqmData("iconpos")),s=this.button.insertBefore(this.select).attr("id",this.buttonId).addClass("ui-btn"+(n.icon?" ui-icon-"+n.icon+" ui-btn-icon-"+o+(n.iconshadow?" ui-shadow-icon":""):"")+(n.theme?" ui-btn-"+n.theme:"")+(n.corners?" ui-corner-all":"")+(n.shadow?" ui-shadow":""));this.setButtonText(),n.nativeMenu&&e.opera&&e.opera.version&&s.addClass("ui-select-nativeonly"),this.isMultiple&&(this.buttonCount=t("<span>").addClass("ui-li-count ui-body-inherit").hide().appendTo(s.addClass("ui-li-has-count"))),(n.disabled||this.element.attr("disabled"))&&this.disable(),this.select.change((function(){i.refresh(),n.nativeMenu&&i._delay((function(){i.select.blur()}))})),this._handleFormReset(),this._on(this.button,{keydown:"_handleKeydown"}),this.build()},build:function(){var e=this;this.select.appendTo(e.button).bind("vmousedown",(function(){e.button.addClass(t.mobile.activeBtnClass)})).bind("focus",(function(){e.button.addClass(t.mobile.focusClass)})).bind("blur",(function(){e.button.removeClass(t.mobile.focusClass)})).bind("focus vmouseover",(function(){e.button.trigger("vmouseover")})).bind("vmousemove",(function(){e.button.removeClass(t.mobile.activeBtnClass)})).bind("change blur vmouseout",(function(){e.button.trigger("vmouseout").removeClass(t.mobile.activeBtnClass)})),e.button.bind("vmousedown",(function(){e.options.preventFocusZoom&&t.mobile.zoom.disable(!0)})),e.label.bind("click focus",(function(){e.options.preventFocusZoom&&t.mobile.zoom.disable(!0)})),e.select.bind("focus",(function(){e.options.preventFocusZoom&&t.mobile.zoom.disable(!0)})),e.button.bind("mouseup",(function(){e.options.preventFocusZoom&&setTimeout((function(){t.mobile.zoom.enable(!0)}),0)})),e.select.bind("blur",(function(){e.options.preventFocusZoom&&t.mobile.zoom.enable(!0)}))},selected:function(){return this._selectOptions().filter(":selected")},selectedIndices:function(){var t=this;return this.selected().map((function(){return t._selectOptions().index(this)})).get()},setButtonText:function(){var e=this,n=this.selected(),o=this.placeholder,s=t(i.createElement("span"));this.button.children("span").not(".ui-li-count").remove().end().end().prepend(((o=n.length?n.map((function(){return t(this).text()})).get().join(", "):e.placeholder)?s.text(o):s.html("&#160;"),s.addClass(e.select.attr("class")).addClass(n.attr("class")).removeClass("ui-screen-hidden")))},setButtonCount:function(){var t=this.selected();this.isMultiple&&this.buttonCount[t.length>1?"show":"hide"]().text(t.length)},_handleKeydown:function(){this._delay("_refreshButton")},_reset:function(){this.refresh()},_refreshButton:function(){this.setButtonText(),this.setButtonCount()},refresh:function(){this._refreshButton()},open:t.noop,close:t.noop,disable:function(){this._setDisabled(!0),this.button.addClass("ui-state-disabled")},enable:function(){this._setDisabled(!1),this.button.removeClass("ui-state-disabled")}},t.mobile.behaviors.formReset))}(t),function(t){t.mobile.links=function(e){t(e).find("a").jqmEnhanceable().filter(":jqmData(rel='popup')[href][href!='']").each((function(){var t=this,e=t.getAttribute("href").substring(1);e&&(t.setAttribute("aria-haspopup",!0),t.setAttribute("aria-owns",e),t.setAttribute("aria-expanded",!1))})).end().not(".ui-btn, :jqmData(role='none'), :jqmData(role='nojs')").addClass("ui-link")}}(t),function(t,i){function n(t,e,i,n){return e>t?i+(t-e)/2:Math.min(Math.max(i,n-e/2),i+t-e)}function o(t){return{x:t.scrollLeft(),y:t.scrollTop(),cx:t[0].innerWidth||t.width(),cy:t[0].innerHeight||t.height()}}t.widget("mobile.popup",{options:{wrapperClass:null,theme:null,overlayTheme:null,shadow:!0,corners:!0,transition:"none",positionTo:"origin",tolerance:null,closeLinkSelector:"a:jqmData(rel='back')",closeLinkEvents:"click.popup",navigateEvents:"navigate.popup",closeEvents:"navigate.popup pagebeforechange.popup",dismissible:!0,enhanced:!1,history:!t.mobile.browser.oldIE},_handleDocumentVmousedown:function(e){this._isOpen&&t.contains(this._ui.container[0],e.target)&&this._ignoreResizeEvents()},_create:function(){var e=this.element,i=e.attr("id"),n=this.options;n.history=n.history&&t.mobile.ajaxEnabled&&t.mobile.hashListeningEnabled,this._on(this.document,{vmousedown:"_handleDocumentVmousedown"}),t.extend(this,{_scrollTop:0,_page:e.closest(".ui-page"),_ui:null,_fallbackTransition:"",_currentTransition:!1,_prerequisites:null,_isOpen:!1,_tolerance:null,_resizeData:null,_ignoreResizeTo:0,_orientationchangeInProgress:!1}),0===this._page.length&&(this._page=t("body")),n.enhanced?this._ui={container:e.parent(),screen:e.parent().prev(),placeholder:t(this.document[0].getElementById(i+"-placeholder"))}:(this._ui=this._enhance(e,i),this._applyTransition(n.transition)),this._setTolerance(n.tolerance)._ui.focusElement=this._ui.container,this._on(this._ui.screen,{vclick:"_eatEventAndClose"}),this._on(this.window,{orientationchange:t.proxy(this,"_handleWindowOrientationchange"),resize:t.proxy(this,"_handleWindowResize"),keyup:t.proxy(this,"_handleWindowKeyUp")}),this._on(this.document,{focusin:"_handleDocumentFocusIn"})},_enhance:function(e,i){var n=this.options,o=n.wrapperClass,s={screen:t("<div class='ui-screen-hidden ui-popup-screen "+this._themeClassFromOption("ui-overlay-",n.overlayTheme)+"'></div>"),placeholder:t("<div style='display: none;'>\x3c!-- placeholder --\x3e</div>"),container:t("<div class='ui-popup-container ui-popup-hidden ui-popup-truncate"+(o?" "+o:"")+"'></div>")},a=this.document[0].createDocumentFragment();return a.appendChild(s.screen[0]),a.appendChild(s.container[0]),i&&(s.screen.attr("id",i+"-screen"),s.container.attr("id",i+"-popup"),s.placeholder.attr("id",i+"-placeholder").html("\x3c!-- placeholder for "+i+" --\x3e")),this._page[0].appendChild(a),s.placeholder.insertAfter(e),e.detach().addClass("ui-popup "+this._themeClassFromOption("ui-body-",n.theme)+" "+(n.shadow?"ui-overlay-shadow ":"")+(n.corners?"ui-corner-all ":"")).appendTo(s.container),s},_eatEventAndClose:function(t){return t.preventDefault(),t.stopImmediatePropagation(),this.options.dismissible&&this.close(),!1},_resizeScreen:function(){var t=this._ui.screen,e=this._ui.container.outerHeight(!0),i=t.removeAttr("style").height(),n=this.document.height()-1;n>i?t.height(n):e>i&&t.height(e)},_handleWindowKeyUp:function(e){return this._isOpen&&e.keyCode===t.mobile.keyCode.ESCAPE?this._eatEventAndClose(e):void 0},_expectResizeEvent:function(){var t=o(this.window);if(this._resizeData){if(t.x===this._resizeData.windowCoordinates.x&&t.y===this._resizeData.windowCoordinates.y&&t.cx===this._resizeData.windowCoordinates.cx&&t.cy===this._resizeData.windowCoordinates.cy)return!1;clearTimeout(this._resizeData.timeoutId)}return this._resizeData={timeoutId:this._delay("_resizeTimeout",200),windowCoordinates:t},!0},_resizeTimeout:function(){this._isOpen?this._expectResizeEvent()||(this._ui.container.hasClass("ui-popup-hidden")&&(this._ui.container.removeClass("ui-popup-hidden ui-popup-truncate"),this.reposition({positionTo:"window"}),this._ignoreResizeEvents()),this._resizeScreen(),this._resizeData=null,this._orientationchangeInProgress=!1):(this._resizeData=null,this._orientationchangeInProgress=!1)},_stopIgnoringResizeEvents:function(){this._ignoreResizeTo=0},_ignoreResizeEvents:function(){this._ignoreResizeTo&&clearTimeout(this._ignoreResizeTo),this._ignoreResizeTo=this._delay("_stopIgnoringResizeEvents",1e3)},_handleWindowResize:function(){this._isOpen&&0===this._ignoreResizeTo&&(!this._expectResizeEvent()&&!this._orientationchangeInProgress||this._ui.container.hasClass("ui-popup-hidden")||this._ui.container.addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style"))},_handleWindowOrientationchange:function(){!this._orientationchangeInProgress&&this._isOpen&&0===this._ignoreResizeTo&&(this._expectResizeEvent(),this._orientationchangeInProgress=!0)},_handleDocumentFocusIn:function(e){var i,n=e.target,o=this._ui;if(this._isOpen){if(n!==o.container[0]){if(i=t(n),!t.contains(o.container[0],n))return t(this.document[0].activeElement).one("focus",t.proxy((function(){this._safelyBlur(n)}),this)),o.focusElement.focus(),e.preventDefault(),e.stopImmediatePropagation(),!1;o.focusElement[0]===o.container[0]&&(o.focusElement=i)}this._ignoreResizeEvents()}},_themeClassFromOption:function(t,e){return e?"none"===e?"":t+e:t+"inherit"},_applyTransition:function(e){return e&&(this._ui.container.removeClass(this._fallbackTransition),"none"!==e&&(this._fallbackTransition=t.mobile._maybeDegradeTransition(e),"none"===this._fallbackTransition&&(this._fallbackTransition=""),this._ui.container.addClass(this._fallbackTransition))),this},_setOptions:function(t){var e=this.options,n=this.element,o=this._ui.screen;return t.wrapperClass!==i&&this._ui.container.removeClass(e.wrapperClass).addClass(t.wrapperClass),t.theme!==i&&n.removeClass(this._themeClassFromOption("ui-body-",e.theme)).addClass(this._themeClassFromOption("ui-body-",t.theme)),t.overlayTheme!==i&&(o.removeClass(this._themeClassFromOption("ui-overlay-",e.overlayTheme)).addClass(this._themeClassFromOption("ui-overlay-",t.overlayTheme)),this._isOpen&&o.addClass("in")),t.shadow!==i&&n.toggleClass("ui-overlay-shadow",t.shadow),t.corners!==i&&n.toggleClass("ui-corner-all",t.corners),t.transition!==i&&(this._currentTransition||this._applyTransition(t.transition)),t.tolerance!==i&&this._setTolerance(t.tolerance),t.disabled!==i&&t.disabled&&this.close(),this._super(t)},_setTolerance:function(e){var n,o={t:30,r:15,b:30,l:15};if(e!==i)switch(n=String(e).split(","),t.each(n,(function(t,e){n[t]=parseInt(e,10)})),n.length){case 1:isNaN(n[0])||(o.t=o.r=o.b=o.l=n[0]);break;case 2:isNaN(n[0])||(o.t=o.b=n[0]),isNaN(n[1])||(o.l=o.r=n[1]);break;case 4:isNaN(n[0])||(o.t=n[0]),isNaN(n[1])||(o.r=n[1]),isNaN(n[2])||(o.b=n[2]),isNaN(n[3])||(o.l=n[3])}return this._tolerance=o,this},_clampPopupWidth:function(t){var e=o(this.window),i={x:this._tolerance.l,y:e.y+this._tolerance.t,cx:e.cx-this._tolerance.l-this._tolerance.r,cy:e.cy-this._tolerance.t-this._tolerance.b};return t||this._ui.container.css("max-width",i.cx),{rc:i,menuSize:{cx:this._ui.container.outerWidth(!0),cy:this._ui.container.outerHeight(!0)}}},_calculateFinalLocation:function(t,e){var i,o=e.rc,s=e.menuSize;return(i={left:n(o.cx,s.cx,o.x,t.x),top:n(o.cy,s.cy,o.y,t.y)}).top=Math.max(0,i.top),i.top-=Math.min(i.top,Math.max(0,i.top+s.cy-this.document.height())),i},_placementCoords:function(t){return this._calculateFinalLocation(t,this._clampPopupWidth())},_createPrerequisites:function(e,i,n){var o,s=this;(o={screen:t.Deferred(),container:t.Deferred()}).screen.then((function(){o===s._prerequisites&&e()})),o.container.then((function(){o===s._prerequisites&&i()})),t.when(o.screen,o.container).done((function(){o===s._prerequisites&&(s._prerequisites=null,n())})),s._prerequisites=o},_animate:function(e){return this._ui.screen.removeClass(e.classToRemove).addClass(e.screenClassToAdd),e.prerequisites.screen.resolve(),e.transition&&"none"!==e.transition&&(e.applyTransition&&this._applyTransition(e.transition),this._fallbackTransition)?void this._ui.container.addClass(e.containerClassToAdd).removeClass(e.classToRemove).animationComplete(t.proxy(e.prerequisites.container,"resolve")):(this._ui.container.removeClass(e.classToRemove),void e.prerequisites.container.resolve())},_desiredCoords:function(e){var i,n=null,s=o(this.window),a=e.x,r=e.y,l=e.positionTo;if(l&&"origin"!==l)if("window"===l)a=s.cx/2+s.x,r=s.cy/2+s.y;else{try{n=t(l)}catch(t){n=null}n&&(n.filter(":visible"),0===n.length&&(n=null))}return n&&(a=(i=n.offset()).left+n.outerWidth()/2,r=i.top+n.outerHeight()/2),("number"!==t.type(a)||isNaN(a))&&(a=s.cx/2+s.x),("number"!==t.type(r)||isNaN(r))&&(r=s.cy/2+s.y),{x:a,y:r}},_reposition:function(t){t={x:t.x,y:t.y,positionTo:t.positionTo},this._trigger("beforeposition",i,t),this._ui.container.offset(this._placementCoords(this._desiredCoords(t)))},reposition:function(t){this._isOpen&&this._reposition(t)},_safelyBlur:function(e){e!==this.window[0]&&"body"!==e.nodeName.toLowerCase()&&t(e).blur()},_openPrerequisitesComplete:function(){var e=this.element.attr("id"),i=this._ui.container.find(":focusable").first();this._ui.container.addClass("ui-popup-active"),this._isOpen=!0,this._resizeScreen(),t.contains(this._ui.container[0],this.document[0].activeElement)||this._safelyBlur(this.document[0].activeElement),i.length>0&&(this._ui.focusElement=i),this._ignoreResizeEvents(),e&&this.document.find("[aria-haspopup='true'][aria-owns='"+e+"']").attr("aria-expanded",!0),this._trigger("afteropen")},_open:function(e){var i=t.extend({},this.options,e),n=function(){var t=navigator.userAgent,e=t.match(/AppleWebKit\/([0-9\.]+)/),i=!!e&&e[1],n=t.match(/Android (\d+(?:\.\d+))/),o=!!n&&n[1],s=t.indexOf("Chrome")>-1;return!(!(null!==n&&"4.0"===o&&i&&i>534.13)||s)}();this._createPrerequisites(t.noop,t.noop,t.proxy(this,"_openPrerequisitesComplete")),this._currentTransition=i.transition,this._applyTransition(i.transition),this._ui.screen.removeClass("ui-screen-hidden"),this._ui.container.removeClass("ui-popup-truncate"),this._reposition(i),this._ui.container.removeClass("ui-popup-hidden"),this.options.overlayTheme&&n&&this.element.closest(".ui-page").addClass("ui-popup-open"),this._animate({additionalCondition:!0,transition:i.transition,classToRemove:"",screenClassToAdd:"in",containerClassToAdd:"in",applyTransition:!1,prerequisites:this._prerequisites})},_closePrerequisiteScreen:function(){this._ui.screen.removeClass("out").addClass("ui-screen-hidden")},_closePrerequisiteContainer:function(){this._ui.container.removeClass("reverse out").addClass("ui-popup-hidden ui-popup-truncate").removeAttr("style")},_closePrerequisitesDone:function(){var e=this._ui.container,n=this.element.attr("id");t.mobile.popup.active=i,t(":focus",e[0]).add(e[0]).blur(),n&&this.document.find("[aria-haspopup='true'][aria-owns='"+n+"']").attr("aria-expanded",!1),this._trigger("afterclose")},_close:function(e){this._ui.container.removeClass("ui-popup-active"),this._page.removeClass("ui-popup-open"),this._isOpen=!1,this._createPrerequisites(t.proxy(this,"_closePrerequisiteScreen"),t.proxy(this,"_closePrerequisiteContainer"),t.proxy(this,"_closePrerequisitesDone")),this._animate({additionalCondition:this._ui.screen.hasClass("in"),transition:e?"none":this._currentTransition,classToRemove:"in",screenClassToAdd:"out",containerClassToAdd:"reverse out",applyTransition:!0,prerequisites:this._prerequisites})},_unenhance:function(){this.options.enhanced||(this._setOptions({theme:t.mobile.popup.prototype.options.theme}),this.element.detach().insertAfter(this._ui.placeholder).removeClass("ui-popup ui-overlay-shadow ui-corner-all ui-body-inherit"),this._ui.screen.remove(),this._ui.container.remove(),this._ui.placeholder.remove())},_destroy:function(){return t.mobile.popup.active===this?(this.element.one("popupafterclose",t.proxy(this,"_unenhance")),this.close()):this._unenhance(),this},_closePopup:function(i,n){var o,s,a=this.options,r=!1;i&&i.isDefaultPrevented()||t.mobile.popup.active!==this||(e.scrollTo(0,this._scrollTop),i&&"pagebeforechange"===i.type&&n&&(o="string"==typeof n.toPage?n.toPage:n.toPage.jqmData("url"),s=(o=t.mobile.path.parseUrl(o)).pathname+o.search+o.hash,this._myUrl!==t.mobile.path.makeUrlAbsolute(s)?r=!0:i.preventDefault()),this.window.off(a.closeEvents),this.element.undelegate(a.closeLinkSelector,a.closeLinkEvents),this._close(r))},_bindContainerClose:function(){this.window.on(this.options.closeEvents,t.proxy(this,"_closePopup"))},widget:function(){return this._ui.container},open:function(e){var i,n,o,s,a,r=this,l=this.options;return t.mobile.popup.active||l.disabled?this:(t.mobile.popup.active=this,this._scrollTop=this.window.scrollTop(),l.history?(a=t.mobile.navigate.history,n=t.mobile.dialogHashKey,s=!!(o=t.mobile.activePage)&&o.hasClass("ui-dialog"),this._myUrl=i=a.getActive().url,i.indexOf(n)>-1&&!s&&a.activeIndex>0?(r._open(e),r._bindContainerClose(),this):(-1!==i.indexOf(n)||s?i=t.mobile.path.parseLocation().hash+n:i+=i.indexOf("#")>-1?n:"#"+n,this.window.one("beforenavigate",(function(t){t.preventDefault(),r._open(e),r._bindContainerClose()})),this.urlAltered=!0,t.mobile.navigate(i,{role:"dialog"}),this)):(r._open(e),r._bindContainerClose(),r.element.delegate(l.closeLinkSelector,l.closeLinkEvents,(function(t){r.close(),t.preventDefault()})),this))},close:function(){return t.mobile.popup.active!==this||(this._scrollTop=this.window.scrollTop(),this.options.history&&this.urlAltered?(t.mobile.back(),this.urlAltered=!1):this._closePopup()),this}}),t.mobile.popup.handleLink=function(e){var i,n=t.mobile.path,o=t(n.hashToSelector(n.parseUrl(e.attr("href")).hash)).first();o.length>0&&o.data("mobile-popup")&&(i=e.offset(),o.popup("open",{x:i.left+e.outerWidth()/2,y:i.top+e.outerHeight()/2,transition:e.jqmData("transition"),positionTo:e.jqmData("position-to")})),setTimeout((function(){e.removeClass(t.mobile.activeBtnClass)}),300)},t.mobile.document.on("pagebeforechange",(function(e,i){"popup"===i.options.role&&(t.mobile.popup.handleLink(i.options.link),e.preventDefault())}))}(t),function(t,e){var n=".ui-disabled,.ui-state-disabled,.ui-li-divider,.ui-screen-hidden,:jqmData(role='placeholder')",o=function(t,e,i){var o=t[i+"All"]().not(n).first();o.length&&(e.blur().attr("tabindex","-1"),o.find("a").first().focus())};t.widget("mobile.selectmenu",t.mobile.selectmenu,{_create:function(){var t=this.options;return t.nativeMenu=t.nativeMenu||this.element.parents(":jqmData(role='popup'),:mobile-popup").length>0,this._super()},_handleSelectFocus:function(){this.element.blur(),this.button.focus()},_handleKeydown:function(t){this._super(t),this._handleButtonVclickKeydown(t)},_handleButtonVclickKeydown:function(e){this.options.disabled||this.isOpen||this.options.nativeMenu||("vclick"===e.type||e.keyCode&&(e.keyCode===t.mobile.keyCode.ENTER||e.keyCode===t.mobile.keyCode.SPACE))&&(this._decideFormat(),"overlay"===this.menuType?this.button.attr("href","#"+this.popupId).attr("data-"+(t.mobile.ns||"")+"rel","popup"):this.button.attr("href","#"+this.dialogId).attr("data-"+(t.mobile.ns||"")+"rel","dialog"),this.isOpen=!0)},_handleListFocus:function(e){var i="focusin"===e.type?{tabindex:"0",event:"vmouseover"}:{tabindex:"-1",event:"vmouseout"};t(e.target).attr("tabindex",i.tabindex).trigger(i.event)},_handleListKeydown:function(e){var i=t(e.target),n=i.closest("li");switch(e.keyCode){case 38:return o(n,i,"prev"),!1;case 40:return o(n,i,"next"),!1;case 13:case 32:return i.trigger("click"),!1}},_handleMenuPageHide:function(){this._delayedTrigger(),this.thisPage.page("bindRemove")},_handleHeaderCloseClick:function(){return"overlay"===this.menuType?(this.close(),!1):void 0},_handleListItemClick:function(e){var i=t(e.target).closest("li"),n=this.select[0].selectedIndex,o=t.mobile.getAttribute(i,"option-index"),s=this._selectOptions().eq(o)[0];s.selected=!this.isMultiple||!s.selected,this.isMultiple&&i.find("a").toggleClass("ui-checkbox-on",s.selected).toggleClass("ui-checkbox-off",!s.selected),this.isMultiple||n===o||(this._triggerChange=!0),this.isMultiple?(this.select.trigger("change"),this.list.find("li:not(.ui-li-divider)").eq(o).find("a").first().focus()):this.close(),e.preventDefault()},build:function(){var i,n,o,s,a,r,l,c,d,u,h,p,f,m,g,v,b,y=this.options;return y.nativeMenu?this._super():(n=(i=this.selectId)+"-listbox",o=i+"-dialog",s=this.label,a=this.element.closest(".ui-page"),r=this.element[0].multiple,l=i+"-menu",c=y.theme?" data-"+t.mobile.ns+"theme='"+y.theme+"'":"",u=(d=y.overlayTheme||y.theme||null)?" data-"+t.mobile.ns+"overlay-theme='"+d+"'":"",h=y.dividerTheme&&r?" data-"+t.mobile.ns+"divider-theme='"+y.dividerTheme+"'":"",p=t("<div data-"+t.mobile.ns+"role='dialog' class='ui-selectmenu' id='"+o+"'"+c+u+"><div data-"+t.mobile.ns+"role='header'><div class='ui-title'></div></div><div data-"+t.mobile.ns+"role='content'></div></div>"),f=t("<div"+c+u+" id='"+n+"' class='ui-selectmenu'></div>").insertAfter(this.select).popup(),m=t("<ul class='ui-selectmenu-list' id='"+l+"' role='listbox' aria-labelledby='"+this.buttonId+"'"+c+h+"></ul>").appendTo(f),g=t("<div class='ui-header ui-bar-"+(y.theme?y.theme:"inherit")+"'></div>").prependTo(f),v=t("<h1 class='ui-title'></h1>").appendTo(g),this.isMultiple&&(b=t("<a>",{role:"button",text:y.closeText,href:"#",class:"ui-btn ui-corner-all ui-btn-left ui-btn-icon-notext ui-icon-delete"}).appendTo(g)),t.extend(this,{selectId:i,menuId:l,popupId:n,dialogId:o,thisPage:a,menuPage:p,label:s,isMultiple:r,theme:y.theme,listbox:f,list:m,header:g,headerTitle:v,headerClose:b,menuPageContent:undefined,menuPageClose:undefined,placeholder:""}),this.refresh(),this._origTabIndex===e&&(this._origTabIndex=null!==this.select[0].getAttribute("tabindex")&&this.select.attr("tabindex")),this.select.attr("tabindex","-1"),this._on(this.select,{focus:"_handleSelectFocus"}),this._on(this.button,{vclick:"_handleButtonVclickKeydown"}),this.list.attr("role","listbox"),this._on(this.list,{focusin:"_handleListFocus",focusout:"_handleListFocus",keydown:"_handleListKeydown","click li:not(.ui-disabled,.ui-state-disabled,.ui-li-divider)":"_handleListItemClick"}),this._on(this.menuPage,{pagehide:"_handleMenuPageHide"}),this._on(this.listbox,{popupafterclose:"_popupClosed"}),this.isMultiple&&this._on(this.headerClose,{click:"_handleHeaderCloseClick"}),this)},_popupClosed:function(){this.close(),this._delayedTrigger()},_delayedTrigger:function(){this._triggerChange&&this.element.trigger("change"),this._triggerChange=!1},_isRebuildRequired:function(){var t=this.list.find("li");return this._selectOptions().not(".ui-screen-hidden").text()!==t.text()},selected:function(){return this._selectOptions().filter(":selected:not( :jqmData(placeholder='true') )")},refresh:function(e){var i,n;return this.options.nativeMenu?this._super(e):(i=this,(e||this._isRebuildRequired())&&i._buildList(),n=this.selectedIndices(),i.setButtonText(),i.setButtonCount(),void i.list.find("li:not(.ui-li-divider)").find("a").removeClass(t.mobile.activeBtnClass).end().attr("aria-selected",!1).each((function(e){var o=t(this);t.inArray(e,n)>-1?(o.attr("aria-selected",!0),i.isMultiple?o.find("a").removeClass("ui-checkbox-off").addClass("ui-checkbox-on"):o.hasClass("ui-screen-hidden")?o.next().find("a").addClass(t.mobile.activeBtnClass):o.find("a").addClass(t.mobile.activeBtnClass)):i.isMultiple&&o.find("a").removeClass("ui-checkbox-on").addClass("ui-checkbox-off")})))},close:function(){if(!this.options.disabled&&this.isOpen){var t=this;"page"===t.menuType?(t.menuPage.dialog("close"),t.list.appendTo(t.listbox)):t.listbox.popup("close"),t._focusButton(),t.isOpen=!1}},open:function(){this.button.click()},_focusMenuItem:function(){var e=this.list.find("a."+t.mobile.activeBtnClass);0===e.length&&(e=this.list.find("li:not("+n+") a.ui-btn")),e.first().focus()},_decideFormat:function(){var e=this,i=this.window,n=e.list.parent().outerHeight(),o=i.scrollTop(),s=e.button.offset().top,a=i.height();n>a-80||!t.support.scrollTop?(e.menuPage.appendTo(t.mobile.pageContainer).page(),e.menuPageContent=e.menuPage.find(".ui-content"),e.menuPageClose=e.menuPage.find(".ui-header a"),e.thisPage.unbind("pagehide.remove"),0===o&&s>a&&e.thisPage.one("pagehide",(function(){t(this).jqmData("lastScroll",s)})),e.menuPage.one({pageshow:t.proxy(this,"_focusMenuItem"),pagehide:t.proxy(this,"close")}),e.menuType="page",e.menuPageContent.append(e.list),e.menuPage.find("div .ui-title").text(e.label.getEncodedText()||e.placeholder)):(e.menuType="overlay",e.listbox.one({popupafteropen:t.proxy(this,"_focusMenuItem")}))},_buildList:function(){var e,n,o,s,a,r,l,c,d,u,h,p,f,m,g=this,v=this.options,b=this.placeholder,y=!0,_="data-"+t.mobile.ns,w=_+"option-index",x=_+"icon",k=_+"role",S=_+"placeholder",T=i.createDocumentFragment(),C=!1;for(g.list.empty().filter(".ui-listview").listview("destroy"),n=(e=this._selectOptions()).length,o=this.select[0],a=0;n>a;a++,C=!1)r=e[a],(l=t(r)).hasClass("ui-screen-hidden")||(c=r.parentNode,h=[],d=l.text(),(u=i.createElement("a")).setAttribute("href","#"),u.appendChild(i.createTextNode(d)),c!==o&&"optgroup"===c.nodeName.toLowerCase()&&((p=c.getAttribute("label"))!==s&&((f=i.createElement("li")).setAttribute(k,"list-divider"),f.setAttribute("role","option"),f.setAttribute("tabindex","-1"),f.appendChild(i.createTextNode(p)),T.appendChild(f),s=p)),!y||r.getAttribute("value")&&0!==d.length&&!l.jqmData("placeholder")||(y=!1,C=!0,null===r.getAttribute(S)&&(this._removePlaceholderAttr=!0),r.setAttribute(S,!0),v.hidePlaceholderMenuItems&&h.push("ui-screen-hidden"),b!==d&&(b=g.placeholder=d)),m=i.createElement("li"),r.disabled&&(h.push("ui-state-disabled"),m.setAttribute("aria-disabled",!0)),m.setAttribute(w,a),m.setAttribute(x,"false"),C&&m.setAttribute(S,!0),m.className=h.join(" "),m.setAttribute("role","option"),u.setAttribute("tabindex","-1"),this.isMultiple&&t(u).addClass("ui-btn ui-checkbox-off ui-btn-icon-right"),m.appendChild(u),T.appendChild(m));g.list[0].appendChild(T),this.isMultiple||b.length?this.headerTitle.text(this.placeholder):this.header.addClass("ui-screen-hidden"),g.list.listview()},_button:function(){return this.options.nativeMenu?this._super():t("<a>",{href:"#",role:"button",id:this.buttonId,"aria-haspopup":"true","aria-owns":this.menuId})},_destroy:function(){this.options.nativeMenu||(this.close(),this._origTabIndex!==e&&(!1!==this._origTabIndex?this.select.attr("tabindex",this._origTabIndex):this.select.removeAttr("tabindex")),this._removePlaceholderAttr&&this._selectOptions().removeAttr("data-"+t.mobile.ns+"placeholder"),this.listbox.remove(),this.menuPage.remove()),this._super()}})}(t),function(t,e){function i(t,e){var i=e||[];return i.push("ui-btn"),t.theme&&i.push("ui-btn-"+t.theme),t.icon&&(i=i.concat(["ui-icon-"+t.icon,"ui-btn-icon-"+t.iconpos]),t.iconshadow&&i.push("ui-shadow-icon")),t.inline&&i.push("ui-btn-inline"),t.shadow&&i.push("ui-shadow"),t.corners&&i.push("ui-corner-all"),t.mini&&i.push("ui-mini"),i}function n(t){var i,n,o,a=!1,r=!0,l={icon:"",inline:!1,shadow:!1,corners:!1,iconshadow:!1,mini:!1},c=[];for(t=t.split(" "),i=0;i<t.length;i++)o=!0,(n=s[t[i]])!==e?(o=!1,l[n]=!0):0===t[i].indexOf("ui-btn-icon-")?(o=!1,r=!1,l.iconpos=t[i].substring(12)):0===t[i].indexOf("ui-icon-")?(o=!1,l.icon=t[i].substring(8)):0===t[i].indexOf("ui-btn-")&&8===t[i].length?(o=!1,l.theme=t[i].substring(7)):"ui-btn"===t[i]&&(o=!1,a=!0),o&&c.push(t[i]);return r&&(l.icon=""),{options:l,unknownClasses:c,alreadyEnhanced:a}}function o(t){return"-"+t.toLowerCase()}var s={"ui-shadow":"shadow","ui-corner-all":"corners","ui-btn-inline":"inline","ui-shadow-icon":"iconshadow","ui-mini":"mini"},a=function(){var i=t.mobile.getAttribute.apply(this,arguments);return null==i?e:i},r=/[A-Z]/g;t.fn.buttonMarkup=function(s,l){var c,d,u,h,p,f=t.fn.buttonMarkup.defaults;for(c=0;c<this.length;c++){if(u=this[c],d=l?{alreadyEnhanced:!1,unknownClasses:[]}:n(u.className),h=t.extend({},d.alreadyEnhanced?d.options:{},s),!d.alreadyEnhanced)for(p in f)h[p]===e&&(h[p]=a(u,p.replace(r,o)));u.className=i(t.extend({},f,h),d.unknownClasses).join(" "),"button"!==u.tagName.toLowerCase()&&u.setAttribute("role","button")}return this},t.fn.buttonMarkup.defaults={icon:"",iconpos:"left",theme:null,inline:!1,shadow:!0,corners:!0,iconshadow:!1,mini:!1},t.extend(t.fn.buttonMarkup,{initSelector:"a:jqmData(role='button'), .ui-bar > a, .ui-bar > :jqmData(role='controlgroup') > a, button:not(:jqmData(role='navbar') button)"})}(t),function(t,e){t.widget("mobile.controlgroup",t.extend({options:{enhanced:!1,theme:null,shadow:!1,corners:!0,excludeInvisible:!0,type:"vertical",mini:!1},_create:function(){var e=this.element,i=this.options,n=t.mobile.page.prototype.keepNativeSelector();t.fn.buttonMarkup&&this.element.find(t.fn.buttonMarkup.initSelector).not(n).buttonMarkup(),t.each(this._childWidgets,t.proxy((function(e,i){t.mobile[i]&&this.element.find(t.mobile[i].initSelector).not(n)[i]()}),this)),t.extend(this,{_ui:null,_initialRefresh:!0}),this._ui=i.enhanced?{groupLegend:e.children(".ui-controlgroup-label").children(),childWrapper:e.children(".ui-controlgroup-controls")}:this._enhance()},_childWidgets:["checkboxradio","selectmenu","button"],_themeClassFromOption:function(t){return t?"none"===t?"":"ui-group-theme-"+t:""},_enhance:function(){var e=this.element,i=this.options,n={groupLegend:e.children("legend"),childWrapper:e.addClass("ui-controlgroup ui-controlgroup-"+("horizontal"===i.type?"horizontal":"vertical")+" "+this._themeClassFromOption(i.theme)+" "+(i.corners?"ui-corner-all ":"")+(i.mini?"ui-mini ":"")).wrapInner("<div class='ui-controlgroup-controls "+(!0===i.shadow?"ui-shadow":"")+"'></div>").children()};return n.groupLegend.length>0&&t("<div role='heading' class='ui-controlgroup-label'></div>").append(n.groupLegend).prependTo(e),n},_init:function(){this.refresh()},_setOptions:function(t){var i,n,o=this.element;return t.type!==e&&(o.removeClass("ui-controlgroup-horizontal ui-controlgroup-vertical").addClass("ui-controlgroup-"+("horizontal"===t.type?"horizontal":"vertical")),i=!0),t.theme!==e&&o.removeClass(this._themeClassFromOption(this.options.theme)).addClass(this._themeClassFromOption(t.theme)),t.corners!==e&&o.toggleClass("ui-corner-all",t.corners),t.mini!==e&&o.toggleClass("ui-mini",t.mini),t.shadow!==e&&this._ui.childWrapper.toggleClass("ui-shadow",t.shadow),t.excludeInvisible!==e&&(this.options.excludeInvisible=t.excludeInvisible,i=!0),n=this._super(t),i&&this.refresh(),n},container:function(){return this._ui.childWrapper},refresh:function(){var e=this.container(),i=e.find(".ui-btn").not(".ui-slider-handle"),n=this._initialRefresh;t.mobile.checkboxradio&&e.find(":mobile-checkboxradio").checkboxradio("refresh"),this._addFirstLastClasses(i,this.options.excludeInvisible?this._getVisibles(i,n):i,n),this._initialRefresh=!1},_destroy:function(){var t,e,i=this.options;return i.enhanced?this:(t=this._ui,e=this.element.removeClass("ui-controlgroup ui-controlgroup-horizontal ui-controlgroup-vertical ui-corner-all ui-mini "+this._themeClassFromOption(i.theme)).find(".ui-btn").not(".ui-slider-handle"),this._removeFirstLastClasses(e),t.groupLegend.unwrap(),void t.childWrapper.children().unwrap())}},t.mobile.behaviors.addFirstLastClasses))}(t),function(t,e){t.widget("mobile.toolbar",{initSelector:":jqmData(role='footer'), :jqmData(role='header')",options:{theme:null,addBackBtn:!1,backBtnTheme:null,backBtnText:"Back"},_create:function(){var e=this.element.is(":jqmData(role='header')")?"header":"footer",i=this.element.closest(".ui-page");0===i.length&&(i=!1,this._on(this.document,{pageshow:"refresh"})),t.extend(this,{role:e,page:i,leftbtn:undefined,rightbtn:undefined}),this.element.attr("role","header"===e?"banner":"contentinfo").addClass("ui-"+e),this.refresh(),this._setOptions(this.options)},_setOptions:function(t){if(t.addBackBtn!==e&&this._updateBackButton(),null!=t.backBtnTheme&&this.element.find(".ui-toolbar-back-btn").addClass("ui-btn ui-btn-"+t.backBtnTheme),t.backBtnText!==e&&this.element.find(".ui-toolbar-back-btn .ui-btn-text").text(t.backBtnText),t.theme!==e){var i=this.options.theme?this.options.theme:"inherit",n=t.theme?t.theme:"inherit";this.element.removeClass("ui-bar-"+i).addClass("ui-bar-"+n)}this._super(t)},refresh:function(){"header"===this.role&&this._addHeaderButtonClasses(),this.page||(this._setRelative(),"footer"===this.role?this.element.appendTo("body"):"header"===this.role&&this._updateBackButton()),this._addHeadingClasses(),this._btnMarkup()},_setRelative:function(){t("[data-"+t.mobile.ns+"role='page']").css({position:"relative"})},_btnMarkup:function(){this.element.children("a").filter(":not([data-"+t.mobile.ns+"role='none'])").attr("data-"+t.mobile.ns+"role","button"),this.element.trigger("create")},_addHeaderButtonClasses:function(){var t=this.element.children("a, button");this.leftbtn=t.hasClass("ui-btn-left")&&!t.hasClass("ui-toolbar-back-btn"),this.rightbtn=t.hasClass("ui-btn-right"),this.leftbtn=this.leftbtn||t.eq(0).not(".ui-btn-right,.ui-toolbar-back-btn").addClass("ui-btn-left").length,this.rightbtn=this.rightbtn||t.eq(1).addClass("ui-btn-right").length},_updateBackButton:function(){var e,i=this.options,n=i.backBtnTheme||i.theme;e=this._backButton=this._backButton||{},this.options.addBackBtn&&"header"===this.role&&t(".ui-page").length>1&&(this.page?this.page[0].getAttribute("data-"+t.mobile.ns+"url")!==t.mobile.path.stripHash(location.hash):t.mobile.navigate&&t.mobile.navigate.history&&t.mobile.navigate.history.activeIndex>0)&&!this.leftbtn?e.attached||(this.backButton=e.element=(e.element||t("<a role='button' href='javascript:void(0);' class='ui-btn ui-corner-all ui-shadow ui-btn-left "+(n?"ui-btn-"+n+" ":"")+"ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left' data-"+t.mobile.ns+"rel='back'>"+i.backBtnText+"</a>")).prependTo(this.element),e.attached=!0):e.element&&(e.element.detach(),e.attached=!1)},_addHeadingClasses:function(){this.element.children("h1, h2, h3, h4, h5, h6").addClass("ui-title").attr({role:"heading","aria-level":"1"})},_destroy:function(){var t;this.element.children("h1, h2, h3, h4, h5, h6").removeClass("ui-title").removeAttr("role").removeAttr("aria-level"),"header"===this.role&&(this.element.children("a, button").removeClass("ui-btn-left ui-btn-right ui-btn ui-shadow ui-corner-all"),this.backButton&&this.backButton.remove()),t=this.options.theme?this.options.theme:"inherit",this.element.removeClass("ui-bar-"+t),this.element.removeClass("ui-"+this.role).removeAttr("role")}})}(t),function(t,e){t.widget("mobile.toolbar",t.mobile.toolbar,{options:{position:null,visibleOnPageShow:!0,disablePageZoom:!0,transition:"slide",fullscreen:!1,tapToggle:!0,tapToggleBlacklist:"a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open",hideDuringFocus:"input, textarea, select",updatePagePadding:!0,trackPersistentToolbars:!0,supportBlacklist:function(){return!t.support.fixedPosition}},_create:function(){this._super(),this.pagecontainer=t(":mobile-pagecontainer"),"fixed"!==this.options.position||this.options.supportBlacklist()||this._makeFixed()},_makeFixed:function(){this.element.addClass("ui-"+this.role+"-fixed"),this.updatePagePadding(),this._addTransitionClass(),this._bindPageEvents(),this._bindToggleHandlers()},_setOptions:function(i){if("fixed"===i.position&&"fixed"!==this.options.position&&this._makeFixed(),"fixed"===this.options.position&&!this.options.supportBlacklist()){var n=this.page?this.page:t(".ui-page-active").length>0?t(".ui-page-active"):t(".ui-page").eq(0);i.fullscreen!==e&&(i.fullscreen?(this.element.addClass("ui-"+this.role+"-fullscreen"),n.addClass("ui-page-"+this.role+"-fullscreen")):(this.element.removeClass("ui-"+this.role+"-fullscreen"),n.removeClass("ui-page-"+this.role+"-fullscreen").addClass("ui-page-"+this.role+"-fixed")))}this._super(i)},_addTransitionClass:function(){var t=this.options.transition;t&&"none"!==t&&("slide"===t&&(t=this.element.hasClass("ui-header")?"slidedown":"slideup"),this.element.addClass(t))},_bindPageEvents:function(){var t=this.page?this.element.closest(".ui-page"):this.document;this._on(t,{pagebeforeshow:"_handlePageBeforeShow",webkitAnimationStart:"_handleAnimationStart",animationstart:"_handleAnimationStart",updatelayout:"_handleAnimationStart",pageshow:"_handlePageShow",pagebeforehide:"_handlePageBeforeHide"})},_handlePageBeforeShow:function(){var e=this.options;e.disablePageZoom&&t.mobile.zoom.disable(!0),e.visibleOnPageShow||this.hide(!0)},_handleAnimationStart:function(){this.options.updatePagePadding&&this.updatePagePadding(this.page?this.page:".ui-page-active")},_handlePageShow:function(){this.updatePagePadding(this.page?this.page:".ui-page-active"),this.options.updatePagePadding&&this._on(this.window,{throttledresize:"updatePagePadding"})},_handlePageBeforeHide:function(e,i){var n,o,s,a,r=this.options;r.disablePageZoom&&t.mobile.zoom.enable(!0),r.updatePagePadding&&this._off(this.window,"throttledresize"),r.trackPersistentToolbars&&(n=t(".ui-footer-fixed:jqmData(id)",this.page),o=t(".ui-header-fixed:jqmData(id)",this.page),s=n.length&&i.nextPage&&t(".ui-footer-fixed:jqmData(id='"+n.jqmData("id")+"')",i.nextPage)||t(),a=o.length&&i.nextPage&&t(".ui-header-fixed:jqmData(id='"+o.jqmData("id")+"')",i.nextPage)||t(),(s.length||a.length)&&(s.add(a).appendTo(t.mobile.pageContainer),i.nextPage.one("pageshow",(function(){a.prependTo(this),s.appendTo(this)}))))},_visible:!0,updatePagePadding:function(i){var n=this.element,o="header"===this.role,s=parseFloat(n.css(o?"top":"bottom"));this.options.fullscreen||(i=i&&i.type===e&&i||this.page||n.closest(".ui-page"),i=this.page?this.page:".ui-page-active",t(i).css("padding-"+(o?"top":"bottom"),n.outerHeight()+s))},_useTransition:function(e){var i=this.window,n=this.element,o=i.scrollTop(),s=n.height(),a=this.page?n.closest(".ui-page").height():t(".ui-page-active").height(),r=t.mobile.getScreenHeight();return!e&&(this.options.transition&&"none"!==this.options.transition&&("header"===this.role&&!this.options.fullscreen&&o>s||"footer"===this.role&&!this.options.fullscreen&&a-s>o+r)||this.options.fullscreen)},show:function(t){var e="ui-fixed-hidden",i=this.element;this._useTransition(t)?i.removeClass("out "+e).addClass("in").animationComplete((function(){i.removeClass("in")})):i.removeClass(e),this._visible=!0},hide:function(t){var e="ui-fixed-hidden",i=this.element,n="out"+("slide"===this.options.transition?" reverse":"");this._useTransition(t)?i.addClass(n).removeClass("in").animationComplete((function(){i.addClass(e).removeClass(n)})):i.addClass(e).removeClass(n),this._visible=!1},toggle:function(){this[this._visible?"hide":"show"]()},_bindToggleHandlers:function(){var e,i,n=this,o=n.options,s=!0;(this.page?this.page:t(".ui-page")).bind("vclick",(function(e){o.tapToggle&&!t(e.target).closest(o.tapToggleBlacklist).length&&n.toggle()})).bind("focusin focusout",(function(a){screen.width<1025&&t(a.target).is(o.hideDuringFocus)&&!t(a.target).closest(".ui-header-fixed, .ui-footer-fixed").length&&("focusout"!==a.type||s?"focusin"===a.type&&s&&(clearTimeout(e),s=!1,i=setTimeout((function(){n.hide()}),0)):(s=!0,clearTimeout(i),e=setTimeout((function(){n.show()}),0)))}))},_setRelative:function(){"fixed"!==this.options.position&&t("[data-"+t.mobile.ns+"role='page']").css({position:"relative"})},_destroy:function(){var e,i,n,o,s=this.pagecontainer.pagecontainer("getActivePage");this._super(),"fixed"===this.options.position&&(i=t("body>.ui-"+this.role+"-fixed").add(s.find(".ui-"+this.options.role+"-fixed")).not(this.element).length>0,o=t("body>.ui-"+this.role+"-fixed").add(s.find(".ui-"+this.options.role+"-fullscreen")).not(this.element).length>0,"ui-header-fixed ui-footer-fixed ui-header-fullscreen in out ui-footer-fullscreen fade slidedown slideup ui-fixed-hidden",this.element.removeClass("ui-header-fixed ui-footer-fixed ui-header-fullscreen in out ui-footer-fullscreen fade slidedown slideup ui-fixed-hidden"),o||(e="ui-page-"+this.role+"-fullscreen"),i||(n="header"===this.role,e+=" ui-page-"+this.role+"-fixed",s.css("padding-"+(n?"top":"bottom"),"")),s.removeClass(e))}})}(t),function(t){t.widget("mobile.toolbar",t.mobile.toolbar,{_makeFixed:function(){this._super(),this._workarounds()},_workarounds:function(){var t=navigator.userAgent,e=navigator.platform,i=t.match(/AppleWebKit\/([0-9]+)/),n=!!i&&i[1],o=null,s=this;if(e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1||e.indexOf("iPod")>-1)o="ios";else{if(!(t.indexOf("Android")>-1))return;o="android"}if("ios"===o)s._bindScrollWorkaround();else{if(!("android"===o&&n&&534>n))return;s._bindScrollWorkaround(),s._bindListThumbWorkaround()}},_viewportOffset:function(){var t=this.element,e=t.hasClass("ui-header"),i=Math.abs(t.offset().top-this.window.scrollTop());return e||(i=Math.round(i-this.window.height()+t.outerHeight())-60),i},_bindScrollWorkaround:function(){var t=this;this._on(this.window,{scrollstop:function(){t._viewportOffset()>2&&t._visible&&t._triggerRedraw()}})},_bindListThumbWorkaround:function(){this.element.closest(".ui-page").addClass("ui-android-2x-fixed")},_triggerRedraw:function(){var e=parseFloat(t(".ui-page-active").css("padding-bottom"));t(".ui-page-active").css("padding-bottom",e+1+"px"),setTimeout((function(){t(".ui-page-active").css("padding-bottom",e+"px")}),0)},destroy:function(){this._super(),this.element.closest(".ui-page-active").removeClass("ui-android-2x-fix")}})}(t),function(t,e){var i=t.mobile.browser.oldIE&&t.mobile.browser.oldIE<=8,n=t("<div class='ui-popup-arrow-guide'></div><div class='ui-popup-arrow-container"+(i?" ie":"")+"'><div class='ui-popup-arrow'></div></div>");t.widget("mobile.popup",t.mobile.popup,{options:{arrow:""},_create:function(){var t=this._super();return this.options.arrow&&(this._ui.arrow=this._addArrow()),t},_addArrow:function(){var t,e=this.options,i=function(){var t=n.clone(),e=t.eq(0),i=t.eq(1),o=i.children();return{arEls:i.add(e),gd:e,ct:i,ar:o}}();return t=this._themeClassFromOption("ui-body-",e.theme),i.ar.addClass(t+(e.shadow?" ui-overlay-shadow":"")),i.arEls.hide().appendTo(this.element),i},_unenhance:function(){var t=this._ui.arrow;return t&&t.arEls.remove(),this._super()},_tryAnArrow:function(t,e,i,n,o){var s,a,r,l={},c={};return n.arFull[t.dimKey]>n.guideDims[t.dimKey]||(l[t.fst]=i[t.fst]+(n.arHalf[t.oDimKey]+n.menuHalf[t.oDimKey])*t.offsetFactor-n.contentBox[t.fst]+(n.clampInfo.menuSize[t.oDimKey]-n.contentBox[t.oDimKey])*t.arrowOffsetFactor,l[t.snd]=i[t.snd],a={x:(s=n.result||this._calculateFinalLocation(l,n.clampInfo)).left,y:s.top},c[t.fst]=a[t.fst]+n.contentBox[t.fst]+t.tipOffset,c[t.snd]=Math.max(s[t.prop]+n.guideOffset[t.prop]+n.arHalf[t.dimKey],Math.min(s[t.prop]+n.guideOffset[t.prop]+n.guideDims[t.dimKey]-n.arHalf[t.dimKey],i[t.snd])),r=Math.abs(i.x-c.x)+Math.abs(i.y-c.y),(!o||r<o.diff)&&(c[t.snd]-=n.arHalf[t.dimKey]+s[t.prop]+n.contentBox[t.snd],o={dir:e,diff:r,result:s,posProp:t.prop,posVal:c[t.snd]})),o},_getPlacementState:function(t){var e,i,n=this._ui.arrow,o={clampInfo:this._clampPopupWidth(!t),arFull:{cx:n.ct.width(),cy:n.ct.height()},guideDims:{cx:n.gd.width(),cy:n.gd.height()},guideOffset:n.gd.offset()};return e=this.element.offset(),n.gd.css({left:0,top:0,right:0,bottom:0}),i=n.gd.offset(),o.contentBox={x:i.left-e.left,y:i.top-e.top,cx:n.gd.width(),cy:n.gd.height()},n.gd.removeAttr("style"),o.guideOffset={left:o.guideOffset.left-e.left,top:o.guideOffset.top-e.top},o.arHalf={cx:o.arFull.cx/2,cy:o.arFull.cy/2},o.menuHalf={cx:o.clampInfo.menuSize.cx/2,cy:o.clampInfo.menuSize.cy/2},o},_placementCoords:function(e){var n,o,s,a,r,l=this.options.arrow,c=this._ui.arrow;return c?(c.arEls.show(),r={},n=this._getPlacementState(!0),s={l:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:1,tipOffset:-n.arHalf.cx,arrowOffsetFactor:0},r:{fst:"x",snd:"y",prop:"top",dimKey:"cy",oDimKey:"cx",offsetFactor:-1,tipOffset:n.arHalf.cx+n.contentBox.cx,arrowOffsetFactor:1},b:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:-1,tipOffset:n.arHalf.cy+n.contentBox.cy,arrowOffsetFactor:1},t:{fst:"y",snd:"x",prop:"left",dimKey:"cx",oDimKey:"cy",offsetFactor:1,tipOffset:-n.arHalf.cy,arrowOffsetFactor:0}},t.each((!0===l?"l,t,r,b":l).split(","),t.proxy((function(t,i){o=this._tryAnArrow(s[i],i,e,n,o)}),this)),o?(c.ct.removeClass("ui-popup-arrow-l ui-popup-arrow-t ui-popup-arrow-r ui-popup-arrow-b").addClass("ui-popup-arrow-"+o.dir).removeAttr("style").css(o.posProp,o.posVal).show(),i||(a=this.element.offset(),r[s[o.dir].fst]=c.ct.offset(),r[s[o.dir].snd]={left:a.left+n.contentBox.x,top:a.top+n.contentBox.y}),o.result):(c.arEls.hide(),this._super(e))):this._super(e)},_setOptions:function(t){var i,n=this.options.theme,o=this._ui.arrow,s=this._super(t);if(t.arrow!==e){if(!o&&t.arrow)return void(this._ui.arrow=this._addArrow());o&&!t.arrow&&(o.arEls.remove(),this._ui.arrow=null)}return(o=this._ui.arrow)&&(t.theme!==e&&(n=this._themeClassFromOption("ui-body-",n),i=this._themeClassFromOption("ui-body-",t.theme),o.ar.removeClass(n).addClass(i)),t.shadow!==e&&o.ar.toggleClass("ui-overlay-shadow",t.shadow)),s},_destroy:function(){var t=this._ui.arrow;return t&&t.arEls.remove(),this._super()}})}(t),function(t,i){t.widget("mobile.panel",{options:{classes:{panel:"ui-panel",panelOpen:"ui-panel-open",panelClosed:"ui-panel-closed",panelFixed:"ui-panel-fixed",panelInner:"ui-panel-inner",modal:"ui-panel-dismiss",modalOpen:"ui-panel-dismiss-open",pageContainer:"ui-panel-page-container",pageWrapper:"ui-panel-wrapper",pageFixedToolbar:"ui-panel-fixed-toolbar",pageContentPrefix:"ui-panel-page-content",animate:"ui-panel-animate"},animate:!0,theme:null,position:"left",dismissible:!0,display:"reveal",swipeClose:!0,positionFixed:!1},_closeLink:null,_parentPage:null,_page:null,_modal:null,_panelInner:null,_wrapper:null,_fixedToolbars:null,_create:function(){var e=this.element,i=e.closest(".ui-page, :jqmData(role='page')");t.extend(this,{_closeLink:e.find(":jqmData(rel='close')"),_parentPage:i.length>0&&i,_openedPage:null,_page:this._getPage,_panelInner:this._getPanelInner(),_fixedToolbars:this._getFixedToolbars}),"overlay"!==this.options.display&&this._getWrapper(),this._addPanelClasses(),t.support.cssTransform3d&&this.options.animate&&this.element.addClass(this.options.classes.animate),this._bindUpdateLayout(),this._bindCloseEvents(),this._bindLinkListeners(),this._bindPageEvents(),this.options.dismissible&&this._createModal(),this._bindSwipeEvents()},_getPanelInner:function(){var t=this.element.find("."+this.options.classes.panelInner);return 0===t.length&&(t=this.element.children().wrapAll("<div class='"+this.options.classes.panelInner+"' />").parent()),t},_createModal:function(){var e=this,i=e._parentPage?e._parentPage.parent():e.element.parent();e._modal=t("<div class='"+e.options.classes.modal+"'></div>").on("mousedown",(function(){e.close()})).appendTo(i)},_getPage:function(){return this._openedPage||this._parentPage||t("."+t.mobile.activePageClass)},_getWrapper:function(){var t=this._page().find("."+this.options.classes.pageWrapper);0===t.length&&(t=this._page().children(".ui-header:not(.ui-header-fixed), .ui-content:not(.ui-popup), .ui-footer:not(.ui-footer-fixed)").wrapAll("<div class='"+this.options.classes.pageWrapper+"'></div>").parent()),this._wrapper=t},_getFixedToolbars:function(){var e=t("body").children(".ui-header-fixed, .ui-footer-fixed"),i=this._page().find(".ui-header-fixed, .ui-footer-fixed");return e.add(i).addClass(this.options.classes.pageFixedToolbar)},_getPosDisplayClasses:function(t){return t+"-position-"+this.options.position+" "+t+"-display-"+this.options.display},_getPanelClasses:function(){var t=this.options.classes.panel+" "+this._getPosDisplayClasses(this.options.classes.panel)+" "+this.options.classes.panelClosed+" ui-body-"+(this.options.theme?this.options.theme:"inherit");return this.options.positionFixed&&(t+=" "+this.options.classes.panelFixed),t},_addPanelClasses:function(){this.element.addClass(this._getPanelClasses())},_handleCloseClick:function(t){t.isDefaultPrevented()||this.close()},_bindCloseEvents:function(){this._on(this._closeLink,{click:"_handleCloseClick"}),this._on({"click a:jqmData(ajax='false')":"_handleCloseClick"})},_positionPanel:function(e){var i=this,n=i._panelInner.outerHeight(),o=n>t.mobile.getScreenHeight();o||!i.options.positionFixed?(o&&(i._unfixPanel(),t.mobile.resetActivePageHeight(n)),e&&this.window[0].scrollTo(0,t.mobile.defaultHomeScroll)):i._fixPanel()},_bindFixListener:function(){this._on(t(e),{throttledresize:"_positionPanel"})},_unbindFixListener:function(){this._off(t(e),"throttledresize")},_unfixPanel:function(){this.options.positionFixed&&t.support.fixedPosition&&this.element.removeClass(this.options.classes.panelFixed)},_fixPanel:function(){this.options.positionFixed&&t.support.fixedPosition&&this.element.addClass(this.options.classes.panelFixed)},_bindUpdateLayout:function(){var t=this;t.element.on("updatelayout",(function(){t._open&&t._positionPanel()}))},_bindLinkListeners:function(){this._on("body",{"click a":"_handleClick"})},_handleClick:function(e){var i,n=this.element.attr("id");e.currentTarget.href.split("#")[1]===n&&undefined!==n&&(e.preventDefault(),(i=t(e.target)).hasClass("ui-btn")&&(i.addClass(t.mobile.activeBtnClass),this.element.one("panelopen panelclose",(function(){i.removeClass(t.mobile.activeBtnClass)}))),this.toggle())},_bindSwipeEvents:function(){var t=this,e=t._modal?t.element.add(t._modal):t.element;t.options.swipeClose&&("left"===t.options.position?e.on("swipeleft.panel",(function(){t.close()})):e.on("swiperight.panel",(function(){t.close()})))},_bindPageEvents:function(){var t=this;this.document.on("panelbeforeopen",(function(e){t._open&&e.target!==t.element[0]&&t.close()})).on("keyup.panel",(function(e){27===e.keyCode&&t._open&&t.close()})),this._parentPage||"overlay"===this.options.display||this._on(this.document,{pageshow:function(){this._openedPage=null,this._getWrapper()}}),t._parentPage?this.document.on("pagehide",":jqmData(role='page')",(function(){t._open&&t.close(!0)})):this.document.on("pagebeforehide",(function(){t._open&&t.close(!0)}))},_open:!1,_pageContentOpenClasses:null,_modalOpenClasses:null,open:function(e){if(!this._open){var i=this,n=i.options,o=function(){i._off(i.document,"panelclose"),i._page().jqmData("panel","open"),t.support.cssTransform3d&&n.animate&&"overlay"!==n.display&&(i._wrapper.addClass(n.classes.animate),i._fixedToolbars().addClass(n.classes.animate)),!e&&t.support.cssTransform3d&&n.animate?(i._wrapper||i.element).animationComplete(s,"transition"):setTimeout(s,0),n.theme&&"overlay"!==n.display&&i._page().parent().addClass(n.classes.pageContainer+"-themed "+n.classes.pageContainer+"-"+n.theme),i.element.removeClass(n.classes.panelClosed).addClass(n.classes.panelOpen),i._positionPanel(!0),i._pageContentOpenClasses=i._getPosDisplayClasses(n.classes.pageContentPrefix),"overlay"!==n.display&&(i._page().parent().addClass(n.classes.pageContainer),i._wrapper.addClass(i._pageContentOpenClasses),i._fixedToolbars().addClass(i._pageContentOpenClasses)),i._modalOpenClasses=i._getPosDisplayClasses(n.classes.modal)+" "+n.classes.modalOpen,i._modal&&i._modal.addClass(i._modalOpenClasses).height(Math.max(i._modal.height(),i.document.height()))},s=function(){i._open&&("overlay"!==n.display&&(i._wrapper.addClass(n.classes.pageContentPrefix+"-open"),i._fixedToolbars().addClass(n.classes.pageContentPrefix+"-open")),i._bindFixListener(),i._trigger("open"),i._openedPage=i._page())};i._trigger("beforeopen"),"open"===i._page().jqmData("panel")?i._on(i.document,{panelclose:o}):o(),i._open=!0}},close:function(e){if(this._open){var i=this,n=this.options,o=function(){n.theme&&"overlay"!==n.display&&i._page().parent().removeClass(n.classes.pageContainer+"-themed "+n.classes.pageContainer+"-"+n.theme),i.element.addClass(n.classes.panelClosed),"overlay"!==n.display&&(i._page().parent().removeClass(n.classes.pageContainer),i._wrapper.removeClass(n.classes.pageContentPrefix+"-open"),i._fixedToolbars().removeClass(n.classes.pageContentPrefix+"-open")),t.support.cssTransform3d&&n.animate&&"overlay"!==n.display&&(i._wrapper.removeClass(n.classes.animate),i._fixedToolbars().removeClass(n.classes.animate)),i._fixPanel(),i._unbindFixListener(),t.mobile.resetActivePageHeight(),i._page().jqmRemoveData("panel"),i._trigger("close"),i._openedPage=null};i._trigger("beforeclose"),i.element.removeClass(n.classes.panelOpen),"overlay"!==n.display&&(i._wrapper.removeClass(i._pageContentOpenClasses),i._fixedToolbars().removeClass(i._pageContentOpenClasses)),!e&&t.support.cssTransform3d&&n.animate?(i._wrapper||i.element).animationComplete(o,"transition"):setTimeout(o,0),i._modal&&i._modal.removeClass(i._modalOpenClasses).height(""),i._open=!1}},toggle:function(){this[this._open?"close":"open"]()},_destroy:function(){var e=this.options,i=t("body > :mobile-panel").length+t.mobile.activePage.find(":mobile-panel").length>1;"overlay"!==e.display&&(0===t("body > :mobile-panel").add(t.mobile.activePage.find(":mobile-panel")).not(".ui-panel-display-overlay").not(this.element).length&&this._wrapper.children().unwrap(),this._open&&(this._fixedToolbars().removeClass(e.classes.pageContentPrefix+"-open"),t.support.cssTransform3d&&e.animate&&this._fixedToolbars().removeClass(e.classes.animate),this._page().parent().removeClass(e.classes.pageContainer),e.theme&&this._page().parent().removeClass(e.classes.pageContainer+"-themed "+e.classes.pageContainer+"-"+e.theme))),i||this.document.off("panelopen panelclose"),this._open&&this._page().jqmRemoveData("panel"),this._panelInner.children().unwrap(),this.element.removeClass([this._getPanelClasses(),e.classes.panelOpen,e.classes.animate].join(" ")).off("swipeleft.panel swiperight.panel").off("panelbeforeopen").off("panelhide").off("keyup.panel").off("updatelayout"),this._modal&&this._modal.remove()}})}(t),function(t,e){t.widget("mobile.table",{options:{classes:{table:"ui-table"},enhanced:!1},_create:function(){this.options.enhanced||this.element.addClass(this.options.classes.table),t.extend(this,{headers:e,allHeaders:e}),this._refresh(!0)},_setHeaders:function(){var t=this.element.find("thead tr");this.headers=this.element.find("tr:eq(0)").children(),this.allHeaders=this.headers.add(t.children())},refresh:function(){this._refresh()},rebuild:t.noop,_refresh:function(){var e=this.element,i=e.find("thead tr");this._setHeaders(),i.each((function(){var n=0;t(this).children().each((function(){var o,s=parseInt(this.getAttribute("colspan"),10),a=":nth-child("+(n+1)+")";if(this.setAttribute("data-"+t.mobile.ns+"colstart",n+1),s)for(o=0;s-1>o;o++)a+=", :nth-child("+(++n+1)+")";t(this).jqmData("cells",e.find("tr").not(i.eq(0)).not(this).children(a)),n++}))}))}})}(t),function(t){t.widget("mobile.table",t.mobile.table,{options:{mode:"columntoggle",columnBtnTheme:null,columnPopupTheme:null,columnBtnText:"Columns...",classes:t.extend(t.mobile.table.prototype.options.classes,{popup:"ui-table-columntoggle-popup",columnBtn:"ui-table-columntoggle-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle"})},_create:function(){this._super(),"columntoggle"===this.options.mode&&(t.extend(this,{_menu:null}),this.options.enhanced?(this._menu=t(this.document[0].getElementById(this._id()+"-popup")).children().first(),this._addToggles(this._menu,!0)):(this._menu=this._enhanceColToggle(),this.element.addClass(this.options.classes.columnToggleTable)),this._setupEvents(),this._setToggleState())},_id:function(){return this.element.attr("id")||this.widgetName+this.uuid},_setupEvents:function(){this._on(this.window,{throttledresize:"_setToggleState"}),this._on(this._menu,{"change input":"_menuInputChange"})},_addToggles:function(e,i){var n,o=0,s=this.options,a=e.controlgroup("container");i?n=e.find("input"):a.empty(),this.headers.not("td").each((function(){var e,r,l=t(this),c=t.mobile.getAttribute(this,"priority");c&&((r=l.add(l.jqmData("cells"))).addClass(s.classes.priorityPrefix+c),e=(i?n.eq(o++):t("<label><input type='checkbox' checked />"+(l.children("abbr").first().attr("title")||l.text())+"</label>").appendTo(a).children(0).checkboxradio({theme:s.columnPopupTheme})).jqmData("header",l).jqmData("cells",r),l.jqmData("input",e))})),i||e.controlgroup("refresh")},_menuInputChange:function(e){var i=t(e.target),n=i[0].checked;i.jqmData("cells").toggleClass("ui-table-cell-hidden",!n).toggleClass("ui-table-cell-visible",n)},_unlockCells:function(t){t.removeClass("ui-table-cell-hidden ui-table-cell-visible")},_enhanceColToggle:function(){var e,i,n,o,s=this.element,a=this.options,r=t.mobile.ns,l=this.document[0].createDocumentFragment();return e=this._id()+"-popup",i=t("<a href='#"+e+"' class='"+a.classes.columnBtn+" ui-btn ui-btn-"+(a.columnBtnTheme||"a")+" ui-corner-all ui-shadow ui-mini' data-"+r+"rel='popup'>"+a.columnBtnText+"</a>"),n=t("<div class='"+a.classes.popup+"' id='"+e+"'></div>"),o=t("<fieldset></fieldset>").controlgroup(),this._addToggles(o,!1),o.appendTo(n),l.appendChild(n[0]),l.appendChild(i[0]),s.before(l),n.popup(),o},rebuild:function(){this._super(),"columntoggle"===this.options.mode&&this._refresh(!1)},_refresh:function(e){var i,n,o;if(this._super(e),!e&&"columntoggle"===this.options.mode)for(i=this.headers,n=[],this._menu.find("input").each((function(){var e=t(this),o=e.jqmData("header"),s=i.index(o[0]);s>-1&&!e.prop("checked")&&n.push(s)})),this._unlockCells(this.element.find(".ui-table-cell-hidden, .ui-table-cell-visible")),this._addToggles(this._menu,e),o=n.length-1;o>-1;o--)i.eq(n[o]).jqmData("input").prop("checked",!1).checkboxradio("refresh").trigger("change")},_setToggleState:function(){this._menu.find("input").each((function(){var e=t(this);this.checked="table-cell"===e.jqmData("cells").eq(0).css("display"),e.checkboxradio("refresh")}))},_destroy:function(){this._super()}})}(t),function(t){t.widget("mobile.table",t.mobile.table,{options:{mode:"reflow",classes:t.extend(t.mobile.table.prototype.options.classes,{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label"})},_create:function(){this._super(),"reflow"===this.options.mode&&(this.options.enhanced||(this.element.addClass(this.options.classes.reflowTable),this._updateReflow()))},rebuild:function(){this._super(),"reflow"===this.options.mode&&this._refresh(!1)},_refresh:function(t){this._super(t),t||"reflow"!==this.options.mode||this._updateReflow()},_updateReflow:function(){var e=this,i=this.options;t(e.allHeaders.get().reverse()).each((function(){var n,o,s=t(this).jqmData("cells"),a=t.mobile.getAttribute(this,"colstart"),r=s.not(this).filter("thead th").length&&" ui-table-cell-label-top",l=t(this).clone().contents();l.length>0&&(r?(o="",(n=parseInt(this.getAttribute("colspan"),10))&&(o="td:nth-child("+n+"n + "+a+")"),e._addLabels(s.filter(o),i.classes.cellLabels+r,l)):e._addLabels(s,i.classes.cellLabels,l))}))},_addLabels:function(e,i,n){1===n.length&&"abbr"===n[0].nodeName.toLowerCase()&&(n=n.eq(0).attr("title")),e.not(":has(b."+i+")").prepend(t("<b class='"+i+"'></b>").append(n))}})}(t),function(t,i){var n=function(e,i){return-1===(""+(t.mobile.getAttribute(this,"filtertext")||t(this).text())).toLowerCase().indexOf(i)};t.widget("mobile.filterable",{initSelector:":jqmData(filter='true')",options:{filterReveal:!1,filterCallback:n,enhanced:!1,input:null,children:"> li, > option, > optgroup option, > tbody tr, > .ui-controlgroup-controls > .ui-btn, > .ui-controlgroup-controls > .ui-checkbox, > .ui-controlgroup-controls > .ui-radio"},_create:function(){var e=this.options;t.extend(this,{_search:null,_timer:0}),this._setInput(e.input),e.enhanced||this._filterItems((this._search&&this._search.val()||"").toLowerCase())},_onKeyUp:function(){var i,n,o=this._search;if(o){if(i=o.val().toLowerCase(),(n=t.mobile.getAttribute(o[0],"lastval")+"")&&n===i)return;this._timer&&(e.clearTimeout(this._timer),this._timer=0),this._timer=this._delay((function(){return!1!==this._trigger("beforefilter",null,{input:o})&&(o[0].setAttribute("data-"+t.mobile.ns+"lastval",i),this._filterItems(i),void(this._timer=0))}),250)}},_getFilterableItems:function(){var e=this.element,i=this.options.children,n=i?t.isFunction(i)?i():i.nodeName?t(i):i.jquery?i:this.element.find(i):{length:0};return 0===n.length&&(n=e.children()),n},_filterItems:function(e){var i,o,s,a=[],r=[],l=this.options,c=this._getFilterableItems();if(null!=e)for(o=l.filterCallback||n,s=c.length,i=0;s>i;i++)(o.call(c[i],i,e)?r:a).push(c[i]);0===r.length?c[l.filterReveal&&0===e.length?"addClass":"removeClass"]("ui-screen-hidden"):(t(r).addClass("ui-screen-hidden"),t(a).removeClass("ui-screen-hidden")),this._refreshChildWidget(),this._trigger("filter",null,{items:c})},_refreshChildWidget:function(){var e,i,n=["collapsibleset","selectmenu","controlgroup","listview"];for(i=n.length-1;i>-1;i--)e=n[i],t.mobile[e]&&((e=this.element.data("mobile-"+e))&&t.isFunction(e.refresh)&&e.refresh())},_setInput:function(i){var n=this._search;this._timer&&(e.clearTimeout(this._timer),this._timer=0),n&&(this._off(n,"keyup change input"),n=null),i&&(n=i.jquery?i:i.nodeName?t(i):this.document.find(i),this._on(n,{keydown:"_onKeyDown",keypress:"_onKeyPress",keyup:"_onKeyUp",change:"_onKeyUp",input:"_onKeyUp"})),this._search=n},_onKeyDown:function(e){e.keyCode===t.ui.keyCode.ENTER&&(e.preventDefault(),this._preventKeyPress=!0)},_onKeyPress:function(t){this._preventKeyPress&&(t.preventDefault(),this._preventKeyPress=!1)},_setOptions:function(t){var e=!(t.filterReveal===i&&t.filterCallback===i&&t.children===i);this._super(t),t.input!==i&&(this._setInput(t.input),e=!0),e&&this.refresh()},_destroy:function(){var t=this.options,e=this._getFilterableItems();t.enhanced?e.toggleClass("ui-screen-hidden",t.filterReveal):e.removeClass("ui-screen-hidden")},refresh:function(){this._timer&&(e.clearTimeout(this._timer),this._timer=0),this._filterItems((this._search&&this._search.val()||"").toLowerCase())}})}(t),function(t,e){var i=/(^|\s)ui-li-divider(\s|$)/,n=t.mobile.filterable.prototype.options.filterCallback;t.mobile.filterable.prototype.options.filterCallback=function(t,e){return!this.className.match(i)&&n.call(this,t,e)},t.widget("mobile.filterable",t.mobile.filterable,{options:{filterPlaceholder:"Filter items...",filterTheme:null},_create:function(){var e,i,n=this.element,o=["collapsibleset","selectmenu","controlgroup","listview"],s={};for(this._super(),t.extend(this,{_widget:null}),e=o.length-1;e>-1;e--)if(i=o[e],t.mobile[i]){if(this._setWidget(n.data("mobile-"+i)))break;s[i+"create"]="_handleCreate"}this._widget||this._on(n,s)},_handleCreate:function(t){this._setWidget(this.element.data("mobile-"+t.type.substring(0,t.type.length-6)))},_trigger:function(t,e,i){return this._widget&&"mobile-listview"===this._widget.widgetFullName&&"beforefilter"===t&&this._widget._trigger("beforefilter",e,i),this._super(t,e,i)},_setWidget:function(t){return!this._widget&&t&&(this._widget=t,this._widget._setOptions=function(t,e){return function(i){e.call(this,i),t._syncTextInputOptions(i)}}(this,this._widget._setOptions)),this._widget&&(this._syncTextInputOptions(this._widget.options),"listview"===this._widget.widgetName&&(this._widget.options.hideDividers=!0,this._widget.element.listview("refresh"))),!!this._widget},_isSearchInternal:function(){return this._search&&this._search.jqmData("ui-filterable-"+this.uuid+"-internal")},_setInput:function(e){var i=this.options,n=!0,o={};if(!e){if(this._isSearchInternal())return;n=!1,e=t("<input data-"+t.mobile.ns+"type='search' placeholder='"+i.filterPlaceholder+"'></input>").jqmData("ui-filterable-"+this.uuid+"-internal",!0),t("<form class='ui-filterable'></form>").append(e).submit((function(t){t.preventDefault(),e.blur()})).insertBefore(this.element),t.mobile.textinput&&(null!=this.options.filterTheme&&(o.theme=i.filterTheme),e.textinput(o))}this._super(e),this._isSearchInternal()&&n&&this._search.attr("placeholder",this.options.filterPlaceholder)},_setOptions:function(i){var n=this._super(i);return i.filterPlaceholder!==e&&this._isSearchInternal()&&this._search.attr("placeholder",i.filterPlaceholder),i.filterTheme!==e&&this._search&&t.mobile.textinput&&this._search.textinput("option","theme",i.filterTheme),n},_refreshChildWidget:function(){this._refreshingChildWidget=!0,this._superApply(arguments),this._refreshingChildWidget=!1},refresh:function(){this._refreshingChildWidget||this._superApply(arguments)},_destroy:function(){this._isSearchInternal()&&this._search.remove(),this._super()},_syncTextInputOptions:function(i){var n,o={};if(this._isSearchInternal()&&t.mobile.textinput){for(n in t.mobile.textinput.prototype.options)i[n]!==e&&(o[n]="theme"===n&&null!=this.options.filterTheme?this.options.filterTheme:i[n]);this._search.textinput("option",o)}}}),t.widget("mobile.listview",t.mobile.listview,{options:{filter:!1},_create:function(){return!0!==this.options.filter||this.element.data("mobile-filterable")||this.element.filterable(),this._super()},refresh:function(){var t;this._superApply(arguments),!0===this.options.filter&&((t=this.element.data("mobile-filterable"))&&t.refresh())}})}(t),function(t,e){function i(t){return t.hash.length>1&&decodeURIComponent(t.href.replace(o,""))===decodeURIComponent(location.href.replace(o,""))}var n=0,o=/#.*$/;t.widget("ui.tabs",{version:"fadf2b312a05040436451c64bbfaf4814bc62c56",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var e=this,i=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",i.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,(function(e){t(this).is(".ui-state-disabled")&&e.preventDefault()})).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,(function(){t(this).closest("li").is(".ui-state-disabled")&&this.blur()})),this._processTabs(),i.active=this._initialActive(),t.isArray(i.disabled)&&(i.disabled=t.unique(i.disabled.concat(t.map(this.tabs.filter(".ui-state-disabled"),(function(t){return e.tabs.index(t)})))).sort()),this.active=!1!==this.options.active&&this.anchors.length?this._findActive(i.active):t(),this._refresh(),this.active.length&&this.load(i.active)},_initialActive:function(){var e=this.options.active,i=this.options.collapsible,n=location.hash.substring(1);return null===e&&(n&&this.tabs.each((function(i,o){return t(o).attr("aria-controls")===n?(e=i,!1):void 0})),null===e&&(e=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===e||-1===e)&&(e=!!this.tabs.length&&0)),!1!==e&&(-1===(e=this.tabs.index(this.tabs.eq(e)))&&(e=!i&&0)),!i&&!1===e&&this.anchors.length&&(e=0),e},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):t()}},_tabKeydown:function(e){var i=t(this.document[0].activeElement).closest("li"),n=this.tabs.index(i),o=!0;if(!this._handlePageNav(e)){switch(e.keyCode){case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:n++;break;case t.ui.keyCode.UP:case t.ui.keyCode.LEFT:o=!1,n--;break;case t.ui.keyCode.END:n=this.anchors.length-1;break;case t.ui.keyCode.HOME:n=0;break;case t.ui.keyCode.SPACE:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n);case t.ui.keyCode.ENTER:return e.preventDefault(),clearTimeout(this.activating),void this._activate(n!==this.options.active&&n);default:return}e.preventDefault(),clearTimeout(this.activating),n=this._focusNextTab(n,o),e.ctrlKey||(i.attr("aria-selected","false"),this.tabs.eq(n).attr("aria-selected","true"),this.activating=this._delay((function(){this.option("active",n)}),this.delay))}},_panelKeydown:function(e){this._handlePageNav(e)||e.ctrlKey&&e.keyCode===t.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){return e.altKey&&e.keyCode===t.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):e.altKey&&e.keyCode===t.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(e,i){for(var n=this.tabs.length-1;-1!==t.inArray((e>n&&(e=0),0>e&&(e=n),e),this.options.disabled);)e=i?e+1:e-1;return e},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).focus(),t},_setOption:function(t,e){return"active"===t?void this._activate(e):"disabled"===t?void this._setupDisabled(e):(this._super(t,e),"collapsible"===t&&(this.element.toggleClass("ui-tabs-collapsible",e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),void("heightStyle"===t&&this._setupHeightStyle(e)))},_tabId:function(t){return t.attr("aria-controls")||"ui-tabs-"+ ++n},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,i=this.tablist.children(":has(a[href])");e.disabled=t.map(i.filter(".ui-state-disabled"),(function(t){return i.index(t)})),this._processTabs(),!1!==e.active&&this.anchors.length?this.active.length&&!t.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=t()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active):(e.active=!1,this.active=t()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map((function(){return t("a",this)[0]})).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=t(),this.anchors.each((function(n,o){var s,a,r,l=t(o).uniqueId().attr("id"),c=t(o).closest("li"),d=c.attr("aria-controls");i(o)?(s=o.hash,a=e.element.find(e._sanitizeSelector(s))):(s="#"+(r=e._tabId(c)),(a=e.element.find(s)).length||(a=e._createPanel(r)).insertAfter(e.panels[n-1]||e.tablist),a.attr("aria-live","polite")),a.length&&(e.panels=e.panels.add(a)),d&&c.data("ui-tabs-aria-controls",d),c.attr({"aria-controls":s.substring(1),"aria-labelledby":l}),a.attr("aria-labelledby",l)})),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return t("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){t.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var i,n=0;i=this.tabs[n];n++)!0===e||-1!==t.inArray(n,e)?t(i).addClass("ui-state-disabled").attr("aria-disabled","true"):t(i).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=e},_setupEvents:function(e){var i={click:function(t){t.preventDefault()}};e&&t.each(e.split(" "),(function(t,e){i[e]="_eventHandler"})),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(e){var i,n=this.element.parent();"fill"===e?(i=n.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each((function(){var e=t(this),n=e.css("position");"absolute"!==n&&"fixed"!==n&&(i-=e.outerHeight(!0))})),this.element.children().not(this.panels).each((function(){i-=t(this).outerHeight(!0)})),this.panels.each((function(){t(this).height(Math.max(0,i-t(this).innerHeight()+t(this).height()))})).css("overflow","auto")):"auto"===e&&(i=0,this.panels.each((function(){i=Math.max(i,t(this).height("").height())})).height(i))},_eventHandler:function(e){var i=this.options,n=this.active,o=t(e.currentTarget).closest("li"),s=o[0]===n[0],a=s&&i.collapsible,r=a?t():this._getPanelForTab(o),l=n.length?this._getPanelForTab(n):t(),c={oldTab:n,oldPanel:l,newTab:a?t():o,newPanel:r};e.preventDefault(),o.hasClass("ui-state-disabled")||o.hasClass("ui-tabs-loading")||this.running||s&&!i.collapsible||!1===this._trigger("beforeActivate",e,c)||(i.active=!a&&this.tabs.index(o),this.active=s?t():o,this.xhr&&this.xhr.abort(),l.length||r.length||t.error("jQuery UI Tabs: Mismatching fragment identifier."),r.length&&this.load(this.tabs.index(o),e),this._toggle(e,c))},_toggle:function(e,i){function n(){s.running=!1,s._trigger("activate",e,i)}function o(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),a.length&&s.options.show?s._show(a,s.options.show,n):(a.show(),n())}var s=this,a=i.newPanel,r=i.oldPanel;this.running=!0,r.length&&this.options.hide?this._hide(r,this.options.hide,(function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),o()})):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),r.hide(),o()),r.attr({"aria-expanded":"false","aria-hidden":"true"}),i.oldTab.attr("aria-selected","false"),a.length&&r.length?i.oldTab.attr("tabIndex",-1):a.length&&this.tabs.filter((function(){return 0===t(this).attr("tabIndex")})).attr("tabIndex",-1),a.attr({"aria-expanded":"true","aria-hidden":"false"}),i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var i,n=this._findActive(e);n[0]!==this.active[0]&&(n.length||(n=this.active),i=n.find(".ui-tabs-anchor")[0],this._eventHandler({target:i,currentTarget:i,preventDefault:t.noop}))},_findActive:function(e){return!1===e?t():this.tabs.eq(e)},_getIndex:function(t){return"string"==typeof t&&(t=this.anchors.index(this.anchors.filter("[href$='"+t+"']"))),t},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each((function(){t.data(this,"ui-tabs-destroy")?t(this).remove():t(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")})),this.tabs.each((function(){var e=t(this),i=e.data("ui-tabs-aria-controls");i?e.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):e.removeAttr("aria-controls")})),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var n=this.options.disabled;!1!==n&&(i===e?n=!1:(i=this._getIndex(i),n=t.isArray(n)?t.map(n,(function(t){return t!==i?t:null})):t.map(this.tabs,(function(t,e){return e!==i?e:null}))),this._setupDisabled(n))},disable:function(i){var n=this.options.disabled;if(!0!==n){if(i===e)n=!0;else{if(i=this._getIndex(i),-1!==t.inArray(i,n))return;n=t.isArray(n)?t.merge([i],n).sort():[i]}this._setupDisabled(n)}},load:function(e,n){e=this._getIndex(e);var o=this,s=this.tabs.eq(e),a=s.find(".ui-tabs-anchor"),r=this._getPanelForTab(s),l={tab:s,panel:r};i(a[0])||(this.xhr=t.ajax(this._ajaxSettings(a,n,l)),this.xhr&&"canceled"!==this.xhr.statusText&&(s.addClass("ui-tabs-loading"),r.attr("aria-busy","true"),this.xhr.success((function(t){setTimeout((function(){r.html(t),o._trigger("load",n,l)}),1)})).complete((function(t,e){setTimeout((function(){"abort"===e&&o.panels.stop(!1,!0),s.removeClass("ui-tabs-loading"),r.removeAttr("aria-busy"),t===o.xhr&&delete o.xhr}),1)}))))},_ajaxSettings:function(e,i,n){var o=this;return{url:e.attr("href"),beforeSend:function(e,s){return o._trigger("beforeLoad",i,t.extend({jqXHR:e,ajaxSettings:s},n))}}},_getPanelForTab:function(e){var i=t(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(t),function(t,e){function i(t){o=t.originalEvent,l=o.accelerationIncludingGravity,s=Math.abs(l.x),a=Math.abs(l.y),r=Math.abs(l.z),!e.orientation&&(s>7||(r>6&&8>a||8>r&&a>6)&&s>5)?n.enabled&&n.disable():n.enabled||n.enable()}t.mobile.iosorientationfixEnabled=!0;var n,o,s,a,r,l,c=navigator.userAgent;/iPhone|iPad|iPod/.test(navigator.platform)&&/OS [1-5]_[0-9_]* like Mac OS X/i.test(c)&&c.indexOf("AppleWebKit")>-1?(n=t.mobile.zoom,t.mobile.document.on("mobileinit",(function(){t.mobile.iosorientationfixEnabled&&t.mobile.window.bind("orientationchange.iosorientationfix",n.enable).bind("devicemotion.iosorientationfix",i)}))):t.mobile.iosorientationfixEnabled=!1}(t,this),function(t,e,n){function o(){s.removeClass("ui-mobile-rendering")}var s=t("html"),a=t.mobile.window;t(e.document).trigger("mobileinit"),t.mobile.gradeA()&&(t.mobile.ajaxBlacklist&&(t.mobile.ajaxEnabled=!1),s.addClass("ui-mobile ui-mobile-rendering"),setTimeout(o,5e3),t.extend(t.mobile,{initializePage:function(){var e=t.mobile.path,n=t(":jqmData(role='page'), :jqmData(role='dialog')"),s=e.stripHash(e.stripQueryParams(e.parseLocation().hash)),r=t.mobile.path.parseLocation(),l=s?i.getElementById(s):undefined;n.length||(n=t("body").wrapInner("<div data-"+t.mobile.ns+"role='page'></div>").children(0)),n.each((function(){var i=t(this);i[0].getAttribute("data-"+t.mobile.ns+"url")||i.attr("data-"+t.mobile.ns+"url",i.attr("id")||e.convertUrlToDataUrl(r.pathname+r.search))})),t.mobile.firstPage=n.first(),t.mobile.pageContainer=t.mobile.firstPage.parent().addClass("ui-mobile-viewport").pagecontainer(),t.mobile.navreadyDeferred.resolve(),a.trigger("pagecontainercreate"),t.mobile.loading("show"),o(),t.mobile.hashListeningEnabled&&t.mobile.path.isHashValid(location.hash)&&(t(l).is(":jqmData(role='page')")||t.mobile.path.isPath(s)||s===t.mobile.dialogHashKey)?t.event.special.navigate.isPushStateEnabled()?(t.mobile.navigate.history.stack=[],t.mobile.navigate(t.mobile.path.isPath(location.hash)?location.hash:location.href)):a.trigger("hashchange",[!0]):(t.event.special.navigate.isPushStateEnabled()&&t.mobile.navigate.navigator.squash(e.parseLocation().href),t.mobile.changePage(t.mobile.firstPage,{transition:"none",reverse:!0,changeHash:!1,fromHashChange:!0}))}}),t((function(){t.support.inlineSVG(),t.mobile.hideUrlBar&&e.scrollTo(0,1),t.mobile.defaultHomeScroll=t.support.scrollTop&&1!==t.mobile.window.scrollTop()?1:0,t.mobile.autoInitializePage&&t.mobile.initializePage(),t.mobile.hideUrlBar&&a.load(t.mobile.silentScroll),t.support.cssPointerEvents||t.mobile.document.delegate(".ui-state-disabled,.ui-disabled","vclick",(function(t){t.preventDefault(),t.stopImmediatePropagation()}))})))}(t,this)}));