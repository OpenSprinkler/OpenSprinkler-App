/*! jQuery v2.1.1 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */
!function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){var n=[],i=n.slice,o=n.concat,a=n.push,s=n.indexOf,r={},l=r.toString,c=r.hasOwnProperty,d={},u=t.document,h="2.1.1",p=function(t,e){return new p.fn.init(t,e)},f=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,m=/^-ms-/,g=/-([\da-z])/gi,v=function(t,e){return e.toUpperCase()};function b(t){var e=t.length,n=p.type(t);return"function"!==n&&!p.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t))}p.fn=p.prototype={jquery:h,constructor:p,selector:"",length:0,toArray:function(){return i.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:i.call(this)},pushStack:function(t){var e=p.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return p.each(this,t,e)},map:function(t){return this.pushStack(p.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:a,sort:n.sort,splice:n.splice},p.extend=p.fn.extend=function(){var t,e,n,i,o,a,s=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof s&&(c=s,s=arguments[r]||{},r++),"object"==typeof s||p.isFunction(s)||(s={}),r===l&&(s=this,r--);l>r;r++)if(null!=(t=arguments[r]))for(e in t)n=s[e],s!==(i=t[e])&&(c&&i&&(p.isPlainObject(i)||(o=p.isArray(i)))?(o?(o=!1,a=n&&p.isArray(n)?n:[]):a=n&&p.isPlainObject(n)?n:{},s[e]=p.extend(c,a,i)):void 0!==i&&(s[e]=i));return s},p.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===p.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!p.isArray(t)&&t-parseFloat(t)>=0},isPlainObject:function(t){return"object"===p.type(t)&&!t.nodeType&&!p.isWindow(t)&&!(t.constructor&&!c.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?r[l.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;(t=p.trim(t))&&(1===t.indexOf("use strict")?((e=u.createElement("script")).text=t,u.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(m,"ms-").replace(g,v)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var i=0,o=t.length,a=b(t);if(n){if(a)for(;o>i&&!1!==e.apply(t[i],n);i++);else for(i in t)if(!1===e.apply(t[i],n))break}else if(a)for(;o>i&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(f,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(b(Object(t))?p.merge(n,"string"==typeof t?[t]:t):a.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:s.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,o=t.length;n>i;i++)t[o++]=e[i];return t.length=o,t},grep:function(t,e,n){for(var i=[],o=0,a=t.length,s=!n;a>o;o++)!e(t[o],o)!==s&&i.push(t[o]);return i},map:function(t,e,n){var i,a=0,s=t.length,r=[];if(b(t))for(;s>a;a++)null!=(i=e(t[a],a,n))&&r.push(i);else for(a in t)null!=(i=e(t[a],a,n))&&r.push(i);return o.apply([],r)},guid:1,proxy:function(t,e){var n,o,a;return"string"==typeof e&&(n=t[e],e=t,t=n),p.isFunction(t)?(o=i.call(arguments,2),a=function(){return t.apply(e||this,o.concat(i.call(arguments)))},a.guid=t.guid=t.guid||p.guid++,a):void 0},now:Date.now,support:d}),p.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(t,e){r["[object "+e+"]"]=e.toLowerCase()}));var y=function(t){var e,n,i,o,a,s,r,l,c,d,u,h,p,f,m,g,v,b,y,w="sizzle"+-new Date,x=t.document,_=0,k=0,S=at(),T=at(),C=at(),M=function(t,e){return t===e&&(u=!0),0},D="undefined",O=1<<31,E={}.hasOwnProperty,A=[],I=A.pop,P=A.push,L=A.push,N=A.slice,R=A.indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1},j="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",$="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",H=B.replace("w","w#"),W="\\["+$+"*("+B+")(?:"+$+"*([*^$|!~]?=)"+$+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+H+"))|)"+$+"*\\]",F=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",U=new RegExp("^"+$+"+|((?:^|[^\\\\])(?:\\\\.)*)"+$+"+$","g"),V=new RegExp("^"+$+"*,"+$+"*"),z=new RegExp("^"+$+"*([>+~]|"+$+")"+$+"*"),q=new RegExp("="+$+"*([^\\]'\"]*?)"+$+"*\\]","g"),Y=new RegExp(F),G=new RegExp("^"+H+"$"),X={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B.replace("w","w*")+")"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+$+"*(even|odd|(([+-]|)(\\d*)n|)"+$+"*(?:([+-]|)"+$+"*(\\d+)|))"+$+"*\\)|)","i"),bool:new RegExp("^(?:"+j+")$","i"),needsContext:new RegExp("^"+$+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+$+"*((?:-\\d)?\\d*)"+$+"*\\)|)(?=[^-]|$)","i")},J=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=/'|\\/g,nt=new RegExp("\\\\([\\da-f]{1,6}"+$+"?|("+$+")|.)","ig"),it=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)};try{L.apply(A=N.call(x.childNodes),x.childNodes),A[x.childNodes.length].nodeType}catch(t){L={apply:A.length?function(t,e){P.apply(t,N.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function ot(t,e,i,o){var a,r,c,d,u,f,v,b,_,k;if((e?e.ownerDocument||e:x)!==p&&h(e),i=i||[],!t||"string"!=typeof t)return i;if(1!==(d=(e=e||p).nodeType)&&9!==d)return[];if(m&&!o){if(a=Z.exec(t))if(c=a[1]){if(9===d){if(!(r=e.getElementById(c))||!r.parentNode)return i;if(r.id===c)return i.push(r),i}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(c))&&y(e,r)&&r.id===c)return i.push(r),i}else{if(a[2])return L.apply(i,e.getElementsByTagName(t)),i;if((c=a[3])&&n.getElementsByClassName&&e.getElementsByClassName)return L.apply(i,e.getElementsByClassName(c)),i}if(n.qsa&&(!g||!g.test(t))){if(b=v=w,_=e,k=9===d&&t,1===d&&"object"!==e.nodeName.toLowerCase()){for(f=s(t),(v=e.getAttribute("id"))?b=v.replace(et,"\\$&"):e.setAttribute("id",b),b="[id='"+b+"'] ",u=f.length;u--;)f[u]=b+mt(f[u]);_=tt.test(t)&&pt(e.parentNode)||e,k=f.join(",")}if(k)try{return L.apply(i,_.querySelectorAll(k)),i}catch(t){}finally{v||e.removeAttribute("id")}}}return l(t.replace(U,"$1"),e,i,o)}function at(){var t=[];return function e(n,o){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=o}}function st(t){return t[w]=!0,t}function rt(t){var e=p.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function lt(t,e){for(var n=t.split("|"),o=t.length;o--;)i.attrHandle[n[o]]=e}function ct(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||O)-(~t.sourceIndex||O);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function dt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ut(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function ht(t){return st((function(e){return e=+e,st((function(n,i){for(var o,a=t([],n.length,e),s=a.length;s--;)n[o=a[s]]&&(n[o]=!(i[o]=n[o]))}))}))}function pt(t){return t&&typeof t.getElementsByTagName!==D&&t}for(e in n=ot.support={},a=ot.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},h=ot.setDocument=function(t){var e,o=t?t.ownerDocument||t:x,s=o.defaultView;return o!==p&&9===o.nodeType&&o.documentElement?(p=o,f=o.documentElement,m=!a(o),s&&s!==s.top&&(s.addEventListener?s.addEventListener("unload",(function(){h()}),!1):s.attachEvent&&s.attachEvent("onunload",(function(){h()}))),n.attributes=rt((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=rt((function(t){return t.appendChild(o.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=K.test(o.getElementsByClassName)&&rt((function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length})),n.getById=rt((function(t){return f.appendChild(t).id=w,!o.getElementsByName||!o.getElementsByName(w).length})),n.getById?(i.find.ID=function(t,e){if(typeof e.getElementById!==D&&m){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(t){var e=t.replace(nt,it);return function(t){return t.getAttribute("id")===e}}):(delete i.find.ID,i.filter.ID=function(t){var e=t.replace(nt,it);return function(t){var n=typeof t.getAttributeNode!==D&&t.getAttributeNode("id");return n&&n.value===e}}),i.find.TAG=n.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==D?e.getElementsByTagName(t):void 0}:function(t,e){var n,i=[],o=0,a=e.getElementsByTagName(t);if("*"===t){for(;n=a[o++];)1===n.nodeType&&i.push(n);return i}return a},i.find.CLASS=n.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==D&&m?e.getElementsByClassName(t):void 0},v=[],g=[],(n.qsa=K.test(o.querySelectorAll))&&(rt((function(t){t.innerHTML="<select msallowclip=''><option selected=''></option></select>",t.querySelectorAll("[msallowclip^='']").length&&g.push("[*^$]="+$+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+$+"*(?:value|"+j+")"),t.querySelectorAll(":checked").length||g.push(":checked")})),rt((function(t){var e=o.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+$+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")}))),(n.matchesSelector=K.test(b=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&rt((function(t){n.disconnectedMatch=b.call(t,"div"),b.call(t,"[s!='']:x"),v.push("!=",F)})),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=K.test(f.compareDocumentPosition),y=e||K.test(f.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},M=e?function(t,e){if(t===e)return u=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t===o||t.ownerDocument===x&&y(x,t)?-1:e===o||e.ownerDocument===x&&y(x,e)?1:d?R.call(d,t)-R.call(d,e):0:4&i?-1:1)}:function(t,e){if(t===e)return u=!0,0;var n,i=0,a=t.parentNode,s=e.parentNode,r=[t],l=[e];if(!a||!s)return t===o?-1:e===o?1:a?-1:s?1:d?R.call(d,t)-R.call(d,e):0;if(a===s)return ct(t,e);for(n=t;n=n.parentNode;)r.unshift(n);for(n=e;n=n.parentNode;)l.unshift(n);for(;r[i]===l[i];)i++;return i?ct(r[i],l[i]):r[i]===x?-1:l[i]===x?1:0},o):p},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&h(t),e=e.replace(q,"='$1']"),!(!n.matchesSelector||!m||v&&v.test(e)||g&&g.test(e)))try{var i=b.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){}return ot(e,p,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!==p&&h(t),y(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==p&&h(t);var o=i.attrHandle[e.toLowerCase()],a=o&&E.call(i.attrHandle,e.toLowerCase())?o(t,e,!m):void 0;return void 0!==a?a:n.attributes||!m?t.getAttribute(e):(a=t.getAttributeNode(e))&&a.specified?a.value:null},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,i=[],o=0,a=0;if(u=!n.detectDuplicates,d=!n.sortStable&&t.slice(0),t.sort(M),u){for(;e=t[a++];)e===t[a]&&(o=i.push(a));for(;o--;)t.splice(i[o],1)}return d=null,t},o=ot.getText=function(t){var e,n="",i=0,a=t.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=o(t)}else if(3===a||4===a)return t.nodeValue}else for(;e=t[i++];)n+=o(e);return n},i=ot.selectors={cacheLength:50,createPseudo:st,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(nt,it),t[3]=(t[3]||t[4]||t[5]||"").replace(nt,it),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return X.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&Y.test(n)&&(e=s(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(nt,it).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+$+")"+t+"("+$+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==D&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(i){var o=ot.attr(i,t);return null==o?"!="===e:!e||(o+="","="===e?o===n:"!="===e?o!==n:"^="===e?n&&0===o.indexOf(n):"*="===e?n&&o.indexOf(n)>-1:"$="===e?n&&o.slice(-n.length)===n:"~="===e?(" "+o+" ").indexOf(n)>-1:"|="===e&&(o===n||o.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,o){var a="nth"!==t.slice(0,3),s="last"!==t.slice(-4),r="of-type"===e;return 1===i&&0===o?function(t){return!!t.parentNode}:function(e,n,l){var c,d,u,h,p,f,m=a!==s?"nextSibling":"previousSibling",g=e.parentNode,v=r&&e.nodeName.toLowerCase(),b=!l&&!r;if(g){if(a){for(;m;){for(u=e;u=u[m];)if(r?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[s?g.firstChild:g.lastChild],s&&b){for(p=(c=(d=g[w]||(g[w]={}))[t]||[])[0]===_&&c[1],h=c[0]===_&&c[2],u=p&&g.childNodes[p];u=++p&&u&&u[m]||(h=p=0)||f.pop();)if(1===u.nodeType&&++h&&u===e){d[t]=[_,p,h];break}}else if(b&&(c=(e[w]||(e[w]={}))[t])&&c[0]===_)h=c[1];else for(;(u=++p&&u&&u[m]||(h=p=0)||f.pop())&&((r?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++h||(b&&((u[w]||(u[w]={}))[t]=[_,h]),u!==e)););return(h-=o)===i||h%i==0&&h/i>=0}}},PSEUDO:function(t,e){var n,o=i.pseudos[t]||i.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return o[w]?o(e):o.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?st((function(t,n){for(var i,a=o(t,e),s=a.length;s--;)t[i=R.call(t,a[s])]=!(n[i]=a[s])})):function(t){return o(t,0,n)}):o}},pseudos:{not:st((function(t){var e=[],n=[],i=r(t.replace(U,"$1"));return i[w]?st((function(t,e,n,o){for(var a,s=i(t,null,o,[]),r=t.length;r--;)(a=s[r])&&(t[r]=!(e[r]=a))})):function(t,o,a){return e[0]=t,i(e,null,a,n),!n.pop()}})),has:st((function(t){return function(e){return ot(t,e).length>0}})),contains:st((function(t){return function(e){return(e.textContent||e.innerText||o(e)).indexOf(t)>-1}})),lang:st((function(t){return G.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(nt,it).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return J.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ht((function(){return[0]})),last:ht((function(t,e){return[e-1]})),eq:ht((function(t,e,n){return[0>n?n+e:n]})),even:ht((function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t})),odd:ht((function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t})),lt:ht((function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t})),gt:ht((function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t}))}},i.pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=dt(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ut(e);function ft(){}function mt(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function gt(t,e,n){var i=e.dir,o=n&&"parentNode"===i,a=k++;return e.first?function(e,n,a){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,a)}:function(e,n,s){var r,l,c=[_,a];if(s){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,s))return!0}else for(;e=e[i];)if(1===e.nodeType||o){if((r=(l=e[w]||(e[w]={}))[i])&&r[0]===_&&r[1]===a)return c[2]=r[2];if(l[i]=c,c[2]=t(e,n,s))return!0}}}function vt(t){return t.length>1?function(e,n,i){for(var o=t.length;o--;)if(!t[o](e,n,i))return!1;return!0}:t[0]}function bt(t,e,n,i,o){for(var a,s=[],r=0,l=t.length,c=null!=e;l>r;r++)(a=t[r])&&(!n||n(a,i,o))&&(s.push(a),c&&e.push(r));return s}function yt(t,e,n,i,o,a){return i&&!i[w]&&(i=yt(i)),o&&!o[w]&&(o=yt(o,a)),st((function(a,s,r,l){var c,d,u,h=[],p=[],f=s.length,m=a||function(t,e,n){for(var i=0,o=e.length;o>i;i++)ot(t,e[i],n);return n}(e||"*",r.nodeType?[r]:r,[]),g=!t||!a&&e?m:bt(m,h,t,r,l),v=n?o||(a?t:f||i)?[]:s:g;if(n&&n(g,v,r,l),i)for(c=bt(v,p),i(c,[],r,l),d=c.length;d--;)(u=c[d])&&(v[p[d]]=!(g[p[d]]=u));if(a){if(o||t){if(o){for(c=[],d=v.length;d--;)(u=v[d])&&c.push(g[d]=u);o(null,v=[],c,l)}for(d=v.length;d--;)(u=v[d])&&(c=o?R.call(a,u):h[d])>-1&&(a[c]=!(s[c]=u))}}else v=bt(v===s?v.splice(f,v.length):v),o?o(null,s,v,l):L.apply(s,v)}))}function wt(t){for(var e,n,o,a=t.length,s=i.relative[t[0].type],r=s||i.relative[" "],l=s?1:0,d=gt((function(t){return t===e}),r,!0),u=gt((function(t){return R.call(e,t)>-1}),r,!0),h=[function(t,n,i){return!s&&(i||n!==c)||((e=n).nodeType?d(t,n,i):u(t,n,i))}];a>l;l++)if(n=i.relative[t[l].type])h=[gt(vt(h),n)];else{if((n=i.filter[t[l].type].apply(null,t[l].matches))[w]){for(o=++l;a>o&&!i.relative[t[o].type];o++);return yt(l>1&&vt(h),l>1&&mt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(U,"$1"),n,o>l&&wt(t.slice(l,o)),a>o&&wt(t=t.slice(o)),a>o&&mt(t))}h.push(n)}return vt(h)}function xt(t,e){var n=e.length>0,o=t.length>0,a=function(a,s,r,l,d){var u,h,f,m=0,g="0",v=a&&[],b=[],y=c,w=a||o&&i.find.TAG("*",d),x=_+=null==y?1:Math.random()||.1,k=w.length;for(d&&(c=s!==p&&s);g!==k&&null!=(u=w[g]);g++){if(o&&u){for(h=0;f=t[h++];)if(f(u,s,r)){l.push(u);break}d&&(_=x)}n&&((u=!f&&u)&&m--,a&&v.push(u))}if(m+=g,n&&g!==m){for(h=0;f=e[h++];)f(v,b,s,r);if(a){if(m>0)for(;g--;)v[g]||b[g]||(b[g]=I.call(l));b=bt(b)}L.apply(l,b),d&&!a&&b.length>0&&m+e.length>1&&ot.uniqueSort(l)}return d&&(_=x,c=y),v};return n?st(a):a}return ft.prototype=i.filters=i.pseudos,i.setFilters=new ft,s=ot.tokenize=function(t,e){var n,o,a,s,r,l,c,d=T[t+" "];if(d)return e?0:d.slice(0);for(r=t,l=[],c=i.preFilter;r;){for(s in(!n||(o=V.exec(r)))&&(o&&(r=r.slice(o[0].length)||r),l.push(a=[])),n=!1,(o=z.exec(r))&&(n=o.shift(),a.push({value:n,type:o[0].replace(U," ")}),r=r.slice(n.length)),i.filter)!(o=X[s].exec(r))||c[s]&&!(o=c[s](o))||(n=o.shift(),a.push({value:n,type:s,matches:o}),r=r.slice(n.length));if(!n)break}return e?r.length:r?ot.error(t):T(t,l).slice(0)},r=ot.compile=function(t,e){var n,i=[],o=[],a=C[t+" "];if(!a){for(e||(e=s(t)),n=e.length;n--;)(a=wt(e[n]))[w]?i.push(a):o.push(a);(a=C(t,xt(o,i))).selector=t}return a},l=ot.select=function(t,e,o,a){var l,c,d,u,h,p="function"==typeof t&&t,f=!a&&s(t=p.selector||t);if(o=o||[],1===f.length){if((c=f[0]=f[0].slice(0)).length>2&&"ID"===(d=c[0]).type&&n.getById&&9===e.nodeType&&m&&i.relative[c[1].type]){if(!(e=(i.find.ID(d.matches[0].replace(nt,it),e)||[])[0]))return o;p&&(e=e.parentNode),t=t.slice(c.shift().value.length)}for(l=X.needsContext.test(t)?0:c.length;l--&&(d=c[l],!i.relative[u=d.type]);)if((h=i.find[u])&&(a=h(d.matches[0].replace(nt,it),tt.test(c[0].type)&&pt(e.parentNode)||e))){if(c.splice(l,1),!(t=a.length&&mt(c)))return L.apply(o,a),o;break}}return(p||r(t,f))(a,e,!m,o,tt.test(t)&&pt(e.parentNode)||e),o},n.sortStable=w.split("").sort(M).join("")===w,n.detectDuplicates=!!u,h(),n.sortDetached=rt((function(t){return 1&t.compareDocumentPosition(p.createElement("div"))})),rt((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||lt("type|href|height|width",(function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&rt((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||lt("value",(function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue})),rt((function(t){return null==t.getAttribute("disabled")}))||lt(j,(function(t,e,n){var i;return n?void 0:!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),ot}(t);p.find=y,p.expr=y.selectors,p.expr[":"]=p.expr.pseudos,p.unique=y.uniqueSort,p.text=y.getText,p.isXMLDoc=y.isXML,p.contains=y.contains;var w=p.expr.match.needsContext,x=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,_=/^.[^:#\[\.,]*$/;function k(t,e,n){if(p.isFunction(e))return p.grep(t,(function(t,i){return!!e.call(t,i,t)!==n}));if(e.nodeType)return p.grep(t,(function(t){return t===e!==n}));if("string"==typeof e){if(_.test(e))return p.filter(e,t,n);e=p.filter(e,t)}return p.grep(t,(function(t){return s.call(e,t)>=0!==n}))}p.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?p.find.matchesSelector(i,t)?[i]:[]:p.find.matches(t,p.grep(e,(function(t){return 1===t.nodeType})))},p.fn.extend({find:function(t){var e,n=this.length,i=[],o=this;if("string"!=typeof t)return this.pushStack(p(t).filter((function(){for(e=0;n>e;e++)if(p.contains(o[e],this))return!0})));for(e=0;n>e;e++)p.find(t,o[e],i);return(i=this.pushStack(n>1?p.unique(i):i)).selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(k(this,t||[],!1))},not:function(t){return this.pushStack(k(this,t||[],!0))},is:function(t){return!!k(this,"string"==typeof t&&w.test(t)?p(t):t||[],!1).length}});var S,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=p.fn.init=function(t,e){var n,i;if(!t)return this;if("string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:T.exec(t))||!n[1]&&e)return!e||e.jquery?(e||S).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof p?e[0]:e,p.merge(this,p.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:u,!0)),x.test(n[1])&&p.isPlainObject(e))for(n in e)p.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(i=u.getElementById(n[2]))&&i.parentNode&&(this.length=1,this[0]=i),this.context=u,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):p.isFunction(t)?void 0!==S.ready?S.ready(t):t(p):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),p.makeArray(t,this))};C.prototype=p.fn,S=p(u);var M=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};function O(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}p.extend({dir:function(t,e,n){for(var i=[],o=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&p(t).is(n))break;i.push(t)}return i},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}}),p.fn.extend({has:function(t){var e=p(t,this),n=e.length;return this.filter((function(){for(var t=0;n>t;t++)if(p.contains(this,e[t]))return!0}))},closest:function(t,e){for(var n,i=0,o=this.length,a=[],s=w.test(t)||"string"!=typeof t?p(t,e||this.context):0;o>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&p.find.matchesSelector(n,t))){a.push(n);break}return this.pushStack(a.length>1?p.unique(a):a)},index:function(t){return t?"string"==typeof t?s.call(p(t),this[0]):s.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(p.unique(p.merge(this.get(),p(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),p.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return p.dir(t,"parentNode")},parentsUntil:function(t,e,n){return p.dir(t,"parentNode",n)},next:function(t){return O(t,"nextSibling")},prev:function(t){return O(t,"previousSibling")},nextAll:function(t){return p.dir(t,"nextSibling")},prevAll:function(t){return p.dir(t,"previousSibling")},nextUntil:function(t,e,n){return p.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return p.dir(t,"previousSibling",n)},siblings:function(t){return p.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return p.sibling(t.firstChild)},contents:function(t){return t.contentDocument||p.merge([],t.childNodes)}},(function(t,e){p.fn[t]=function(n,i){var o=p.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=p.filter(i,o)),this.length>1&&(D[t]||p.unique(o),M.test(t)&&o.reverse()),this.pushStack(o)}}));var E,A=/\S+/g,I={};function P(){u.removeEventListener("DOMContentLoaded",P,!1),t.removeEventListener("load",P,!1),p.ready()}p.Callbacks=function(t){t="string"==typeof t?I[t]||function(t){var e=I[t]={};return p.each(t.match(A)||[],(function(t,n){e[n]=!0})),e}(t):p.extend({},t);var e,n,i,o,a,s,r=[],l=!t.once&&[],c=function(u){for(e=t.memory&&u,n=!0,s=o||0,o=0,a=r.length,i=!0;r&&a>s;s++)if(!1===r[s].apply(u[0],u[1])&&t.stopOnFalse){e=!1;break}i=!1,r&&(l?l.length&&c(l.shift()):e?r=[]:d.disable())},d={add:function(){if(r){var n=r.length;!function e(n){p.each(n,(function(n,i){var o=p.type(i);"function"===o?t.unique&&d.has(i)||r.push(i):i&&i.length&&"string"!==o&&e(i)}))}(arguments),i?a=r.length:e&&(o=n,c(e))}return this},remove:function(){return r&&p.each(arguments,(function(t,e){for(var n;(n=p.inArray(e,r,n))>-1;)r.splice(n,1),i&&(a>=n&&a--,s>=n&&s--)})),this},has:function(t){return t?p.inArray(t,r)>-1:!(!r||!r.length)},empty:function(){return r=[],a=0,this},disable:function(){return r=l=e=void 0,this},disabled:function(){return!r},lock:function(){return l=void 0,e||d.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!r||n&&!l||(e=[t,(e=e||[]).slice?e.slice():e],i?l.push(e):c(e)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},p.extend({Deferred:function(t){var e=[["resolve","done",p.Callbacks("once memory"),"resolved"],["reject","fail",p.Callbacks("once memory"),"rejected"],["notify","progress",p.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return p.Deferred((function(n){p.each(e,(function(e,a){var s=p.isFunction(t[e])&&t[e];o[a[1]]((function(){var t=s&&s.apply(this,arguments);t&&p.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a[0]+"With"](this===i?n.promise():this,s?[t]:arguments)}))})),t=null})).promise()},promise:function(t){return null!=t?p.extend(t,i):i}},o={};return i.pipe=i.then,p.each(e,(function(t,a){var s=a[2],r=a[3];i[a[1]]=s.add,r&&s.add((function(){n=r}),e[1^t][2].disable,e[2][2].lock),o[a[0]]=function(){return o[a[0]+"With"](this===o?i:this,arguments),this},o[a[0]+"With"]=s.fireWith})),i.promise(o),t&&t.call(o,o),o},when:function(t){var e,n,o,a=0,s=i.call(arguments),r=s.length,l=1!==r||t&&p.isFunction(t.promise)?r:0,c=1===l?t:p.Deferred(),d=function(t,n,o){return function(a){n[t]=this,o[t]=arguments.length>1?i.call(arguments):a,o===e?c.notifyWith(n,o):--l||c.resolveWith(n,o)}};if(r>1)for(e=new Array(r),n=new Array(r),o=new Array(r);r>a;a++)s[a]&&p.isFunction(s[a].promise)?s[a].promise().done(d(a,o,s)).fail(c.reject).progress(d(a,n,e)):--l;return l||c.resolveWith(o,s),c.promise()}}),p.fn.ready=function(t){return p.ready.promise().done(t),this},p.extend({isReady:!1,readyWait:1,holdReady:function(t){t?p.readyWait++:p.ready(!0)},ready:function(t){(!0===t?--p.readyWait:p.isReady)||(p.isReady=!0,!0!==t&&--p.readyWait>0||(E.resolveWith(u,[p]),p.fn.triggerHandler&&(p(u).triggerHandler("ready"),p(u).off("ready"))))}}),p.ready.promise=function(e){return E||(E=p.Deferred(),"complete"===u.readyState?setTimeout(p.ready):(u.addEventListener("DOMContentLoaded",P,!1),t.addEventListener("load",P,!1))),E.promise(e)},p.ready.promise();var L=p.access=function(t,e,n,i,o,a,s){var r=0,l=t.length,c=null==n;if("object"===p.type(n))for(r in o=!0,n)p.access(t,e,r,n[r],!0,a,s);else if(void 0!==i&&(o=!0,p.isFunction(i)||(s=!0),c&&(s?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(p(t),n)})),e))for(;l>r;r++)e(t[r],n,s?i:i.call(t[r],r,e(t[r],n)));return o?t:c?e.call(t):l?e(t[0],n):a};function N(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=p.expando+Math.random()}p.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},N.uid=1,N.accepts=p.acceptData,N.prototype={key:function(t){if(!N.accepts(t))return 0;var e={},n=t[this.expando];if(!n){n=N.uid++;try{e[this.expando]={value:n},Object.defineProperties(t,e)}catch(i){e[this.expando]=n,p.extend(t,e)}}return this.cache[n]||(this.cache[n]={}),n},set:function(t,e,n){var i,o=this.key(t),a=this.cache[o];if("string"==typeof e)a[e]=n;else if(p.isEmptyObject(a))p.extend(this.cache[o],e);else for(i in e)a[i]=e[i];return a},get:function(t,e){var n=this.cache[this.key(t)];return void 0===e?n:n[e]},access:function(t,e,n){var i;return void 0===e||e&&"string"==typeof e&&void 0===n?void 0!==(i=this.get(t,e))?i:this.get(t,p.camelCase(e)):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i,o,a=this.key(t),s=this.cache[a];if(void 0===e)this.cache[a]={};else{p.isArray(e)?i=e.concat(e.map(p.camelCase)):(o=p.camelCase(e),e in s?i=[e,o]:i=(i=o)in s?[i]:i.match(A)||[]),n=i.length;for(;n--;)delete s[i[n]]}},hasData:function(t){return!p.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var R=new N,j=new N,$=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,B=/([A-Z])/g;function H(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(B,"-$1").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:$.test(n)?p.parseJSON(n):n)}catch(t){}j.set(t,e,n)}else n=void 0;return n}p.extend({hasData:function(t){return j.hasData(t)||R.hasData(t)},data:function(t,e,n){return j.access(t,e,n)},removeData:function(t,e){j.remove(t,e)},_data:function(t,e,n){return R.access(t,e,n)},_removeData:function(t,e){R.remove(t,e)}}),p.fn.extend({data:function(t,e){var n,i,o,a=this[0],s=a&&a.attributes;if(void 0===t){if(this.length&&(o=j.get(a),1===a.nodeType&&!R.get(a,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(0===(i=s[n].name).indexOf("data-")&&(i=p.camelCase(i.slice(5)),H(a,i,o[i])));R.set(a,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each((function(){j.set(this,t)})):L(this,(function(e){var n,i=p.camelCase(t);if(a&&void 0===e){if(void 0!==(n=j.get(a,t)))return n;if(void 0!==(n=j.get(a,i)))return n;if(void 0!==(n=H(a,i,void 0)))return n}else this.each((function(){var n=j.get(this,i);j.set(this,i,e),-1!==t.indexOf("-")&&void 0!==n&&j.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){j.remove(this,t)}))}}),p.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=R.get(t,e),n&&(!i||p.isArray(n)?i=R.access(t,e,p.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=p.queue(t,e),i=n.length,o=n.shift(),a=p._queueHooks(t,e);"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===e&&n.unshift("inprogress"),delete a.stop,o.call(t,(function(){p.dequeue(t,e)}),a)),!i&&a&&a.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return R.get(t,n)||R.access(t,n,{empty:p.Callbacks("once memory").add((function(){R.remove(t,[e+"queue",n])}))})}}),p.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?p.queue(this[0],t):void 0===e?this:this.each((function(){var n=p.queue(this,t,e);p._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&p.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){p.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,o=p.Deferred(),a=this,s=this.length,r=function(){--i||o.resolveWith(a,[a])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)(n=R.get(a[s],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(r));return r(),o.promise(e)}});var W=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,F=["Top","Right","Bottom","Left"],U=function(t,e){return t=e||t,"none"===p.css(t,"display")||!p.contains(t.ownerDocument,t)},V=/^(?:checkbox|radio)$/i;!function(){var t=u.createDocumentFragment().appendChild(u.createElement("div")),e=u.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),d.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",d.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var z="undefined";d.focusinBubbles="onfocusin"in t;var q=/^key/,Y=/^(?:mouse|pointer|contextmenu)|click/,G=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;function J(){return!0}function Q(){return!1}function K(){try{return u.activeElement}catch(t){}}p.event={global:{},add:function(t,e,n,i,o){var a,s,r,l,c,d,u,h,f,m,g,v=R.get(t);if(v)for(n.handler&&(n=(a=n).handler,o=a.selector),n.guid||(n.guid=p.guid++),(l=v.events)||(l=v.events={}),(s=v.handle)||(s=v.handle=function(e){return typeof p!==z&&p.event.triggered!==e.type?p.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(A)||[""]).length;c--;)f=g=(r=X.exec(e[c])||[])[1],m=(r[2]||"").split(".").sort(),f&&(u=p.event.special[f]||{},f=(o?u.delegateType:u.bindType)||f,u=p.event.special[f]||{},d=p.extend({type:f,origType:g,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&p.expr.match.needsContext.test(o),namespace:m.join(".")},a),(h=l[f])||((h=l[f]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(t,i,m,s)||t.addEventListener&&t.addEventListener(f,s,!1)),u.add&&(u.add.call(t,d),d.handler.guid||(d.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,d):h.push(d),p.event.global[f]=!0)},remove:function(t,e,n,i,o){var a,s,r,l,c,d,u,h,f,m,g,v=R.hasData(t)&&R.get(t);if(v&&(l=v.events)){for(c=(e=(e||"").match(A)||[""]).length;c--;)if(f=g=(r=X.exec(e[c])||[])[1],m=(r[2]||"").split(".").sort(),f){for(u=p.event.special[f]||{},h=l[f=(i?u.delegateType:u.bindType)||f]||[],r=r[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=a=h.length;a--;)d=h[a],!o&&g!==d.origType||n&&n.guid!==d.guid||r&&!r.test(d.namespace)||i&&i!==d.selector&&("**"!==i||!d.selector)||(h.splice(a,1),d.selector&&h.delegateCount--,u.remove&&u.remove.call(t,d));s&&!h.length&&(u.teardown&&!1!==u.teardown.call(t,m,v.handle)||p.removeEvent(t,f,v.handle),delete l[f])}else for(f in l)p.event.remove(t,f+e[c],n,i,!0);p.isEmptyObject(l)&&(delete v.handle,R.remove(t,"events"))}},trigger:function(e,n,i,o){var a,s,r,l,d,h,f,m=[i||u],g=c.call(e,"type")?e.type:e,v=c.call(e,"namespace")?e.namespace.split("."):[];if(s=r=i=i||u,3!==i.nodeType&&8!==i.nodeType&&!G.test(g+p.event.triggered)&&(g.indexOf(".")>=0&&(v=g.split("."),g=v.shift(),v.sort()),d=g.indexOf(":")<0&&"on"+g,(e=e[p.expando]?e:new p.Event(g,"object"==typeof e&&e)).isTrigger=o?2:3,e.namespace=v.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),n=null==n?[e]:p.makeArray(n,[e]),f=p.event.special[g]||{},o||!f.trigger||!1!==f.trigger.apply(i,n))){if(!o&&!f.noBubble&&!p.isWindow(i)){for(l=f.delegateType||g,G.test(l+g)||(s=s.parentNode);s;s=s.parentNode)m.push(s),r=s;r===(i.ownerDocument||u)&&m.push(r.defaultView||r.parentWindow||t)}for(a=0;(s=m[a++])&&!e.isPropagationStopped();)e.type=a>1?l:f.bindType||g,(h=(R.get(s,"events")||{})[e.type]&&R.get(s,"handle"))&&h.apply(s,n),(h=d&&s[d])&&h.apply&&p.acceptData(s)&&(e.result=h.apply(s,n),!1===e.result&&e.preventDefault());return e.type=g,o||e.isDefaultPrevented()||f._default&&!1!==f._default.apply(m.pop(),n)||!p.acceptData(i)||d&&p.isFunction(i[g])&&!p.isWindow(i)&&((r=i[d])&&(i[d]=null),p.event.triggered=g,i[g](),p.event.triggered=void 0,r&&(i[d]=r)),e.result}},dispatch:function(t){t=p.event.fix(t);var e,n,o,a,s,r=[],l=i.call(arguments),c=(R.get(this,"events")||{})[t.type]||[],d=p.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!d.preDispatch||!1!==d.preDispatch.call(this,t)){for(r=p.event.handlers.call(this,t,c),e=0;(a=r[e++])&&!t.isPropagationStopped();)for(t.currentTarget=a.elem,n=0;(s=a.handlers[n++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(s.namespace))&&(t.handleObj=s,t.data=s.data,void 0!==(o=((p.event.special[s.origType]||{}).handle||s.handler).apply(a.elem,l))&&!1===(t.result=o)&&(t.preventDefault(),t.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,o,a,s=[],r=e.delegateCount,l=t.target;if(r&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==t.type){for(i=[],n=0;r>n;n++)void 0===i[o=(a=e[n]).selector+" "]&&(i[o]=a.needsContext?p(o,this).index(l)>=0:p.find(o,this,null,[l]).length),i[o]&&i.push(a);i.length&&s.push({elem:l,handlers:i})}return r<e.length&&s.push({elem:this,handlers:e.slice(r)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,o,a=e.button;return null==t.pageX&&null!=e.clientX&&(i=(n=t.target.ownerDocument||u).documentElement,o=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),t.which||void 0===a||(t.which=1&a?1:2&a?3:4&a?2:0),t}},fix:function(t){if(t[p.expando])return t;var e,n,i,o=t.type,a=t,s=this.fixHooks[o];for(s||(this.fixHooks[o]=s=Y.test(o)?this.mouseHooks:q.test(o)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,t=new p.Event(a),e=i.length;e--;)t[n=i[e]]=a[n];return t.target||(t.target=u),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,a):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==K()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===K()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&p.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return p.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,i){var o=p.extend(new p.Event,n,{type:t,isSimulated:!0,originalEvent:{}});i?p.event.trigger(o,null,e):p.event.dispatch.call(e,o),o.isDefaultPrevented()&&n.preventDefault()}},p.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},p.Event=function(t,e){return this instanceof p.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?J:Q):this.type=t,e&&p.extend(this,e),this.timeStamp=t&&t.timeStamp||p.now(),void(this[p.expando]=!0)):new p.Event(t,e)},p.Event.prototype={isDefaultPrevented:Q,isPropagationStopped:Q,isImmediatePropagationStopped:Q,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=J,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=J,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=J,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},p.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){p.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=t.relatedTarget,o=t.handleObj;return(!i||i!==this&&!p.contains(this,i))&&(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}})),d.focusinBubbles||p.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){p.event.simulate(e,t.target,p.event.fix(t),!0)};p.event.special[e]={setup:function(){var i=this.ownerDocument||this,o=R.access(i,e);o||i.addEventListener(t,n,!0),R.access(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=R.access(i,e)-1;o?R.access(i,e,o):(i.removeEventListener(t,n,!0),R.remove(i,e))}}})),p.fn.extend({on:function(t,e,n,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof e&&(n=n||e,e=void 0),t)this.on(s,e,n,t[s],o);return this}if(null==n&&null==i?(i=e,n=e=void 0):null==i&&("string"==typeof e?(i=n,n=void 0):(i=n,n=e,e=void 0)),!1===i)i=Q;else if(!i)return this;return 1===o&&(a=i,i=function(t){return p().off(t),a.apply(this,arguments)},i.guid=a.guid||(a.guid=p.guid++)),this.each((function(){p.event.add(this,t,i,n,e)}))},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(t,e,n){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,p(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return(!1===e||"function"==typeof e)&&(n=e,e=void 0),!1===n&&(n=Q),this.each((function(){p.event.remove(this,t,n,e)}))},trigger:function(t,e){return this.each((function(){p.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];return n?p.event.trigger(t,e,n,!0):void 0}});var Z=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,tt=/<([\w:]+)/,et=/<|&#?\w+;/,nt=/<(?:script|style|link)/i,it=/checked\s*(?:[^=]|=\s*.checked.)/i,ot=/^$|\/(?:java|ecma)script/i,at=/^true\/(.*)/,st=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,rt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function lt(t,e){return p.nodeName(t,"table")&&p.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function ct(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function dt(t){var e=at.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function ut(t,e){for(var n=0,i=t.length;i>n;n++)R.set(t[n],"globalEval",!e||R.get(e[n],"globalEval"))}function ht(t,e){var n,i,o,a,s,r,l,c;if(1===e.nodeType){if(R.hasData(t)&&(a=R.access(t),s=R.set(e,a),c=a.events))for(o in delete s.handle,s.events={},c)for(n=0,i=c[o].length;i>n;n++)p.event.add(e,o,c[o][n]);j.hasData(t)&&(r=j.access(t),l=p.extend({},r),j.set(e,l))}}function pt(t,e){var n=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&p.nodeName(t,e)?p.merge([t],n):n}function ft(t,e){var n=e.nodeName.toLowerCase();"input"===n&&V.test(t.type)?e.checked=t.checked:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}rt.optgroup=rt.option,rt.tbody=rt.tfoot=rt.colgroup=rt.caption=rt.thead,rt.th=rt.td,p.extend({clone:function(t,e,n){var i,o,a,s,r=t.cloneNode(!0),l=p.contains(t.ownerDocument,t);if(!(d.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||p.isXMLDoc(t)))for(s=pt(r),i=0,o=(a=pt(t)).length;o>i;i++)ft(a[i],s[i]);if(e)if(n)for(a=a||pt(t),s=s||pt(r),i=0,o=a.length;o>i;i++)ht(a[i],s[i]);else ht(t,r);return(s=pt(r,"script")).length>0&&ut(s,!l&&pt(t,"script")),r},buildFragment:function(t,e,n,i){for(var o,a,s,r,l,c,d=e.createDocumentFragment(),u=[],h=0,f=t.length;f>h;h++)if((o=t[h])||0===o)if("object"===p.type(o))p.merge(u,o.nodeType?[o]:o);else if(et.test(o)){for(a=a||d.appendChild(e.createElement("div")),s=(tt.exec(o)||["",""])[1].toLowerCase(),r=rt[s]||rt._default,a.innerHTML=r[1]+o.replace(Z,"<$1></$2>")+r[2],c=r[0];c--;)a=a.lastChild;p.merge(u,a.childNodes),(a=d.firstChild).textContent=""}else u.push(e.createTextNode(o));for(d.textContent="",h=0;o=u[h++];)if((!i||-1===p.inArray(o,i))&&(l=p.contains(o.ownerDocument,o),a=pt(d.appendChild(o),"script"),l&&ut(a),n))for(c=0;o=a[c++];)ot.test(o.type||"")&&n.push(o);return d},cleanData:function(t){for(var e,n,i,o,a=p.event.special,s=0;void 0!==(n=t[s]);s++){if(p.acceptData(n)&&((o=n[R.expando])&&(e=R.cache[o]))){if(e.events)for(i in e.events)a[i]?p.event.remove(n,i):p.removeEvent(n,i,e.handle);R.cache[o]&&delete R.cache[o]}delete j.cache[n[j.expando]]}}}),p.fn.extend({text:function(t){return L(this,(function(t){return void 0===t?p.text(this):this.empty().each((function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return this.domManip(arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||lt(this,t).appendChild(t)}))},prepend:function(){return this.domManip(arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=lt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return this.domManip(arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return this.domManip(arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},remove:function(t,e){for(var n,i=t?p.filter(t,this):this,o=0;null!=(n=i[o]);o++)e||1!==n.nodeType||p.cleanData(pt(n)),n.parentNode&&(e&&p.contains(n.ownerDocument,n)&&ut(pt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(p.cleanData(pt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return p.clone(this,t,e)}))},html:function(t){return L(this,(function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!nt.test(t)&&!rt[(tt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Z,"<$1></$2>");try{for(;i>n;n++)1===(e=this[n]||{}).nodeType&&(p.cleanData(pt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,(function(e){t=this.parentNode,p.cleanData(pt(this)),t&&t.replaceChild(e,this)})),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=o.apply([],t);var n,i,a,s,r,l,c=0,u=this.length,h=this,f=u-1,m=t[0],g=p.isFunction(m);if(g||u>1&&"string"==typeof m&&!d.checkClone&&it.test(m))return this.each((function(n){var i=h.eq(n);g&&(t[0]=m.call(this,n,i.html())),i.domManip(t,e)}));if(u&&(i=(n=p.buildFragment(t,this[0].ownerDocument,!1,this)).firstChild,1===n.childNodes.length&&(n=i),i)){for(s=(a=p.map(pt(n,"script"),ct)).length;u>c;c++)r=n,c!==f&&(r=p.clone(r,!0,!0),s&&p.merge(a,pt(r,"script"))),e.call(this[c],r,c);if(s)for(l=a[a.length-1].ownerDocument,p.map(a,dt),c=0;s>c;c++)r=a[c],ot.test(r.type||"")&&!R.access(r,"globalEval")&&p.contains(l,r)&&(r.src?p._evalUrl&&p._evalUrl(r.src):p.globalEval(r.textContent.replace(st,"")))}return this}}),p.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){p.fn[t]=function(t){for(var n,i=[],o=p(t),s=o.length-1,r=0;s>=r;r++)n=r===s?this:this.clone(!0),p(o[r])[e](n),a.apply(i,n.get());return this.pushStack(i)}}));var mt,gt={};function vt(e,n){var i,o=p(n.createElement(e)).appendTo(n.body),a=t.getDefaultComputedStyle&&(i=t.getDefaultComputedStyle(o[0]))?i.display:p.css(o[0],"display");return o.detach(),a}function bt(t){var e=u,n=gt[t];return n||("none"!==(n=vt(t,e))&&n||((e=(mt=(mt||p("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),n=vt(t,e),mt.detach()),gt[t]=n),n}var yt=/^margin/,wt=new RegExp("^("+W+")(?!px)[a-z%]+$","i"),xt=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)};function _t(t,e,n){var i,o,a,s,r=t.style;return(n=n||xt(t))&&(s=n.getPropertyValue(e)||n[e]),n&&(""!==s||p.contains(t.ownerDocument,t)||(s=p.style(t,e)),wt.test(s)&&yt.test(e)&&(i=r.width,o=r.minWidth,a=r.maxWidth,r.minWidth=r.maxWidth=r.width=s,s=n.width,r.width=i,r.minWidth=o,r.maxWidth=a)),void 0!==s?s+"":s}function kt(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}!function(){var e,n,i=u.documentElement,o=u.createElement("div"),a=u.createElement("div");if(a.style){function s(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",i.appendChild(o);var s=t.getComputedStyle(a,null);e="1%"!==s.top,n="4px"===s.width,i.removeChild(o)}a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===a.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(a),t.getComputedStyle&&p.extend(d,{pixelPosition:function(){return s(),e},boxSizingReliable:function(){return null==n&&s(),n},reliableMarginRight:function(){var e,n=a.appendChild(u.createElement("div"));return n.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",a.style.width="1px",i.appendChild(o),e=!parseFloat(t.getComputedStyle(n,null).marginRight),i.removeChild(o),e}})}}(),p.swap=function(t,e,n,i){var o,a,s={};for(a in e)s[a]=t.style[a],t.style[a]=e[a];for(a in o=n.apply(t,i||[]),e)t.style[a]=s[a];return o};var St=/^(none|table(?!-c[ea]).+)/,Tt=new RegExp("^("+W+")(.*)$","i"),Ct=new RegExp("^([+-])=("+W+")","i"),Mt={position:"absolute",visibility:"hidden",display:"block"},Dt={letterSpacing:"0",fontWeight:"400"},Ot=["Webkit","O","Moz","ms"];function Et(t,e){if(e in t)return e;for(var n=e[0].toUpperCase()+e.slice(1),i=e,o=Ot.length;o--;)if((e=Ot[o]+n)in t)return e;return i}function At(t,e,n){var i=Tt.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function It(t,e,n,i,o){for(var a=n===(i?"border":"content")?4:"width"===e?1:0,s=0;4>a;a+=2)"margin"===n&&(s+=p.css(t,n+F[a],!0,o)),i?("content"===n&&(s-=p.css(t,"padding"+F[a],!0,o)),"margin"!==n&&(s-=p.css(t,"border"+F[a]+"Width",!0,o))):(s+=p.css(t,"padding"+F[a],!0,o),"padding"!==n&&(s+=p.css(t,"border"+F[a]+"Width",!0,o)));return s}function Pt(t,e,n){var i=!0,o="width"===e?t.offsetWidth:t.offsetHeight,a=xt(t),s="border-box"===p.css(t,"boxSizing",!1,a);if(0>=o||null==o){if((0>(o=_t(t,e,a))||null==o)&&(o=t.style[e]),wt.test(o))return o;i=s&&(d.boxSizingReliable()||o===t.style[e]),o=parseFloat(o)||0}return o+It(t,e,n||(s?"border":"content"),i,a)+"px"}function Lt(t,e){for(var n,i,o,a=[],s=0,r=t.length;r>s;s++)(i=t[s]).style&&(a[s]=R.get(i,"olddisplay"),n=i.style.display,e?(a[s]||"none"!==n||(i.style.display=""),""===i.style.display&&U(i)&&(a[s]=R.access(i,"olddisplay",bt(i.nodeName)))):(o=U(i),"none"===n&&o||R.set(i,"olddisplay",o?n:p.css(i,"display"))));for(s=0;r>s;s++)(i=t[s]).style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?a[s]||"":"none"));return t}function Nt(t,e,n,i,o){return new Nt.prototype.init(t,e,n,i,o)}p.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=_t(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,a,s,r=p.camelCase(e),l=t.style;return e=p.cssProps[r]||(p.cssProps[r]=Et(l,r)),s=p.cssHooks[e]||p.cssHooks[r],void 0===n?s&&"get"in s&&void 0!==(o=s.get(t,!1,i))?o:l[e]:("string"===(a=typeof n)&&(o=Ct.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(p.css(t,e)),a="number"),void(null!=n&&n==n&&("number"!==a||p.cssNumber[r]||(n+="px"),d.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,i))||(l[e]=n))))}},css:function(t,e,n,i){var o,a,s,r=p.camelCase(e);return e=p.cssProps[r]||(p.cssProps[r]=Et(t.style,r)),(s=p.cssHooks[e]||p.cssHooks[r])&&"get"in s&&(o=s.get(t,!0,n)),void 0===o&&(o=_t(t,e,i)),"normal"===o&&e in Dt&&(o=Dt[e]),""===n||n?(a=parseFloat(o),!0===n||p.isNumeric(a)?a||0:o):o}}),p.each(["height","width"],(function(t,e){p.cssHooks[e]={get:function(t,n,i){return n?St.test(p.css(t,"display"))&&0===t.offsetWidth?p.swap(t,Mt,(function(){return Pt(t,e,i)})):Pt(t,e,i):void 0},set:function(t,n,i){var o=i&&xt(t);return At(0,n,i?It(t,e,i,"border-box"===p.css(t,"boxSizing",!1,o),o):0)}}})),p.cssHooks.marginRight=kt(d.reliableMarginRight,(function(t,e){return e?p.swap(t,{display:"inline-block"},_t,[t,"marginRight"]):void 0})),p.each({margin:"",padding:"",border:"Width"},(function(t,e){p.cssHooks[t+e]={expand:function(n){for(var i=0,o={},a="string"==typeof n?n.split(" "):[n];4>i;i++)o[t+F[i]+e]=a[i]||a[i-2]||a[0];return o}},yt.test(t)||(p.cssHooks[t+e].set=At)})),p.fn.extend({css:function(t,e){return L(this,(function(t,e,n){var i,o,a={},s=0;if(p.isArray(e)){for(i=xt(t),o=e.length;o>s;s++)a[e[s]]=p.css(t,e[s],!1,i);return a}return void 0!==n?p.style(t,e,n):p.css(t,e)}),t,e,arguments.length>1)},show:function(){return Lt(this,!0)},hide:function(){return Lt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){U(this)?p(this).show():p(this).hide()}))}}),p.Tween=Nt,Nt.prototype={constructor:Nt,init:function(t,e,n,i,o,a){this.elem=t,this.prop=n,this.easing=o||"swing",this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=a||(p.cssNumber[n]?"":"px")},cur:function(){var t=Nt.propHooks[this.prop];return t&&t.get?t.get(this):Nt.propHooks._default.get(this)},run:function(t){var e,n=Nt.propHooks[this.prop];return this.pos=e=this.options.duration?p.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Nt.propHooks._default.set(this),this}},Nt.prototype.init.prototype=Nt.prototype,Nt.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=p.css(t.elem,t.prop,""))&&"auto"!==e?e:0:t.elem[t.prop]},set:function(t){p.fx.step[t.prop]?p.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[p.cssProps[t.prop]]||p.cssHooks[t.prop])?p.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},Nt.propHooks.scrollTop=Nt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},p.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},p.fx=Nt.prototype.init,p.fx.step={};var Rt,jt,$t=/^(?:toggle|show|hide)$/,Bt=new RegExp("^(?:([+-])=|)("+W+")([a-z%]*)$","i"),Ht=/queueHooks$/,Wt=[function(t,e,n){var i,o,a,s,r,l,c,d=this,u={},h=t.style,f=t.nodeType&&U(t),m=R.get(t,"fxshow");for(i in n.queue||(null==(r=p._queueHooks(t,"fx")).unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,d.always((function(){d.always((function(){r.unqueued--,p.queue(t,"fx").length||r.empty.fire()}))}))),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],c=p.css(t,"display"),"inline"===("none"===c?R.get(t,"olddisplay")||bt(t.nodeName):c)&&"none"===p.css(t,"float")&&(h.display="inline-block")),n.overflow&&(h.overflow="hidden",d.always((function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}))),e)if(o=e[i],$t.exec(o)){if(delete e[i],a=a||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;f=!0}u[i]=m&&m[i]||p.style(t,i)}else c=void 0;if(p.isEmptyObject(u))"inline"===("none"===c?bt(t.nodeName):c)&&(h.display=c);else for(i in m?"hidden"in m&&(f=m.hidden):m=R.access(t,"fxshow",{}),a&&(m.hidden=!f),f?p(t).show():d.done((function(){p(t).hide()})),d.done((function(){var e;for(e in R.remove(t,"fxshow"),u)p.style(t,e,u[e])})),u)s=zt(f?m[i]:0,i,d),i in m||(m[i]=s.start,f&&(s.end=s.start,s.start="width"===i||"height"===i?1:0))}],Ft={"*":[function(t,e){var n=this.createTween(t,e),i=n.cur(),o=Bt.exec(e),a=o&&o[3]||(p.cssNumber[t]?"":"px"),s=(p.cssNumber[t]||"px"!==a&&+i)&&Bt.exec(p.css(n.elem,t)),r=1,l=20;if(s&&s[3]!==a){a=a||s[3],o=o||[],s=+i||1;do{s/=r=r||".5",p.style(n.elem,t,s+a)}while(r!==(r=n.cur()/i)&&1!==r&&--l)}return o&&(s=n.start=+s||+i||0,n.unit=a,n.end=o[1]?s+(o[1]+1)*o[2]:+o[2]),n}]};function Ut(){return setTimeout((function(){Rt=void 0})),Rt=p.now()}function Vt(t,e){var n,i=0,o={height:t};for(e=e?1:0;4>i;i+=2-e)o["margin"+(n=F[i])]=o["padding"+n]=t;return e&&(o.opacity=o.width=t),o}function zt(t,e,n){for(var i,o=(Ft[e]||[]).concat(Ft["*"]),a=0,s=o.length;s>a;a++)if(i=o[a].call(n,e,t))return i}function qt(t,e,n){var i,o,a=0,s=Wt.length,r=p.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var e=Rt||Ut(),n=Math.max(0,c.startTime+c.duration-e),i=1-(n/c.duration||0),a=0,s=c.tweens.length;s>a;a++)c.tweens[a].run(i);return r.notifyWith(t,[c,i,n]),1>i&&s?n:(r.resolveWith(t,[c]),!1)},c=r.promise({elem:t,props:p.extend({},e),opts:p.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:Rt||Ut(),duration:n.duration,tweens:[],createTween:function(e,n){var i=p.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)c.tweens[n].run(1);return e?r.resolveWith(t,[c,e]):r.rejectWith(t,[c,e]),this}}),d=c.props;for(function(t,e){var n,i,o,a,s;for(n in t)if(o=e[i=p.camelCase(n)],a=t[n],p.isArray(a)&&(o=a[1],a=t[n]=a[0]),n!==i&&(t[i]=a,delete t[n]),(s=p.cssHooks[i])&&"expand"in s)for(n in a=s.expand(a),delete t[i],a)n in t||(t[n]=a[n],e[n]=o);else e[i]=o}(d,c.opts.specialEasing);s>a;a++)if(i=Wt[a].call(c,t,d,c.opts))return i;return p.map(d,zt,c),p.isFunction(c.opts.start)&&c.opts.start.call(t,c),p.fx.timer(p.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}p.Animation=p.extend(qt,{tweener:function(t,e){p.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,i=0,o=t.length;o>i;i++)n=t[i],Ft[n]=Ft[n]||[],Ft[n].unshift(e)},prefilter:function(t,e){e?Wt.unshift(t):Wt.push(t)}}),p.speed=function(t,e,n){var i=t&&"object"==typeof t?p.extend({},t):{complete:n||!n&&e||p.isFunction(t)&&t,duration:t,easing:n&&e||e&&!p.isFunction(e)&&e};return i.duration=p.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in p.fx.speeds?p.fx.speeds[i.duration]:p.fx.speeds._default,(null==i.queue||!0===i.queue)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){p.isFunction(i.old)&&i.old.call(this),i.queue&&p.dequeue(this,i.queue)},i},p.fn.extend({fadeTo:function(t,e,n,i){return this.filter(U).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var o=p.isEmptyObject(t),a=p.speed(e,n,i),s=function(){var e=qt(this,p.extend({},t),a);(o||R.get(this,"finish"))&&e.stop(!0)};return s.finish=s,o||!1===a.queue?this.each(s):this.queue(a.queue,s)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,o=null!=t&&t+"queueHooks",a=p.timers,s=R.get(this);if(o)s[o]&&s[o].stop&&i(s[o]);else for(o in s)s[o]&&s[o].stop&&Ht.test(o)&&i(s[o]);for(o=a.length;o--;)a[o].elem!==this||null!=t&&a[o].queue!==t||(a[o].anim.stop(n),e=!1,a.splice(o,1));(e||!n)&&p.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=R.get(this),i=n[t+"queue"],o=n[t+"queueHooks"],a=p.timers,s=i?i.length:0;for(n.finish=!0,p.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=a.length;e--;)a[e].elem===this&&a[e].queue===t&&(a[e].anim.stop(!0),a.splice(e,1));for(e=0;s>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish}))}}),p.each(["toggle","show","hide"],(function(t,e){var n=p.fn[e];p.fn[e]=function(t,i,o){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(Vt(e,!0),t,i,o)}})),p.each({slideDown:Vt("show"),slideUp:Vt("hide"),slideToggle:Vt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){p.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}})),p.timers=[],p.fx.tick=function(){var t,e=0,n=p.timers;for(Rt=p.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||p.fx.stop(),Rt=void 0},p.fx.timer=function(t){p.timers.push(t),t()?p.fx.start():p.timers.pop()},p.fx.interval=13,p.fx.start=function(){jt||(jt=setInterval(p.fx.tick,p.fx.interval))},p.fx.stop=function(){clearInterval(jt),jt=null},p.fx.speeds={slow:600,fast:200,_default:400},p.fn.delay=function(t,e){return t=p.fx&&p.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,n){var i=setTimeout(e,t);n.stop=function(){clearTimeout(i)}}))},function(){var t=u.createElement("input"),e=u.createElement("select"),n=e.appendChild(u.createElement("option"));t.type="checkbox",d.checkOn=""!==t.value,d.optSelected=n.selected,e.disabled=!0,d.optDisabled=!n.disabled,(t=u.createElement("input")).value="t",t.type="radio",d.radioValue="t"===t.value}();var Yt,Gt=p.expr.attrHandle;p.fn.extend({attr:function(t,e){return L(this,p.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){p.removeAttr(this,t)}))}}),p.extend({attr:function(t,e,n){var i,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return typeof t.getAttribute===z?p.prop(t,e,n):(1===a&&p.isXMLDoc(t)||(e=e.toLowerCase(),i=p.attrHooks[e]||(p.expr.match.bool.test(e)?Yt:undefined)),void 0===n?i&&"get"in i&&null!==(o=i.get(t,e))?o:null==(o=p.find.attr(t,e))?void 0:o:null!==n?i&&"set"in i&&void 0!==(o=i.set(t,n,e))?o:(t.setAttribute(e,n+""),n):void p.removeAttr(t,e))},removeAttr:function(t,e){var n,i,o=0,a=e&&e.match(A);if(a&&1===t.nodeType)for(;n=a[o++];)i=p.propFix[n]||n,p.expr.match.bool.test(n)&&(t[i]=!1),t.removeAttribute(n)},attrHooks:{type:{set:function(t,e){if(!d.radioValue&&"radio"===e&&p.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}}}),Yt={set:function(t,e,n){return!1===e?p.removeAttr(t,n):t.setAttribute(n,n),n}},p.each(p.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=Gt[e]||p.find.attr;Gt[e]=function(t,e,i){var o,a;return i||(a=Gt[e],Gt[e]=o,o=null!=n(t,e,i)?e.toLowerCase():null,Gt[e]=a),o}}));var Xt=/^(?:input|select|textarea|button)$/i;p.fn.extend({prop:function(t,e){return L(this,p.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[p.propFix[t]||t]}))}}),p.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,n){var i,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return(1!==a||!p.isXMLDoc(t))&&(e=p.propFix[e]||e,o=p.propHooks[e]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:t[e]=n:o&&"get"in o&&null!==(i=o.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||Xt.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),d.optSelected||(p.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),p.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){p.propFix[this.toLowerCase()]=this}));var Jt=/[\t\r\n\f]/g;p.fn.extend({addClass:function(t){var e,n,i,o,a,s,r="string"==typeof t&&t,l=0,c=this.length;if(p.isFunction(t))return this.each((function(e){p(this).addClass(t.call(this,e,this.className))}));if(r)for(e=(t||"").match(A)||[];c>l;l++)if(i=1===(n=this[l]).nodeType&&(n.className?(" "+n.className+" ").replace(Jt," "):" ")){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");s=p.trim(i),n.className!==s&&(n.className=s)}return this},removeClass:function(t){var e,n,i,o,a,s,r=0===arguments.length||"string"==typeof t&&t,l=0,c=this.length;if(p.isFunction(t))return this.each((function(e){p(this).removeClass(t.call(this,e,this.className))}));if(r)for(e=(t||"").match(A)||[];c>l;l++)if(i=1===(n=this[l]).nodeType&&(n.className?(" "+n.className+" ").replace(Jt," "):"")){for(a=0;o=e[a++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");s=t?p.trim(i):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):this.each(p.isFunction(t)?function(n){p(this).toggleClass(t.call(this,n,this.className,e),e)}:function(){if("string"===n)for(var e,i=0,o=p(this),a=t.match(A)||[];e=a[i++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else(n===z||"boolean"===n)&&(this.className&&R.set(this,"__className__",this.className),this.className=this.className||!1===t?"":R.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(Jt," ").indexOf(e)>=0)return!0;return!1}});var Qt=/\r/g;p.fn.extend({val:function(t){var e,n,i,o=this[0];return arguments.length?(i=p.isFunction(t),this.each((function(n){var o;1===this.nodeType&&(null==(o=i?t.call(this,n,p(this).val()):t)?o="":"number"==typeof o?o+="":p.isArray(o)&&(o=p.map(o,(function(t){return null==t?"":t+""}))),(e=p.valHooks[this.type]||p.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))}))):o?(e=p.valHooks[o.type]||p.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(o,"value"))?n:"string"==typeof(n=o.value)?n.replace(Qt,""):null==n?"":n:void 0}}),p.extend({valHooks:{option:{get:function(t){var e=p.find.attr(t,"value");return null!=e?e:p.trim(p.text(t))}},select:{get:function(t){for(var e,n,i=t.options,o=t.selectedIndex,a="select-one"===t.type||0>o,s=a?null:[],r=a?o+1:i.length,l=0>o?r:a?o:0;r>l;l++)if(!(!(n=i[l]).selected&&l!==o||(d.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&p.nodeName(n.parentNode,"optgroup"))){if(e=p(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,i,o=t.options,a=p.makeArray(e),s=o.length;s--;)((i=o[s]).selected=p.inArray(i.value,a)>=0)&&(n=!0);return n||(t.selectedIndex=-1),a}}}}),p.each(["radio","checkbox"],(function(){p.valHooks[this]={set:function(t,e){return p.isArray(e)?t.checked=p.inArray(p(t).val(),e)>=0:void 0}},d.checkOn||(p.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),p.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(t,e){p.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}})),p.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var Kt=p.now(),Zt=/\?/;p.parseJSON=function(t){return JSON.parse(t+"")},p.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&p.error("Invalid XML: "+t),e};var te,ee,ne=/#.*$/,ie=/([?&])_=[^&]*/,oe=/^(.*?):[ \t]*([^\r\n]*)$/gm,ae=/^(?:GET|HEAD)$/,se=/^\/\//,re=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,le={},ce={},de="*/".concat("*");try{ee=location.href}catch(t){(ee=u.createElement("a")).href="",ee=ee.href}function ue(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,o=0,a=e.toLowerCase().match(A)||[];if(p.isFunction(n))for(;i=a[o++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function he(t,e,n,i){var o={},a=t===ce;function s(r){var l;return o[r]=!0,p.each(t[r]||[],(function(t,r){var c=r(e,n,i);return"string"!=typeof c||a||o[c]?a?!(l=c):void 0:(e.dataTypes.unshift(c),s(c),!1)})),l}return s(e.dataTypes[0])||!o["*"]&&s("*")}function pe(t,e){var n,i,o=p.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((o[n]?t:i||(i={}))[n]=e[n]);return i&&p.extend(!0,t,i),t}te=re.exec(ee.toLowerCase())||[],p.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ee,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(te[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":de,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":p.parseJSON,"text xml":p.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?pe(pe(t,p.ajaxSettings),e):pe(p.ajaxSettings,t)},ajaxPrefilter:ue(le),ajaxTransport:ue(ce),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,i,o,a,s,r,l,c,d=p.ajaxSetup({},e),u=d.context||d,h=d.context&&(u.nodeType||u.jquery)?p(u):p.event,f=p.Deferred(),m=p.Callbacks("once memory"),g=d.statusCode||{},v={},b={},y=0,w="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===y){if(!a)for(a={};e=oe.exec(o);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===y?o:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return y||(t=b[n]=b[n]||t,v[t]=e),this},overrideMimeType:function(t){return y||(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>y)for(e in t)g[e]=[g[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||w;return n&&n.abort(e),_(0,e),this}};if(f.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,d.url=((t||d.url||ee)+"").replace(ne,"").replace(se,te[1]+"//"),d.type=e.method||e.type||d.method||d.type,d.dataTypes=p.trim(d.dataType||"*").toLowerCase().match(A)||[""],null==d.crossDomain&&(r=re.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]===te[1]&&r[2]===te[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(te[3]||("http:"===te[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=p.param(d.data,d.traditional)),he(le,d,e,x),2===y)return x;for(c in(l=d.global)&&0==p.active++&&p.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!ae.test(d.type),i=d.url,d.hasContent||(d.data&&(i=d.url+=(Zt.test(i)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=ie.test(i)?i.replace(ie,"$1_="+Kt++):i+(Zt.test(i)?"&":"?")+"_="+Kt++)),d.ifModified&&(p.lastModified[i]&&x.setRequestHeader("If-Modified-Since",p.lastModified[i]),p.etag[i]&&x.setRequestHeader("If-None-Match",p.etag[i])),(d.data&&d.hasContent&&!1!==d.contentType||e.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+de+"; q=0.01":""):d.accepts["*"]),d.headers)x.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(!1===d.beforeSend.call(u,x,d)||2===y))return x.abort();for(c in w="abort",{success:1,error:1,complete:1})x[c](d[c]);if(n=he(ce,d,e,x)){x.readyState=1,l&&h.trigger("ajaxSend",[x,d]),d.async&&d.timeout>0&&(s=setTimeout((function(){x.abort("timeout")}),d.timeout));try{y=1,n.send(v,_)}catch(t){if(!(2>y))throw t;_(-1,t)}}else _(-1,"No Transport");function _(t,e,a,r){var c,v,b,w,_,k=e;2!==y&&(y=2,s&&clearTimeout(s),n=void 0,o=r||"",x.readyState=t>0?4:0,c=t>=200&&300>t||304===t,a&&(w=function(t,e,n){for(var i,o,a,s,r=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(o in r)if(r[o]&&r[o].test(i)){l.unshift(o);break}if(l[0]in n)a=l[0];else{for(o in n){if(!l[0]||t.converters[o+" "+l[0]]){a=o;break}s||(s=o)}a=a||s}return a?(a!==l[0]&&l.unshift(a),n[a]):void 0}(d,x,a)),w=function(t,e,n,i){var o,a,s,r,l,c={},d=t.dataTypes.slice();if(d[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(a=d.shift();a;)if(t.responseFields[a]&&(n[t.responseFields[a]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=a,a=d.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(s=c[l+" "+a]||c["* "+a]))for(o in c)if((r=o.split(" "))[1]===a&&(s=c[l+" "+r[0]]||c["* "+r[0]])){!0===s?s=c[o]:!0!==c[o]&&(a=r[0],d.unshift(r[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(t){return{state:"parsererror",error:s?t:"No conversion from "+l+" to "+a}}}return{state:"success",data:e}}(d,w,x,c),c?(d.ifModified&&((_=x.getResponseHeader("Last-Modified"))&&(p.lastModified[i]=_),(_=x.getResponseHeader("etag"))&&(p.etag[i]=_)),204===t||"HEAD"===d.type?k="nocontent":304===t?k="notmodified":(k=w.state,v=w.data,c=!(b=w.error))):(b=k,(t||!k)&&(k="error",0>t&&(t=0))),x.status=t,x.statusText=(e||k)+"",c?f.resolveWith(u,[v,k,x]):f.rejectWith(u,[x,k,b]),x.statusCode(g),g=void 0,l&&h.trigger(c?"ajaxSuccess":"ajaxError",[x,d,c?v:b]),m.fireWith(u,[x,k]),l&&(h.trigger("ajaxComplete",[x,d]),--p.active||p.event.trigger("ajaxStop")))}return x},getJSON:function(t,e,n){return p.get(t,e,n,"json")},getScript:function(t,e){return p.get(t,void 0,e,"script")}}),p.each(["get","post"],(function(t,e){p[e]=function(t,n,i,o){return p.isFunction(n)&&(o=o||i,i=n,n=void 0),p.ajax({url:t,type:e,dataType:o,data:n,success:i})}})),p.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){p.fn[e]=function(t){return this.on(e,t)}})),p._evalUrl=function(t){return p.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},p.fn.extend({wrapAll:function(t){var e;return p.isFunction(t)?this.each((function(e){p(this).wrapAll(t.call(this,e))})):(this[0]&&(e=p(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this)},wrapInner:function(t){return this.each(p.isFunction(t)?function(e){p(this).wrapInner(t.call(this,e))}:function(){var e=p(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=p.isFunction(t);return this.each((function(n){p(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(){return this.parent().each((function(){p.nodeName(this,"body")||p(this).replaceWith(this.childNodes)})).end()}}),p.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},p.expr.filters.visible=function(t){return!p.expr.filters.hidden(t)};var fe=/%20/g,me=/\[\]$/,ge=/\r?\n/g,ve=/^(?:submit|button|image|reset|file)$/i,be=/^(?:input|select|textarea|keygen)/i;function ye(t,e,n,i){var o;if(p.isArray(e))p.each(e,(function(e,o){n||me.test(t)?i(t,o):ye(t+"["+("object"==typeof o?e:"")+"]",o,n,i)}));else if(n||"object"!==p.type(e))i(t,e);else for(o in e)ye(t+"["+o+"]",e[o],n,i)}p.param=function(t,e){var n,i=[],o=function(t,e){e=p.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=p.ajaxSettings&&p.ajaxSettings.traditional),p.isArray(t)||t.jquery&&!p.isPlainObject(t))p.each(t,(function(){o(this.name,this.value)}));else for(n in t)ye(n,t[n],e,o);return i.join("&").replace(fe,"+")},p.fn.extend({serialize:function(){return p.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=p.prop(this,"elements");return t?p.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!p(this).is(":disabled")&&be.test(this.nodeName)&&!ve.test(t)&&(this.checked||!V.test(t))})).map((function(t,e){var n=p(this).val();return null==n?null:p.isArray(n)?p.map(n,(function(t){return{name:e.name,value:t.replace(ge,"\r\n")}})):{name:e.name,value:n.replace(ge,"\r\n")}})).get()}}),p.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var we=0,xe={},_e={0:200,1223:204},ke=p.ajaxSettings.xhr();t.ActiveXObject&&p(t).on("unload",(function(){for(var t in xe)xe[t]()})),d.cors=!!ke&&"withCredentials"in ke,d.ajax=ke=!!ke,p.ajaxTransport((function(t){var e;return d.cors||ke&&!t.crossDomain?{send:function(n,i){var o,a=t.xhr(),s=++we;if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)a[o]=t.xhrFields[o];for(o in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)a.setRequestHeader(o,n[o]);e=function(t){return function(){e&&(delete xe[s],e=a.onload=a.onerror=null,"abort"===t?a.abort():"error"===t?i(a.status,a.statusText):i(_e[a.status]||a.status,a.statusText,"string"==typeof a.responseText?{text:a.responseText}:void 0,a.getAllResponseHeaders()))}},a.onload=e(),a.onerror=e("error"),e=xe[s]=e("abort");try{a.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}:void 0})),p.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return p.globalEval(t),t}}}),p.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),p.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain)return{send:function(i,o){e=p("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),u.head.appendChild(e[0])},abort:function(){n&&n()}}}));var Se=[],Te=/(=)\?(?=&|$)|\?\?/;p.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Se.pop()||p.expando+"_"+Kt++;return this[t]=!0,t}}),p.ajaxPrefilter("json jsonp",(function(e,n,i){var o,a,s,r=!1!==e.jsonp&&(Te.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Te.test(e.data)&&"data");return r||"jsonp"===e.dataTypes[0]?(o=e.jsonpCallback=p.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,r?e[r]=e[r].replace(Te,"$1"+o):!1!==e.jsonp&&(e.url+=(Zt.test(e.url)?"&":"?")+e.jsonp+"="+o),e.converters["script json"]=function(){return s||p.error(o+" was not called"),s[0]},e.dataTypes[0]="json",a=t[o],t[o]=function(){s=arguments},i.always((function(){t[o]=a,e[o]&&(e.jsonpCallback=n.jsonpCallback,Se.push(o)),s&&p.isFunction(a)&&a(s[0]),s=a=void 0})),"script"):void 0})),p.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||u;var i=x.exec(t),o=!n&&[];return i?[e.createElement(i[1])]:(i=p.buildFragment([t],e,o),o&&o.length&&p(o).remove(),p.merge([],i.childNodes))};var Ce=p.fn.load;p.fn.load=function(t,e,n){if("string"!=typeof t&&Ce)return Ce.apply(this,arguments);var i,o,a,s=this,r=t.indexOf(" ");return r>=0&&(i=p.trim(t.slice(r)),t=t.slice(0,r)),p.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(o="POST"),s.length>0&&p.ajax({url:t,type:o,dataType:"html",data:e}).done((function(t){a=arguments,s.html(i?p("<div>").append(p.parseHTML(t)).find(i):t)})).complete(n&&function(t,e){s.each(n,a||[t.responseText,e,t])}),this},p.expr.filters.animated=function(t){return p.grep(p.timers,(function(e){return t===e.elem})).length};var Me=t.document.documentElement;function De(t){return p.isWindow(t)?t:9===t.nodeType&&t.defaultView}p.offset={setOffset:function(t,e,n){var i,o,a,s,r,l,c=p.css(t,"position"),d=p(t),u={};"static"===c&&(t.style.position="relative"),r=d.offset(),a=p.css(t,"top"),l=p.css(t,"left"),("absolute"===c||"fixed"===c)&&(a+l).indexOf("auto")>-1?(s=(i=d.position()).top,o=i.left):(s=parseFloat(a)||0,o=parseFloat(l)||0),p.isFunction(e)&&(e=e.call(t,n,r)),null!=e.top&&(u.top=e.top-r.top+s),null!=e.left&&(u.left=e.left-r.left+o),"using"in e?e.using.call(t,u):d.css(u)}},p.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){p.offset.setOffset(this,t,e)}));var e,n,i=this[0],o={top:0,left:0},a=i&&i.ownerDocument;return a?(e=a.documentElement,p.contains(e,i)?(typeof i.getBoundingClientRect!==z&&(o=i.getBoundingClientRect()),n=De(a),{top:o.top+n.pageYOffset-e.clientTop,left:o.left+n.pageXOffset-e.clientLeft}):o):void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===p.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),p.nodeName(t[0],"html")||(i=t.offset()),i.top+=p.css(t[0],"borderTopWidth",!0),i.left+=p.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-p.css(n,"marginTop",!0),left:e.left-i.left-p.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent||Me;t&&!p.nodeName(t,"html")&&"static"===p.css(t,"position");)t=t.offsetParent;return t||Me}))}}),p.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(e,n){var i="pageYOffset"===n;p.fn[e]=function(o){return L(this,(function(e,o,a){var s=De(e);return void 0===a?s?s[n]:e[o]:void(s?s.scrollTo(i?t.pageXOffset:a,i?a:t.pageYOffset):e[o]=a)}),e,o,arguments.length,null)}})),p.each(["top","left"],(function(t,e){p.cssHooks[e]=kt(d.pixelPosition,(function(t,n){return n?(n=_t(t,e),wt.test(n)?p(t).position()[e]+"px":n):void 0}))})),p.each({Height:"height",Width:"width"},(function(t,e){p.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,i){p.fn[i]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return L(this,(function(e,n,i){var o;return p.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===i?p.css(e,n,s):p.style(e,n,i,s)}),e,a?i:void 0,a,null)}}))})),p.fn.size=function(){return this.length},p.fn.andSelf=p.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],(function(){return p}));var Oe=t.jQuery,Ee=t.$;return p.noConflict=function(e){return t.$===p&&(t.$=Ee),e&&t.jQuery===p&&(t.jQuery=Oe),p},typeof e===z&&(t.jQuery=t.$=p),p}));var curr183,currToken,currIp,currPrefix,currAuth,currPass,currAuthUser,currAuthPass,currLocal,currLang,language,deviceip,errorTimeout,weather,openPanel,DEFAULT_WEATHER_SERVER_URL="https://weather.opensprinkler.com",WEATHER_SERVER_URL=DEFAULT_WEATHER_SERVER_URL,isIEMobile=/IEMobile/.test(navigator.userAgent),isAndroid=/Android|\bSilk\b/.test(navigator.userAgent),isiOS=/iP(ad|hone|od)/.test(navigator.userAgent),isFireFox=/Firefox/.test(navigator.userAgent),isWinApp=/MSAppHost/.test(navigator.userAgent),isOSXApp=window.cordova&&"osx"===window.cordova.platformId,isChromeApp="object"==typeof chrome&&"object"==typeof chrome.storage,isFileCapable=!isiOS&&!isAndroid&&!isIEMobile&&!isOSXApp&&!isWinApp&&window.FileReader,isTouchCapable="ontouchstart"in window||"onmsgesturechange"in window,isMetric=-1===["US","BM","PW"].indexOf(navigator.languages[0].split("-")[1]),groupView=!1,storage={get:function(t,e){if(e=e||function(){},isChromeApp)chrome.storage.local.get(t,e);else{var n,i={};for(n in"string"==typeof t&&(t=[t]),t)t.hasOwnProperty(n)&&(i[t[n]]=localStorage.getItem(t[n]));e(i)}},set:function(t,e){if(e=e||function(){},isChromeApp)chrome.storage.local.set(t,e);else{var n;if("object"==typeof t)for(n in t)t.hasOwnProperty(n)&&localStorage.setItem(n,t[n]);e(!0)}},remove:function(t,e){if(e=e||function(){},isChromeApp)chrome.storage.local.remove(t,e);else{var n;for(n in"string"==typeof t&&(t=[t]),t)t.hasOwnProperty(n)&&localStorage.removeItem(t[n]);e(!0)}}},regex={gps:/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/},statusBarPrimary=isAndroid?"#121212":"#1D1D1D",statusBarOverlay=isAndroid?"#151515":"#202020",retryCount=2,controller={},switching=!1,currentCoordinates=[0,0],pageHistoryCount=-1,goingBack=!1,keyIndex={tz:1,ntp:2,dhcp:3,ip1:4,ip2:5,ip3:6,ip4:7,gw1:8,gw2:9,gw3:10,gw4:11,hp0:12,hp1:13,ar:14,ext:15,seq:16,sdt:17,mas:18,mton:19,mtof:20,urs:21,rso:22,wl:23,den:24,ipas:25,devid:26,con:27,lit:28,dim:29,bst:30,uwt:31,ntp1:32,ntp2:33,ntp3:34,ntp4:35,lg:36,mas2:37,mton2:38,mtof2:39,fpr0:41,fpr1:42,re:43,dns1:44,dns2:45,dns3:46,dns4:47,sar:48,ife:49,sn1t:50,sn1o:51,sn2t:52,sn2o:53,sn1on:54,sn1of:55,sn2on:56,sn2of:57,subn1:58,subn2:59,subn3:60,subn4:61},dialog={REMOVE_STATION:1},popupData={shift:void 0},MANUAL_STATION_PID=99,MASTER_STATION_1=1,MASTER_STATION_2=2,IGNORE_SENSOR_1=1,IGNORE_SENSOR_2=2,NUM_SEQ_GROUPS=4,PARALLEL_GROUP_NAME="P",PARALLEL_GID_VALUE=255,MASTER_GROUP_NAME="M",MASTER_GID_VALUE=254,notifications=[],timers={};if(isWinApp&&$(window).on("error",(function(t,e,n){return window.console.log(t,e,n),!0})),window.MSApp){if(window.Windows&&Windows.UI&&Windows.UI.ApplicationSettings&&Windows.UI.ApplicationSettings.SettingsPane){var settingsPane=Windows.UI.ApplicationSettings.SettingsPane.getForCurrentView();settingsPane.addEventListener("commandsrequested",(function(t){var e=t.request.applicationCommands,n=new Windows.UI.ApplicationSettings.SettingsCommand("privacy","Privacy Policy",(function(){window.open("https://albahra.com/journal/privacy-policy")}));e.append(n)}))}MSApp.execUnsafeLocalFunction&&($.fn.oldDomManIp=$.fn.domManip,$.fn.domManip=function(t,e,n){var i=this;return MSApp.execUnsafeLocalFunction((function(){return i.oldDomManIp(t,e,n)}))})}function initApp(){updateLang(),currLocal||$.ajaxSetup({timeout:1e4}),isIEMobile&&insertStyle(".ui-toolbar-back-btn{display:none!important}ul{list-style:none!important;}"),isChromeApp&&insertStyle("html,body{overflow-y:scroll}"),isAndroid?(insertStyle(".ui-toolbar-back-btn{display:none!important}"),$(this).ajaxStart((function(){try{navigator.app.clearCache()}catch(t){}}))):isFireFox?$.ajaxSetup({xhr:function(){return new window.XMLHttpRequest({mozSystem:!0})}}):$.ajaxSetup({cache:!1}),$.mobile.defaultPageTransition=isAndroid||isIEMobile?"fade":"slide",$.mobile.hoverDelay=0,$.mobile.activeBtnClass="activeButton",$.mobile.document.on("click",".iab",(function(){var t=isOSXApp?"_system":"_blank",e=$(this),n=window.open(this.href,t,"location="+(isAndroid?"yes":"no")+",enableViewportScale="+(e.hasClass("iabNoScale")?"no":"yes")+",toolbar=yes,toolbarposition=top,toolbarcolor="+statusBarPrimary+",closebuttoncaption="+(e.hasClass("iabNoScale")?_("Back"):_("Done")));return isIEMobile&&($.mobile.document.data("iabOpen",!0),n.addEventListener("exit",(function(){$.mobile.document.removeData("iabOpen")}))),setTimeout((function(){e.removeClass("ui-btn-active")}),100),!1})),$.mobile.document.on("click",".ui-select .ui-btn",(function(){var t=$(this),e=t.attr("id").replace("-button","-listbox"),n=$("#"+e);return n.popup("destroy").detach().addClass("ui-page-theme-a"),$.mobile.pageContainer.append(n),n.popup({history:!1,positionTo:t,overlayTheme:"b"}).popup("open"),t.off("click").on("click",(function(){n.popup("open")})),!1})),$.mobile.document.on("swiperight swipeleft",".ui-page",(function(t){var e=$(".ui-page-active");"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName||"open"===e.jqmData("panel")||e.find(".ui-popup-active").length||("swiperight"===t.type?openPanel():showNotifications())})),$.widget("mobile.collapsible",$.mobile.collapsible,{_handleExpandCollapse:function(t){this._trigger("before"+(t?"collapse":"expand"))&&this._superApply(arguments)}}),$("#site-selector").on("change",(function(){updateSite($(this).val())})),$("#footer-menu").on("click",(function(){showHomeMenu(this)})),$("#header,#footer").toolbar(),FastClick.attach(document.body),updateTimers(),$.mobile.document.on("keydown",(function(t){var e=$(t.target).prop("tagName");if("INPUT"!==e&&"TEXTAREA"!==e){var n=t.keyCode,i=t.altKey,o=$("#mainMenu-popup").hasClass("ui-popup-active");if(77===n)$("#mainMenu").length>0?$("#mainMenu").popup("close"):showHomeMenu();else(o||i)&&80===n?(t.preventDefault(),changePage("#programs")):(o||i)&&79===n?(t.preventDefault(),changePage("#os-options")):(o||i)&&86===n?(t.preventDefault(),changePage("#preview")):(o||i)&&76===n?(t.preventDefault(),changePage("#logs")):(o||i)&&82===n?(t.preventDefault(),changePage("#runonce")):(o||i)&&85===n?(t.preventDefault(),showPause()):(o||i)&&68===n&&(t.preventDefault(),showRainDelay())}})),bindPanel(),currLocal||void 0!==window.cordova||updateDeviceIP(),cloudSync(),setTimeout((function(){checkConfigured(!0)}),200)}function flipSwitched(){if(!switching){var t,e=$(this),n=e.attr("id"),i=e.is(":checked"),o="mmm"===n?"mm":n;t=sendToOS(i?"/cv?pw=&"+o+"=1":"/cv?pw=&"+o+"=0"),$.when(t).then((function(){refreshStatus(),"mmm"===n&&$("#mm_list .green").removeClass("green"),checkStatus()}),(function(){switching=!0,setTimeout((function(){switching=!1}),200),e.prop("checked",!i).flipswitch("refresh")}))}}function sendToOS(t,e){t=t.replace("pw=","pw="+encodeURIComponent(currPass)),e=e||"text";var n=/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|up|cm)/.exec(t),i=n?"change":"default",o=n&&checkOSVersion(300),a=o?t.split("?")[0]:t,s={url:currToken?"https://cloud.openthings.io/forward/v1/"+currToken+a:currPrefix+currIp+a,type:o?"POST":"GET",data:o?getUrlVars(t):null,dataType:e,shouldRetry:function(t,e){return!(0===t.status&&"abort"===t.statusText||retryCount<e)||($.ajaxq.abort(i),!1)}};return currAuth&&$.extend(s,{beforeSend:function(t){t.setRequestHeader("Authorization","Basic "+btoa(currAuthUser+":"+currAuthPass))}}),curr183&&$.extend(s,{cache:"true"}),$.ajaxq(i,s).then((function(e){if("string"==typeof e)try{e=$.parseJSON(e)}catch(t){return e}return"object"!=typeof e||"number"!=typeof e.result||1===e.result?e:2===e.result?(/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|up|cm)/.exec(t)&&showerror(_("Check device password and try again.")),$.Deferred().reject({status:401})):32===e.result?$.Deferred().reject({status:404}):/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|up|cm)/.exec(t)?(48===e.result?showerror(_("The selected station is already running or is scheduled to run.")):showerror(_("Please check input and try again.")),$.Deferred().reject(e)):void 0}),(function(e){"timeout"!==e.statusText&&0!==e.status||!/\/(?:cv|cs|cr|cp|uwa|dp|co|cl|cu|cm)/.exec(t)?401===e.status&&showerror(_("Check device password and try again.")):showerror(_("Connection timed-out. Please try again."))}))}function networkFail(){changeStatus(0,"red","<p class='running-text center'>"+_("Network Error")+"</p>",(function(){showLoading("#weather,#footer-running"),refreshStatus(),updateWeather()}))}function newLoad(){var t=$("#site-selector").val(),e="<div class='logo'></div><h1 style='padding-top:5px'>"+_("Connecting to")+" "+t+"</h1><p class='cancel tight center inline-icon'><span class='btn-no-border ui-btn ui-icon-delete ui-btn-icon-notext'></span>Cancel</p>";$.mobile.loading("show",{html:currLocal?"<h1>"+_("Loading")+"</h1>":e,textVisible:!0,theme:"b"}),$(".ui-loader").css({"box-shadow":"none","margin-top":"-4em"}).find(".cancel").one("click",(function(){$.ajaxq.abort("default"),changePage("#site-control",{transition:"none"})})),controller={},clearNotifications(),timers={},$.ajaxq.abort("default"),updateController((function(){var e=$(".weatherAdjust"),n=$(".changePassword");$.mobile.loading("hide"),checkURLandUpdateWeather(),checkOSVersion(210)?e.css("display",""):e.hide(),checkOSVersion(230)&&(updateAnalogSensor(),updateProgramAdjustments()),isOSPi()||checkOSVersion(208)?n.css("display",""):n.hide(),currLocal?$("#info-list").find("li[data-role='list-divider']").text(_("Information")):($("#info-list").find("li[data-role='list-divider']").text(t),document.title="OpenSprinkler - "+t),checkFirmwareUpdate(),detectUnusedExpansionBoards(),checkOSVersion(213)&&255!==controller.options.hwv&&fixPasswordHash(t),currLocal||"number"!=typeof controller.settings.eip||checkPublicAccess(controller.settings.eip),updateLoginButtons(),isOSPi()&&showUnifiedFirmwareNotification(),controller.options.firstRun?showGuidedSetup():goHome(!0)}),(function(e){$.ajaxq.abort("default"),controller={},$.mobile.loading("hide");var n=function(){currLocal?storage.remove(["sites"],(function(){window.location.reload()})):"site-control"===$(".ui-page-active").attr("id")?i():($.mobile.document.one("pageshow",i),changePage("#site-control",{transition:"none"}))},i=function(){showerror(_("Unable to connect to")+" "+t,3500)};"object"==typeof e&&401===e.status?($(".ui-popup-active").find("[data-role='popup']").popup("close"),changePassword({fixIncorrect:!0,name:t,callback:newLoad,cancel:n})):n()}))}function updateController(t,e){t=t||function(){},e=e||function(){};var n=function(){$("html").trigger("datarefresh"),checkStatus(),t()};isControllerConnected()&&checkOSVersion(216)?updateControllerData(n,e):$.when(updateControllerPrograms(),updateControllerStations(),updateControllerOptions(),updateControllerStatus(),updateControllerSettings()).then(n,e)}function updateControllerData(t,e){sendToOS("/ja?pw=","json").then((function(n){if(void 0===n||$.isEmptyObject(n))e();else{var i=controller.special;(controller=n).special=i,controller.status=controller.status.sn,t()}}))}function updateControllerPrograms(t){return t=t||function(){},!0===curr183?sendToOS("/gp?d=0").done((function(e){for(var n,i,o=e.match(/(nprogs|nboards|mnp)=[\w|\d|.\"]+/g),a=/pd=\[\];(.*);/.exec(e),s={},r=0;r<o.length;r++)""!==o[r]&&(s[(n=o[r].split("="))[0]]=parseInt(n[1]));if(s.pd=[],null!==a)for(a=a[1].split(";"),r=0;r<a.length;r++)i=(i=(i=a[r].split("="))[1].replace("[","")).replace("]",""),s.pd[r]=parseIntArray(i.split(","));controller.programs=s,t()})):sendToOS("/jp?pw=","json").done((function(e){controller.programs=e,t()}))}function updateControllerStations(t){return t=t||function(){},!0===curr183?sendToOS("/vs").done((function(e){var n=/snames=\[(.*?)\];/.exec(e),i=e.match(/(?:masop|mo)\s?[=|:]\s?\[(.*?)\]/);(n=n[1].split(",")).pop();for(var o=0;o<n.length;o++)n[o]=n[o].replace(/'/g,"");i=parseIntArray(i[1].split(",")),controller.stations={snames:n,masop:i,maxlen:n.length},t()})):sendToOS("/jn?pw=","json").done((function(e){controller.stations=e,t()}))}function updateControllerOptions(t){return t=t||function(){},!0===curr183?sendToOS("/vo").done((function(e){var n,i,o,a={};if(e.match(/var sd\s*=/)){for(var s=/(tz|htp|htp2|nbrd|seq|sdt|mas|mton|mtoff|urs|rst|wl|ipas)\s?[=|:]\s?([\w|\d|.\"]+)/gm;null!==(n=s.exec(e));)a[n[1].replace("nbrd","ext").replace("mtoff","mtof")]=+n[2];a.ext--,a.fwv="1.8.3-ospi"}else{var r=[1,2,12,13,14,15,16,17,18,19,20,21,22,23,25,26];for(n=(n=/var opts=\[(.*)\];/.exec(e))[1].replace(/"/g,"").split(","),i=0;i<n.length-1;i+=4)o=+n[i+3],-1!==$.inArray(o,r)&&(a[keyIndex[o]]=+n[i+2]);a.fwv=183}controller.options=a,t()})):sendToOS("/jo?pw=","json").done((function(e){controller.options=e,t()}))}function updateControllerStatus(t){return t=t||function(){},!0===curr183?sendToOS("/sn0").then((function(e){var n=e.toString().match(/\d+/);n=parseIntArray(n[0].split("")),controller.status=n,t()}),(function(){controller.status=[]})):sendToOS("/js?pw=","json").then((function(e){controller.status=e.sn,t()}),(function(){controller.status=[]}))}function updateControllerSettings(t){return t=t||function(){},!0===curr183?sendToOS("").then((function(t){var e,n,i=/(ver|devt|nbrd|tz|en|rd|rs|mm|rdst|urs)\s?[=|:]\s?([\w|\d|.\"]+)/gm,o=t.match(/loc\s?[=|:]\s?[\"|'](.*)[\"|']/),a=t.match(/lrun=\[(.*)\]/),s=t.match(/ps=\[(.*)\];/),r={};for(n=(s=s[1].split("],[")).length-1;n>=0;n--)s[n]=parseIntArray(s[n].replace(/\[|\]/g,"").split(","));for(;null!==(e=i.exec(t));)r[e[1]]=+e[2];r.loc=o[1],r.ps=s,r.lrun=parseIntArray(a[1].split(",")),controller.settings=r}),(function(){if(controller.settings&&controller.stations){var t,e=[];for(t=0;t<controller.stations.maxlen;t++)e.push([0,0]);controller.settings.ps=e}})):sendToOS("/jc?pw=").then((function(e){if("object"!=typeof e)try{e=JSON.parse(e)}catch(t){var n=/,"wto":\{.*?\}/,i=e.match(n);e=e.replace(n,"");try{e=JSON.parse(e),handleCorruptedWeatherOptions(i)}catch(t){return!1}}if(void 0===e.lrun&&(e.lrun=[0,0,0,0]),e.loc.match(regex.gps)){var o=e.loc.split(",");currentCoordinates=[parseFloat(o[0]),parseFloat(o[1])]}controller.settings=e,t()}),(function(){if(controller.settings&&controller.stations){var t,e=[];for(t=0;t<controller.stations.maxlen;t++)e.push([0,0]);controller.settings.ps=e}}))}function updateControllerStationSpecial(t){return t=t||function(){},sendToOS("/je?pw=","json").then((function(e){controller.special=e,t()}),(function(){controller.special={}}))}function checkConfigured(t){storage.get(["sites","current_site","cloudToken"],(function(e){var n,i=e.sites,o=e.current_site;if(i=parseSites(i),(n=Object.keys(i)).length){if(null===o||!(o in i))return $.mobile.loading("hide"),void changePage("#site-control",{transition:t?"none":void 0});updateSiteList(n,o),currToken=i[o].os_token,currIp=i[o].os_ip,currPass=i[o].os_pw,currPrefix=void 0!==i[o].ssl&&"1"===i[o].ssl?"https://":"http://",void 0!==i[o].auth_user&&void 0!==i[o].auth_pw?(currAuth=!0,currAuthUser=i[o].auth_user,currAuthPass=i[o].auth_pw):currAuth=!1,curr183=!!i[o].is183,newLoad()}else t&&(void 0===e.cloudToken||null===e.cloudToken?changePage("#start",{transition:"none"}):changePage("#site-control",{transition:"none"}))}))}function fixPasswordHash(t){storage.get(["sites"],(function(e){var n=parseSites(e.sites);if(!isMD5(currPass)){var i=md5(currPass);sendToOS("/sp?pw=&npw="+encodeURIComponent(i)+"&cpw="+encodeURIComponent(i),"json").done((function(e){var o=e.result;if(!o||o>1)return!1;n[t].os_pw=currPass=i,storage.set({sites:JSON.stringify(n)},cloudSaveSites)}))}}))}function submitNewUser(t,e){document.activeElement.blur(),$.mobile.loading("show");var n,i=$(".connection-type input[type='radio']:checked").val(),o=$.mobile.path.parseUrl($("#os_ip").val()).hrefNoHash.replace(/https?:\/\//,""),a="token"===i?$("#os_token").val():null,s=function(n,i){var s;if($.mobile.loading("hide"),("string"==typeof n&&n.match(/var (en|sd)\s*=/)||"number"==typeof n.fwv&&203===n.fwv)&&(s=!0),void 0!==n.fwv||!0===s){var r=$("#os_name").val(),l=$("#os_pw").val(),c=$("#save_pw").is(":checked");""===r&&(r="Site "+(Object.keys(i).length+1)),i[r]={},i[r].os_token=currToken=a,i[r].os_ip=currIp=o,"number"==typeof n.fwv&&n.fwv>=213&&"number"==typeof n.wl&&(l=md5(l)),i[r].os_pw=c?l:"",currPass=l,t?(i[r].ssl="1",currPrefix="https://"):currPrefix="http://",e?(i[r].auth_user=$("#os_auth_user").val(),i[r].auth_pw=$("#os_auth_pw").val(),currAuth=!0,currAuthUser=i[r].auth_user,currAuthPass=i[r].auth_pw):currAuth=!1,!0===s&&(i[r].is183="1",curr183=!0),$("#os_name,#os_ip,#os_pw,#os_auth_user,#os_auth_pw,#os_token").val(""),storage.set({sites:JSON.stringify(i),current_site:r},(function(){cloudSaveSites(),updateSiteList(Object.keys(i),r),newLoad()}))}else showerror(_("Check IP/Port and try again."))},r=function(n){e||401!==n.status?t?($.mobile.loading("hide"),showerror(_("Check IP/Port and try again."))):submitNewUser(!0):l()},l=function(){$("#addnew-auth").length?submitNewUser(t,!0):d()},c=function(){return btoa($("#os_auth_user").val()+":"+$("#os_auth_pw").val())},d=function(){$.mobile.loading("hide");var e=$("<div class='ui-content' id='addnew-auth'><form method='post' novalidate><p class='center smaller'>"+_("Authorization Required")+"</p><label for='os_auth_user'>"+_("Username:")+"</label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' name='os_auth_user' id='os_auth_user'><label for='os_auth_pw'>"+_("Password:")+"</label><input type='password' name='os_auth_pw' id='os_auth_pw'><input type='submit' value='"+_("Submit")+"'></form></div>").enhanceWithin();e.on("submit","form",(function(){return submitNewUser(t,!0),!1})),$("#addnew-content").hide(),$("#addnew").append(e).popup("reposition",{positionTo:"window"})};if(o||a)if(a&&32!==a.length)showerror(_("OpenThings Token must be 32 characters long."));else if(!0!==e&&$("#os_useauth").is(":checked"))l();else{!0===$("#os_usessl").is(":checked")&&(t=!0),n=t?"https://":"http://",e&&($("#addnew-auth").hide(),$("#addnew-content").show(),$("#addnew").popup("reposition",{positionTo:"window"}));var u="/jo?pw="+md5($("#os_pw").val()),h=a?"https://cloud.openthings.io/forward/v1/"+a+u:n+o+u;$.ajax({url:h,type:"GET",dataType:"json",timeout:1e4,global:!1,beforeSend:function(t){!a&&e&&t.setRequestHeader("Authorization","Basic "+c())},error:function(t){e||401!==t.status?$.ajax({url:a?"https://cloud.openthings.io/forward/v1/"+a:n+o,type:"GET",dataType:"text",timeout:1e4,global:!1,cache:!0,beforeSend:function(t){!a&&e&&t.setRequestHeader("Authorization","Basic "+c())},success:function(t){storage.get("sites",(function(e){var n=parseSites(e.sites);s(t,n)}))},error:r}):l()},success:function(t){storage.get("sites",(function(e){var n=parseSites(e.sites);s(t,n)}))}})}else showerror(_("An IP address or token is required to continue."))}function parseSites(t){return null==t?{}:JSON.parse(t)}function showSiteSelect(t){$("#site-select").popup("destroy").remove();var e=$("<div data-role='popup' id='site-select' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+_("Select Site")+"</h1></div><div class='ui-content'><ul data-role='none' class='ui-listview ui-corner-all ui-shadow'></ul></div></div>");t&&e.find("ul").html(t),e.one("popupafterclose",(function(){$(this).popup("destroy").remove()})).popup({history:!1,positionTo:"window"}).enhanceWithin().popup("open")}function showAddNew(t,e){$("#addnew").popup("destroy").remove();var n=!!t,i=$("<div data-role='popup' id='addnew' data-theme='a' data-overlay-theme='b'><div data-role='header' data-theme='b'><h1>"+_("New Device")+"</h1></div><div class='ui-content' id='addnew-content'><form method='post' novalidate>"+(n?"":"<p class='center smaller'>"+_("Note: The name is used to identify the OpenSprinkler within the app. OpenSprinkler IP can be either an IP or hostname. You can also specify a port by using IP:Port")+"</p>")+"<label for='os_name'>"+_("Open Sprinkler Name:")+"</label><input autocorrect='off' spellcheck='false' type='text' name='os_name' id='os_name' placeholder='Home'>"+(n?"":"<div class='ui-field-contain'><fieldset data-role='controlgroup' class='ui-mini center connection-type' data-type='horizontal'><legend class='left'>"+_("Connection Type")+":</legend><input class='noselect' type='radio' name='connectionType' id='type-direct' value='ip' checked='checked'><label for='type-direct'>"+_("Direct")+"</label><input class='noselect' type='radio' name='connectionType' id='type-token' value='token'><label for='type-token'>"+_("OpenThings Cloud")+"</label></fieldset></div><label class='ip-field' for='os_ip'>"+_("Open Sprinkler IP:")+"</label>")+"<input data-wrapper-class='ip-field' "+(n?"data-role='none' style='display:none' ":"")+"autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='url' pattern='' name='os_ip' id='os_ip' value='"+(n?t:"")+"' placeholder='home.dyndns.org'><label class='token-field' for='os_token' style='display: none'>"+_("OpenThings Token")+":</label><input data-wrapper-class='token-field hidden' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' pattern='' name='os_token' id='os_token' value='' placeholder='"+_("OpenThings Token")+"'><label for='os_pw'>"+_("Open Sprinkler Password:")+"</label><input type='password' name='os_pw' id='os_pw' value=''><label for='save_pw'>"+_("Save Password")+"</label><input type='checkbox' data-wrapper-class='save_pw' name='save_pw' id='save_pw' data-mini='true' checked='checked'>"+(n?"":"<div data-theme='a' data-mini='true' data-role='collapsible' class='advanced-options'><h4>"+_("Advanced")+"</h4><fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' class='center'><input type='checkbox' name='os_usessl' id='os_usessl'><label for='os_usessl'>"+_("Use SSL")+"</label><input type='checkbox' name='os_useauth' id='os_useauth'><label for='os_useauth'>"+_("Use Auth")+"</label></fieldset></div>")+"<input type='submit' data-theme='b' value='"+_("Submit")+"'></form></div></div>");return i.find("form").on("submit",(function(){return submitNewUser(),!1})),i.one("popupafterclose",(function(){$(this).popup("destroy").remove()})).popup({history:!1,positionTo:"window"}).enhanceWithin(),e?$(".ui-popup-active").children().first().one("popupafterclose",(function(){i.popup("open")})).popup("close"):i.popup("open"),fixInputClick(i),i.find(".ui-collapsible-heading-toggle").on("click",(function(){var t=$(this).parents(".ui-collapsible").hasClass("ui-collapsible-collapsed"),e=$(".ui-page-active"),n=parseInt(e.css("min-height"));t?e.css("min-height",n+65+"px"):e.css("min-height",n-65+"px"),i.popup("reposition",{positionTo:"window"})})),i.find(".connection-type input[type='radio']").on("change",(function(){var t="token"===this.value?"ip":"token";i.find("."+t+"-field").hide(),i.find("."+this.value+"-field").removeClass("hidden").show(),i.find(".advanced-options").toggle("ip"===this.value)})),!1}$(document).one("deviceready",(function(){window.cordova&&window.cordova.InAppBrowser&&(window.open=window.cordova.InAppBrowser.open);try{StatusBar.overlaysWebView(!1),StatusBar.styleLightContent(),StatusBar.backgroundColorByHexString(statusBarPrimary),$.mobile.window.on("statusTap",(function(){$("body, html").animate({scrollTop:0},700)}))}catch(t){}setTimeout((function(){try{navigator.splashscreen.hide()}catch(t){}}),500),$.mobile.document.on("backbutton",(function(){return isIEMobile&&$.mobile.document.data("iabOpen")||checkChangesBeforeBack(),!1})),updateDeviceIP(),isiOS&&ThreeDeeTouch.isAvailable((function(t){t&&(ThreeDeeTouch.enableLinkPreview(),ThreeDeeTouch.configureQuickActions([{type:"sites",title:_("Manage Sites"),iconType:"Location"},{type:"addprogram",title:_("Add Program"),iconType:"Add"},{type:"stopall",title:_("Stop All Stations"),iconType:"Pause"}]),ThreeDeeTouch.onHomeIconPressed=function(t){"sites"===t.type?changePage("#site-control"):"addprogram"===t.type?changePage("#addprogram"):"stopall"===t.type&&stopAllStations()})}))})).one("mobileinit",(function(){(isChromeApp||"file:"===window.location.protocol)&&($.mobile.hashListeningEnabled=!1),$.support.cors=!0,$.mobile.allowCrossDomainPages=!0,loadLocalSettings()})).on("pagebeforechange",(function(t,e){var n,i=e.toPage,o=$(".ui-page-active");"string"==typeof e.toPage&&(n=$.mobile.path.parseUrl(i).hash,o.length>0&&n==="#"+o.attr("id")||("popup"===e.options.role||$(".ui-popup-active").length||$.mobile.silentScroll(0),"#programs"===n?getPrograms(e.options.programToExpand):"#addprogram"===n?addProgram(e.options.copyID):"#manual"===n?getManual():"#about"===n?showAbout():"#runonce"===n?getRunonce():"#os-options"===n?showOptions(e.options.expandItem):"#analogsensorconfig"===n?showAnalogSensorConfig():"#analogsensorchart"===n?showAnalogSensorCharts():"#preview"===n?getPreview():"#logs"===n?getLogs():"#forecast"===n?showForecast():"#loadingPage"===n?checkConfigured(!0):"#start"===n?showStart():"#site-control"===n?showSites():"#sprinklers"===n&&(0===$(n).length?showHome(e.options.firstLoad):$(n).one("pageshow",(function(){refreshStatus()})))))})).on("resume",(function(){void 0!==currIp&&(cloudSync(),showLoading("#weather,#footer-running"),updateController(updateWeather,networkFail))})).on("pause",(function(){})).on("pagebeforeshow",(function(t){var e="#"+t.target.id;"#start"===e||"#loadingPage"===e?$("#header,#footer,#footer-menu").hide():$("#header,#footer,#footer-menu").show(),storage.get("showDisabled",(function(t){t.showDisabled&&"true"===t.showDisabled?$(e).addClass("show-hidden").find(".station-hidden").show():$(e).removeClass("show-hidden").find(".station-hidden").hide()}))})).on("pageshow",(function(t){var e="#"+t.target.id,n=$(e);if(goingBack?goingBack=!1:pageHistoryCount++,fixInputClick(n),isControllerConnected()&&"#site-control"!==e&&"#start"!==e&&"#loadingPage"!==e){var i,o=setInterval((function(){refreshStatus()}),5e3);checkOSVersion(216)||(i=setInterval(refreshData,2e4)),n.one("pagehide",(function(){clearInterval(o),clearInterval(i)}))}})).on("popupafteropen",(function(){if($(".ui-overlay-b:not(.ui-screen-hidden)").length)try{StatusBar.backgroundColorByHexString(statusBarOverlay)}catch(t){}})).on("popupafterclose",(function(){$(".ui-page-active").children().add("#sprinklers-settings").removeClass("blur-filter");try{StatusBar.backgroundColorByHexString(statusBarPrimary)}catch(t){}})).on("popupbeforeposition",(function(){$(".ui-page-active").children().add("#sprinklers-settings").addClass("blur-filter")})).on("popupbeforeposition","#localization",checkCurrLang).one("pagebeforeshow","#loadingPage",initApp);var showSites=function(){var t,e,n,i=$("<div data-role='page' id='site-control'><div class='ui-content'></div></div>"),o=function(){var t=function(){e.eq(0).hide(),$("#header").show(),$("#footer, #footer-menu").hide()};i.hasClass("ui-page-active")?t():i.one("pagebeforeshow",(function(e){e.stopImmediatePropagation(),t()})),i.on("swiperight swipeleft",(function(t){t.stopImmediatePropagation()})),document.title="OpenSprinkler"},a=$("<div data-role='popup' id='addsite' data-theme='b'><ul data-role='listview'><li data-icon='false'><a href='#' id='site-add-scan'>"+_("Scan For Device")+"</a></li><li data-icon='false'><a href='#' id='site-add-manual'>"+_("Manually Add Device")+"</a></li></ul></div>");function s(){storage.get(["sites","current_site","cloudToken"],(function(e){if(t=parseSites(e.sites),$.isEmptyObject(t)){if("string"!=typeof e.cloudToken)return void changePage("#start");o(),i.find(".ui-content").html("<p class='center'>"+_("Please add a site by tapping the 'Add' button in the top right corner.")+"</p>")}else{var a="<div data-role='collapsible-set'>",r=[],l=0;n=Object.keys(t).length,isControllerConnected()&&n&&e.current_site in t||o(),t=sortObj(t),$.each(t,(function(t,e){r.push(t),t=htmlEscape(t),a+="<fieldset "+(1===n?"data-collapsed='false'":"")+" id='site-"+l+"' data-role='collapsible'><h3><a class='ui-btn ui-btn-corner-all connectnow yellow' data-site='"+l+"' href='#'>"+_("connect")+"</a>"+t+"</h3><form data-site='"+l+"' novalidate><div class='ui-field-contain'><label for='cnm-"+l+"'>"+_("Change Name")+"</label><input id='cnm-"+l+"' type='text' value='"+t+"'></div>"+(e.os_token?"":"<div class='ui-field-contain'><label for='cip-"+l+"'>"+_("Change IP")+"</label><input id='cip-"+l+"' type='url' value='"+e.os_ip+"' autocomplete='off' autocorrect='off' autocapitalize='off' pattern='' spellcheck='false'></div>")+(e.os_token?"<div class='ui-field-contain'><label for='ctoken-"+l+"'>"+_("Change Token")+"</label><input id='ctoken-"+l+"' type='text' value='"+e.os_token+"' autocomplete='off' autocorrect='off' autocapitalize='off' pattern='' spellcheck='false'></div>":"")+"<div class='ui-field-contain'><label for='cpw-"+l+"'>"+_("Change Password")+"</label><input id='cpw-"+l+"' type='password'></div>"+(e.os_token?"":"<fieldset data-mini='true' data-role='collapsible'><h3><span style='line-height:23px'>"+_("Advanced")+"</span><button data-helptext='"+_("These options are only for an OpenSprinkler behind a proxy capable of SSL and/or Basic Authentication.")+"' class='collapsible-button-right help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></h3><label for='usessl-"+l+"'><input data-mini='true' type='checkbox' id='usessl-"+l+"' name='usessl-"+l+"'"+(void 0!==e.ssl&&"1"===e.ssl?" checked='checked'":"")+">"+_("Use SSL")+"</label><label for='useauth-"+l+"'><input class='useauth' data-user='"+e.auth_user+"' data-pw='"+e.auth_pw+"' data-mini='true' type='checkbox' id='useauth-"+l+"' name='useauth-"+l+"'"+(void 0!==e.auth_user&&void 0!==e.auth_pw?" checked='checked'":"")+">"+_("Use Auth")+"</label></fieldset>")+"<input class='submit' type='submit' value='"+_("Save Changes to")+" "+t+"'><a data-role='button' class='deletesite' data-site='"+l+"' href='#' data-theme='b'>"+_("Delete")+" "+t+"</a></form></fieldset>",testSite(e,l,(function(t,e){i.find("#site-"+t+" .connectnow").removeClass("yellow").addClass(e?"green":"red")})),l++})),(a=$(a+"</div>")).find("form").one("change input",(function(){$(this).find(".submit").addClass("hasChanges")})),a.find(".connectnow").on("click",(function(){return updateSite(r[$(this).data("site")]),!1})),a.find(".help-icon").on("click",showHelpText),a.find(".useauth").on("change",(function(){var t=$(this);if(t.is(":checked")){var e=$("<div data-role='popup' data-theme='a'><form method='post' class='ui-content' novalidate><label for='auth_user'>"+_("Username:")+"</label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' name='auth_user' id='auth_user'><label for='auth_pw'>"+_("Password:")+"</label><input type='password' name='auth_pw' id='auth_pw'><input type='submit' class='submit' value='"+_("Submit")+"'></form></div>").enhanceWithin(),n=!1;e.find(".submit").on("click",(function(){return t.data({user:e.find("#auth_user").val(),pw:e.find("#auth_pw").val()}),n=!0,e.popup("close"),!1})),e.one("popupafterclose",(function(){n||t.attr("checked",!1).checkboxradio("refresh")})),openPopup(e)}else t.data({user:"",pw:""})})),a.find("form").on("submit",(function(){var n=$(this),i=n.data("site"),o=r[i],l=a.find("#cip-"+i).val(),c=a.find("#cpw-"+i).val(),d=a.find("#cnm-"+i).val(),u=a.find("#useauth-"+i).is(":checked"),h=a.find("#usessl-"+i).is(":checked")?"1":void 0,p=a.find("#useauth-"+i).data("user"),f=a.find("#useauth-"+i).data("pw"),m=""!==l&&l!==t[o].os_ip||h!==t[o].ssl||p!==t[o].auth_user||f!==t[o].auth_pw,g=o===e.current_site,v=""!==d&&d!==o;return n.find(".submit").removeClass("hasChanges"),u?(t[o].auth_user=p,t[o].auth_pw=f):(delete t[o].auth_user,delete t[o].auth_pw),"1"===h?t[o].ssl=h:delete t[o].ssl,""!==l&&l!==t[o].os_ip&&(t[o].os_ip=l),""!==c&&c!==t[o].os_pw&&(isMD5(t[o].os_pw)&&(c=md5(c)),t[o].os_pw=c),v&&(t[d]=t[o],delete t[o],o=d,g&&(storage.set({current_site:o}),e.current_site=o),updateSiteList(Object.keys(t),e.current_site)),storage.set({sites:JSON.stringify(t)},cloudSaveSites),showerror(_("Site updated successfully")),o===e.current_site&&(""!==c&&(currPass=c),m&&checkConfigured()),v&&!n.find(".submit").hasClass("preventUpdate")&&s(),!1})),a.find(".deletesite").on("click",(function(){var n=r[$(this).data("site")];return areYouSure(_("Are you sure you want to delete ")+n+"?","",(function(){$("#site-selector").val()===n&&o(),delete t[n],storage.set({sites:JSON.stringify(t)},(function(){return cloudSaveSites(),updateSiteList(Object.keys(t),e.current_site),$.isEmptyObject(t)?storage.get("cloudToken",(function(){if(null===e.cloudToken||void 0===e.cloudToken)return currIp="",currPass="",void changePage("#start")})):(s(),showerror(_("Site deleted successfully"))),!1}))})),!1})),i.find(".ui-content").html(a.enhanceWithin())}"string"==typeof e.cloudToken&&i.find(".ui-content").prepend(addSyncStatus(e.cloudToken))}))}return a.find("#site-add-scan").on("click",(function(){return a.popup("close"),startScan(),!1})),a.find("#site-add-manual").on("click",(function(){return showAddNew(!1,!0),!1})),i.on("pagehide",(function(){a.popup("destroy").detach(),i.detach()})),$("html").on("siterefresh",(function(){i.hasClass("ui-page-active")&&s()})),function(){e=changeHeader({title:_("Manage Sites"),animate:!!isControllerConnected(),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:function(){i.find(".hasChanges").addClass("preventUpdate"),checkChangesBeforeBack()}},rightBtn:{icon:"plus",text:_("Add"),on:function(){void 0===deviceip?showAddNew():a.popup("open").popup("reposition",{positionTo:e.eq(2)})}}}),s(),$.mobile.pageContainer.append(a),a.popup({history:!1,positionTo:e.eq(2)}).enhanceWithin(),$("#site-control").remove(),$.mobile.pageContainer.append(i)}}();function addSyncStatus(t){var e=$("<div class='ui-bar smaller ui-bar-a ui-corner-all logged-in-alert'><div class='inline ui-btn ui-icon-recycle btn-no-border ui-btn-icon-notext ui-mini'></div><div class='inline syncStatus'>"+_("Synced with OpenSprinkler.com")+" ("+getTokenUser(t)+")</div><div class='inline ui-btn ui-icon-delete btn-no-border ui-btn-icon-notext ui-mini logout'></div></div>");return e.find(".logout").on("click",logout),e.find(".ui-icon-recycle").on("click",(function(){var t=$(this);t.addClass("spin"),cloudSync((function(){t.removeClass("spin")}))})),e}function testSite(t,e,n){var i="/jo?pw="+encodeURIComponent(t.os_pw),o=t.os_token?"https://cloud.openthings.io/forward/v1/"+t.os_token+i:("1"===t.ssl?"https://":"http://")+t.os_ip+i;$.ajax({url:o,type:"GET",dataType:"json",beforeSend:function(e){void 0!==t.auth_user&&void 0!==t.auth_pw&&e.setRequestHeader("Authorization","Basic "+btoa(t.auth_user+":"+t.auth_pw))}}).then((function(){n(e,!0)}),(function(){n(e,!1)}))}function updateSiteList(t,e){var n="",i=$("#site-selector");$.each(t,(function(){n+="<option "+(this.toString()===e?"selected ":"")+"value='"+htmlEscape(this)+"'>"+this+"</option>"})),$("#info-list").find("li[data-role='list-divider']").text(e),i.html(n),i.parent().parent().hasClass("ui-select")&&i.selectmenu("refresh")}function updateSite(t){storage.get("sites",(function(e){var n=parseSites(e.sites);t in n&&closePanel((function(){storage.set({current_site:t},checkConfigured)}))}))}function findLocalSiteName(t,e){for(var n in t)if(t.hasOwnProperty(n)&&-1!==currIp.indexOf(t[n].os_ip))return void e(n);e(!1)}function updateDeviceIP(t){var e,n=function(e){deviceip=e,"function"==typeof t&&t(e)};if(isChromeApp)chrome.system.network.getNetworkInterfaces((function(t){var i;for(i in t)t.hasOwnProperty(i)&&/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(t[i].address)&&(e=t[i].address);n(e)}));else try{networkinterface.getWiFiIPAddress((function(t){e=t.ip,n(e)}))}catch(t){findRouter((function(t,e){n(t?e:void 0)}))}}function isLocalIP(t){var e=parseIntArray(t.split("."));return 10===e[0]||127===e[0]||172===e[0]&&e[1]>17&&e[1]<32||192===e[0]&&168===e[1]}function startScan(t,e){var n,i,o,a,s,r,l,c,d,u=deviceip.split("."),h=1,p=0,f="",m="",g=[],v=!1;for(e=e||0,t="number"==typeof t?t:80,storage.get("sites",(function(t){var e,n=parseSites(t.sites);for(e in n)n.hasOwnProperty(e)&&g.push(n[e].os_ip)})),o=function(){h++},a=function(t){h++;var e,n,i=$.mobile.path.parseUrl(this.url).authority;if(-1===$.inArray(i,g)){if("text"===this.dataType){if(!(n=t.match(/var\s*ver=(\d+)/)))return;e=n[1]}else{if(!t.hasOwnProperty("fwv"))return;e=t.fwv}p++,f+="<li><a class='ui-btn ui-btn-icon-right ui-icon-carat-r' href='#' data-ip='"+i+"'>"+i+"<p>"+_("Firmware")+": "+getOSVersion(e)+"</p></a></li>"}},r=function(){if(!0===v)return $.mobile.loading("hide"),clearInterval(l),!1;245===h&&($.mobile.loading("hide"),clearInterval(l),p?((f=$(f)).find("a").on("click",(function(){return addFound($(this).data("ip")),!1})),showSiteSelect(f)):0===e?startScan(8080,1):1===e?startScan(80,2):2===e?startScan(8080,3):showerror(_("No new devices were detected on your network")))},u.pop(),s=u.join("."),0===e?d=_("Scanning for OpenSprinkler"):1===e?d=_("Scanning for OpenSprinkler Pi"):2===e?d=_("Scanning for OpenSprinkler (1.8.3)"):3===e&&(d=_("Scanning for OpenSprinkler Pi (1.8.3)")),$.mobile.loading("show",{html:"<h1>"+d+"</h1><p class='cancel tight center inline-icon'><span class='btn-no-border ui-btn ui-icon-delete ui-btn-icon-notext'></span>"+_("Cancel")+"</p>",textVisible:!0,theme:"b"}),$(".ui-loader").find(".cancel").one("click",(function(){v=!0})),n=1;n<=244;n++)e<2?(m="/jo",c="json"):c="text",i="http://"+(u=s+"."+n)+(t&&80!==t?":"+t:"")+m,$.ajax({url:i,type:"GET",dataType:c,timeout:6e3,global:!1,error:o,success:a});l=setInterval(r,200)}function findRouter(t){t=t||function(){};var e,n,i,o=["192.168.1.1","10.0.1.1","192.168.1.220","192.168.2.1","10.1.1.1","192.168.11.1","192.168.0.1","192.168.0.30","192.168.0.50","192.168.10.1","192.168.20.1","192.168.30.1","192.168.62.1","192.168.102.1","192.168.1.254","192.168.0.227","10.0.0.138","192.168.123.254","192.168.4.1","10.0.0.2","10.0.2.1","10.0.3.1","10.0.4.1","10.0.5.1"],a=o.length,s=0,r=function(t,e){s++,!0===t&&(n=e)};for(i=0;i<a;i++)"string"!=typeof n&&ping(o[i],r);e=setInterval((function(){s!==a&&"string"!=typeof n||(clearInterval(e),"string"==typeof n?t(!0,n):t(!1))}),50)}function ping(t,e){e=e||function(){},t&&""!==t||e(!1),$.ajax({url:"http://"+t,type:"GET",timeout:6e3,global:!1}).then((function(){e(!0,t)}),(function(n){"timeout"===n.statusText?e(!1):e(!0,t)}))}function addFound(t){$("#site-select").one("popupafterclose",(function(){showAddNew(t)})).popup("close")}function showZimmermanAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var n=$.extend({},{h:100,t:100,r:100,bh:30,bt:70,br:0},unescapeJSON(t.value)),i=checkOSVersion(2162);isMetric&&(n.bt=Math.round(5*(n.bt-32)/9*10)/10,n.br=Math.round(25.4*n.br*10)/10);var o=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Set the baseline weather conditions for your location. ")+_("The Zimmerman method will adjust the watering duration based on differences from this reference point.")+"</p><div class='ui-grid-b'><div class='ui-block-a'><label class='center'>"+_("Temp")+(isMetric?" &#176;C":" &#176;F")+"</label><input data-wrapper-class='pad_buttons' class='bt' type='number' "+(isMetric?"min='-20' max='50'":"min='0' max='120'")+" value='"+n.bt+(i?"'>":"' disabled='disabled'>")+"</div><div class='ui-block-b'><label class='center'>"+_("Rain")+(isMetric?" mm":' "')+"</label><input data-wrapper-class='pad_buttons' class='br' type='number' "+(isMetric?"min='0' max='25' step='0.1'":"min='0' max='1' step='0.01'")+" value='"+n.br+(i?"'>":"' disabled='disabled'>")+"</div><div class='ui-block-c'><label class='center'>"+_("Humidity")+" %</label><input data-wrapper-class='pad_buttons' class='bh' type='number'  min='0' max='100' value='"+n.bh+(i?"'>":"' disabled='disabled'>")+"</div></div><p class='rain-desc center smaller'>"+_("Set the sensitivity of the watering adjustment to changes in each of the above weather conditions.")+"</p><span><fieldset class='ui-grid-b incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div></fieldset><div class='ui-grid-b inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='t' type='number' min='0' max='100' value='"+n.t+"'></div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='r' type='number'  min='0' max='100' value='"+n.r+"'></div><div class='ui-block-c'><input data-wrapper-class='pad_buttons' class='h' type='number'  min='0' max='100' value='"+n.h+"'></div></div><fieldset class='ui-grid-b decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div></fieldset></span><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>"),a=function(t,e){var n=o.find(".inputs input").eq(t),i=parseInt(n.val());-1===e&&0===i||1===e&&100===i||n.val(i+e)};o.find(".submit").on("click",(function(){var n={h:parseInt(o.find(".h").val()),t:parseInt(o.find(".t").val()),r:parseInt(o.find(".r").val())};return i&&($.extend(n,{bh:parseInt(o.find(".bh").val()),bt:parseFloat(o.find(".bt").val()),br:parseFloat(o.find(".br").val())}),isMetric&&(n.bt=Math.round(100*(9*n.bt/5+32))/100,n.br=Math.round(n.br/25.4*1e3)/1e3)),t&&(t.value=escapeJSON(n)),e(),o.popup("close"),!1})),o.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),holdButton(o.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return a(e,1),!1})),holdButton(o.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return a(e,-1),!1})),$("#adjustmentOptions").remove(),o.css("max-width","380px"),openPopup(o,{positionTo:"window"})}function showAutoRainDelayAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var n=$.extend({},{d:24},unescapeJSON(t.value)),i=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("If the weather reports any condition suggesting rain, a rain delay is automatically issued using the below set delay duration.")+"</p><label class='center' for='delay_duration'>"+_("Delay Duration (hours)")+"</label><div class='input_with_buttons'><button class='decr ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input id='delay_duration' type='number' pattern='[0-9]*' value='"+n.d+"'><button class='incr ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>"),o=function(t){var e=i.find("#delay_duration"),n=parseInt(e.val());-1===t&&0===n||1===t&&8760===n||e.val(n+t)};i.find(".submit").on("click",(function(){return n={d:parseInt(i.find("#delay_duration").val())},t&&(t.value=escapeJSON(n)),e(),i.popup("close"),!1})),i.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){(""===this.value||parseInt(this.value)<0)&&(this.value="0")})),holdButton(i.find(".incr"),(function(){return o(1),!1})),holdButton(i.find(".decr"),(function(){return o(-1),!1})),$("#adjustmentOptions").remove(),i.css("max-width","380px"),openPopup(i,{positionTo:"window"})}function showMonthlyAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var n=$.extend({},{scales:[100,100,100,100,100,100,100,100,100,100,100,100]},unescapeJSON(t.value)),i=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Input Monthly Watering Percentage Values")+"</p><div class='ui-grid-c'><div class='ui-block-a'><label class='center'>"+_("Jan")+"</label><input data-wrapper-class='pad_buttons' class='sc0' type='number' min=0 max=250 value="+n.scales[0]+"></div><div class='ui-block-b'><label class='center'>"+_("Feb")+"</label><input data-wrapper-class='pad_buttons' class='sc1' type='number' min=0 max=250 value="+n.scales[1]+"></div><div class='ui-block-c'><label class='center'>"+_("Mar")+"</label><input data-wrapper-class='pad_buttons' class='sc2' type='number' min=0 max=250 value="+n.scales[2]+"></div><div class='ui-block-d'><label class='center'>"+_("Apr")+"</label><input data-wrapper-class='pad_buttons' class='sc3' type='number' min=0 max=250 value="+n.scales[3]+"></div></div><div class='ui-grid-c'><div class='ui-block-a'><label class='center'>"+_("May")+"</label><input data-wrapper-class='pad_buttons' class='sc4' type='number' min=0 max=250 value="+n.scales[4]+"></div><div class='ui-block-b'><label class='center'>"+_("Jun")+"</label><input data-wrapper-class='pad_buttons' class='sc5' type='number' min=0 max=250 value="+n.scales[5]+"></div><div class='ui-block-c'><label class='center'>"+_("Jul")+"</label><input data-wrapper-class='pad_buttons' class='sc6' type='number' min=0 max=250 value="+n.scales[6]+"></div><div class='ui-block-d'><label class='center'>"+_("Aug")+"</label><input data-wrapper-class='pad_buttons' class='sc7' type='number' min=0 max=250 value="+n.scales[7]+"></div></div><div class='ui-grid-c'><div class='ui-block-a'><label class='center'>"+_("Sep")+"</label><input data-wrapper-class='pad_buttons' class='sc8' type='number' min=0 max=250 value="+n.scales[8]+"></div><div class='ui-block-b'><label class='center'>"+_("Oct")+"</label><input data-wrapper-class='pad_buttons' class='sc9' type='number' min=0 max=250 value="+n.scales[9]+"></div><div class='ui-block-c'><label class='center'>"+_("Nov")+"</label><input data-wrapper-class='pad_buttons' class='sc10' type='number' min=0 max=250 value="+n.scales[10]+"></div><div class='ui-block-d'><label class='center'>"+_("Dec")+"</label><input data-wrapper-class='pad_buttons' class='sc11' type='number' min=0 max=250 value="+n.scales[11]+"></div></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");i.find(".submit").on("click",(function(){for(var o=[],a=0;a<12;a++)o[a]=parseInt(i.find(".sc"+a).val()),o[a]<0&&(o[a]=0),o[a]>250&&(o[a]=250);return n={scales:o},t&&(t.value=escapeJSON(n)),e(),i.popup("close"),!1})),i.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){(""===this.value||parseInt(this.value)<0)&&(this.value="0")})),$("#adjustmentOptions").remove(),i.css("max-width","380px"),openPopup(i,{positionTo:"window"})}function validateWULocation(t,e){controller.settings.wto&&"string"==typeof controller.settings.wto.key&&""!==controller.settings.wto.key||e(!1),$.ajax({url:"https://api.weather.com/v2/pws/observations/hourly/7day?stationId="+t+"&format=json&units=e&apiKey="+controller.settings.wto.key,cache:!0}).done((function(t){t&&!t.errors?e(!0):e(!1)})).fail((function(){e(!1)}))}function showEToAdjustmentOptions(t,e){$(".ui-popup-active").find("[data-role='popup']").popup("close");var n=$.extend({},{baseETo:0,elevation:600},unescapeJSON(t.value));isMetric&&(n.baseETo=Math.round(25.4*n.baseETo*100)/100,n.elevation=Math.round(n.elevation/3.28));var i=$("<div data-role='popup' data-theme='a' id='adjustmentOptions'><div data-role='header' data-theme='b'><h1>"+_("Weather Adjustment Options")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Set the baseline potential evapotranspiration (ETo) and elevation for your location. ")+_("The ETo adjustment method will adjust the watering duration based on the difference between the baseline ETo and the current ETo.")+"</p><div class='ui-grid-a'><div class='ui-block-a'><label class='center'>"+_("Baseline ETo")+(isMetric?" (mm":"(in")+"/day)</label><input data-wrapper-class='pad_buttons' class='baseline-ETo' type='number' min='0' "+(isMetric?"max='25' step='0.1'":"max='1' step='0.01'")+" value='"+n.baseETo+"'></div><div class='ui-block-b'><label class='center'>"+_("Elevation")+(isMetric?" (m)":" (ft)")+"</label><input data-wrapper-class='pad_buttons' class='elevation' type='number' step='1'"+(isMetric?"min='-400' max='9000'":"min='-1400' max='30000'")+" value='"+n.elevation+"'></div></div><button class='detect-baseline-eto'>"+_("Detect baseline ETo")+"</button><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");i.find(".submit").on("click",(function(){return n={baseETo:parseFloat(i.find(".baseline-ETo").val()),elevation:parseInt(i.find(".elevation").val())},isMetric&&(n.baseETo=Math.round(n.baseETo/25.4*100)/100,n.elevation=Math.round(3.28*n.elevation)),t&&(t.value=escapeJSON(n)),e(),i.popup("close"),!1})),i.find(".detect-baseline-eto").on("click",(function(){var t=$(".detect-baseline-eto").html();return showLoading(".detect-baseline-eto"),$.ajax({url:WEATHER_SERVER_URL+"/baselineETo?loc="+encodeURIComponent(controller.settings.loc),contentType:"application/json; charset=utf-8",success:function(t){var e=t.eto;isMetric&&(e=Math.round(25.4*e*100)/100),$(".baseline-ETo").val(e),window.alert("Detected baseline ETo for configured location is "+e+(isMetric?"mm":"in")+"/day")},error:function(t,e){var n="Unable to detect baseline ETo: "+(t.status?t.responseText+"("+t.status+")":e);window.alert(n),window.console.error(n)},complete:function(){$(".detect-baseline-eto").html(t)}}),!1})),i.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),$("#adjustmentOptions").remove(),i.css("max-width","380px"),openPopup(i,{positionTo:"window"})}function formatTemp(t){return t=isMetric?Math.round(5/9*(t-32)*10)/10+" &#176;C":Math.round(10*t)/10+" &#176;F"}function formatPrecip(t){return t=isMetric?Math.round(25.4*t*10)/10+" mm":Math.round(100*t)/100+" in"}function formatHumidity(t){return Math.round(t)+" %"}function formatSpeed(t){return t=isMetric?Math.round(1.6*t*10)/10+" km/h":Math.round(10*t)/10+" mph"}function hideWeather(){$("#weather").empty().parents(".info-card").addClass("noweather")}function finishWeatherUpdate(){updateWeatherBox(),$.mobile.document.trigger("weatherUpdateComplete")}function updateWeather(){var t=(new Date).getTime();if(weather&&weather.providedLocation===controller.settings.loc&&t-weather.lastUpdated<36e4)finishWeatherUpdate();else{if(localStorage.weatherData)try{var e=JSON.parse(localStorage.weatherData);if(e.providedLocation===controller.settings.loc&&t-e.lastUpdated<36e4)return weather=e,void finishWeatherUpdate()}catch(t){}weather=void 0,""!==controller.settings.loc?(showLoading("#weather"),$.ajax({url:WEATHER_SERVER_URL+"/weatherData?loc="+encodeURIComponent(controller.settings.loc),contentType:"application/json; charset=utf-8",success:function(t){"object"==typeof t?(currentCoordinates=t.location,weather=t,t.lastUpdated=(new Date).getTime(),t.providedLocation=controller.settings.loc,localStorage.weatherData=JSON.stringify(t),finishWeatherUpdate()):hideWeather()}})):hideWeather()}}function checkURLandUpdateWeather(){var t=function(t){WEATHER_SERVER_URL=t?currPrefix+t:DEFAULT_WEATHER_SERVER_URL,updateWeather()};return controller.settings.wsp?"weather.opensprinkler.com"===controller.settings.wsp?void t():void t(controller.settings.wsp):$.get(currPrefix+currIp+"/su").then((function(e){var n=e.match(/value="([\w|:|/|.]+)" name=wsp/);t(n?n[1]:void 0)}))}function updateWeatherBox(){$("#weather").html((controller.settings.rd?"<div class='rain-delay red'><span class='icon ui-icon-alert'></span>Rain Delay<span class='time'>"+dateToString(new Date(1e3*controller.settings.rdst),void 0,!0)+"</span></div>":"")+"<div title='"+weather.description+"' class='wicon'><img src='https://openweathermap.org/img/w/"+weather.icon+".png'></div><div class='inline tight'>"+formatTemp(weather.temp)+"</div><br><div class='inline location tight'>"+_("Current Weather")+"</div>"+("object"==typeof weather.alert?"<div><button class='tight help-icon btn-no-border ui-btn ui-icon-alert ui-btn-icon-notext ui-corner-all'></button>"+weather.alert.type+"</div>":"")).off("click").on("click",(function(t){var e=$(t.target);return e.hasClass("rain-delay")||e.parents(".rain-delay").length?areYouSure(_("Do you want to turn off rain delay?"),"",(function(){showLoading("#weather"),sendToOS("/cv?pw=&rd=0").done((function(){updateController(updateWeather)}))})):changePage("#forecast"),!1})).parents(".info-card").removeClass("noweather")}function coordsToLocation(t,e,n,i){i=i||t+","+e,$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?latlng="+t+","+e+"&key=AIzaSyDaT_HTZwFojXmvYIhwWudK00vFXzMmOKc&result_type=locality|sublocality|administrative_area_level_1|country",(function(t){if(0!==t.results.length){t=t.results,i=t[0].formatted_address;var e=!1;for(var o in t)if(t.hasOwnProperty(o)&&($.inArray("locality",t[o].types)>-1||$.inArray("sublocality",t[o].types)>-1||$.inArray("postal_code",t[o].types)>-1||$.inArray("street_address",t[o].types)>-1)){e=!0;break}if(!1!==e){t=t[o].address_components;var a="",s="";for(o in e=!1,t)t.hasOwnProperty(o)&&!e&&(""===a&&$.inArray("locality",t[o].types)>-1&&(a=t[o].long_name+", "+a),""===a&&$.inArray("sublocality",t[o].types)>-1&&(a=t[o].long_name+", "+a),$.inArray("administrative_area_level_1",t[o].types)>-1&&(a+=t[o].long_name,e=!0),$.inArray("country",t[o].types)>-1&&(s=t[o].long_name));e||(a+=s),n(a)}else n(i)}else n(i)}))}function getSunTimes(t){t=t||new Date(1e3*controller.settings.devt);var e=SunCalc.getTimes(t,currentCoordinates[0],currentCoordinates[1]),n=e.sunrise,i=e.sunset,o=getTimezoneOffset();return n.setUTCMinutes(n.getUTCMinutes()+o),i.setUTCMinutes(i.getUTCMinutes()+o),[n=60*n.getUTCHours()+n.getUTCMinutes(),i=60*i.getUTCHours()+i.getUTCMinutes()]}function makeAttribution(t){if("string"!=typeof t)return"";var e="<div class='weatherAttribution'>";switch(t){case"DarkSky":case"DS":e+="<a href='https://darksky.net/poweredby/' target='_blank'>"+_("Powered by Dark Sky")+"</a>";break;case"OWM":e+="<a href='https://openweathermap.org/' target='_blank'>"+_("Powered by OpenWeather")+"</a>";break;case"WUnderground":case"WU":e+="<a href='https://wunderground.com/' target='_blank'>"+_("Powered by Weather Underground")+"</a>";break;case"local":e+=_("Powered by your Local PWS");break;case"Manual":e+=_("Using manual watering");break;default:e+=_("Unrecognised weather provider")}return e+"</div>"}function showForecast(){var t=$("<div data-role='page' id='forecast'><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'>"+makeForecast()+"</ul>"+makeAttribution(weather.wp||weather.weatherProvider)+"</div></div>");changeHeader({title:_("Forecast"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack},rightBtn:{icon:"refresh",text:_("Refresh"),on:function(){$.mobile.loading("show"),$.mobile.document.one("weatherUpdateComplete",(function(){$.mobile.loading("hide")})),updateWeather()}}}),t.one("pagehide",(function(){t.remove()})),t.find(".alert").on("click",(function(){openPopup($("<div data-role='popup' data-theme='a'><div data-role='header' data-theme='b'><h1>"+weather.alert.name+"</h1></div><div class='ui-content'><span style='white-space: pre-wrap'>"+$.trim(weather.alert.message)+"</span></div></div>"))})),$("#forecast").remove(),$.mobile.pageContainer.append(t)}function makeForecast(){var t,e,n,i="",o=controller.settings.sunrise?controller.settings.sunrise:getSunTimes()[0],a=controller.settings.sunset?controller.settings.sunset:getSunTimes()[1],s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(i+="<li data-icon='false' class='center'><div>"+_("Now")+"</div><br><div title='"+weather.description+"' class='wicon'><img src='https://openweathermap.org/img/w/"+weather.icon+".png'></div><span>"+formatTemp(weather.temp)+"</span><br><span>"+_("Sunrise")+"</span><span>: "+pad(parseInt(o/60)%24)+":"+pad(o%60)+"</span> <span>"+_("Sunset")+"</span><span>: "+pad(parseInt(a/60)%24)+":"+pad(a%60)+"</span></li>",t=1;t<weather.forecast.length;t++)o=(n=getSunTimes(e=new Date(1e3*weather.forecast[t].date)))[0],a=n[1],i+="<li data-icon='false' class='center'><div>"+e.toLocaleDateString()+"</div><br><div title='"+weather.forecast[t].description+"' class='wicon'><img src='https://openweathermap.org/img/w/"+weather.forecast[t].icon+".png'></div><span>"+_(s[e.getDay()])+"</span><br><span>"+_("Low")+"</span><span>: "+formatTemp(weather.forecast[t].temp_min)+"  </span><span>"+_("High")+"</span><span>: "+formatTemp(weather.forecast[t].temp_max)+"</span><br><span>"+_("Sunrise")+"</span><span>: "+pad(parseInt(o/60)%24)+":"+pad(o%60)+"</span> <span>"+_("Sunset")+"</span><span>: "+pad(parseInt(a/60)%24)+":"+pad(a%60)+"</span></li>";return i}function overlayMap(t){$("#location-list").popup("destroy").remove(),$.mobile.loading("show"),t=t||function(){};var e=$("<div data-role='popup' id='location-list' data-theme='a' style='background-color:rgb(229, 227, 223);'><a href='#' data-rel='back' class='ui-btn ui-corner-all ui-shadow ui-btn-b ui-icon-delete ui-btn-icon-notext ui-btn-right'>"+_("Close")+"</a><iframe style='border:none' src='"+getAppURLPath()+"map.html' width='100%' height='100%' seamless=''></iframe></div>"),n=function(t){t=t||function(t){t&&o.get(0).contentWindow.postMessage({type:"currentLocation",payload:{lat:t.coords.latitude,lon:t.coords.longitude}},"*")};var e,n=function(n){clearTimeout(e),$.mobile.loading("hide"),n||showerror(_("Unable to retrieve your current location")),t(n)};try{e=setTimeout((function(){$.mobile.loading("show",{html:"<div class='logo'></div><h1 style='padding-top:5px'>"+_("Attempting to retrieve your current location")+"</h1></p>",textVisible:!0,theme:"b"})}),100),navigator.geolocation.getCurrentPosition((function(t){clearTimeout(e),n(t)}),(function(){n(!1)}),{timeout:1e4})}catch(t){n(!1)}},i=function(t,e){var n=$("#wtkey").val();""!==n&&$.ajax({url:"https://api.weather.com/v3/location/near?format=json&product=pws&apiKey="+n+"&geocode="+encodeURIComponent(t)+","+encodeURIComponent(e),cache:!0}).done((function(t){var e=[];t.location.stationId.forEach((function(n,i){e.push({id:n,lat:t.location.latitude[i],lon:t.location.longitude[i],message:t.location.stationId[i]})})),e.length>0&&(e=encodeURIComponent(JSON.stringify(e)),o.get(0).contentWindow.postMessage({type:"pwsData",payload:e},"*"))}))},o=e.find("iframe"),a=$("#loc").val(),s={lat:a.match(regex.gps)?a.split(",")[0]:currentCoordinates[0],lon:a.match(regex.gps)?a.split(",")[1]:currentCoordinates[1]},r=!1;$.mobile.window.off("message onmessage").on("message onmessage",(function(o){var a=o.originalEvent.data;if(void 0!==a.WS){var s=a.WS.split(",");t(s.length>1?s:a.WS,a.station),r=!0,e.popup("destroy").remove()}else!0===a.loaded?$.mobile.loading("hide"):"object"==typeof a.location?i(a.location[0],a.location[1]):!0===a.dismissKeyboard?document.activeElement.blur():!0===a.getLocation&&n()})),o.one("load",(function(){0===s.lat&&0===s.lon&&n(),this.contentWindow.postMessage({type:"startLocation",payload:{start:s}},"*")})),e.one("popupafterclose",(function(){!1===r&&t(!1)})),openPopup(e,{beforeposition:function(){e.css({width:window.innerWidth-36,height:window.innerHeight-28})},x:0,y:0}),i(s.lat,s.lon)}var rebootReasons={0:_("None"),1:_("Factory Reset"),2:_("Reset Button"),3:_("WiFi Change"),4:_("Web Request"),5:_("Web Request"),6:_("WiFi Configure"),7:_("Firmware Update"),8:_("Weather Failure"),9:_("Network Failure"),10:_("Clock Update"),99:_("Power On")},weatherErrors={"-4":_("Empty Response"),"-3":_("Timed Out"),"-2":_("Connection Failed"),"-1":_("No Response"),0:_("Success"),1:_("Weather Data Error"),10:_("Building Weather History"),11:_("Weather Provider Response Incomplete"),12:_("Weather Provider Request Failed"),2:_("Location Error"),20:_("Location Request Error"),21:_("Location Not Found"),22:_("Invalid Location Format"),3:_("PWS Error"),30:_("Invalid WUnderground PWS"),31:_("Invalid WUnderground Key"),32:_("WUnderground Authentication Error"),33:_("Unsupported WUnderground Method"),34:_("No WUnderground PWS Provided"),4:_("Adjustment Method Error"),40:_("Unsupported Adjustment Method"),41:_("No Adjustment Method Provided"),5:_("Adjustment Options Error"),50:_("Corrupt Adjustment Options"),51:_("Missing Adjustment Option"),99:_("Unexpected Error")};function getRebootReason(t){return t in rebootReasons?rebootReasons[t]:_("Unrecognised")+" ("+t+")"}function getWeatherError(t){var e=Math.floor(t/10);return t in weatherErrors?weatherErrors[t]:t<=59&&t>=10&&e in weatherErrors?weatherErrors[e]:_("Unrecognised")+" ("+t+")"}function getWeatherStatus(t){return t<0?"<font class='debugWUError'>"+_("Offline")+"</font>":t>0?"<font class='debugWUError'>"+_("Error")+"</font>":"<font class='debugWUOK'>"+_("Online")+"</font>"}function getWiFiRating(t){return _(t<-80?"Unuseable":t<-70?"Poor":t<-60?"Fair":t<-50?"Good":"Excellent")}function debugWU(){var t="<div data-role='popup' id='debugWU' class='ui-content ui-page-theme-a'>";return t+="<div class='debugWUHeading'>System Status</div><table class='debugWUTable'>"+("number"==typeof controller.settings.lupt?"<tr><td>"+_("Last Reboot")+"</td><td>"+(controller.settings.lupt<1e3?"--":dateToString(new Date(1e3*controller.settings.lupt),null,2))+"</td></tr>":"")+("number"==typeof controller.settings.lrbtc?"<tr><td>"+_("Reboot Reason")+"</td><td>"+getRebootReason(controller.settings.lrbtc)+"</td></tr>":"")+("number"==typeof controller.settings.RSSI?"<tr><td>"+_("WiFi Strength")+"</td><td>"+getWiFiRating(controller.settings.RSSI)+"</td></tr>":"")+("number"==typeof controller.settings.wterr?"<tr><td>"+_("Weather Service")+"</td><td>"+getWeatherStatus(controller.settings.wterr)+"</td></tr>":"")+"</table><div class='debugWUHeading'>Watering Level</div><table class='debugWUTable'>"+(void 0!==controller.options.uwt?"<tr><td>"+_("Method")+"</td><td>"+getAdjustmentMethod(controller.options.uwt).name+"</td></tr>":"")+(void 0!==controller.options.wl?"<tr><td>"+_("Watering Level")+"</td><td>"+controller.options.wl+" %</td></tr>":"")+("number"==typeof controller.settings.lswc?"<tr><td>"+_("Last Updated")+"</td><td>"+(0===controller.settings.lswc?_("Never"):humaniseDuration(1e3*controller.settings.devt,1e3*controller.settings.lswc))+"</td></tr>":"")+"</table><div class='debugWUHeading'>Weather Service Details</div><div class='debugWUScrollable'><table class='debugWUTable'>","object"==typeof controller.settings.wtdata&&Object.keys(controller.settings.wtdata).length>0&&(t+=(void 0!==controller.settings.wtdata.h?"<tr><td>"+_("Mean Humidity")+"</td><td>"+formatHumidity(controller.settings.wtdata.h)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.t?"<tr><td>"+_("Mean Temp")+"</td><td>"+formatTemp(controller.settings.wtdata.t)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.p?"<tr><td>"+_("Total Rain")+"</td><td>"+formatPrecip(controller.settings.wtdata.p)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.eto?"<tr><td>"+_("ETo")+"</td><td>"+formatPrecip(controller.settings.wtdata.eto)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.radiation?"<tr><td>"+_("Mean Radiation")+"</td><td>"+controller.settings.wtdata.radiation+" kWh/m2</td></tr>":"")+(void 0!==controller.settings.wtdata.minT?"<tr><td>"+_("Min Temp")+"</td><td>"+formatTemp(controller.settings.wtdata.minT)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.maxT?"<tr><td>"+_("Max Temp")+"</td><td>"+formatTemp(controller.settings.wtdata.maxT)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.minH?"<tr><td>"+_("Min Humidity")+"</td><td>"+formatHumidity(controller.settings.wtdata.minH)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.maxH?"<tr><td>"+_("Max Humidity")+"</td><td>"+formatHumidity(controller.settings.wtdata.maxH)+"</td></tr>":"")+(void 0!==controller.settings.wtdata.wind?"<tr><td>"+_("Mean Wind")+"</td><td>"+formatSpeed(controller.settings.wtdata.wind)+"</td></tr>":"")),t+="number"==typeof controller.settings.lwc?"<tr><td>"+_("Last Request")+"</td><td>"+dateToString(new Date(1e3*controller.settings.lwc),null,2)+"</td></tr>":"",t+="number"==typeof controller.settings.wterr?"<tr><td>"+_("Last Response")+"</td><td>"+getWeatherError(controller.settings.wterr)+"</td></tr>":"",t+="</table></div>","number"==typeof controller.settings.otcs&&(t+="<div class='debugWUHeading'>Integrations</div><table class='debugWUTable'><tr><td>OpenThings Cloud</td><td>"+resolveOTCStatus(controller.settings.otcs)+"</td></tr></table>"),!controller.settings.wtdata||"string"!=typeof controller.settings.wtdata.wp&&"string"!=typeof controller.settings.wtdata.weatherProvider||(t+="<hr>",t+=makeAttribution(controller.settings.wtdata.wp||controller.settings.wtdata.weatherProvider)),t+="</div>",openPopup($(t)),!1}function resolveOTCStatus(t){switch(t){case 0:return"Not Enabled";case 1:return"Connecting...";case 2:return"<font class='debugWUError'>Disconnected</font>";case 3:return"<font class='debugWUOK'>Connected</font>"}}function showRainDelay(){$(".ui-popup-active").find("[data-role='popup']").popup("close"),showDurationBox({title:_("Change Rain Delay"),callback:raindelay,label:_("Duration"),maximum:31536e3,granularity:2,preventCompression:!0,incrementalUpdate:!1,updateOnChange:!1,helptext:_("Enable manual rain delay by entering a value into the input below. To turn off a currently enabled rain delay use a value of 0.")})}function showPause(){StationQueue.isPaused()?areYouSure(_("Do you want to resume program operation?"),"",(function(){sendToOS("/pq?pw=")})):showDurationBox({title:"Pause Station Runs",incrementalUpdate:!1,maximum:65535,callback:function(t){sendToOS("/pq?dur="+t+"&pw=")}})}function getAdjustmentMethod(t){var e=[{name:_("Manual"),id:0},{name:"Zimmerman",id:1},{name:_("Auto Rain Delay"),id:2,minVersion:216},{name:"ETo",id:3,minVersion:216},{name:"Monthly",id:4,minVersion:220}];return void 0===t?e:e[-129&t]}function getCurrentAdjustmentMethodId(){return-129&controller.options.uwt}function getRestriction(t){return[{isCurrent:0,name:_("None")},{isCurrent:!!(controller.options.uwt>>7&1),name:_("California Restriction")}][t]}function setRestriction(t,e){return e=e||-129&controller.options.uwt,1===t&&(e|=128),e}function testAPIKey(t,e){$.ajax({url:"https://api.weather.com/v2/pws/observations/current?stationId=KMAHANOV10&format=json&units=m&apiKey="+t,cache:!0}).done((function(t){t.errors?e(!1):e(!0)})).fail((function(){e(!1)}))}function bindPanel(){var t=$("#sprinklers-settings"),e=function(){return controller&&controller.settings&&controller.settings.en&&1===controller.settings.en?_("Disable"):_("Enable")};t.enhanceWithin().panel().removeClass("hidden").panel("option","classes.modal","needsclick ui-panel-dismiss"),t.find("a[href='#site-control']").on("click",(function(){return changePage("#site-control"),!1})),t.find("a[href='#about']").on("click",(function(){return changePage("#about"),!1})),t.find(".cloud-login").on("click",(function(){return requestCloudAuth(),!1})),t.find("a[href='#debugWU']").on("click",debugWU),t.find("a[href='#localization']").on("click",languageSelect),t.find(".export_config").on("click",(function(){return"object"!=typeof controller.stations.stn_spe||"object"==typeof controller.special||controller.stations.stn_spe.every((function(t){return 0===t}))?getExportMethod():updateControllerStationSpecial(getExportMethod),!1})),t.find(".import_config").on("click",(function(){return storage.get("backup",(function(t){getImportMethod(t.backup)})),!1})),t.find(".toggleOperation").on("click",(function(){var t=$(this),n=1-controller.settings.en;return areYouSure(_("Are you sure you want to")+" "+e().toLowerCase()+" "+_("operation?"),"",(function(){sendToOS("/cv?pw=&en="+n).done((function(){$.when(updateControllerSettings(),updateControllerStatus()).done((function(){checkStatus(),t.find("span:first").html(e()).attr("data-translate",e())}))}))})),!1})).find("span:first").html(e()).attr("data-translate",e()),t.find(".reboot-os").on("click",(function(){return areYouSure(_("Are you sure you want to reboot OpenSprinkler?"),"",(function(){$.mobile.loading("show"),sendToOS("/cv?pw=&rbt=1").done((function(){$.mobile.loading("hide"),showerror(_("OpenSprinkler is rebooting now"))}))})),!1})),t.find(".changePassword > a").on("click",changePassword),t.find("#downgradeui").on("click",(function(){return areYouSure(_("Are you sure you want to downgrade the UI?"),"",(function(){var t="http://rayshobby.net/scripts/java/svc"+getOSVersion();sendToOS("/cu?jsp="+encodeURIComponent(t)+"&pw=").done((function(){storage.remove(["sites","current_site","lang","provider","wapikey","runonce"]),location.reload()}))})),!1})),t.find("#logout").on("click",(function(){return logout(),!1})),openPanel=function(){var t=$("#sprinklers-settings"),e=function(){var e=controller&&controller.settings&&controller.settings.en&&1===controller.settings.en?_("Disable"):_("Enable");t.find(".toggleOperation span:first").html(e).attr("data-translate",e)};return $("html").on("datarefresh",e),function(){var n=$(".ui-page-active").attr("id");"start"!==n&&"loadingPage"!==n&&isControllerConnected()&&1===$(".ui-page-active").length&&(e(),t.panel("open"))}}()}function showOptions(t){var e,n,i,o="",a=$("<div data-role='page' id='os-options'><div class='ui-content' role='main'><div data-role='collapsibleset' id='os-options-list'></div><a class='submit preventBack' style='display:none'></a></div></div>"),s=function(t,e,n){return"<div class='ui-field-contain'><fieldset data-role='controlgroup' class='ui-mini center sensor-options' data-type='horizontal'><legend class='left'>"+_("Sensor")+(n?" "+n+" ":" ")+_("Type")+"</legend><input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-none' value='0'"+(0===e?" checked='checked'":"")+"><label for='o"+t+"-none'>"+_("None")+"</label><input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-rain' value='1'"+(1===e?" checked='checked'":"")+"><label for='o"+t+"-rain'>"+_("Rain")+"</label>"+(52===t?"":"<input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-flow' value='2'"+(2===e?" checked='checked'":"")+"><label for='o"+t+"-flow'>"+_("Flow")+"</label>")+(checkOSVersion(219)?"<input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-soil' value='3'"+(3===e?" checked='checked'":"")+"><label for='o"+t+"-soil'>"+_("Soil")+"</label>":"")+(checkOSVersion(217)?"<input class='noselect' type='radio' name='o"+t+"' id='o"+t+"-program' value='240'"+(240===e?" checked='checked'":"")+"><label for='o"+t+"-program'>"+_("Program Switch")+"</label>":"")+"</fieldset></div>"},r=function(){var t,e={},n=!1,i=isOSPi(),o=l.eq(2);if(o.prop("disabled",!0),a.find(".submit").removeClass("hasChanges"),a.find("#os-options-list").find(":input,button").filter(":not(.noselect)").each((function(){var o,s=$(this),r=s.attr("id"),l=s.val();if(!r||!l&&""!==l)return!0;switch(r){case"o1":var c=l.split(":");c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10),c[1]=(c[1]/15>>0)/4,c[0]=c[0]+(c[0]>=0?c[1]:-c[1]),l=4*(c[0]+12)>>0;break;case"datetime":var d=new Date(1e3*l);return e.tyy=d.getUTCFullYear(),e.tmm=d.getUTCMonth(),e.tdd=d.getUTCDate(),e.thh=d.getUTCHours(),e.tmi=d.getUTCMinutes(),e.ttt=Math.round(d.getTime()/1e3),!0;case"ip_addr":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid IP address is required when DHCP is not used")),n=!0,!1):(e.o4=o[0],e.o5=o[1],e.o6=o[2],e.o7=o[3],!0);case"subnet":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid subnet address is required when DHCP is not used")),n=!0,!1):(e.o58=o[0],e.o59=o[1],e.o60=o[2],e.o61=o[3],!0);case"gateway":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid gateway address is required when DHCP is not used")),n=!0,!1):(e.o8=o[0],e.o9=o[1],e.o10=o[2],e.o11=o[3],!0);case"dns":return"0.0.0.0"===(o=l.split("."))?(showerror(_("A valid DNS address is required when DHCP is not used")),n=!0,!1):(e.o44=o[0],e.o45=o[1],e.o46=o[2],e.o47=o[3],!0);case"ntp_addr":return o=l.split("."),e.o32=o[0],e.o33=o[1],e.o34=o[2],e.o35=o[3],!0;case"wtkey":return!0;case"wto":if(l=escapeJSON($.extend({},unescapeJSON(l),{key:a.find("#wtkey").val()})),escapeJSON(controller.settings.wto)===l)return!0;break;case"mqtt":if(escapeJSON(controller.settings.mqtt)===l)return!0;break;case"otc":if(escapeJSON(controller.settings.otc)===l)return!0;break;case"isMetric":return isMetric=s.is(":checked"),storage.set({isMetric:isMetric}),!0;case"groupView":return groupView=s.is(":checked"),storage.set({groupView:groupView}),!0;case"o12":return i||(e.o12=255&l,e.o13=l>>8&255),!0;case"o31":if(3===parseInt(l)&&!unescapeJSON($("#wto")[0].value).baseETo)return showerror(_("You must specify a baseline ETo adjustment method option to use the ET adjustment method.")),n=!0,!1;var u=a.find("#weatherRestriction");u.length&&(l=setRestriction(parseInt(u.val()),l));break;case"o18":case"o37":parseInt(l)>8*(parseInt(a.find("#o15").val())+1)&&(l=0);break;case"o41":return"gallon"===a.find("#o41-units").val()&&(l*=3.78541),e.o41=100*l&255,e.o42=100*l>>8&255,!0;case"o2":case"o3":case"o14":case"o16":case"o21":case"o22":case"o25":case"o36":case"o48":case"o50":case"o51":case"o52":case"o53":if(l=s.is(":checked")?1:0,!checkOSVersion(219)&&!l)return!0}i&&("loc"===r||"lg"===r?r="o"+r:(t=/\d+/.exec(r),r="o"+Object.keys(keyIndex).find((function(e){return keyIndex[e]===t})))),!0===checkOSVersion(208)&&"loc"===r&&(l=l.replace(/\s/g,"_")),e[r]=l})),n)return o.prop("disabled",!1),void a.find(".submit").addClass("hasChanges");void 0!==controller.options.fpr0&&(void 0!==controller.options.urs?e.o21=a.find("input[name='o21'][type='radio']:checked").val():(void 0!==controller.options.sn1t&&(e.o50=a.find("input[name='o50'][type='radio']:checked").val()),void 0!==controller.options.sn2t&&(e.o52=a.find("input[name='o52'][type='radio']:checked").val()))),e=transformKeys(e),$.mobile.loading("show"),sendToOS("/co?pw=&"+$.param(e)).done((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Settings have been saved"))})),goBack(),updateController(updateWeather)})).fail((function(){o.prop("disabled",!1),a.find(".submit").addClass("hasChanges")}))},l=changeHeader({title:_("Edit Options"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:checkChangesBeforeBack},rightBtn:{icon:"check",text:_("Submit"),class:"submit",on:r}});if(a.find(".submit").on("click",r),o="<fieldset data-role='collapsible'"+("string"!=typeof t||"system"===t?" data-collapsed='false'":"")+"><legend>"+_("System")+"</legend>",void 0!==controller.options.ntp&&(o+="<div class='ui-field-contain datetime-input'><label for='datetime'>"+_("Device Time")+"</label><button "+(controller.options.ntp?"disabled ":"")+"data-mini='true' id='datetime' value='"+(controller.settings.devt+60*new Date(1e3*controller.settings.devt).getTimezoneOffset())+"'>"+dateToString(new Date(1e3*controller.settings.devt)).slice(0,-3)+"</button></div>"),!isOSPi()&&void 0!==controller.options.tz){for(e=["-12:00","-11:30","-11:00","-10:00","-09:30","-09:00","-08:30","-08:00","-07:00","-06:00","-05:00","-04:30","-04:00","-03:30","-03:00","-02:30","-02:00","+00:00","+01:00","+02:00","+03:00","+03:30","+04:00","+04:30","+05:00","+05:30","+05:45","+06:00","+06:30","+07:00","+08:00","+08:45","+09:00","+09:30","+10:00","+10:30","+11:00","+11:30","+12:00","+12:45","+13:00","+13:45","+14:00"],n=((n=controller.options.tz-48)>=0?"+":"-")+pad(Math.abs(n)/4>>0)+":"+(Math.abs(n)%4*15/10>>0)+Math.abs(n)%4*15%10,o+="<div class='ui-field-contain'><label for='o1' class='select'>"+_("Timezone")+"</label><select "+(checkOSVersion(210)&&"object"==typeof weather?"disabled='disabled' ":"")+"data-mini='true' id='o1'>",i=0;i<e.length;i++)o+="<option "+(e[i]===n?"selected":"")+" value='"+e[i]+"'>"+e[i]+"</option>";o+="</select></div>"}if(o+="<div class='ui-field-contain'><label for='loc'>"+_("Location")+"</label><button data-mini='true' id='loc' value='"+("''"===controller.settings.loc.trim()?_("Not specified"):controller.settings.loc)+"'><span>"+controller.settings.loc+"</span><a class='ui-btn btn-no-border ui-btn-icon-notext ui-icon-delete ui-btn-corner-all clear-loc'></a></button></div>",void 0!==controller.options.lg&&(o+="<label for='o36'><input data-mini='true' id='o36' type='checkbox' "+(1===controller.options.lg?"checked='checked'":"")+">"+_("Enable Logging")+"</label>"),o+="<label for='isMetric'><input data-mini='true' id='isMetric' type='checkbox' "+(isMetric?"checked='checked'":"")+">"+_("Use Metric")+"</label>",Supported.groups()&&(o+="<label for='groupView'><input data-mini='true' id='groupView' type='checkbox' "+(groupView?"checked='checked'":"")+">"+_("Order Stations by Groups")+"</label>"),o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"master"===t?" data-collapsed='false'":"")+"><legend>"+_("Configure Master")+"</legend>",void 0!==controller.options.mas){for(o+="<div class='ui-field-contain ui-field-no-border'><label for='o18' class='select'>"+_("Master Station")+" "+(void 0!==controller.options.mas2?"1":"")+"</label><select data-mini='true' id='o18'><option value='0'>"+_("None")+"</option>",i=0;i<controller.stations.snames.length&&(o+="<option "+(1===Station.isMaster(i)?"selected":"")+" value='"+(i+1)+"'>"+controller.stations.snames[i]+"</option>",checkOSVersion(214)||7!==i);i++);o+="</select></div>",void 0!==controller.options.mton&&(o+="<div "+(0===controller.options.mas?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o19'>"+_("Master On Adjustment")+"</label><button data-mini='true' id='o19' value='"+controller.options.mton+"'>"+controller.options.mton+"s</button></div>"),void 0!==controller.options.mtof&&(o+="<div "+(0===controller.options.mas?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o20'>"+_("Master Off Adjustment")+"</label><button data-mini='true' id='o20' value='"+controller.options.mtof+"'>"+controller.options.mtof+"s</button></div>")}if(void 0!==controller.options.mas2){for(o+="<hr style='width:95%' class='content-divider'>",o+="<div class='ui-field-contain ui-field-no-border'><label for='o37' class='select'>"+_("Master Station")+" 2</label><select data-mini='true' id='o37'><option value='0'>"+_("None")+"</option>",i=0;i<controller.stations.snames.length&&(o+="<option "+(2===Station.isMaster(i)?"selected":"")+" value='"+(i+1)+"'>"+controller.stations.snames[i]+"</option>",checkOSVersion(214)||7!==i);i++);o+="</select></div>",void 0!==controller.options.mton2&&(o+="<div "+(0===controller.options.mas2?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o38'>"+_("Master On Adjustment")+"</label><button data-mini='true' id='o38' value='"+controller.options.mton2+"'>"+controller.options.mton2+"s</button></div>"),void 0!==controller.options.mtof2&&(o+="<div "+(0===controller.options.mas2?"style='display:none' ":"")+"class='ui-field-no-border ui-field-contain duration-field'><label for='o39'>"+_("Master Off Adjustment")+"</label><button data-mini='true' id='o39' value='"+controller.options.mtof2+"'>"+controller.options.mtof2+"s</button></div>")}if(o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"station"===t?" data-collapsed='false'":"")+"><legend>"+_("Station Handling")+"</legend>",void 0!==controller.options.ext){for(o+="<div class='ui-field-contain'><label for='o15' class='select'>"+_("Number of Stations")+("number"==typeof controller.options.dexp&&controller.options.dexp<255&&controller.options.dexp>=0?" <span class='nobr'>("+(8*controller.options.dexp+8)+" "+_("available")+")</span>":"")+"</label><select data-mini='true' id='o15'>",i=0;i<=(controller.options.mexp||5);i++)o+="<option "+(controller.options.ext===i?"selected":"")+" value='"+i+"'>"+(8*i+8)+" "+_("stations")+"</option>";o+="</select></div>"}if(void 0!==controller.options.sdt&&(o+="<div class='ui-field-contain duration-field'><label for='o17'>"+_("Station Delay")+"</label><button data-mini='true' id='o17' value='"+controller.options.sdt+"'>"+dhms2str(sec2dhms(controller.options.sdt))+"</button></div>"),o+="<label for='showDisabled'><input data-mini='true' class='noselect' id='showDisabled' type='checkbox' "+("true"===localStorage.showDisabled?"checked='checked'":"")+">"+_("Show Disabled")+" "+_("(Changes Auto-Saved)")+"</label>",void 0!==controller.options.seq&&(o+="<label for='o16'><input data-mini='true' id='o16' type='checkbox' "+(1===controller.options.seq?"checked='checked'":"")+">"+_("Sequential")+"</label>"),o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"weather"===t?" data-collapsed='false'":"")+"><legend>"+_("Weather and Sensors")+"</legend>",void 0!==controller.options.uwt){for(o+="<div class='ui-field-contain'><label for='o31' class='select'>"+_("Weather Adjustment Method")+"<button data-helptext='"+_("Weather adjustment uses DarkSky data in conjunction with the selected method to adjust the watering percentage.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><select data-mini='true' id='o31'>",i=0;i<getAdjustmentMethod().length;i++){var c=getAdjustmentMethod()[i];c.minVersion&&!checkOSVersion(c.minVersion)||(o+="<option "+(c.id===getCurrentAdjustmentMethodId()?"selected":"")+" value='"+i+"'>"+c.name+"</option>")}if(o+="</select></div>","object"==typeof controller.settings.wto&&(o+="<div class='ui-field-contain"+(0===getCurrentAdjustmentMethodId()?" hidden":"")+"'><label for='wto'>"+_("Adjustment Method Options")+"</label><button data-mini='true' id='wto' value='"+escapeJSON(controller.settings.wto)+"'>"+_("Tap to Configure")+"</button></div>"),checkOSVersion(214)){for(o+="<div class='ui-field-contain'><label for='weatherRestriction' class='select'>"+_("Weather-Based Restrictions")+"<button data-helptext='"+_("Prevents watering when the selected restriction is met.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><select data-mini='true' class='noselect' id='weatherRestriction'>",i=0;i<2;i++){var d=getRestriction(i);o+="<option "+(!0===d.isCurrent?"selected":"")+" value='"+i+"'>"+d.name+"</option>"}o+="</select></div>"}}if(void 0!==controller.options.wl&&(o+="<div class='ui-field-contain duration-field'><label for='o23'>"+_("% Watering")+"<button data-helptext='"+_("The watering percentage scales station run times by the set value.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button "+(controller.options.uwt&&getCurrentAdjustmentMethodId()>0?"disabled='disabled' ":"")+"data-mini='true' id='o23' value='"+controller.options.wl+"'>"+controller.options.wl+"%</button></div>"),void 0===controller.options.urs&&void 0===controller.options.sn1t||(void 0!==controller.options.fpr0?o+=void 0!==controller.options.urs?s(keyIndex.urs,controller.options.urs):void 0!==controller.options.sn1t?s(keyIndex.sn1t,controller.options.sn1t,1):"":o+="<label for='o21'><input data-mini='true' id='o21' type='checkbox' "+(1===controller.options.urs?"checked='checked'":"")+">"+_("Use Rain Sensor")+"</label>"),void 0!==controller.options.rso&&(o+="<label for='o22'><input "+(1===controller.options.urs||240===controller.options.urs?"":"data-wrapper-class='hidden' ")+"data-mini='true' id='o22' type='checkbox' "+(1===controller.options.rso?"checked='checked'":"")+">"+_("Normally Open")+"</label>"),void 0!==controller.options.sn1o&&(o+="<label for='o51'><input "+(1===controller.options.sn1t||3===controller.options.sn1t||240===controller.options.sn1t?"":"data-wrapper-class='hidden' ")+"data-mini='true' id='o51' type='checkbox' "+(1===controller.options.sn1o?"checked='checked'":"")+">"+_("Normally Open")+"</label>"),void 0!==controller.options.fpr0&&(o+="<div class='ui-field-contain"+(2===controller.options.urs||2===controller.options.sn1t?"":" hidden")+"'><label for='o41'>"+_("Flow Pulse Rate")+"</label><table><tr style='width:100%;vertical-align: top;'><td style='width:100%'><div class='ui-input-text controlgroup-textinput ui-btn ui-body-inherit ui-corner-all ui-mini ui-shadow-inset ui-input-has-clear'><input data-role='none' data-mini='true' type='number' pattern='^[-+]?[0-9]*.?[0-9]*$' id='o41' value='"+(256*controller.options.fpr1+controller.options.fpr0)/100+"'></div></td><td class='tight-select'><select id='o41-units' class='noselect' data-mini='true'><option selected='selected' value='liter'>L/pulse</option><option value='gallon'>Gal/pulse</option></select></td></tr></table></div>"),void 0!==controller.options.sn1on&&(o+="<div class='"+(1===controller.options.sn1t||3===controller.options.sn1t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o54'>"+_("Sensor 1 Delayed On Time")+"</label><button data-mini='true' id='o54' value='"+controller.options.sn1on+"'>"+controller.options.sn1on+"m</button></div>"),void 0!==controller.options.sn1of&&(o+="<div class='"+(1===controller.options.sn1t||3===controller.options.sn1t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o55'>"+_("Sensor 1 Delayed Off Time")+"</label><button data-mini='true' id='o55' value='"+controller.options.sn1of+"'>"+controller.options.sn1of+"m</button></div>"),checkOSVersion(217)&&(o+="<label id='prgswitch' class='center smaller"+(240===controller.options.urs||240===controller.options.sn1t||240===controller.options.sn2t?"":" hidden")+"'>"+_("When using program switch, a switch is connected to the sensor port to trigger Program 1 every time the switch is pressed for at least 1 second.")+"</label>"),void 0!==controller.options.sn2t&&checkOSVersion(219)&&(o+=s(keyIndex.sn2t,controller.options.sn2t,2)),void 0!==controller.options.sn2o&&(o+="<label for='o53'><input "+(1===controller.options.sn2t||3===controller.options.sn2t||240===controller.options.sn2t?"":"data-wrapper-class='hidden' ")+"data-mini='true' id='o53' type='checkbox' "+(1===controller.options.sn2o?"checked='checked'":"")+">"+_("Normally Open")+"</label>"),void 0!==controller.options.sn2on&&(o+="<div class='"+(1===controller.options.sn2t||3===controller.options.sn2t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o56'>"+_("Sensor 2 Delayed On Time")+"</label><button data-mini='true' id='o56' value='"+controller.options.sn2on+"'>"+controller.options.sn2on+"m</button></div>"),void 0!==controller.options.sn2of&&(o+="<div class='"+(1===controller.options.sn2t||3===controller.options.sn2t?"":"hidden ")+"ui-field-no-border ui-field-contain duration-field'><label for='o57'>"+_("Sensor 2 Delayed Off Time")+"</label><button data-mini='true' id='o57' value='"+controller.options.sn2of+"'>"+controller.options.sn2of+"m</button></div>"),void 0!==controller.options.sn2t&&(o+="<label id='prgswitch-2' class='center smaller"+(240===controller.options.urs||240===controller.options.sn1t||240===controller.options.sn2t?"":" hidden")+"'>"+_("When using program switch, a switch is connected to the sensor port to trigger Program 2 every time the switch is pressed for at least 1 second.")+"</label>"),void 0===controller.settings.ifkey&&void 0===controller.settings.mqtt&&void 0===controller.settings.otc||(o+="</fieldset><fieldset data-role='collapsible'"+("string"==typeof t&&"integrations"===t?" data-collapsed='false'":"")+"><legend>"+_("Integrations")+"</legend>",void 0!==controller.settings.otc&&(o+="<div class='ui-field-contain'><label for='otc'>"+_("OTC")+"<button style='display:inline-block;' data-helptext='"+_("OpenThings Cloud (OTC) allows remote access using OTC Token .")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='otc' value='"+escapeJSON(controller.settings.otc)+"'>"+_("Tap to Configure")+"</button></div>"),void 0!==controller.settings.mqtt&&(o+="<div class='ui-field-contain'><label for='mqtt'>"+_("MQTT")+"<button style='display:inline-block;' data-helptext='"+_("OpenSprinkler can send notifications to an MQTT broker at a specified host and port.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='mqtt' value='"+escapeJSON(controller.settings.mqtt)+"'>"+_("Tap to Configure")+"</button></div>"),void 0!==controller.settings.ifkey&&(o+="<div class='ui-field-contain'><label for='ifkey'>"+_("IFTTT Key")+"<button data-helptext='"+_("To enable IFTTT, a Webhooks key is required which can be obtained from https://ifttt.com")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' data-mini='true' type='text' id='ifkey' value='"+controller.settings.ifkey+"'></div>",o+="<div class='ui-field-contain'><label for='o49'>"+_("IFTTT Events")+"<button data-helptext='"+_("Select which events to send to IFTTT for use in recipes.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='o49' value='"+controller.options.ife+"'>"+_("Configure Events")+"</button></div>"),void 0!==controller.settings.dname&&(o+="<div class='ui-field-contain'><label for='dname'>"+_("Device Name")+"<button data-helptext='"+_("Device name is attached to all IFTTT notifications to help distinguish multiple devices")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' data-mini='true' type='text' id='dname' value=\""+controller.settings.dname+'"></div>')),o+="</fieldset><fieldset class='full-width-slider' data-role='collapsible'"+("string"==typeof t&&"lcd"===t?" data-collapsed='false'":"")+"><legend>"+_("LCD Screen")+"</legend>",void 0!==controller.options.con&&(o+="<div class='ui-field-contain'><label for='o27'>"+_("Contrast")+"</label><input type='range' id='o27' min='0' max='255' step='10' data-highlight='true' value='"+controller.options.con+"'></div>"),void 0!==controller.options.lit&&(o+="<div class='ui-field-contain'><label for='o28'>"+_("Brightness")+"</label><input type='range' id='o28' min='0' max='255' step='10' data-highlight='true' value='"+controller.options.lit+"'></div>"),void 0!==controller.options.dim&&(o+="<div class='ui-field-contain'><label for='o29'>"+_("Idle Brightness")+"</label><input type='range' id='o29' min='0' max='255' step='10' data-highlight='true' value='"+controller.options.dim+"'></div>"),o+="</fieldset><fieldset data-role='collapsible' data-theme='b'"+("string"==typeof t&&"advanced"===t?" data-collapsed='false'":"")+"><legend>"+_("Advanced")+"</legend>",checkOSVersion(219)&&void 0!==controller.options.uwt&&"object"==typeof controller.settings.wto&&(o+="<div class='ui-field-contain'><label for='wtkey'>"+_("Wunderground Key").replace("Wunderground","Wunder&shy;ground")+"<button data-helptext='"+_("We use DarkSky normally however with a user provided API key the weather source will switch to Weather Underground.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><table><tr style='width:100%;vertical-align: top;'><td style='width:100%'><div class='"+(controller.settings.wto.key&&""!==controller.settings.wto.key?"green ":"")+"ui-input-text controlgroup-textinput ui-btn ui-body-inherit ui-corner-all ui-mini ui-shadow-inset ui-input-has-clear'><input data-role='none' data-mini='true' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='text' id='wtkey' value='"+(controller.settings.wto.key||"")+"'><a href='#' tabindex='-1' aria-hidden='true' data-helptext='"+_("An invalid API key has been detected.")+"' class='hidden help-icon ui-input-clear ui-btn ui-icon-alert ui-btn-icon-notext ui-corner-all'></a></div></td><td><button class='noselect' data-mini='true' id='verify-api'>"+_("Verify")+"</button></td></tr></table></div>"),void 0!==controller.options.hp0&&(o+="<div class='ui-field-contain'><label for='o12'>"+_("HTTP Port (restart required)")+"</label><input data-mini='true' type='number' pattern='[0-9]*' id='o12' value='"+(256*controller.options.hp1+controller.options.hp0)+"'></div>"),void 0!==controller.options.devid&&(o+="<div class='ui-field-contain'><label for='o26'>"+_("Device ID (restart required)")+"<button data-helptext='"+_("Device ID modifies the last byte of the MAC address.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><input data-mini='true' type='number' pattern='[0-9]*' max='255' id='o26' value='"+controller.options.devid+"'></div>"),void 0!==controller.options.rlp?o+="<div class='ui-field-contain duration-field'><label for='o30'>"+_("Relay Pulse")+"<button data-helptext='"+_("Relay pulsing is used for special situations where rapid pulsing is needed in the output with a range from 1 to 2000 milliseconds. A zero value disables the pulsing option.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='o30' value='"+controller.options.rlp+"'>"+controller.options.rlp+"ms</button></div>":!0!==checkOSVersion(215)&&void 0!==controller.options.bst&&(o+="<div class='ui-field-contain duration-field'><label for='o30'>"+_("Boost Time")+"<button data-helptext='"+_("Boost time changes how long the boost converter is activated with a range from 0 to 1000 milliseconds.")+"' class='help-icon btn-no-border ui-btn ui-icon-info ui-btn-icon-notext'></button></label><button data-mini='true' id='o30' value='"+controller.options.bst+"'>"+controller.options.bst+"ms</button></div>"),void 0!==controller.options.ntp&&checkOSVersion(210)){var u=[controller.options.ntp1,controller.options.ntp2,controller.options.ntp3,controller.options.ntp4].join(".");o+="<div class='"+(1===controller.options.ntp?"":"hidden ")+"ui-field-contain duration-field'><label for='ntp_addr'>"+_("NTP IP Address")+"</label><button data-mini='true' id='ntp_addr' value='"+u+"'>"+u+"</button></div>"}if(void 0!==controller.options.dhcp&&checkOSVersion(210)){var h=[controller.options.ip1,controller.options.ip2,controller.options.ip3,controller.options.ip4].join("."),p=[controller.options.gw1,controller.options.gw2,controller.options.gw3,controller.options.gw4].join(".");if(o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='ip_addr'>"+_("IP Address")+"</label><button data-mini='true' id='ip_addr' value='"+h+"'>"+h+"</button></div>",o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='gateway'>"+_("Gateway Address")+"</label><button data-mini='true' id='gateway' value='"+p+"'>"+p+"</button></div>",void 0!==controller.options.subn1){var f=[controller.options.subn1,controller.options.subn2,controller.options.subn3,controller.options.subn4].join(".");o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='subnet'>"+_("Subnet Mask")+"</label><button data-mini='true' id='subnet' value='"+f+"'>"+f+"</button></div>"}if(void 0!==controller.options.dns1){var m=[controller.options.dns1,controller.options.dns2,controller.options.dns3,controller.options.dns4].join(".");o+="<div class='"+(1===controller.options.dhcp?"hidden ":"")+"ui-field-contain duration-field'><label for='dns'>"+_("DNS Address")+"</label><button data-mini='true' id='dns' value='"+m+"'>"+m+"</button></div>"}o+="<label for='o3'><input data-mini='true' id='o3' type='checkbox' "+(1===controller.options.dhcp?"checked='checked'":"")+">"+_("Use DHCP (restart required)")+"</label>"}void 0!==controller.options.ntp&&(o+="<label for='o2'><input data-mini='true' id='o2' type='checkbox' "+(1===controller.options.ntp?"checked='checked'":"")+">"+_("NTP Sync")+"</label>"),void 0!==controller.options.ar&&(o+="<label for='o14'><input data-mini='true' id='o14' type='checkbox' "+(1===controller.options.ar?"checked='checked'":"")+">"+_("Auto Reconnect")+"</label>"),void 0!==controller.options.ipas&&(o+="<label for='o25'><input data-mini='true' id='o25' type='checkbox' "+(1===controller.options.ipas?"checked='checked'":"")+">"+_("Ignore Password")+"</label>"),void 0!==controller.options.sar&&(o+="<label for='o48'><input data-mini='true' id='o48' type='checkbox' "+(1===controller.options.sar?"checked='checked'":"")+">"+_("Special Station Auto-Refresh")+"</label>"),o+="</fieldset><fieldset data-role='collapsible' data-theme='b'"+("string"==typeof t&&"reset"===t?" data-collapsed='false'":"")+"><legend>"+_("Reset")+"</legend>",o+="<button data-mini='true' class='center-div reset-log'>"+_("Clear Log Data")+"</button>",o+="<button data-mini='true' class='center-div reset-options'>"+_("Reset All Options")+"</button>",o+="<button data-mini='true' class='center-div reset-programs'>"+_("Delete All Programs")+"</button>",o+="<button data-mini='true' class='center-div reset-stations'>"+_("Reset Station Attributes")+"</button>",controller.options.hwv>=30&&controller.options.hwv<40&&(o+="<hr class='divider'><button data-mini='true' class='center-div reset-wireless'>"+_("Reset Wireless Settings")+"</button>"),o+="</fieldset>",a.find("#os-options-list").html(o).one("change input",":not(.noselect)",(function(){l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges")})).find("fieldset").each((function(){var t=$(this);1===t.children().length&&t.remove()})),a.find(".clear-loc").on("click",(function(t){t.stopImmediatePropagation(),areYouSure(_("Are you sure you want to clear the current location?"),"",(function(){a.find("#loc").val("''").removeClass("green").find("span").text(_("Not specified")),a.find("#o1").selectmenu("enable"),l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges")}))})),a.find("#showDisabled").on("change",(function(){return storage.set({showDisabled:this.checked}),!1})),a.find("#loc").on("click",(function(){var t=$(this);t.prop("disabled",!0),overlayMap((function(e,n){if(!1===e)""===t.val()&&(t.removeClass("green"),a.find("#o1").selectmenu("enable"));else{if(checkOSVersion(210)&&a.find("#o1").selectmenu("disable"),"string"==typeof e)t.val(e).find("span").text(e);else{e[0]=parseFloat(e[0]).toFixed(5),e[1]=parseFloat(e[1]).toFixed(5),"string"==typeof n&&validateWULocation(n,(function(e){e?t.addClass("green"):e||t.removeClass("green")}));var i=a.find("#wto");i&&void 0!==i.val()&&i.val(escapeJSON($.extend({},unescapeJSON(i.val()),{pws:n||""}))),t.val(e),coordsToLocation(e[0],e[1],(function(e){t.find("span").text(e)}))}l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges")}t.prop("disabled",!1)}))})),a.find("#wto").on("click",(function(){var t=this,e=unescapeJSON(this.value),n={pws:e.pws,key:e.key},i=parseInt(a.find("#o31").val()),o=function(){t.value=escapeJSON($.extend({},unescapeJSON(t.value),n)),l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges")};1===i?showZimmermanAdjustmentOptions(this,o):2===i?showAutoRainDelayAdjustmentOptions(this,o):3===i?showEToAdjustmentOptions(this,o):4===i&&showMonthlyAdjustmentOptions(this,o)})),a.find(".reset-log").on("click",clearLogs),a.find(".reset-programs").on("click",clearPrograms),a.find(".reset-options").on("click",(function(){resetAllOptions((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Settings have been saved"))})),goBack()}))})),a.find(".reset-stations").on("click",(function(){var t,e="";if(Supported.groups())for(t=0;t<controller.stations.snames.length;t++)e+="g"+t+"=0&";if(void 0!==controller.options.mas)for(t=0;t<controller.settings.nbrd;t++)e+="m"+t+"=255&";if(void 0!==controller.options.mas2)for(t=0;t<controller.settings.nbrd;t++)e+="n"+t+"=0&";if("object"==typeof controller.stations.ignore_rain)for(t=0;t<controller.settings.nbrd;t++)e+="i"+t+"=0&";if("object"==typeof controller.stations.ignore_sn1)for(t=0;t<controller.settings.nbrd;t++)e+="j"+t+"=0&";if("object"==typeof controller.stations.ignore_sn2)for(t=0;t<controller.settings.nbrd;t++)e+="k"+t+"=0&";if("object"==typeof controller.stations.act_relay)for(t=0;t<controller.settings.nbrd;t++)e+="a"+t+"=0&";if("object"==typeof controller.stations.stn_dis)for(t=0;t<controller.settings.nbrd;t++)e+="d"+t+"=0&";if("object"==typeof controller.stations.stn_seq)for(t=0;t<controller.settings.nbrd;t++)e+="q"+t+"=255&";if("object"==typeof controller.stations.stn_spe)for(t=0;t<controller.settings.nbrd;t++)e+="p"+t+"=0&";areYouSure(_("Are you sure you want to reset station attributes?"),_("This will reset all station attributes"),(function(){$.mobile.loading("show"),storage.get(["sites","current_site"],(function(t){var e=parseSites(t.sites);e[t.current_site].notes={},e[t.current_site].images={},e[t.current_site].lastRunTime={},storage.set({sites:JSON.stringify(e)},cloudSaveSites)})),sendToOS("/cs?pw=&"+e).done((function(){showerror(_("Stations have been updated")),updateController()}))}))})),a.find(".reset-wireless").on("click",(function(){areYouSure(_("Are you sure you want to reset the wireless settings?"),_("This will delete the stored SSID/password for your wireless network and return the device to access point mode"),(function(){sendToOS("/cv?pw=&ap=1").done((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Wireless settings have been reset. Please follow the OpenSprinkler user manual on restoring connectivity."))})),goBack()}))}))})),a.find("#o3").on("change",(function(){var t=$(this).is(":checked"),e=a.find("#ip_addr,#gateway,#dns,#subnet").parents(".ui-field-contain");t?e.addClass("hidden"):e.removeClass("hidden")})),a.find(".sensor-options input[type='radio']").on("change",(function(){var t=this.value,e=parseInt(this.id.match(/o(\d+)/)[1],10);"2"===t?a.find("#o41").parents(".ui-field-contain").removeClass("hidden"):21!==e&&50!==e||a.find("#o41").parents(".ui-field-contain").addClass("hidden"),"1"===t||"3"===t||"240"===t?a.find("#o"+(e+1)).parent().removeClass("hidden"):a.find("#o"+(e+1)).parent().addClass("hidden"),"240"===$("input[name='o21'][type='radio']:checked").val()||"240"===$("input[name='o50'][type='radio']:checked").val()?a.find("#prgswitch").removeClass("hidden"):a.find("#prgswitch").addClass("hidden"),"240"===$("input[name='o52'][type='radio']:checked").val()?a.find("#prgswitch-2").removeClass("hidden"):a.find("#prgswitch-2").addClass("hidden"),"1"===t||"3"===t?a.find("#o"+(e+4)+",#o"+(e+5)).parent().removeClass("hidden"):a.find("#o"+(e+4)+",#o"+(e+5)).parent().addClass("hidden")})),a.find("#o21").on("change",(function(){a.find("#o22").parent().toggleClass("hidden",$(this).is(":checked"))})),a.find("#verify-api").on("click",(function(){var t=a.find("#wtkey"),e=$(this);e.prop("disabled",!0),testAPIKey(t.val(),(function(n){!0===n?(t.parent().find(".ui-icon-alert").hide(),t.parent().removeClass("red").addClass("green")):(t.parent().find(".ui-icon-alert").removeClass("hidden").show(),t.parent().removeClass("green").addClass("red")),e.prop("disabled",!1)}))})),a.find(".help-icon").on("click",showHelpText),a.find(".duration-field button:not(.help-icon)").on("click",(function(){var t=$(this),e=t.attr("id"),n=a.find("label[for='"+e+"']").text(),i=t.parent().find(".help-icon").data("helptext"),o=240;if(l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges"),"ip_addr"===e||"gateway"===e||"dns"===e||"ntp_addr"===e||"subnet"===e)showIPRequest({title:n,ip:t.val().split("."),callback:function(e){t.val(e.join(".")).text(e.join("."))}});else if("o19"===e||"o38"===e)showSingleDurationInput({data:t.val(),title:n,callback:function(e){t.val(e).text(e+"s")},label:_("Seconds"),maximum:checkOSVersion(220)?600:60,minimum:checkOSVersion(220)?-600:0,helptext:i});else if("o30"===e)showSingleDurationInput({data:t.val(),title:n,callback:function(e){t.val(e).text(e+"ms")},label:_("Milliseconds"),maximum:2e3,helptext:i});else if("o20"===e||"o39"===e)showSingleDurationInput({data:t.val(),title:n,callback:function(e){t.val(e).text(e+"s")},label:_("Seconds"),maximum:checkOSVersion(220)?600:0,minimum:checkOSVersion(220)?-600:-60,helptext:i});else if("o23"===e)showSingleDurationInput({data:t.val(),title:n,callback:function(e){t.val(e).text(e+"%")},label:_("% Watering"),maximum:250,helptext:i});else if("o17"===e){var s=0;checkOSVersion(210)&&(o=checkOSVersion(214)?57600:64800),checkOSVersion(211)&&(s=-3540,o=3540),checkOSVersion(217)&&(s=-600,o=600),showSingleDurationInput({data:t.val(),title:n,label:_("Seconds"),callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e)))},maximum:o,minimum:s})}else"o54"!==e&&"o55"!==e&&"o56"!==e&&"o57"!==e||showSingleDurationInput({data:t.val(),title:n,callback:function(e){t.val(e).text(e+"m")},label:_("Minutes"),maximum:240,minimum:0,helptext:i});return!1})),a.find("#o2").on("change",(function(){var t=$(this).is(":checked");a.find(".datetime-input button").prop("disabled",t),a.find("#ntp_addr").parents(".ui-field-contain").toggleClass("hidden",!t)})),a.find("#o18,#o37").on("change",(function(){a.find("#o19,#o20").parents(".ui-field-contain").toggle(0!==parseInt(a.find("#o18").val())),void 0!==controller.options.mas2&&a.find("#o38,#o39").parents(".ui-field-contain").toggle(0!==parseInt(a.find("#o37").val()))})),a.find("#o31").on("change",(function(){a.find("#o23").prop("disabled",0!==parseInt(this.value)),a.find("#wto").click().parents(".ui-field-contain").toggleClass("hidden",0===parseInt(this.value))})),a.find("#wtkey").on("change input",(function(){a.find("#wtkey").siblings(".help-icon").hide(),a.find("#wtkey").parent().removeClass("red green")})),a.find("#o49").on("click",(function(){var t={program:_("Program Start"),sensor1:_("Sensor 1 Update"),flow:_("Flow Sensor Update"),weather:_("Weather Adjustment Update"),reboot:_("Controller Reboot"),run:_("Station Run"),sensor2:_("Sensor 2 Update"),rain:_("Rain Delay Update")},e=this,n=parseInt(e.value),i="",o=0,s=0;$.each(t,(function(t,e){i+="<label for='ifttt-"+t+"'><input class='needsclick' data-iconpos='right' id='ifttt-"+t+"' type='checkbox' "+(getBitFromByte(n,o)?"checked='checked'":"")+">"+e+"</label>",o++}));var r=$("<div data-role='popup' data-theme='a'><div data-role='controlgroup' data-mini='true' class='tight'><div class='ui-bar ui-bar-a'>"+_("Select IFTTT Events")+"</div>"+i+"<input data-wrapper-class='attrib-submit' class='submit' data-theme='b' type='submit' value='"+_("Submit")+"' /></div></div>");r.find(".submit").on("click",(function(){o=0,$.each(t,(function(t){s|=r.find("#ifttt-"+t).is(":checked")<<o,o++})),r.popup("close"),n!==s&&(e.value=s,l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges"))})),openPopup(r)})),a.find("#mqtt").on("click",(function(){var t=this,e=t.value,n=$.extend({},{en:0,host:"server",port:1883,user:"",pass:""},unescapeJSON(e));$(".ui-popup-active").find("[data-role='popup']").popup("close");var i=$("<div data-role='popup' data-theme='a' id='mqttSettings'><div data-role='header' data-theme='b'><h1>"+_("MQTT Settings")+"</h1></div><div class='ui-content'><label for='enable'>"+_("Enable")+"</label><input class='needsclick mqtt_enable' data-mini='true' data-iconpos='right' id='enable' type='checkbox' "+(n.en?"checked='checked'":"")+"><div class='ui-body'><div class='ui-grid-a' style='display:table;'><div class='ui-block-a' style='width:40%'><label for='server' style='padding-top:10px'>"+_("Broker/Server")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='text' id='server' data-mini='true' maxlength='50' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(n.en?"":"disabled='disabled'")+" placeholder='"+_("broker/server")+"' value='"+n.host+"' required /></div><div class='ui-block-a' style='width:40%'><label for='port' style='padding-top:10px'>"+_("Port")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='number' id='port' data-mini='true' pattern='[0-9]*' min='0' max='65535'"+(n.en?"":"disabled='disabled'")+" placeholder='1883' value='"+n.port+"' required /></div><div class='ui-block-a' style='width:40%'><label for='username' style='padding-top:10px'>"+_("Username")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='text' id='username' data-mini='true' maxlength='32' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(n.en?"":"disabled='disabled'")+" placeholder='"+_("username (optional)")+"' value='"+n.user+"' required /></div><div class='ui-block-a' style='width:40%'><label for='password' style='padding-top:10px'>"+_("Password")+"</label></div><div class='ui-block-b' style='width:60%'><input class='mqtt-input' type='password' id='password' data-mini='true' maxlength='32' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(n.en?"":"disabled='disabled'")+" placeholder='"+_("password (optional)")+"' value='"+n.pass+"' required /></div></div></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");i.find("#enable").on("change",(function(){this.checked?i.find(".mqtt-input").textinput("enable"):i.find(".mqtt-input").textinput("disable")})),i.find(".submit").on("click",(function(){var n={en:i.find("#enable").prop("checked")?1:0,host:i.find("#server").val(),port:parseInt(i.find("#port").val()),user:i.find("#username").val(),pass:i.find("#password").val()};i.popup("close"),e!==escapeJSON(n)&&(t.value=escapeJSON(n),l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges"))})),i.css("max-width","380px"),openPopup(i,{positionTo:"window"})})),a.find("#otc").on("click",(function(){var t=this,e=t.value,n=$.extend({},{en:0,token:"",server:"ws.cloud.openthings.io",port:80},unescapeJSON(e));$(".ui-popup-active").find("[data-role='popup']").popup("close");var i=$("<div data-role='popup' data-theme='a' id='otcSettings'><div data-role='header' data-theme='b'><h1>"+_("OpenThings Cloud (OTC) Settings")+"</h1></div><div class='ui-content'><label for='enable'>"+_("Enable")+"</label><input class='needsclick otc_enable' data-mini='true' data-iconpos='right' id='enable' type='checkbox' "+(n.en?"checked='checked'":"")+"><div class='ui-body'><div class='ui-grid-a' style='display:table;'><div class='ui-block-a' style='width:25%'><label for='token' style='padding-top:10px'>"+_("Token")+"</label></div><div class='ui-block-b' style='width:75%'><input class='otc-input' type='text' id='token' data-mini='true' maxlength='36' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(n.en?"":"disabled='disabled'")+" placeholder='"+_("token")+"' value='"+n.token+"' required /></div><div class='ui-block-a' style='width:25%'><label for='server' style='padding-top:10px'>"+_("Server")+"</label></div><div class='ui-block-b' style='width:75%'><input class='otc-input' type='text' id='server' data-mini='true' maxlength='50' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'"+(n.en?"":"disabled='disabled'")+" placeholder='"+_("server")+"' value='"+n.server+"' required /></div><div class='ui-block-a' style='width:25%'><label for='port' style='padding-top:10px'>"+_("Port")+"</label></div><div class='ui-block-b' style='width:75%'><input class='otc-input' type='number' id='port' data-mini='true' pattern='[0-9]*' min='0' max='65535'"+(n.en?"":"disabled='disabled'")+" placeholder='80' value='"+n.port+"' required /></div></div></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>");i.find("#enable").on("change",(function(){this.checked?i.find(".otc-input").textinput("enable"):i.find(".otc-input").textinput("disable")})),i.find(".submit").on("click",(function(){if(i.find("#enable").prop("checked")&&32!==i.find("#token").val().length)showerror(_("OpenThings Token must be 32 characters long."));else{var n={en:i.find("#enable").prop("checked")?1:0,token:i.find("#token").val(),server:i.find("#server").val(),port:parseInt(i.find("#port").val())};i.popup("close"),e!==escapeJSON(n)&&(t.value=escapeJSON(n),l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges"))}})),i.css("max-width","380px"),openPopup(i,{positionTo:"window"})})),a.find(".datetime-input").on("click",(function(){var t=$(this).find("button");if(!t.prop("disabled"))return l.eq(2).prop("disabled",!1),a.find(".submit").addClass("hasChanges"),showDateTimeInput(t.val(),(function(e){t.text(dateToString(e).slice(0,-3)).val(Math.round(e.getTime()/1e3))})),!1})),a.one("pagehide",(function(){a.remove()})),l.eq(2).prop("disabled",!0),$("#os-options").remove(),$.mobile.pageContainer.append(a)}var showHomeMenu=function(){var t,e,n,i;return function(o){o=o instanceof $?o:$(o),$(".ui-popup-active").find("[data-role='popup']").popup("close"),t=$(".ui-page-active"),e=t.attr("id"),n=t.hasClass("show-hidden"),(i=$("<div data-role='popup' data-theme='a' id='mainMenu'><ul data-role='listview' data-inset='true' data-corners='false'><li data-role='list-divider'>"+_("Information")+"</li><li><a href='#preview' class='squeeze'>"+_("Preview Programs")+"</a></li>"+(checkOSVersion(206)||checkOSPiVersion("1.9")?"<li><a href='#logs'>"+_("View Logs")+"</a></li>":"")+"<li data-role='list-divider'>"+_("Programs and Settings")+"</li><li><a href='#raindelay'>"+_("Change Rain Delay")+"</a></li>"+(Supported.pausing()?StationQueue.isPaused()?"<li><a href='#globalpause'>"+_("Resume Station Runs")+"</a></li>":StationQueue.isActive()>=-1?"<li><a href='#globalpause'>"+_("Pause Station Runs")+"</a></li>":"":"")+"<li><a href='#runonce'>"+_("Run-Once Program")+"</a></li><li><a href='#programs'>"+_("Edit Programs")+"</a></li><li><a href='#os-options'>"+_("Edit Options")+"</a></li>"+(checkOSVersion(230)?"<li><a href='#analogsensorconfig'>"+_("Analog Sensor Config")+"</a></li><li><a href='#analogsensorchart'>"+_("Show Sensor Log")+"</a></li>":"")+(checkOSVersion(210)?"":"<li><a href='#manual'>"+_("Manual Control")+"</a></li>")+("sprinklers"===e||"runonce"===e||"programs"===e||"manual"===e||"addprogram"===e?"</ul><div class='ui-grid-a ui-mini tight'><div class='ui-block-a'><a class='ui-btn tight' href='#show-hidden'>"+_(n?"Hide":"Show")+" "+_("Disabled")+"</a></div><div class='ui-block-b'><a class='ui-btn red tight' href='#stop-all'>"+_("Stop All Stations")+"</a></div></div>":"<li><a class='ui-btn red' href='#stop-all'>"+_("Stop All Stations")+"</a></li></ul>")+"</div>")).on("click","a",(function(){var e=$(this).attr("href");return i.popup("close"),"#stop-all"===e?stopAllStations():"#show-hidden"===e?n?($(".station-hidden").hide(),t.removeClass("show-hidden")):($(".station-hidden").show(),t.addClass("show-hidden")):"#raindelay"===e?showRainDelay():"#globalpause"===e?showPause():checkChanges((function(){changePage(e)})),!1})),$("#mainMenu").remove(),i.one("popupafterclose",(function(){o.show()})),openPopup(i,{positionTo:o}),o.hide()}}(),showHome=function(){var t,e,n,i,o,a=$("<div data-role='page' id='sprinklers'><div class='ui-panel-wrapper'><div class='ui-content' role='main'><div class='ui-grid-a ui-body ui-corner-all info-card noweather'><div class='ui-block-a'><div id='weather' class='pointer'></div></div><div class='ui-block-b center home-info pointer'><div class='sitename bold'></div><div id='clock-s' class='nobr'></div>"+_("Water Level")+": <span class='waterlevel'></span>%</div></div><div id='os-stations-list' class='card-group center'></div><div id='os-sensor-show' class='card-group center'></div></div></div></div>"),s=function(t,e){timers["station-"+t]={val:e,station:t,update:function(){a.find("#countdown-"+t).text("("+sec2hms(this.val)+" "+_("remaining")+")")},done:function(){a.find("#countdown-"+t).parent("p").empty().siblings(".station-status").removeClass("on").addClass("off")}}},r=function(e){var i=Station.getName(e),a=Station.getPID(e)>0,r=Station.isRunning(e),l=a?pidname(Station.getPID(e)):"",c=Station.getRemainingRuntime(e),d=Supported.pausing()&&StationQueue.isPaused(),u=!!o[n].images[e];Station.getStatus(e)&&c>0&&s(e,c),t+="<div data-station='"+e+"' class='ui-corner-all card"+(Station.isDisabled(e)?" station-hidden' style='display:none":"")+"'>",t+="<div class='ui-body ui-body-a center'>",t+="<img src='"+(u?"data:image/jpeg;base64,"+o[n].images[e]:getAppURLPath()+"img/placeholder.png")+"' />",t+="<p class='station-name center inline-icon' id='station_"+e+"'>"+i+"</p>",t+="<span class='btn-no-border ui-btn ui-btn-icon-notext ui-corner-all card-icon station-status "+(r?"on":a?"wait":"off")+"'></span>",t+="<span class='btn-no-border ui-btn ui-btn-icon-notext ui-icon-wifi card-icon special-station "+(Station.isSpecial(e)?"":"hidden")+"'></span>",Supported.groups()&&(t+="<span class='btn-no-border ui-btn card-icon station-gid "+(Station.isMaster(e)?"hidden":"")+"'>"+mapGIDValueToName(Station.getGIDValue(e))+"</span>"),t+="<span class='btn-no-border ui-btn "+(Station.isMaster(e)?"ui-icon-master":"ui-icon-gear")+" card-icon ui-btn-icon-notext station-settings' data-station='"+e+"' id='attrib-"+e+"' "+(Supported.master(MASTER_STATION_1)?"data-um='"+StationAttribute.getMasterOperation(e,MASTER_STATION_1)+"' ":"")+(Supported.master(MASTER_STATION_2)?"data-um2='"+StationAttribute.getMasterOperation(e,MASTER_STATION_2)+"' ":"")+(Supported.ignoreRain()?"data-ir='"+StationAttribute.getIgnoreRain(e)+"' ":"")+(Supported.ignoreSensor(IGNORE_SENSOR_1)?"data-sn1='"+StationAttribute.getIgnoreSensor(e,IGNORE_SENSOR_1)+"' ":"")+(Supported.ignoreSensor(IGNORE_SENSOR_2)?"data-sn2='"+StationAttribute.getIgnoreSensor(e,IGNORE_SENSOR_2)+"' ":"")+(Supported.actRelay()?"data-ar='"+StationAttribute.getActRelay(e)+"' ":"")+(Supported.disabled()?"data-sd='"+StationAttribute.getDisabled(e)+"' ":"")+(Supported.sequential()?"data-us='"+StationAttribute.getSequential(e)+"' ":"")+(Supported.special()?"data-hs='"+StationAttribute.getSpecial(e)+"' ":"")+(Supported.groups()?"data-gid='"+Station.getGIDValue(e)+"' ":"")+"></span>",Station.isMaster(e)||(a||r)&&(t+="<p class='rem center'>"+(r?_("Running")+" "+l:_("Scheduled")+" "+(Station.getStartTime(e)?_("for")+" "+dateToString(new Date(1e3*Station.getStartTime(e))):l)),c>0&&(t+=" <span id="+(d?"'pause":"'countdown-")+e+"' class='nobr'>("+sec2hms(c)+" "+_("remaining")+")</span>"),t+="</p>"),t+="</div><hr style='display:none' class='content-divider'"+(Supported.groups()?"divider-gid="+Station.getGIDValue(e):"")+"></div>"},l=function(){$("#stn_attrib").popup("destroy").remove();var t=$(this),e=t.data("station"),i=t.siblings("[id='station_"+e+"']"),a=function(){var t=r.find("#http-server").val()+","+r.find("#http-port").val()+","+r.find("#http-on").val()+","+r.find("#http-off").val(),e=encodeURIComponent(t).length;r.find("#character-count").text(240-e),e>240?(r.find(".attrib-submit").addClass("ui-disabled"),r.find("#character-tracking").addClass("red-text bold")):(r.find(".attrib-submit").removeClass("ui-disabled"),r.find("#character-tracking").removeClass("red-text bold"))},s=function(a){var l=parseInt(r.find("#hs").val());if(t.data("hs",l),1===l)t.data("specialData",r.find("#rf-code").val());else if(2===l){for(var d=r.find("#remote-address").val().split("."),u=parseInt(r.find("#remote-port").val())||80,h=(r.find("#remote-station").val()||1)-1,p="",f=0;f<4;f++)p+=pad(parseInt(d[f]).toString(16));if(p+=(u<256?"00":"")+pad(u.toString(16)),p+=pad(h.toString(16)),!0!==a)return $.mobile.loading("show"),r.find(".attrib-submit").addClass("ui-disabled"),void verifyRemoteStation(p,(function(t){var e;if(!0!==t){!1===t||-1===t?e=_("Unable to reach the remote station."):-2===t?e=_("Password on remote controller does not match the password on this controller."):-3===t&&(e=_("Remote controller is not configured as an extender. Would you like to do this now?")),r.one("popupafterclose",(function(){$.mobile.loading("hide"),n.css("opacity","")})),$.mobile.loading("show",{html:"<h1>"+e+"</h1><button class='ui-btn cancel'>"+_("Cancel")+"</button><button class='ui-btn continue'>"+_("Continue")+"</button>",textVisible:!0,theme:"b"});var n=$(".ui-loader");n.css("opacity",".96"),n.find(".cancel").one("click",(function(){$.mobile.loading("hide"),n.css("opacity","")})),n.find(".continue").one("click",(function(){$.mobile.loading("hide"),n.css("opacity",""),-3===t&&convertRemoteToExtender(p),s(!0)})),r.find(".attrib-submit").removeClass("ui-disabled")}else s(!0)}));t.data("specialData",p)}else if(3===l){var m=pad(r.find("#gpio-pin").val()||"05");m+=r.find("#active-state").val()||"1",t.data("specialData",m)}else if(4===l){var g=r.find("#http-server").val();g+=","+r.find("#http-port").val(),g+=","+r.find("#http-on").val(),g+=","+r.find("#http-off").val(),t.data("specialData",g)}t.data("um",r.find("#um").is(":checked")?1:0),t.data("um2",r.find("#um2").is(":checked")?1:0),t.data("ir",r.find("#ir").is(":checked")?1:0),t.data("sn1",r.find("#sn1").is(":checked")?1:0),t.data("sn2",r.find("#sn2").is(":checked")?1:0),t.data("ar",r.find("#ar").is(":checked")?1:0),t.data("sd",r.find("#sd").is(":checked")?1:0),t.data("us",r.find("#us").is(":checked")?1:0),i.html(r.find("#stn-name").val());var v=r.find("span.seqgrp").text();t.attr("data-gid",mapGIDNameToValue(v)),o[n].notes[e]=r.find("#stn-notes").val(),storage.set({sites:JSON.stringify(o)},cloudSaveSites),c(e),r.popup("destroy").remove()},r="<div data-overlay-theme='b' data-role='popup' data-theme='a' id='stn_attrib'><fieldset style='margin:0' data-mini='true' data-corners='false' data-role='controlgroup'><form><div id='station-tabs'>";if("number"!=typeof e)return!1;if(Supported.special()&&(r+="<ul class='tabs'><li class='current' data-tab='tab-basic'>"+_("Basic")+"</li><li data-tab='tab-advanced'>"+_("Advanced")+"</li></ul>"),r+="<div id='tab-basic' class='tab-content current'>",r+="<div class='ui-bar-a ui-bar'>"+_("Station Name")+":</div><input class='bold center' data-corners='false' data-wrapper-class='tight stn-name ui-btn' id='stn-name' type='text' value=\""+i.text()+'">',void 0!==navigator.camera&&"function"==typeof navigator.camera.getPicture&&(r+="<button class='changeBackground'>"+("string"!=typeof o[n].images[e]?_("Add"):_("Change"))+" "+_("Image")+"</button>"),Station.isMaster(e)||(Supported.master(MASTER_STATION_1)&&(r+="<label for='um'><input class='needsclick' data-iconpos='right' id='um' type='checkbox' "+(1===t.data("um")?"checked='checked'":"")+">"+_("Use Master")+" "+(Supported.master(MASTER_STATION_2)?"1":"")+"</label>"),Supported.master(MASTER_STATION_2)&&(r+="<label for='um2'><input class='needsclick' data-iconpos='right' id='um2' type='checkbox' "+(1===t.data("um2")?"checked='checked'":"")+">"+_("Use Master")+" 2</label>"),Supported.ignoreRain()&&(r+="<label for='ir'><input class='needsclick' data-iconpos='right' id='ir' type='checkbox' "+(1===t.data("ir")?"checked='checked'":"")+">"+_("Ignore Rain")+"</label>"),Supported.ignoreSensor(IGNORE_SENSOR_1)&&(r+="<label for='sn1'><input class='needsclick' data-iconpos='right' id='sn1' type='checkbox' "+(1===t.data("sn1")?"checked='checked'":"")+">"+_("Ignore Sensor 1")+"</label>"),Supported.ignoreSensor(IGNORE_SENSOR_2)&&(r+="<label for='sn2'><input class='needsclick' data-iconpos='right' id='sn2' type='checkbox' "+(1===t.data("sn2")?"checked='checked'":"")+">"+_("Ignore Sensor 2")+"</label>"),Supported.actRelay()&&(r+="<label for='ar'><input class='needsclick' data-iconpos='right' id='ar' type='checkbox' "+(1===t.data("ar")?"checked='checked'":"")+">"+_("Activate Relay")+"</label>"),Supported.disabled()&&(r+="<label for='sd'><input class='needsclick' data-iconpos='right' id='sd' type='checkbox' "+(1===t.data("sd")?"checked='checked'":"")+">"+_("Disable")+"</label>"),Supported.sequential()&&!Supported.groups()&&(r+="<label for='us'><input class='needsclick' data-iconpos='right' id='us' type='checkbox' "+(1===t.data("us")?"checked='checked'":"")+">"+_("Sequential")+"</label>")),r+="<div class='ui-bar-a ui-bar'>"+_("Station Notes")+":</div><textarea data-corners='false' class='tight stn-notes' id='stn-notes'>"+(o[n].notes[e]?o[n].notes[e]:"")+"</textarea>",r+="</div>",r+="<div id='tab-advanced' class='tab-content'>",Supported.groups()&&!Station.isMaster(e)&&(r+="<div class='ui-bar-a ui-bar seq-container'>"+_("Sequential Group")+":</div><select id='gid' class='seqgrp' data-mini='true'></select><div><p id='prohibit-change' class='center hidden' style='color: #ff0033;'>Changing group designation is prohibited while station is running</p></div>"),Supported.special()&&(r+="<div class='ui-bar-a ui-bar'>"+_("Station Type")+":</div><select data-mini='true' id='hs'"+(Station.isSpecial(e)?" class='ui-disabled'":"")+"><option data-hs='0' value='0'"+(Station.isSpecial(e)?"":"selected")+">"+_("Standard")+"</option><option data-hs='1' value='1'>"+_("RF")+"</option><option data-hs='2' value='2'>"+_("Remote")+"</option><option data-hs='3' value='3'"+(checkOSVersion(217)&&(void 0!==controller.settings.gpio&&controller.settings.gpio.length>0||"OSPi"===getHWVersion()||"2.3"===getHWVersion())?">":" disabled>")+_("GPIO")+"</option><option data-hs='4' value='4'"+(checkOSVersion(217)?">":" disabled>")+_("HTTP")+"</option></select><div id='specialOpts'></div>"),r+="</div>",r+="<input data-wrapper-class='attrib-submit' data-theme='b' type='submit' value='"+_("Submit")+"' /></form></fieldset></div>",r=$(r).enhanceWithin().on("submit","form",(function(){return s(e),!1})),Supported.groups()){var l=r.find("select.seqgrp"),d=r.find("span.seqgrp"),u=Station.getGIDValue(e),h=Station.isRunning(e),p=r.find("p#prohibit-change");h?(l.addClass("ui-state-disabled"),p.removeClass("hidden")):(l.removeClass("ui-state-disabled"),p.addClass("hidden"));for(var m=0;m<=NUM_SEQ_GROUPS;m++){var g=mapIndexToGIDValue(m),v=mapGIDValueToName(g),b=$("<option data-gid='"+g+"' value='"+g+"'>"+_(v)+"</option>");g===u?(b.prop("selected",!0),d.text(v)):b.prop("selected",!1),l.append(b)}}r.find("ul.tabs li").click((function(){var t=$(this).attr("data-tab");$("ul.tabs li").removeClass("current"),$(".tab-content").removeClass("current"),$(this).addClass("current"),$("#"+t).addClass("current")})),r.find("#hs").on("change",(function(){return function(t){var n=r.find("#specialOpts"),i=controller.special&&controller.special.hasOwnProperty(e)?controller.special[e].sd:"",o=controller.special&&controller.special.hasOwnProperty(e)?controller.special[e].st:0;if(n.empty(),0===t)n.append("<p class='special-desc center small'>"+_("Select the station type using the dropdown selector above and configure the station properties.")+"</p>").enhanceWithin();else if(1===t)i=o===t?i:"0000000000000000",n.append("<div class='ui-bar-a ui-bar'>"+_("RF Code")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='rf-code' required='true' type='text' value='"+i+"'>").enhanceWithin();else if(2===t)i=parseRemoteStationData(o===t?i:"00000000005000"),n.append("<div class='ui-bar-a ui-bar'>"+_("Remote Address")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='remote-address' required='true' type='text' pattern='^(?:[0-9]{1,3}.){3}[0-9]{1,3}$' value='"+i.ip+"'><div class='ui-bar-a ui-bar'>"+_("Remote Port")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='remote-port' required='true' type='number' placeholder='80' min='0' max='65535' value='"+i.port+"'><div class='ui-bar-a ui-bar'>"+_("Remote Station (index)")+":</div><input class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='remote-station' required='true' type='number' min='1' max='200' placeholder='1' value='"+(i.station+1)+"'>").enhanceWithin();else if(3===t){var s,l=5,c=1,d=[];if(controller.settings.gpio?d=controller.settings.gpio:"OSPi"===getHWVersion()?d=[5,6,7,8,9,10,11,12,13,16,18,19,20,21,23,24,25,26]:"2.3"===getHWVersion()&&(d=[2,10,12,13,14,15,18,19]),o===t&&(i=i.split(""),l=parseInt(i[0]+i[1]),c=parseInt(i[2])),d.length){s="<div class='ui-bar-a ui-bar'>"+_("GPIO Pin")+":</div><select class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='gpio-pin'>";for(var u=0;u<d.length;u++)s+="<option value='"+d[u]+"' "+(d[u]===l?"selected='selected'":"")+">"+d[u];s+="</select>"}else s="";s+="<div class='ui-bar-a ui-bar'>"+_("Active State")+":</div><select class='center' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='active-state'><option value='1' "+(1===c?"selected='selected'":"")+">"+_("HIGH")+"<option value='0' "+(0===c?"selected='selected'":"")+">"+_("LOW")+"</select>",n.append(s).enhanceWithin()}else 4===t&&(i=o===t?i.split(","):["server","80","On","Off"],n.append("<div class='ui-bar-a ui-bar'>"+_("Server Name")+":</div><input class='center  validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-server' required='true' type='text' value='"+i[0]+"'><div class='ui-bar-a ui-bar'>"+_("Server Port")+":</div><input class='center  validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-port' required='true' type='number' min='0' max='65535' value='"+parseInt(i[1])+"'><div class='ui-bar-a ui-bar'>"+_("On Command")+":</div><input class='center validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-on' required='true' type='text' value='"+i[2]+"'><div class='ui-bar-a ui-bar'>"+_("Off Command")+":</div><input class='center validate-length' data-corners='false' data-wrapper-class='tight ui-btn stn-name' id='http-off' required='true' type='text' value='"+i[3]+"'><div class='center smaller' id='character-tracking' style='color:#999;'><p>"+_("Note: There is a limit on the number of character used to configure this station type.")+"</p><span>"+_("Characters remaining")+": </span><span id='character-count'>placeholder</span></div>").enhanceWithin(),a(),$(".validate-length").on("input",a))}(parseInt($(this).val())),!1})),Station.isSpecial(e)?updateControllerStationSpecial((function(){r.find("#hs").removeClass("ui-disabled").find("option[data-hs='"+controller.special[e].st+"']").prop("selected",!0),r.find("#hs").change()})):(r.find("#hs").removeClass("ui-disabled"),r.find("option[data-hs='0']").prop("selected",!0),r.find("#hs").change()),r.find(".changeBackground").on("click",(function(t){t.preventDefault();var i=this;takePicture((function(t){o[n].images[e]=t,storage.set({sites:JSON.stringify(o)},cloudSaveSites),f(),i.innerHTML=_("Change")+" "+_("Image")}))})),$.mobile.pageContainer.append(r);var y={history:!1};if(isiOS){var w=getPageTop();y.x=w.x,y.y=w.y}else y.positionTo="window";r.popup(y).popup("open")},c=function(t){var e,n,i,o,s,r=!0===checkOSVersion(208),l={},c={},d={},u={},h={},p={},f={},m={},g={},v={};for(n=0;n<controller.settings.nbrd;n++)for(Supported.master(MASTER_STATION_1)&&(l["m"+n]=0),Supported.master(MASTER_STATION_2)&&(c["n"+n]=0),Supported.sequential()&&(d["q"+n]=0),Supported.special()&&(u["p"+n]=0),Supported.ignoreRain()&&(h["i"+n]=0),Supported.ignoreSensor(IGNORE_SENSOR_1)&&(p["j"+n]=0),Supported.ignoreSensor(IGNORE_SENSOR_2)&&(f["k"+n]=0),Supported.actRelay()&&(m["a"+n]=0),Supported.disabled()&&(g["d"+n]=0),s=0;s<8;s++)i=8*n+s,e=a.find("#attrib-"+i),Supported.master(MASTER_STATION_1)&&(l["m"+n]=l["m"+n]+(e.data("um")<<s)),Supported.master(MASTER_STATION_2)&&(c["n"+n]=c["n"+n]+(e.data("um2")<<s)),Supported.sequential()&&(d["q"+n]=d["q"+n]+(e.data("us")<<s)),Supported.special()&&(u["p"+n]=u["p"+n]+((e.data("hs")?1:0)<<s)),Supported.ignoreRain()&&(h["i"+n]=h["i"+n]+(e.data("ir")<<s)),Supported.ignoreSensor(IGNORE_SENSOR_1)&&(p["j"+n]=p["j"+n]+(e.data("sn1")<<s)),Supported.ignoreSensor(IGNORE_SENSOR_2)&&(f["k"+n]=f["k"+n]+(e.data("sn2")<<s)),Supported.actRelay()&&(m["a"+n]=m["a"+n]+(e.data("ar")<<s)),Supported.disabled()&&(g["d"+n]=g["d"+n]+(e.data("sd")<<s)),i===t&&(v["s"+i]=r?a.find("#station_"+i).text().replace(/\s/g,"_"):a.find("#station_"+i).text(),Supported.special()&&e.data("hs")&&(u.st=e.data("hs"),u.sd=e.data("specialData"),u.sid=t),Supported.groups()&&(o=e.attr("data-gid")));$.mobile.loading("show"),sendToOS("/cs?pw=&"+$.param(v)+(Supported.master(MASTER_STATION_1)?"&"+$.param(l):"")+(Supported.master(MASTER_STATION_2)?"&"+$.param(c):"")+(Supported.sequential()?"&"+$.param(d):"")+(Supported.special()?"&"+$.param(u):"")+(Supported.ignoreRain()?"&"+$.param(h):"")+(Supported.ignoreSensor(IGNORE_SENSOR_1)?"&"+$.param(p):"")+(Supported.ignoreSensor(IGNORE_SENSOR_2)?"&"+$.param(f):"")+(Supported.actRelay()?"&"+$.param(m):"")+(Supported.disabled()?"&"+$.param(g):"")+(Supported.groups()?"&g"+t+"="+o:"")).done((function(){showerror(_("Stations have been updated")),updateController((function(){$("html").trigger("datarefresh")}))}))},d=function(){timers.clock={val:controller.settings.devt,update:function(){a.find("#clock-s").text(dateToString(new Date(1e3*this.val),null,1))}}},u=function(t,e){var n=$(t),i=$(e),o=Card.getSID(n),a=Card.getSID(i),s=Station.isMaster(o)>0?1:0,r=Station.isMaster(a)>0?1:0;if(s>r)return-1;if(s<r)return 1;var l=Station.getGIDValue(Card.getSID(n)),c=Station.getGIDValue(Card.getSID(i));if(l<c)return-1;if(l>c)return 1;var d=Station.getStatus(o),u=Station.getStatus(a);return d>u?-1:d<u?1:o<a?-1:o>a?1:0},h=function(t,e){var n=$(t),i=$(e),o=Card.getSID(n),a=Card.getSID(i),s=Station.getStatus(o),r=Station.getStatus(a);return s>r?-1:s<r?1:o<a?-1:o>a?1:0},p=function(){var t=a.find("#os-stations-list"),e=t.children(),n=groupView?u:h;e.sort(n).detach().appendTo(t),Supported.groups()&&groupView?function(t,e){var n,i,o,a,s;for(s=0;s<t.children().length;s++)n=CardList.getCardByIndex(e,s),Card.setGroupLabel(n,Card.getGIDName(n));for(s=0;s<t.children().length-1;s++)n=CardList.getCardByIndex(e,s),i=CardList.getCardByIndex(e,s+1),o=Card.getDivider(n),a=Card.getGroupLabel(n),Card.isMasterStation(n)?(Card.isMasterStation(i)?o.hide():o.show(),a.addClass("hidden")):Station.getGIDValue(Card.getSID(n))!==Station.getGIDValue(Card.getSID(i))?o.show():o.hide();Card.getDivider(i).show(),Card.setGroupLabel(i,Card.getGIDName(i))}(t,e):function(t,e){var n,i,o,a,s;for(s=0;s<t.children().length-1;s++)n=CardList.getCardByIndex(e,s),i=CardList.getCardByIndex(e,s+1),(o=Card.getDivider(n)).hide(),Card.setGroupLabel(n,mapGIDValueToName(Station.getGIDValue(s))),void 0!==(a=Card.getGroupLabel(n))&&Card.isMasterStation(n)&&a.addClass("hidden"),Station.isRunning(Card.getSID(n))&&!Station.isRunning(Card.getSID(i))&&o.show();Card.getDivider(i).hide(),Card.setGroupLabel(i,mapGIDValueToName(Station.getGIDValue(s))),void 0!==(a=Card.getGroupLabel(i))&&Card.isMasterStation(i)&&a.addClass("hidden")}(t,e)},f=function(){var i,l,c,u,h,f,g,v,b=a.find("#os-stations-list"),y=b.children();if(a.hasClass("ui-page-active")){d(),m(),updateSensorShowArea(a),a.find(".waterlevel").text(controller.options.wl),a.find(".sitename").text(e.val()),CardList.getAllCards(y).filter((function(t,e){return parseInt($(e).data("station"),10)>=controller.stations.snames.length})).remove();for(var w=0;w<controller.stations.snames.length;w++)i=Station.getPID(w)>0,l=Station.getStatus(w)>0,c=i?pidname(Station.getPID(w)):"",u=Station.getRemainingRuntime(w),h=StationQueue.isPaused(),v=!!o[n].images[w],f=CardList.getCardBySID(y,w),Card.getDivider(f),0===f.length?(t="",r(w),b.append(t)):(f.find(".ui-body > img").attr("src",v?"data:image/jpeg;base64,"+o[n].images[w]:getAppURLPath()+"img/placeholder.png"),Station.isDisabled(w)?(a.hasClass("show-hidden")||f.hide(),f.addClass("station-hidden")):f.show().removeClass("station-hidden"),f.find("#station_"+w).text(controller.stations.snames[w]),f.find(".special-station").removeClass("hidden").addClass(Station.isSpecial(w)?"":"hidden"),f.find(".station-status").removeClass("on off wait").addClass(l?"on":i?"wait":"off"),Station.isMaster(w)?f.find(".station-settings").removeClass("ui-icon-gear").addClass("ui-icon-master"):f.find(".station-settings").removeClass("ui-icon-master").addClass("ui-icon-gear"),f.find(".station-settings").data({um:Supported.master(MASTER_STATION_1)?StationAttribute.getMasterOperation(w,MASTER_STATION_1):void 0,um2:Supported.master(MASTER_STATION_2)?StationAttribute.getMasterOperation(w,MASTER_STATION_2):void 0,ir:Supported.ignoreRain()?StationAttribute.getIgnoreRain(w):void 0,sn1:Supported.ignoreSensor(IGNORE_SENSOR_1)?StationAttribute.getIgnoreSensor(w,IGNORE_SENSOR_1):void 0,sn2:Supported.ignoreSensor(IGNORE_SENSOR_2)?StationAttribute.getIgnoreSensor(w,IGNORE_SENSOR_2):void 0,ar:Supported.actRelay()?StationAttribute.getActRelay(w):void 0,sd:Supported.disabled()?StationAttribute.getDisabled(w):void 0,us:Supported.sequential()?StationAttribute.getSequential(w):void 0,hs:Supported.special()?StationAttribute.getSpecial(w):void 0,gid:Supported.groups()?Station.getGIDValue(w):void 0}),Station.isMaster(w)||!i&&!l?f.find(".rem").remove():(g=l?_("Running")+" "+c:_("Scheduled")+" "+(Station.getStartTime(w)?_("for")+" "+dateToString(new Date(1e3*Station.getStartTime(w))):c),u>0&&(g+=" <span id="+(h?"'pause":"'countdown-")+w+"' class='nobr'>("+sec2hms(u)+" "+_("remaining")+")</span>",controller.status[w]&&s(w,u)),0===f.find(".rem").length?f.find(".ui-body").append("<p class='rem center'>"+g+"</p>"):f.find(".rem").html(g)));p()}},m=function(t){t=t||function(){},n=e.val(),storage.get("sites",(function(e){"object"!=typeof(o=parseSites(e.sites))[n].images||$.isEmptyObject(o[n].images)?(o[n].images={},a.removeClass("has-images")):a.addClass("has-images"),"object"!=typeof o[n].notes&&(o[n].notes={}),"object"!=typeof o[n].lastRunTime&&(o[n].lastRunTime={}),t()}))};return a.one("pageshow",(function(){$("html").on("datarefresh",f)})),function(s){if(!isControllerConnected())return!1;t="",e=$("#site-selector"),m((function(){for(i=0;i<controller.stations.snames.length;i++)r(i);a.find("#os-stations-list").html(t),p()})),a.find(".sitename").toggleClass("hidden",!!currLocal).text(e.val()),a.find(".waterlevel").text(controller.options.wl),updateSensorShowArea(a),d(),a.on("click",".station-settings",l),a.on("click",".home-info",(function(){return changePage("#os-options",{expandItem:"weather"}),!1})),a.on("click",".card",(function(){if(!checkOSVersion(210))return!1;var t,e=$(this),i=Card.getSID(e),a=Card.getGIDValue(e),s=Station.getStatus(i),r=Station.getName(i),l={};if(Station.isMaster(i))return!1;if(l.type=dialog.REMOVE_STATION,l.station=i,l.gid=a,s)t=_("Do you want to stop the selected station?");else{if(!e.find("span.nobr").length)return void showDurationBox({title:r,incrementalUpdate:!1,maximum:65535,seconds:o[n].lastRunTime[i]>0?o[n].lastRunTime[i]:0,helptext:_("Enter a duration to manually run ")+r,callback:function(t){sendToOS("/cm?sid="+i+"&en=1&t="+t+"&pw=","json").done((function(){Station.setPID(i,MANUAL_STATION_PID),Station.setRemainingRuntime(i,t),refreshStatus(),showerror(_("Station has been queued")),o[n].lastRunTime[i]=t,storage.set({sites:JSON.stringify(o)},cloudSaveSites)}))}});t=_("Do you want to unschedule the selected station?")}areYouSure(t,Station.getName(i),(function(){var t=!0===popupData.shift?1:0;sendToOS("/cm?sid="+i+"&ssta="+t+"&en=0&pw=").done((function(){Station.setPID(i,0),Station.setRemainingRuntime(i,0),Station.setStatus(i,0),delete timers["station-"+i],refreshStatus(),showerror(_("Station has been stopped"))}))}),null,l)})).on("click","img",(function(){var t=$(this),e=t.parents(".card").data("station");return-1!==t.attr("src").indexOf("data:image/jpeg;base64")?areYouSure(_("Do you want to delete the current image?"),"",(function(){delete o[n].images[e],storage.set({sites:JSON.stringify(o)},cloudSaveSites),f()})):takePicture((function(t){o[n].images[e]=t,storage.set({sites:JSON.stringify(o)},cloudSaveSites),f()})),!1})).on({pagebeforeshow:function(){var t=changeHeader({class:"logo",leftBtn:{icon:"bullets",on:function(){return openPanel(),!1}},rightBtn:{icon:"bell",class:"notifications",text:"<span class='notificationCount ui-li-count ui-btn-corner-all'>"+notifications.length+"</span>",on:function(){return showNotifications(),!1}},animate:!s});0===notifications.length&&$(t[2]).hide()}}),$("#sprinklers").remove(),$.mobile.pageContainer.append(a),$.isEmptyObject(weather)||updateWeatherBox()}}(),showStart=function(){var t=$("<div data-role='page' id='start'><ul data-role='none' id='welcome_list' class='ui-listview ui-listview-inset ui-corner-all'><li><div class='logo' id='welcome_logo'></div></li><li class='ui-li-static ui-body-inherit ui-first-child ui-last-child ui-li-separate'><p class='rain-desc'>"+_("Welcome to the OpenSprinkler application. This app only works with the OpenSprinkler controller which must be installed and setup on your home network.")+"</p><a class='iab iabNoScale ui-btn ui-mini center' target='_blank' href='https://opensprinkler.com/product/opensprinkler/'>"+_("Purchase OpenSprinkler")+"</a></li><li class='ui-first-child ui-last-child'><a href='#' class='ui-btn center cloud-login'>"+_("OpenSprinkler.com Login")+"</a></li><hr class='content-divider'><li id='auto-scan' class='ui-first-child'><a href='#' class='ui-btn ui-btn-icon-right ui-icon-carat-r'>"+_("Scan For Device")+"</a></li><li class='ui-first-child ui-last-child'><a class='ui-btn ui-btn-icon-right ui-icon-carat-r' data-rel='popup' href='#addnew'>"+_("Add Controller")+"</a></li></ul></div>"),e=function(){updateDeviceIP((function(t){void 0!==t&&isLocalIP(t)?(o.removeClass("ui-first-child").find("a.ui-btn").text(_("Manually Add Device")),i.show()):n()}))},n=function(){o.addClass("ui-first-child").find("a.ui-btn").text(_("Add Controller")),i.hide()},i=t.find("#auto-scan"),o=i.next();return t.find("#auto-scan").find("a").on("click",(function(){return startScan(),!1})),t.find("a[href='#addnew']").on("click",(function(){showAddNew()})),t.find(".cloud-login").on("click",(function(){return requestCloudAuth(),!1})),t.on("pagehide",(function(){t.detach()})),function(){if(isControllerConnected())return!1;$("#start").remove(),$.mobile.pageContainer.append(t),e()}}();function showGuidedSetup(){}function parseRemoteStationData(t){t=t.split("");for(var e,n=[],i={},o=0;o<8;o++)e=parseInt(t[o]+t[o+1],16)||0,n.push(e),o++;return i.ip=n.join("."),i.port=parseInt(t[8]+t[9]+t[10]+t[11],16),i.station=parseInt(t[12]+t[13],16),i}function verifyRemoteStation(t,e){t=parseRemoteStationData(t),$.ajax({url:"http://"+t.ip+":"+t.port+"/jo?pw="+encodeURIComponent(currPass),type:"GET",dataType:"json"}).then((function(t){"object"==typeof t&&t.hasOwnProperty("fwv")?1===Object.keys(t).length?e(-2):t.hasOwnProperty("re")&&0!==t.re?e(!0):e(-3):e(-1)}),(function(){e(!1)}))}function convertRemoteToExtender(t){t=parseRemoteStationData(t),$.ajax({url:"http://"+t.ip+":"+t.port+"/cv?re=1&pw="+encodeURIComponent(currPass),type:"GET",dataType:"json"})}function refreshStatus(t){if(isControllerConnected()){t=t||function(){};var e=function(){$("html").trigger("datarefresh"),checkStatus(),t()};checkOSVersion(216)?updateController((function(){checkOSVersion(230)?updateAnalogSensor((function(){updateProgramAdjustments(e)})):e()}),networkFail):$.when(updateControllerStatus(),updateControllerSettings(),updateControllerOptions()).then(e,networkFail)}}function refreshData(){isControllerConnected()&&(checkOSVersion(216)?updateController(null,networkFail):$.when(updateControllerPrograms(),updateControllerStations()).fail(networkFail))}function changeStatus(t,e,n,i){var o=$("#footer-running"),a="";i=i||function(){},t>1&&(timers.statusbar={val:t,type:"statusbar",update:function(){$("#countdown").text("("+sec2hms(this.val)+" "+_("remaining")+")")}}),isControllerConnected()&&void 0!==controller.settings.curr&&(a+=_("Current")+": "+controller.settings.curr+" mA "),!isControllerConnected()||2!==controller.options.urs&&2!==controller.options.sn1t||void 0===controller.settings.flcrt||void 0===controller.settings.flwrt||(a+="<span style='padding-left:5px'>"+_("Flow")+": "+(flowCountToVolume(controller.settings.flcrt)/(controller.settings.flwrt/60)).toFixed(2)+" L/min</span>"),a=""!==a?n+"<p class='running-text smaller center'>"+a+"</p>":n,o.removeClass().addClass(e).html(a).off("click").on("click",i)}function checkStatus(){var t,e,n,i,o,a,s;if(isControllerConnected())if(1!==controller.options.re)if(controller.settings.en){if(controller.settings.pq)return i="<p class='running-text center pointer'>"+_("Stations Currently Paused"),controller.settings.pt&&(i+=" <span id='countdown' class='nobr'>("+sec2hms(controller.settings.pt)+" "+_("remaining")+")</span>"),i+="</p>",void changeStatus(controller.settings.pt||0,"yellow",i,(function(){areYouSure(_("Do you want to resume station operation?"),"",(function(){showLoading("#footer-running"),sendToOS("/pq?pw=&dur=0").done((function(){setTimeout(refreshStatus,1e3)}))}))}));for(t={},s=0;s<controller.status.length;s++)controller.status[s]&&!Station.isMaster(s)&&(t[s]=controller.status[s]);if(Object.keys(t).length>=2){for(s in e=0,t)t.hasOwnProperty(s)&&(a=Station.getRemainingRuntime(s))>e&&(e=a);return n=Object.keys(t)[0],i="<div><div class='running-icon'></div><div class='running-text pointer'>",i+=pidname(Station.getPID(n))+" "+_("is running on")+" "+Object.keys(t).length+" "+_("stations")+" ",e>0&&(i+="<span id='countdown' class='nobr'>("+sec2hms(e)+" "+_("remaining")+")</span>"),void changeStatus(e,"green",i+="</div></div>",goHome)}for(o=!1,s=0;s<controller.stations.snames.length;s++)if(controller.settings.ps[s]&&Station.getPID(s)&&Station.getStatus(s)&&!Station.isMaster(s)){o=!0,i="<div><div class='running-icon'></div><div class='running-text pointer'>",i+=pidname(Station.getPID(s))+" "+_("is running on station")+" <span class='nobr'>"+Station.getName(s)+"</span> ",Station.getRemainingRuntime(s)>0&&(i+="<span id='countdown' class='nobr'>("+sec2hms(Station.getRemainingRuntime(s))+" "+_("remaining")+")</span>"),i+="</div></div>";break}if(o)changeStatus(Station.getRemainingRuntime(s),"green",i,goHome);else if(controller.settings.rd)changeStatus(0,"red","<p class='running-text center pointer'>"+_("Rain delay until")+" "+dateToString(new Date(1e3*controller.settings.rdst))+"</p>",(function(){areYouSure(_("Do you want to turn off rain delay?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&rd=0").done((function(){refreshStatus(updateWeather)}))}))}));else if(1!==controller.options.urs||1!==controller.settings.rs)if(1!==controller.settings.sn1)if(1!==controller.settings.sn2)if(1!==controller.settings.mm){var r=controller.settings.lrun[2];if(0===r)changeStatus(0,"transparent","<p class='running-text smaller center pointer'>"+_("System Idle")+"</p>",goHome);else changeStatus(0,"transparent","<p class='running-text smaller center pointer'>"+pidname(controller.settings.lrun[1])+" "+_("last ran station")+" "+controller.stations.snames[controller.settings.lrun[0]]+" "+_("for")+" "+(r/60>>0)+"m "+r%60+"s "+_("on")+" "+dateToString(new Date(1e3*(controller.settings.lrun[3]-r)))+"</p>",goHome)}else changeStatus(0,"red","<p class='running-text center pointer'>"+_("Manual mode enabled")+"</p>",(function(){areYouSure(_("Do you want to turn off manual mode?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&mm=0").done((function(){updateController()}))}))}));else changeStatus(0,"red","<p class='running-text center'>Sensor 2 ("+(3===controller.options.sn2t?_("Soil"):_("Rain"))+_(") Activated")+"</p>");else changeStatus(0,"red","<p class='running-text center'>Sensor 1 ("+(3===controller.options.sn1t?_("Soil"):_("Rain"))+_(") Activated")+"</p>");else changeStatus(0,"red","<p class='running-text center'>"+_("Rain detected")+"</p>")}else changeStatus(0,"red","<p class='running-text center pointer'>"+_("System Disabled")+"</p>",(function(){areYouSure(_("Do you want to re-enable system operation?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&en=1").done((function(){updateController()}))}))}));else changeStatus(0,"red","<p class='running-text center pointer'>"+_("Configured as Extender")+"</p>",(function(){areYouSure(_("Do you wish to disable extender mode?"),"",(function(){showLoading("#footer-running"),sendToOS("/cv?pw=&re=0").done((function(){updateController()}))}))}));else changeStatus(0,"transparent","<p class='running-text smaller'></p>")}function calculateTotalRunningTime(t){var e,n,i=controller.options.sdt;if(Supported.groups()){e=new Array(NUM_SEQ_GROUPS).fill(0),n=0;var o=0;$.each(controller.stations.snames,(function(o){var a=t[o],s=Station.getGIDValue(o);a>0&&(s!==PARALLEL_GID_VALUE?e[s]+=a+i:a>n&&(n=a))}));for(var a=0;a<NUM_SEQ_GROUPS;a++)e[a]>i&&(e[a]-=i),e[a]>o&&(o=e[a]);return Math.max(o,n)}return e=0,n=0,$.each(controller.stations.snames,(function(o){var a=t[o];a>0&&(Station.isSequential(o)?e+=a+i:a>n&&(n=a))})),e>i&&(e-=i),Math.max(e,n)}function updateTimers(){var t=(new Date).getTime();setInterval((function(){if(!isControllerConnected())return!1;var e=(new Date).getTime();if(e-t>2e3&&(checkStatus(),refreshStatus()),t=e,!$.isEmptyObject(timers))for(var n in timers)timers.hasOwnProperty(n)&&(timers[n].val<=0?("statusbar"===n&&(showLoading("#footer-running"),refreshStatus()),"function"==typeof timers[n].done&&timers[n].done(),delete timers[n]):"clock"===n?(++timers[n].val,timers[n].update()):"statusbar"!==n&&"number"!=typeof timers[n].station||(--timers[n].val,timers[n].update()))}),1e3)}function removeStationTimers(){for(var t in timers)timers.hasOwnProperty(t)&&"clock"!==t&&delete timers[t]}var getManual=function(){var t,e,n,i=$("<div data-role='page' id='manual'><div class='ui-content' role='main'><p class='center'>"+_("With manual mode turned on, tap a station to toggle it.")+"</p><fieldset data-role='collapsible' data-collapsed='false' data-mini='true'><legend>"+_("Options")+"</legend><div class='ui-field-contain'><label for='mmm'><b>"+_("Manual Mode")+"</b></label><input type='checkbox' data-on-text='On' data-off-text='Off' data-role='flipswitch' name='mmm' id='mmm'></div><p class='rain-desc smaller center' style='padding-top:5px'>"+_("Station timer prevents a station from running indefinitely and will automatically turn it off after the set duration (or when toggled off)")+"</p><div class='ui-field-contain duration-input'><label for='auto-off'><b>"+_("Station Timer")+"</b></label><button data-mini='true' name='auto-off' id='auto-off' value='3600'>1h</button></div></fieldset><div id='manual-station-list'></div></div></div>"),o=function(t){updateControllerStatus().done((function(){var e=n.eq(t).find("a");controller.options.mas&&(controller.status[controller.options.mas-1]?n.eq(controller.options.mas-1).addClass("green"):n.eq(controller.options.mas-1).removeClass("green")),e.text(controller.stations.snames[t]),controller.status[t]?e.removeClass("yellow").addClass("green"):e.removeClass("green yellow")}))},a=function(){if(!controller.settings.mm)return showerror(_("Manual mode is not enabled. Please enable manual mode then try again.")),!1;var e=$(this),i=e.closest("li"),a=n.index(i),r=a+1,l=s.val();return e.hasClass("yellow")||(t=controller.status[a]?checkOSPiVersion("2.1")?"/sn?sid="+r+"&set_to=0&pw=":"/sn"+r+"=0":checkOSPiVersion("2.1")?"/sn?sid="+r+"&set_to=1&set_time="+l+"&pw=":"/sn"+r+"=1&t="+l,e.removeClass("green").addClass("yellow"),e.html("<p class='ui-icon ui-icon-loading mini-load'></p>"),sendToOS(t).always((function(){setTimeout(o,1e3,a)}))),!1},s=i.find("#auto-off");return i.on("pagehide",(function(){i.detach()})),storage.get("autoOff",(function(t){t.autoOff&&(s.val(t.autoOff),s.text(dhms2str(sec2dhms(t.autoOff))))})),s.on("click",(function(){var t=$(this),e=i.find("label[for='"+t.attr("id")+"']").text();return showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e))),storage.set({autoOff:e})},maximum:32768}),!1})),i.find("#mmm").on("change",flipSwitched),function(){var t="<li data-role='list-divider' data-theme='a'>"+_("Sprinkler Stations")+"</li>";i.find("#mmm").prop("checked",!!controller.settings.mm),$.each(controller.stations.snames,(function(e,n){Station.isMaster(e)?t+="<li data-icon='false' class='center"+(controller.status[e]?" green":"")+(Station.isDisabled(e)?" station-hidden' style='display:none":"")+"'>"+n+" ("+_("Master")+")</li>":t+="<li data-icon='false'><a class='mm_station center"+(controller.status[e]?" green":"")+(Station.isDisabled(e)?" station-hidden' style='display:none":"")+"'>"+n+"</a></li>"})),e=$("<ul data-role='listview' data-inset='true' id='mm_list'>"+t+"</ul>"),n=e.children("li").slice(1),e.find(".mm_station").on("vclick",a),i.find("#manual-station-list").html(e).enhanceWithin(),changeHeader({title:_("Manual Control"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#manual").remove(),$.mobile.pageContainer.append(i)}}(),getRunonce=function(){var t,e,n,i,o,a,s,r,l=$("<div data-role='page' id='runonce'><div class='ui-content' role='main' id='runonce_list'></div></div>"),c=function(t){o.l=t,$("<option value='l' selected='selected'>"+_("Last Used Program")+"</option>").insertAfter(l.find("#rprog").find("option[value='t']")),u(t)},d=function(){return l.find("[id^='zone-']").val(0).text("0s").removeClass("green"),!1},u=function(t){l.find("[id^='zone-']").each((function(e,n){if(!Station.isMaster(e)){var i=$(n);i.val(t[e]).text(getDurationText(t[e])),t[e]>0?i.addClass("green"):i.removeClass("green")}}))};return l.on("pagehide",(function(){l.detach()})),function(){if(e="<p class='center'>"+_("Zero value excludes the station from the run-once program.")+"</p>",i=[],controller.programs.pd.length)for(a=0;a<controller.programs.pd.length;a++){s=readProgram(controller.programs.pd[a]);var h=[];if(checkOSVersion(210))h=s.stations;else{var p=s.stations.split("");for(t=0;t<controller.stations.snames.length;t++)h.push(parseInt(p[t])?s.duration:0)}i.push(h)}for(o=i,n="<select data-mini='true' name='rprog' id='rprog'><option value='t'>"+_("Test All Stations")+"</option><option value='s' selected='selected'>"+_("Quick Programs")+"</option>",t=0;t<i.length;t++)r=checkOSVersion(210)?controller.programs.pd[t][5]:_("Program")+" "+(t+1),n+="<option value='"+t+"'>"+r+"</option>";if(e+=(n+="</select>")+"<form>",$.each(controller.stations.snames,(function(t,n){Station.isMaster(t)?e+="<div class='ui-field-contain duration-input"+(Station.isDisabled(t)?" station-hidden' style='display:none":"")+"'><label for='zone-"+t+"'>"+n+":</label><button disabled='true' data-mini='true' name='zone-"+t+"' id='zone-"+t+"' value='0'>Master</button></div>":e+="<div class='ui-field-contain duration-input"+(Station.isDisabled(t)?" station-hidden' style='display:none":"")+"'><label for='zone-"+t+"'>"+n+":</label><button data-mini='true' name='zone-"+t+"' id='zone-"+t+"' value='0'>0s</button></div>"})),e+="</form><a class='ui-btn ui-corner-all ui-shadow rsubmit' href='#'>"+_("Submit")+"</a><a class='ui-btn ui-btn-b ui-corner-all ui-shadow rreset' href='#'>"+_("Reset")+"</a>",l.find(".ui-content").html(e).enhanceWithin(),"object"==typeof controller.settings.rodur){var f=0;for(t=0;t<controller.settings.rodur.length;t++)f+=controller.settings.rodur[t];0!==f&&c(controller.settings.rodur)}else storage.get("runonce",(function(t){(t=t.runonce)&&(t=JSON.parse(t),c(t))}));l.find("#rprog").on("change",(function(){var t=$(this).val();"s"!==t?"t"!==t?void 0!==o[t]&&u(o[t]):u(Array.apply(null,Array(controller.stations.snames.length)).map((function(){return 60}))):d()})),l.on("click",".rsubmit",submitRunonce).on("click",".rreset",d),l.find("[id^='zone-']").on("click",(function(){var t=$(this),e=l.find("label[for='"+t.attr("id")+"']").text().slice(0,-1);return showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e),t.text(getDurationText(e)),e>0?t.addClass("green"):t.removeClass("green")},maximum:65535,showSun:!!checkOSVersion(214)}),!1})),changeHeader({title:_("Run-Once"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack},rightBtn:{icon:"check",text:_("Submit"),on:submitRunonce}}),$("#runonce").remove(),$.mobile.pageContainer.append(l)}}();function submitRunonce(t){t instanceof Array||(t=[],$("#runonce").find("[id^='zone-']").each((function(){t.push(parseInt(this.value)||0)})),t.push(0));var e=function(){$.mobile.loading("show"),storage.set({runonce:JSON.stringify(t)}),sendToOS("/cr?pw=&t="+JSON.stringify(t)).done((function(){$.mobile.loading("hide"),$.mobile.document.one("pageshow",(function(){showerror(_("Run-once program has been scheduled"))})),refreshStatus(),goBack()}))},n=StationQueue.isActive();-1!==n?areYouSure(_("Do you want to stop the currently running program?"),pidname(Station.getPID(n)),(function(){$.mobile.loading("show"),stopStations(e)})):e()}var getPreview=function(){var t,e,n,i,o,a,s,r,l,c,d,u,h,p,f,m,g,v,b=$("<div data-role='page' id='preview'><div class='ui-content' role='main'><div id='preview_header' class='input_with_buttons'><button class='preview-minus ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input class='center' type='date' name='preview_date' id='preview_date'><button class='preview-plus ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div><div id='timeline'></div><div data-role='controlgroup' data-type='horizontal' id='timeline-navigation'><a class='ui-btn ui-corner-all ui-icon-plus ui-btn-icon-notext btn-no-border' title='"+_("Zoom in")+"'></a><a class='ui-btn ui-corner-all ui-icon-minus ui-btn-icon-notext btn-no-border' title='"+_("Zoom out")+"'></a><a class='ui-btn ui-corner-all ui-icon-carat-l ui-btn-icon-notext btn-no-border' title='"+_("Move left")+"'></a><a class='ui-btn ui-corner-all ui-icon-carat-r ui-btn-icon-notext btn-no-border' title='"+_("Move right")+"'></a></div></div></div>"),y=b.find("#timeline"),w=b.find("#timeline-navigation");return b.find("#preview_date").on("change",(function(){h=this.value.split("-"),p=new Date(h[0],h[1]-1,h[2]),u()})),b.one("pagebeforeshow",(function(){holdButton(b.find(".preview-plus"),(function(){d(1)})),holdButton(b.find(".preview-minus"),(function(){d(-1)}))})),b.on({pagehide:function(){b.detach()},pageshow:function(){u()}}),e=function(e,i,o){t=[];var a,s,c,d,u,h,p,f,b,y,w,x,_=Math.floor(controller.settings.devt/86400),k=0,S=Date.UTC(o,e-1,i,0,0,0,0),T=S/1e3/3600/24>>0,C=8*controller.settings.nbrd,M=new Array(C),D=new Array(C),O=new Array(C),E=new Array(C),A=[],I=new Array(C),P=0,L=0,N=new Array(NUM_SEQ_GROUPS);for(d=0;d<C;d++)M[d]=-1,D[d]=0,O[d]=0,E[d]=0,I[d]=255;for(h=0;h<NUM_SEQ_GROUPS;h++)N[h]=0;do{a=0,s=0;for(var R=0;R<controller.programs.pd.length;R++)if(c=controller.programs.pd[R],n(c,k,S,T,_))for(d=0;d<C;d++)if(b=d>>3,w=d%8,!Station.isMaster(d))if(m){if(controller.stations.stn_dis[b]&1<<w)continue;if(c[4][d]&&0===O[d]){var j=0;(j=2&c[0]&&(controller.options.uwt>0&&T===_||0===controller.options.uwt)?getStationDuration(c[4][d],S)*controller.options.wl/100>>0:getStationDuration(c[4][d],S))>0&&(v?A.length<C&&A.push({st:-1,dur:j,sid:d,pid:R+1,gid:controller.stations.stn_grp?controller.stations.stn_grp[d]:-1,pl:1}):(O[d]=j,D[d]=R+1),s=1)}}else c[7+b]&1<<w&&(O[d]=c[6]*controller.options.wl/100>>0,D[d]=R+1,s=1);if(s){var $=60*k,B=$,H=new Array(NUM_SEQ_GROUPS);if(g){for(L>$&&(B=L+controller.options.sdt),h=0;h<NUM_SEQ_GROUPS;h++)H[h]=$,N[h]>$&&(H[h]=N[h]+controller.options.sdt);if(v)for(u=0;u<A.length;u++)(p=A[u]).st>=0||0===p.dur||(y=(d=p.sid)>>3,x=7&d,-1===p.gid?controller.stations.stn_seq[y]&1<<x?(p.st=B,B+=p.dur,B+=controller.options.sdt):(p.st=$,$++):p.gid!==PARALLEL_GID_VALUE?(p.st=H[p.gid],H[p.gid]+=p.dur,H[p.gid]+=controller.options.sdt):(p.st=$,$++),a=1);else for(d=0;d<C;d++)y=d>>3,x=7&d,0===O[d]||M[d]>=0||(controller.stations.stn_seq[y]&1<<x?(M[d]=B,B+=O[d],O[d]=B,B+=controller.options.sdt,E[d]=1):(M[d]=$,O[d]=$+O[d],E[d]=1),a=1)}else if(m&&controller.options.seq&&P>$&&($=P+controller.options.sdt),controller.options.seq)for(d=0;d<8*controller.settings.nbrd;d++)0!==O[d]&&0!==D[d]&&(M[d]=$,$+=O[d],O[d]=$,$+=controller.options.sdt,a=1);else for(d=0;d<8*controller.settings.nbrd;d++)0!==O[d]&&0!==D[d]&&(M[d]=$,O[d]=$+O[d],a=1)}if(v){for(u=0;u<A.length;u++)(f=I[d=(p=A[u]).sid])<255&&A[f].st<p.st||(I[d]=u);for(l(60*k,A,I,S),k++,d=0;d<8*controller.settings.nbrd;d++)if(255!==(f=I[d])&&(p=A[f]).st>=0&&60*k>=p.st+p.dur){var W=A.length;f<W-1&&(A[f]=A[W-1],I[A[f].sid]===W-1&&(I[A[f].sid]=f)),A.pop(),I[d]=255}for(L=0,h=0;h<NUM_SEQ_GROUPS;h++)L[h]=0;for(u=0;u<A.length;u++){y=(d=(p=A[u]).sid)>>3,x=7&d;var F=p.st+p.dur;-1===p.gid?controller.stations.stn_seq[y]&1<<x&&F>L&&(L=F):p.gid!==PARALLEL_GID_VALUE&&F>N[p.gid]&&(N[p.gid]=F)}}else if(a)if(g)for(L=r(60*k,M,D,O,E,S),k++,d=0;d<8*controller.settings.nbrd;d++)D[d]>0&&60*k>=O[d]&&(M[d]=-1,D[d]=0,O[d]=0,E[d]=0);else if(m)for(P=r(60*k,M,D,O,E,S),k++,d=0;d<8*controller.settings.nbrd;d++)M[d]=-1,D[d]=0,O[d]=0;else{var U=r(60*k,M,D,O,E,S)/60>>0;for(controller.options.seq&&k!==U?k=U:k++,d=0;d<8*controller.settings.nbrd;d++)M[d]=-1,D[d]=0,O[d]=0}else if(k++,g)for(d=0;d<8*controller.settings.nbrd;d++)D[d]>0&&60*k>=O[d]&&(M[d]=-1,D[d]=0,O[d]=0,E[d]=0)}while(k<1440)},l=function(e,n,i,o){for(var a=0;a<8*controller.settings.nbrd;a++){var s=i[a];if(255!==s){var r=n[s];if(r.pl){var l=void 0!==controller.options.mas2,d=controller.stations.masop[a>>3]&1<<a%8,u=!!l&&controller.stations.masop2[a>>3]&1<<a%8;Station.isMaster(a)||(controller.options.mas>0&&d&&t.push({start:r.st+controller.options.mton,end:r.st+r.dur+controller.options.mtof,content:"",className:"master",shortname:"M"+(l?"1":""),group:"Master",station:a}),l&&controller.options.mas2>0&&u&&t.push({start:r.st+controller.options.mton2,end:r.st+r.dur+controller.options.mtof2,content:"",className:"master",shortname:"M2",group:"Master 2",station:a})),c(a,r.st,r.pid,r.st+r.dur,o),r.pl=0}}}},r=function(e,n,i,o,a,s){for(var r=e,l=0;l<8*controller.settings.nbrd;l++)if(i[l])if(g){if(a[l]){var d=void 0!==controller.options.mas2,u=controller.stations.masop[l>>3]&1<<l%8,h=!!d&&controller.stations.masop2[l>>3]&1<<l%8;Station.isMaster(l)||(controller.options.mas>0&&u&&t.push({start:n[l]+controller.options.mton,end:o[l]+controller.options.mtof,content:"",className:"master",shortname:"M"+(d?"1":""),group:"Master",station:l}),d&&controller.options.mas2>0&&h&&t.push({start:n[l]+controller.options.mton2,end:o[l]+controller.options.mtof2,content:"",className:"master",shortname:"M2",group:"Master 2",station:l})),c(l,n[l],i[l],o[l],s),a[l]=0,controller.stations.stn_seq[l>>3]&1<<(7&l)&&(r=r>o[l]?r:o[l])}}else 1===controller.options.seq?(Station.isMaster(l)&&controller.stations.masop[l>>3]&1<<l%8&&t.push({start:n[l]+controller.options.mton,end:o[l]+controller.options.mtof,content:"",className:"master",shortname:"M",group:"Master",station:l}),c(l,n[l],i[l],o[l],s),r=o[l]):(c(l,e,i[l],o[l],s),Station.isMaster(l)&&controller.stations.masop[l>>3]&1<<l%8&&(r=r>o[l]?r:o[l]));return g||0===controller.options.seq&&controller.options.mas>0&&t.push({start:e,end:r,content:"",className:"master",shortname:"M",group:"Master",station:l}),r},c=function(e,n,i,o,a){var s="program-"+(i+3)%4,r="P"+i;(0!==controller.settings.rd&&a+n+900*(controller.options.tz-48)<=1e3*controller.settings.rdst||1===controller.options.urs&&1===controller.settings.rs)&&"object"==typeof controller.stations.ignore_rain&&0==(controller.stations.ignore_rain[e/8>>0]&1<<e%8)&&(s="delayed"),checkOSVersion(210)&&(r=controller.programs.pd[i-1][5]),t.push({start:n,end:o,className:s,content:r,pid:i-1,shortname:"S"+(e+1),group:controller.stations.snames[e],station:e})},n=function(t,e,n,a,r){return v?s(t,e,n,a,r):m?o(t,e,n,a,r):i(t,e,n,a,r)},i=function(t,e,n,i,o){if(0===t[0])return 0;if(128&t[1]&&t[2]>1){var a=t[2];if(i%a!=(o+(127&t[1]))%a)return 0}else{var s=new Date(n),r=(s.getUTCDay()+6)%7;if(0==(t[1]&1<<r))return 0;var l=s.getUTCDate();if(128&t[1]&&0===t[2]&&l%2!=0)return 0;if(128&t[1]&&1===t[2]&&(31===l||29===l&&1===s.getUTCMonth()||l%2!=1))return 0}return e<t[3]||e>t[4]||isOSPi()&&e>=t[4]||0===t[5]?0:((e-t[3])/t[5]>>0)*t[5]==e-t[3]?1:0},a=function(t,e,n,i){var o=t[0]>>2&3,a=t[0]>>4&3,s=new Date(e),r=s.getUTCDate(),l=s.getUTCMonth()+1,c=t[6];if("object"==typeof c&&c[0]){var d=(l<<5)+r;if(c[1]<=c[2]){if(d<c[1]||d>c[2])return 0}else if(d>c[2]&&d<c[1])return 0}if(3===a){var u=t[2];if(n%u!=(i+t[1])%u)return 0}else{if(0!==a)return 0;var h=(s.getUTCDay()+6)%7;if(0==(t[1]&1<<h))return 0}if(2===o){if(r%2!=0)return 0}else if(1===o&&(31===r||29===r&&1===s.getUTCMonth()||r%2!=1))return 0;return 1},o=function(t,e,n,i,o){var s=1&t[0],r=t[0]>>6&1,l=new Date(n);if(0===s)return 0;if(!a(t,n,i,o))return 0;if(0===r){var c=getStartTime(t[3][0],l),d=t[3][1],u=t[3][2];if(e<c)return 0;if(0===d)return e===c?1:0;if(0===u)return 0;var h=Math.round((e-c)/u);if(h*u==e-c&&h<=d)return 1}else for(var p=t[3],f=0;f<4;f++)if(e===getStartTime(p[f],l))return 1;return 0},s=function(t,e,n,i,o){var s=1&t[0],r=t[0]>>6&1,l=new Date(n);if(0===s)return 0;var c,d=getStartTime(t[3][0],l),u=t[3][1],h=t[3][2];if(a(t,n,i,o)){if(0!==r){for(var p=t[3],f=0;f<4;f++)if(e===getStartTime(p[f],l))return 1;return 0}if(e===d)return 1;if(e>d&&h&&(c=Math.round((e-d)/h))*h==e-d&&c<=u)return 1}return r||!h?0:a(t,n-864e5,i-1,o)&&(c=Math.round((e-d+1440)/h))*h==e-d+1440&&c<=u?1:0},d=function(t){p.setDate(p.getDate()+t);var e=pad(p.getMonth()+1),n=pad(p.getDate()),i=p.getFullYear();h=[i,e,n],b.find("#preview_date").val(h.join("-")),u()},u=function(){if(e(h[1],h[2],h[0]),w.hide(),t.length){t.sort(sortByStation);var n=[],i=new Date(h[0],h[1]-1,h[2],24);$.each(t,(function(){var t=this.start+this.end;if(this.start=new Date(h[0],h[1]-1,h[2],0,0,this.start),t>86400){var e=Math.floor(this.end/86400);this.end=new Date(h[0],h[1]-1,parseInt(h[2])+e,0,0,this.end%86400),i=i>this.end?i:this.end}else this.end=new Date(h[0],h[1]-1,h[2],0,0,this.end);n[this.group]=this.shortname}));var o={width:"100%",editable:!1,axisOnTop:!0,eventMargin:10,eventMarginAxis:0,min:new Date(h[0],h[1]-1,h[2],0),max:i,selectable:!0,showMajorLabels:!1,zoomMax:864e5,zoomMin:36e5,groupsChangeable:!1,showNavigation:!1,groupsOrder:"none",groupMinHeight:20},a=function(){s.redraw()},s=new links.Timeline(y[0],o),r=new Date(f);r.setMinutes(r.getMinutes()+r.getTimezoneOffset()),s.setCurrentTime(r),links.events.addListener(s,"select",(function(){var t=s.getSelection();t.length&&void 0!==t[0].row&&changePage("#programs",{programToExpand:parseInt(s.getItem(t[0].row).pid)})})),$.mobile.window.on("resize",a),b.one("pagehide",(function(){$.mobile.window.off("resize",a)})),s.draw(t),b.find(".timeline-groups-text").each((function(){var t=$(this),e=n[t.text()];t.attr("data-shortname",e)})),b.find(".timeline-groups-axis").children().first().html("<div class='timeline-axis-text center dayofweek' data-shortname='"+getDayName(p,"short")+"'>"+getDayName(p)+"</div>"),isAndroid?(w.find(".ui-icon-plus").off("click").on("click",(function(){return s.zoom(.4),!1})),w.find(".ui-icon-minus").off("click").on("click",(function(){return s.zoom(-.4),!1})),w.find(".ui-icon-carat-l").off("click").on("click",(function(){return s.move(-.2),!1})),w.find(".ui-icon-carat-r").off("click").on("click",(function(){return s.move(.2),!1})),w.show()):w.hide(),y.on("swiperight swipeleft",(function(t){t.stopImmediatePropagation()}))}else b.find("#timeline").html("<p align='center'>"+_("No stations set to run on this day.")+"</p>")},function(){m=checkOSVersion(210),g=checkOSVersion(211),v=checkOSVersion(216),""===b.find("#preview_date").val()&&(f=new Date(1e3*controller.settings.devt),h=f.toISOString().slice(0,10).split("-"),p=new Date(h[0],h[1]-1,h[2]),b.find("#preview_date").val(h.join("-"))),changeHeader({title:_("Program Preview"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#preview").remove(),$.mobile.pageContainer.append(b)}}();function getStationDuration(t,e){if(checkOSVersion(214)){var n=getSunTimes(e);65535===t?t=60*(n[0]+1440-n[1]):65534===t&&(t=60*(n[1]-n[0]))}return t}var getLogs=function(){var t,e,n,i=$("<div data-role='page' id='logs'><div class='ui-content' role='main'><fieldset data-role='controlgroup' data-type='horizontal' data-mini='true' class='log_type'><input data-mini='true' type='radio' name='log_type' id='log_timeline' value='timeline'><label for='log_timeline'>"+_("Timeline")+"</label><input data-mini='true' type='radio' name='log_type' id='log_table' value='table'><label for='log_table'>"+_("Table")+"</label></fieldset><fieldset data-role='collapsible' data-mini='true' id='log_options' class='center'><legend>"+_("Options")+"</legend><fieldset data-role='controlgroup' data-type='horizontal' id='table_sort'><p class='tight'>"+_("Grouping:")+"</p><input data-mini='true' type='radio' name='table-group' id='table-sort-day' value='day' checked='checked'><label for='table-sort-day'>"+_("Day")+"</label><input data-mini='true' type='radio' name='table-group' id='table-sort-station' value='station'><label for='table-sort-station'>"+_("Station")+"</label></fieldset><div class='ui-field-contain'><label for='log_start'>"+_("Start:")+"</label><input data-mini='true' type='date' id='log_start'><label for='log_end'>"+_("End:")+"</label><input data-mini='true' type='date' id='log_end'></div><a data-role='button' data-icon='action' class='export_logs' href='#' data-mini='true'>"+_("Export")+"</a><a data-role='button' class='red clear_logs' href='#' data-mini='true' data-icon='alert'>"+_("Clear Logs")+"</a></fieldset><div id='logs_list' class='center'></div></div></div>"),o=i.find("#logs_list"),a=i.find("#table_sort"),s=i.find("#log_options"),r=[],l=[],c=[],d=function(e,i){var o=[],a={totalRuntime:0,totalCount:0};if("table"===e&&"station"===i)for(n=0;n<t.length;n++)o[n]=[];return $.each(r,(function(){var n=this[1],s=parseInt(this[2]);s<0&&(s+=65536);var r=new Date(parseInt(1e3*this[3])-1e3*s),l=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds());if("string"==typeof n)if("rd"===n)n=t.length-1;else if("s1"===n)n=t.length-3;else if("s2"===n)n=t.length-2;else{if("rs"!==n)return;n=t.length-2}else if("number"==typeof n){if(n>t.length-2||Station.isMaster(n))return;a.totalRuntime+=s,a.totalCount++}if("table"===e)switch(i){case"station":o[n].push([l,dhms2str(sec2dhms(s))]);break;case"day":var c=Math.floor(r.getTime()/1e3/60/60/24),d=[l,dhms2str(sec2dhms(s)),n];"object"!=typeof o[c]?o[c]=[d]:o[c].push(d)}else if("timeline"===e){var u,h,p,f,m=parseInt(this[0]);if("rs"===this[1])u="delayed",p=h=_("Rain Sensor"),f=_("RS");else if("rd"===this[1])u="delayed",p=h=_("Rain Delay"),f=_("RD");else if("s1"===this[1])u="delayed",p=h=3===controller.options.sn1t?_("Soil Sensor"):_("Rain Sensor"),f=_("SEN1");else if("s2"===this[1])u="delayed",p=h=3===controller.options.sn2t?_("Soil Sensor"):_("Rain Sensor"),f=_("SEN2");else{if(0===m)return;u="program-"+(m+3)%4,h=pidname(m),p=controller.stations.snames[n],f="S"+(n+1)}o.push({start:l,end:new Date(l.getTime()+1e3*s),className:u,content:h,pid:m-1,shortname:f,group:p,station:n})}})),"timeline"===e&&o.sort(sortByStation),[o,a]},u=function(t,e){var n=[],i=[];return l.length&&(t.avgWaterLevel=0,$.each(l,(function(){n[Math.floor(this[3]/60/60/24)]=this[2],t.avgWaterLevel+=this[2]})),t.avgWaterLevel=parseFloat((t.avgWaterLevel/l.length).toFixed(2))),c.length&&(t.totalVolume=0,$.each(c,(function(){var n=flowCountToVolume(this[0]);if("timeline"===e){var o=new Date(parseInt(1e3*this[3])),a=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());i.push({start:new Date(a.getTime()-parseInt(1e3*this[2])),end:a,className:"",content:n+" L",shortname:_("FS"),group:_("Flow Sensor")})}else{var s=Math.floor(this[3]/60/60/24);i[s]=i[s]?i[s]+n:n}t.totalVolume+=n}))),[n,i,t]},h=function(t,e,n){if("object"!=typeof t||t.length<1||t.result&&32===t.result)return $.mobile.loading("hide"),void v();try{c=JSON.parse(c.replace(/,\s*inf/g,""))}catch(t){c=[]}r=t,l=$.isEmptyObject(e)?[]:e,c=$.isEmptyObject(n)?[]:n,p(),exportObj(".export_logs",r),$.mobile.loading("hide")},p=function(){i.find("#log_table").prop("checked")?m():i.find("#log_timeline").prop("checked")&&f()},f=function(){if(r.length<1)v();else{a.hide(),o.show(),s.collapsible("collapse");var t=d("timeline"),e=u(t[1],"timeline"),n=t[0].concat(e[1]),l=e[2],c={width:"100%",editable:!1,axisOnTop:!0,eventMargin:10,eventMarginAxis:0,min:y().start,max:new Date(y().end.getTime()+8634e4),selectable:!1,showMajorLabels:!1,groupsChangeable:!1,showNavigation:!1,groupsOrder:"none",groupMinHeight:20,zoomMin:6e4},h=function(){m.redraw()},p=function(){$.mobile.window.off("resize",h)},f=[];o.on("swiperight swipeleft",(function(t){t.stopImmediatePropagation()})),$.each(n,(function(){f[this.group]=this.shortname}));var m=new links.Timeline(o.get(0),c);$.mobile.window.on("resize",h),i.one("pagehide",p),i.find("input:radio[name='log_type']").one("change",p),m.draw(n),o.find(".timeline-groups-text").each((function(){this.setAttribute("data-shortname",f[this.textContent])})),o.prepend(g(l))}},m=function(){if(r.length<1)v();else{a.show(),o.show();var e,n,l,c=i.find("input:radio[name='table-group']:checked").val(),h=d("table",c),p=h[0],f=u(h[1]),m=[],b=f[0],y=f[1],w=f[2],k="<table><thead><tr><th data-priority='1'>"+_("Runtime")+"</th><th data-priority='2'>"+("station"===c?_("Date/Time"):_("Time")+"</th><th>"+_("Station"))+"</th></tr></thead><tbody>",S=g(w)+"<div data-role='collapsible-set' data-inset='true' data-theme='b' data-collapsed-icon='arrow-d' data-expanded-icon='arrow-u'>",T=0;for(e in p)if(p.hasOwnProperty(e)){if(0===(n=p[e].length))continue;for(m[T]="<div data-role='collapsible' data-collapsed='true'><h2>"+(checkOSVersion(210)&&"day"===c?"<a class='ui-btn red ui-btn-corner-all delete-day day-"+e+"'>"+_("delete")+"</a>":"")+"<div class='ui-btn-up-c ui-btn-corner-all custom-count-pos'>"+n+" "+_(1===n?"run":"runs")+"</div>"+("station"===c?t[e]:dateToString(new Date(1e3*e*60*60*24)).slice(0,-9))+"</h2>",b[e]&&(m[T]+="<span style='border:none' class='"+(100!==b[e]?b[e]<100?"green ":"red ":"")+"ui-body ui-body-a'>"+_("Average")+" "+_("Water Level")+": "+b[e]+"%</span>"),y[e]&&(m[T]+="<span style='border:none' class='ui-body ui-body-a'>"+_("Total Water Used")+": "+y[e]+" L</span>"),m[T]+=k,l=0;l<p[e].length;l++){var C=new Date(p[e][l][0]);m[T]+="<tr><td>"+p[e][l][1]+"</td><td>"+("station"===c?dateToString(C,!1):pad(C.getHours())+":"+pad(C.getMinutes())+":"+pad(C.getSeconds())+"</td><td>"+t[p[e][l][2]])+"</td></tr>"}m[T]+="</tbody></table></div>",T++}"day"===c&&m.reverse(),s.collapsible("collapse"),o.html(S+m.join("")+"</div>").enhanceWithin(),o.find(".delete-day").on("click",(function(){var t,e;return $.each(this.className.split(" "),(function(){if(0===this.indexOf("day-"))return t=this.split("day-")[1],!1})),e=dateToString(new Date(1e3*t*60*60*24)).slice(0,-9),areYouSure(_("Are you sure you want to ")+_("delete")+" "+e+"?","",(function(){$.mobile.loading("show"),sendToOS("/dl?pw=&day="+t).done((function(){x(),showerror(e+" "+_("deleted"))}))})),!1})),fixInputClick(o)}},g=function(t){if(0===t.totalCount||0===t.totalRuntime)return"";var e=void 0!==t.avgWaterLevel;return"<div class='ui-body-a smaller' id='logs_summary'><div><span class='bold'>"+_("Total Station Events")+"</span>: "+t.totalCount+"</div><div><span class='bold'>"+_("Total Runtime")+"</span>: "+dhms2str(sec2dhms(t.totalRuntime))+"</div>"+(e?"<div><span class='bold'>"+_("Average")+" "+_("Water Level")+"</span>: <span class='"+(100!==t.avgWaterLevel?t.avgWaterLevel<100?"green-text":"red-text":"")+"'>"+t.avgWaterLevel+"%</span></div>":"")+(void 0!==t.totalVolume&&t.totalVolume>0?"<div><span class='bold'>"+_("Total Water Used")+"</span>: "+t.totalVolume+" L"+(e&&t.avgWaterLevel<100?" (<span class='green-text'>"+(t.totalVolume-t.totalVolume*(t.avgWaterLevel/100)).toFixed(2)+"L saved</span>)":"")+"</div>":"")+"</div>"},v=function(){r=[],s.collapsible("expand"),a.hide(),o.show().html(_("No entries found in the selected date range"))},b=function(){$.mobile.loading("hide"),a.empty().hide(),o.show().html(_("Error retrieving log data. Please refresh to try again."))},y=function(){var t=S.val().split("-"),e=T.val().split("-");return{start:new Date(t[0],t[1]-1,t[2]),end:new Date(e[0],e[1]-1,e[2])}},w=function(){return"start="+y().start.getTime()/1e3+"&end="+(y().end.getTime()/1e3+86340)},x=function(){var t=y().end.getTime()/1e3,e=y().start.getTime()/1e3;if(t<e)return v(),void showerror(_("Start time cannot be greater than end time"));var n=0;if($.mobile.loading("show"),t-e>3154e4){showerror(_("The requested time span exceeds the maxiumum of 1 year and has been adjusted"),3500);var i=y().start;i.setFullYear(i.getFullYear()+1),$("#log_end").val(i.getFullYear()+"-"+pad(i.getMonth()+1)+"-"+pad(i.getDate())),n=500}var o=$.Deferred().resolve(),a=$.Deferred().resolve();checkOSVersion(211)&&(o=sendToOS("/jl?pw=&type=wl&"+w(),"json")),checkOSVersion(216)&&(a=sendToOS("/jl?pw=&type=fl&"+w())),setTimeout((function(){$.when(sendToOS("/jl?pw=&"+w(),"json"),o,a).then(h,b)}),n)},k=window.innerWidth<640,S=i.find("#log_start"),T=i.find("#log_end");return i.find(".clear_logs").on("click",(function(){return clearLogs(x),!1})),isiOS?S.add(T).on("blur",(function(){i.hasClass("ui-page-active")&&x()})):S.add(T).change((function(){clearTimeout(e),e=setTimeout(x,1e3)})),a.find("input[name='table-group']").change((function(){m()})),i.find("input:radio[name='log_type']").change(p),i.on({pagehide:function(){i.detach()},pageshow:x}),i.find("#log_timeline").prop("checked",!k),i.find("#log_table").prop("checked",k),function(){var e=checkOSVersion(219)?[3===controller.options.sn1t?_("Soil Sensor"):_("Rain Sensor"),3===controller.options.sn2t?_("Soil Sensor"):_("Rain Sensor"),_("Rain Delay")]:[_("Rain Sensor"),_("Rain Delay")];if(t=$.merge($.merge([],controller.stations.snames),e),i.find(".clear_logs").toggleClass("hidden",!isOSPi()&&!checkOSVersion(210)),""===S.val()||""===T.val()){var n=new Date(1e3*controller.settings.devt);S.val(new Date(n.getTime()-6048e5).toISOString().slice(0,10)),T.val(n.toISOString().slice(0,10))}changeHeader({title:_("Logs"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack},rightBtn:{icon:"refresh",text:_("Refresh"),on:x}}),$("#logs").remove(),$.mobile.pageContainer.append(i)}}();function clearLogs(t){areYouSure(_("Are you sure you want to clear ALL your log data?"),"",(function(){var e=isOSPi()?"/cl?pw=":"/dl?pw=&day=all";$.mobile.loading("show"),sendToOS(e).done((function(){"function"==typeof t&&t(),showerror(_("Logs have been cleared"))}))}))}function clearPrograms(t){areYouSure(_("Are you sure you want to delete ALL programs?"),"",(function(){$.mobile.loading("show"),sendToOS("/dp?pw=&pid=-1").done((function(){"function"==typeof t&&t(),showerror(_("Programs have been deleted"))}))}))}function resetAllOptions(t){areYouSure(_("Are you sure you want to delete all settings and return to the default settings?"),"",(function(){var e;isOSPi()?e="otz=32&ontp=1&onbrd=0&osdt=0&omas=0&omton=0&omtoff=0&orst=1&owl=100&orlp=0&ouwt=0&olg=1&oloc=Boston,MA":(e="o2=1&o3=1&o12=80&o13=0&o15=0&o17=0&o18=0&o19=0&o20=0&o22=1&o23=100&o26=0&o27=110&o28=100&o29=15&o30=320&o31=0&o36=1&o37=0&o38=0&o39=0&o41=100&o42=0&o43=0&o44=8&o45=8&o46=8&o47=8&o48=0&o49=0&o50=0&o51=1&o52=0&o53=1&o54=0&o55=0&o56=0&o57=0&",checkOSVersion(2199)?e+="o32=0&o33=0&o34=0&o35=0&":e+="o32=216&o33=239&o34=35&o35=12&",e=transformKeysinString(e+="loc=Boston,MA&wto=%22key%22%3A%22%22")),sendToOS("/co?pw=&"+e).done((function(){"function"==typeof t&&t(),updateController(updateWeather)}))}))}var getPrograms=function(){var t,e=$("<div data-role='page' id='programs'><div class='ui-content' role='main' id='programs_list'></div></div>");function n(){var t=$(makeAllPrograms());t.find("[id^=program-]").on({collapsiblecollapse:function(){$(this).find(".ui-collapsible-content").empty()},collapsiblebeforecollapse:function(t){var e=$(this),n=e.find(".hasChanges");n.length&&(areYouSure(_("Do you want to save your changes?"),"",(function(){n.removeClass("hasChanges").click(),e.collapsible("collapse")}),(function(){n.removeClass("hasChanges"),e.collapsible("collapse")})),t.preventDefault())},collapsibleexpand:function(){expandProgram($(this))}}),checkOSVersion(210)&&t.find(".move-up").removeClass("hidden").on("click",(function(){var t=$(this).parents("fieldset"),n=parseInt(t.attr("id").split("-")[1]);return $.mobile.loading("show"),sendToOS("/up?pw=&pid="+n).done((function(){updateControllerPrograms((function(){$.mobile.loading("hide"),e.trigger("programrefresh")}))})),!1})),t.find(".program-copy").on("click",(function(){return changePage("#addprogram",{copyID:parseInt($(this).parents("fieldset").attr("id").split("-")[1])}),!1})),e.find("#programs_list").html(t.enhanceWithin())}return e.on("programrefresh",n).on("pagehide",(function(){e.detach()})).on("pagebeforeshow",(function(){updateProgramHeader(),"number"!=typeof t&&1===controller.programs.pd.length&&(t=0),"number"==typeof t&&(e.find("fieldset[data-collapsed='false']").collapsible("collapse"),$("#program-"+t).collapsible("expand"))})),function(i){t=i,changeHeader({title:_("Programs"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:checkChangesBeforeBack},rightBtn:{icon:"plus",text:_("Add"),on:function(){checkChanges((function(){changePage("#addprogram")}))}}}),n(),$("#programs").remove(),$.mobile.pageContainer.append(e)}}();function expandProgram(t){var e=parseInt(t.attr("id").split("-")[1]);t.find(".ui-collapsible-content").html(makeProgram(e)).enhanceWithin().on("change input click",(function(e){"click"===e.type&&"BUTTON"!==e.target.tagName||($(this).off("change input click"),t.find("[id^='submit-']").addClass("hasChanges"))})),t.find("[id^='submit-']").on("click",(function(){return submitProgram(e),!1})),t.find("[id^='delete-']").on("click",(function(){return deleteProgram(e),!1})),t.find("[id^='run-']").on("click",(function(){return areYouSure(_("Are you sure you want to start "+(checkOSVersion(210)?controller.programs.pd[e][5]:"Program "+e)+" now?"),"",(function(){var t=[],n=function(){t.push(0),submitRunonce(t)};if(checkOSVersion(210)){if(t=controller.programs.pd[e][4],controller.programs.pd[e][0]>>1&1)return areYouSure(_("Do you wish to apply the current watering level?"),"",(function(){for(var e=t.length-1;e>=0;e--)t[e]=parseInt(t[e]*(controller.options.wl/100));n()}),n),!1}else{var i=parseInt($("#duration-"+e).val()),o=$("[id^='station_'][id$='-"+e+"']");$.each(o,(function(){$(this).is(":checked")?t.push(i):t.push(0)}))}n()})),!1}))}function readProgram(t){return checkOSVersion(210)?readProgram21(t):readProgram183(t)}function readProgram183(t){var e=t[1],n=t[2],i=!1,o=!1,a=!1,s="",r="",l={};l.en=t[0];for(var c=0;c<controller.programs.nboards;c++)for(var d=t[7+c],u=0;u<8;u++)r+=d&1<<u?"1":"0";if(l.stations=r,l.duration=t[6],l.start=t[3],l.end=t[4],l.interval=t[5],128&e&&n>1)s=[n,127&e],a=!0;else{for(var h=0;h<7;h++)s+=e&1<<h?"1":"0";128&e&&0===n&&(i=!0),128&e&&1===n&&(o=!0)}return l.days=s,l.is_even=i,l.is_odd=o,l.is_interval=a,l}function readProgram21(t){var e=t[1],n=t[2],i=t[0]>>2&3,o=t[0]>>4&3,a=t[0]>>6&1,s="",r={repeat:0,interval:0};if(r.en=t[0]>>0&1,r.weather=t[0]>>1&1,r.is_even=2===i,r.is_odd=1===i,r.is_interval=3===o,r.stations=t[4],r.name=t[5],0===a?(r.start=t[3][0],r.repeat=t[3][1],r.interval=t[3][2]):1===a&&(r.start=t[3]),3===o)s=[n,e];else if(0===o)for(var l=0;l<7;l++)s+=e&1<<l?"1":"0";return r.days=s,r}function getStartTime(t,e){var n=2047&t,i=0,o=getSunTimes(e);if(t<0)return t;if(t>>13&1)i=1;else if(1&!(t>>14))return t;return t>>12&1&&(n=-n),t=o[i],(t+=n)<0?t=0:t>1440&&(t=1440),t}function readStartTime(t){var e=2047&t,n=_("Sunrise");if(t>>13&1)n=_("Sunset");else if(1&!(t>>14))return minutesToTime(t);return t>>12&1&&(e=-e),n+(0!==e?(e>0?"+":"")+dhms2str(sec2dhms(60*e)):"")}function pidname(t){var e=_("Program")+" "+t;return 255===t||99===t?e=_("Manual program"):254===t||98===t?e=_("Run-once program"):checkOSVersion(210)&&t<=controller.programs.pd.length&&(e=controller.programs.pd[t-1][5]),e}function updateProgramHeader(){$("#programs_list").find("[id^=program-]").each((function(t,e){var n=$(e).find(".ui-collapsible-heading-toggle");(checkOSVersion(210)?1&controller.programs.pd[t][0]:controller.programs.pd[t][0])?n.removeClass("red"):n.addClass("red")}))}function makeAllPrograms(){if(0===controller.programs.pd.length)return"<p class='center'>"+_("You have no programs currently added. Tap the Add button on the top right corner to get started.")+"</p>";for(var t,e="<p class='center'>"+_("Click any program below to expand/edit. Be sure to save changes.")+"</p><div data-role='collapsible-set'>",n=0;n<controller.programs.pd.length;n++)t=_("Program")+" "+(n+1),checkOSVersion(210)&&(t=controller.programs.pd[n][5]),e+="<fieldset id='program-"+n+"' data-role='collapsible'><h3><a "+(n>0?"":"style='visibility:hidden' ")+"class='hidden ui-btn ui-btn-icon-notext ui-icon-arrow-u ui-btn-corner-all move-up'></a><a class='ui-btn ui-btn-corner-all program-copy'>"+_("copy")+"</a><span class='program-name'>"+t+"</span></h3>",e+="</fieldset>";return e+"</div>"}function makeProgram(t,e){return checkOSVersion(210)?makeProgram21(t,e):makeProgram183(t,e)}function makeProgram183(t,e){var n,i,o,a,s,r,l=[_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday"),_("Sunday")],c="",d=e?"new":t;if("string"==typeof(s="new"===t?{en:0,weather:0,is_interval:0,is_even:0,is_odd:0,duration:0,interval:0,start:0,end:0,days:[0,0]}:readProgram(controller.programs.pd[t])).days)for(i=(n=s.days.split("")).length;i--;)n[i]=0|n[i];else n=[0,0,0,0,0,0,0];if(void 0!==s.stations)for(i=(a=s.stations.split("")).length-1;i>=0;i--)a[i]=0|a[i];for(c+="<label for='en-"+d+"'><input data-mini='true' type='checkbox' "+(s.en||"new"===t?"checked='checked'":"")+" name='en-"+d+"' id='en-"+d+"'>"+_("Enabled")+"</label>",c+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",c+="<input data-mini='true' type='radio' name='rad_days-"+d+"' id='days_week-"+d+"' value='days_week-"+d+"' "+(s.is_interval?"":"checked='checked'")+"><label for='days_week-"+d+"'>"+_("Weekly")+"</label>",c+="<input data-mini='true' type='radio' name='rad_days-"+d+"' id='days_n-"+d+"' value='days_n-"+d+"' "+(s.is_interval?"checked='checked'":"")+"><label for='days_n-"+d+"'>"+_("Interval")+"</label>",c+="</fieldset><div id='input_days_week-"+d+"' "+(s.is_interval?"style='display:none'":"")+">",c+="<div class='center'><p class='tight'>"+_("Restrictions")+"</p><select data-inline='true' data-iconpos='left' data-mini='true' id='days_rst-"+d+"'>",c+="<option value='none' "+(s.is_even||s.is_odd?"":"selected='selected'")+">"+_("None")+"</option>",c+="<option value='odd' "+(!s.is_even&&s.is_odd?"selected='selected'":"")+">"+_("Odd Days Only")+"</option>",c+="<option value='even' "+(!s.is_odd&&s.is_even?"selected='selected'":"")+">"+_("Even Days Only")+"</option>",c+="</select></div>",c+="<div class='center'><p class='tight'>"+_("Days of the Week")+"</p><select "+($.mobile.window.width()>560?"data-inline='true' ":"")+"data-iconpos='left' data-mini='true' multiple='multiple' data-native-menu='false' id='d-"+d+"'><option>"+_("Choose day(s)")+"</option>",o=0;o<l.length;o++)c+="<option "+(!s.is_interval&&n[o]?"selected='selected'":"")+" value='"+o+"'>"+l[o]+"</option>";for(c+="</select></div></div>",c+="<div "+(s.is_interval?"":"style='display:none'")+" id='input_days_n-"+d+"' class='ui-grid-a'>",c+="<div class='ui-block-a'><label class='center' for='every-"+d+"'>"+_("Interval (Days)")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='every-"+d+"' pattern='[0-9]*' id='every-"+d+"' value='"+s.days[0]+"'></div>",c+="<div class='ui-block-b'><label class='center' for='starting-"+d+"'>"+_("Starting In")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='starting-"+d+"' pattern='[0-9]*' id='starting-"+d+"' value='"+s.days[1]+"'></div>",c+="</div>",c+="<fieldset data-role='controlgroup'><legend>"+_("Stations:")+"</legend>",o=0;o<controller.stations.snames.length;o++)c+="<label for='station_"+o+"-"+d+"'><input "+(Station.isDisabled(o)?"data-wrapper-class='station-hidden hidden' ":"")+"data-mini='true' type='checkbox' "+(void 0!==a&&a[o]?"checked='checked'":"")+" name='station_"+o+"-"+d+"' id='station_"+o+"-"+d+"'>"+controller.stations.snames[o]+"</label>";return c+="</fieldset>",c+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",c+="<button class='ui-btn ui-mini' name='s_checkall-"+d+"' id='s_checkall-"+d+"'>"+_("Check All")+"</button>",c+="<button class='ui-btn ui-mini' name='s_uncheckall-"+d+"' id='s_uncheckall-"+d+"'>"+_("Uncheck All")+"</button>",c+="</fieldset>",c+="<div class='ui-grid-a'>",c+="<div class='ui-block-a'><label class='center' for='start-"+d+"'>"+_("Start Time")+"</label><button class='timefield pad_buttons' data-mini='true' id='start-"+d+"' value='"+s.start+"'>"+minutesToTime(s.start)+"</button></div>",c+="<div class='ui-block-b'><label class='center' for='end-"+d+"'>"+_("End Time")+"</label><button class='timefield pad_buttons' data-mini='true' id='end-"+d+"' value='"+s.end+"'>"+minutesToTime(s.end)+"</button></div>",c+="</div>",c+="<div class='ui-grid-a'>",c+="<div class='ui-block-a'><label class='pad_buttons center' for='duration-"+d+"'>"+_("Station Duration")+"</label><button class='pad_buttons' data-mini='true' name='duration-"+d+"' id='duration-"+d+"' value='"+s.duration+"'>"+dhms2str(sec2dhms(s.duration))+"</button></div>",c+="<div class='ui-block-b'><label class='pad_buttons center' for='interval-"+d+"'>"+_("Program Interval")+"</label><button class='pad_buttons' data-mini='true' name='interval-"+d+"' id='interval-"+d+"' value='"+60*s.interval+"'>"+dhms2str(sec2dhms(60*s.interval))+"</button></div>",c+="</div>",!0===e||"new"===t?c+="<input data-mini='true' data-icon='check' type='submit' data-theme='b' name='submit-"+d+"' id='submit-"+d+"' value='"+_("Save New Program")+"'>":(c+="<button data-mini='true' data-icon='check' data-theme='b' name='submit-"+d+"' id='submit-"+d+"'>"+_("Save Changes to Program")+" "+(t+1)+"</button>",c+="<button data-mini='true' data-icon='arrow-r' name='run-"+d+"' id='run-"+d+"'>"+_("Run Program")+" "+(t+1)+"</button>",c+="<button data-mini='true' data-icon='delete' class='red bold' data-theme='b' name='delete-"+d+"' id='delete-"+d+"'>"+_("Delete Program")+" "+(t+1)+"</button>"),(r=$(c)).find("input[name^='rad_days']").on("change",(function(){var t,e=$(this).val().split("-")[0];t="n"===(e=e.split("_")[1])?"week":"n",$("#input_days_"+e+"-"+d).show(),$("#input_days_"+t+"-"+d).hide()})),r.find("[id^='duration-'],[id^='interval-']").on("click",(function(){var t=$(this),e=t.attr("id").match("interval")?1:0,n=r.find("label[for='"+t.attr("id")+"']").text();showDurationBox({seconds:t.val(),title:n,callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e)))},maximum:e?86340:65535,granularity:e})})),r.find(".timefield").on("click",(function(){var t=$(this),e=r.find("label[for='"+t.attr("id")+"']").text();showTimeInput({minutes:t.val(),title:e,callback:function(e){t.val(e),t.text(minutesToTime(e))}})})),r.find("[id^='s_checkall-']").on("click",(function(){return r.find("[id^='station_'][id$='-"+d+"']").prop("checked",!0).checkboxradio("refresh"),!1})),r.find("[id^='s_uncheckall-']").on("click",(function(){return r.find("[id^='station_'][id$='-"+d+"']").prop("checked",!1).checkboxradio("refresh"),!1})),fixInputClick(r),r}function makeProgram21(t,e){var n,i,o,a,s,r,l,c,d=[_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday"),_("Sunday")],u="",h=e?"new":t;if("string"==typeof(a="new"===t?{name:"",en:0,weather:0,is_interval:0,is_even:0,is_odd:0,interval:0,start:0,days:[0,0],repeat:0,stations:[]}:readProgram(controller.programs.pd[t])).days)for(i=(n=a.days.split("")).length;i--;)n[i]=0|n[i];else n=[0,0,0,0,0,0,0];if(r="object"==typeof a.start?a.start:[a.start,-1,-1,-1],u+="<div style='margin-top:5px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Basic Settings")+"</h3></div>",u+="<div class='ui-body ui-body-a center'>",u+="<label for='name-"+h+"'>"+_("Program Name")+"</label><input data-mini='true' type='text' name='name-"+h+"' id='name-"+h+"' maxlength='"+controller.programs.pnsize+"' placeholder='"+_("Program")+" "+(controller.programs.pd.length+1)+"' value=\""+a.name+'">',u+="<label for='en-"+h+"'><input data-mini='true' type='checkbox' "+(a.en||"new"===t?"checked='checked'":"")+" name='en-"+h+"' id='en-"+h+"'>"+_("Enabled")+"</label>",u+="<label for='uwt-"+h+"'><input data-mini='true' type='checkbox' "+(a.weather?"checked='checked'":"")+" name='uwt-"+h+"' id='uwt-"+h+"'>"+_("Use Weather Adjustment")+"</label>",Supported.dateRange()){var p=Program.getDateRangeStart(h),f=Program.getDateRangeEnd(h);u+="<label for='use-dr-"+h+"'><input data-mini='true' type='checkbox' "+(Program.isDateRangeEnabled(h)?"checked='checked'":"")+" name='use-dr-"+h+"' id='use-dr-"+h+"'>"+_("Enable Date Range")+"</label>",u+="<div id='date-range-options-"+h+"'"+(Program.isDateRangeEnabled(h)?"":"style='display:none'")+">",u+="<div class='ui-grid-a' style=''><div class='ui-block-a drfrom'><label class='center' for='from-dr-"+h+"'>"+_("From (mm/dd)")+"</label><div class='dr-input'><input type='text' placeholder='MM/DD' id='from-dr-"+h+"' value="+decodeDate(p)+"></input></div></div><div class='ui-block-b drto'><label class='center' for='to-dr-"+h+"'>"+_("To (mm/dd)")+"</label><div class='dr-input'><input type='text' placeholder='MM/DD' id='to-dr-"+h+"' value="+decodeDate(f)+"></input></div></div></div></div>"}for(u+="<label class='center' for='start_1-"+h+"'>"+_("Start Time")+"</label><button class='timefield' data-mini='true' id='start_1-"+h+"' value='"+r[0]+"'>"+readStartTime(r[0])+"</button>",u+="</div></div></div></div>",u+="<div style='margin-top:10px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Program Type")+"</h3></div>",u+="<div class='ui-body ui-body-a'>",u+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",u+="<input data-mini='true' type='radio' name='rad_days-"+h+"' id='days_week-"+h+"' value='days_week-"+h+"' "+(a.is_interval?"":"checked='checked'")+"><label for='days_week-"+h+"'>"+_("Weekly")+"</label>",u+="<input data-mini='true' type='radio' name='rad_days-"+h+"' id='days_n-"+h+"' value='days_n-"+h+"' "+(a.is_interval?"checked='checked'":"")+"><label for='days_n-"+h+"'>"+_("Interval")+"</label>",u+="</fieldset>",u+="<div id='input_days_week-"+h+"' "+(a.is_interval?"style='display:none'":"")+">",u+="<div class='center'><p class='tight'>"+_("Days of the Week")+"</p><select "+($.mobile.window.width()>560?"data-inline='true' ":"")+"data-iconpos='left' data-mini='true' multiple='multiple' data-native-menu='false' id='d-"+h+"'><option>"+_("Choose day(s)")+"</option>",o=0;o<d.length;o++)u+="<option "+(!a.is_interval&&n[o]?"selected='selected'":"")+" value='"+o+"'>"+d[o]+"</option>";u+="</select></div></div>",u+="<div "+(a.is_interval?"":"style='display:none'")+" id='input_days_n-"+h+"' class='ui-grid-a'>",u+="<div class='ui-block-a'><label class='center' for='every-"+h+"'>"+_("Interval (Days)")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='every-"+h+"' pattern='[0-9]*' id='every-"+h+"' value='"+a.days[0]+"'></div>",u+="<div class='ui-block-b'><label class='center' for='starting-"+h+"'>"+_("Starting In")+"</label><input data-wrapper-class='pad_buttons' data-mini='true' type='number' name='starting-"+h+"' pattern='[0-9]*' id='starting-"+h+"' value='"+a.days[1]+"'></div>",u+="</div>",u+="<div class='center'><p class='tight'>"+_("Restrictions")+"</p><select data-inline='true' data-iconpos='left' data-mini='true' id='days_rst-"+h+"'>",u+="<option value='none' "+(a.is_even||a.is_odd?"":"selected='selected'")+">"+_("None")+"</option>",u+="<option value='odd' "+(!a.is_even&&a.is_odd?"selected='selected'":"")+">"+_("Odd Days Only")+"</option>",u+="<option value='even' "+(!a.is_odd&&a.is_even?"selected='selected'":"")+">"+_("Even Days Only")+"</option>",u+="</select></div>",u+="</div></div>",u+="<div style='margin-top:10px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Stations")+"</h3></div>",u+="<div class='ui-body ui-body-a'>";var m=$("#programs").hasClass("show-hidden")?"":"' style='display:none";for(o=0;o<controller.stations.snames.length;o++)Station.isMaster(o)?u+="<div class='ui-field-contain duration-input"+(Station.isDisabled(o)?" station-hidden"+m:"")+"'><label for='station_"+o+"-"+h+"'>"+controller.stations.snames[o]+":</label><button disabled='true' data-mini='true' name='station_"+o+"-"+h+"' id='station_"+o+"-"+h+"' value='0'>"+_("Master")+"</button></div>":(l=a.stations[o]||0,u+="<div class='ui-field-contain duration-input"+(Station.isDisabled(o)?" station-hidden"+m:"")+"'><label for='station_"+o+"-"+h+"'>"+controller.stations.snames[o]+":</label><button "+(l>0?"class='green' ":"")+"data-mini='true' name='station_"+o+"-"+h+"' id='station_"+o+"-"+h+"' value='"+l+"'>"+getDurationText(l)+"</button></div>");for(u+="</div></div>",u+="<div style='margin-top:10px' class='ui-corner-all'>",u+="<div class='ui-bar ui-bar-a'><h3>"+_("Additional Start Times")+"</h3></div>",u+="<div class='ui-body ui-body-a'>",u+="<fieldset data-role='controlgroup' data-type='horizontal' class='center'>",u+="<input data-mini='true' type='radio' name='stype-"+h+"' id='stype_repeat-"+h+"' value='stype_repeat-"+h+"' "+("object"==typeof a.start?"":"checked='checked'")+"><label for='stype_repeat-"+h+"'>"+_("Repeating")+"</label>",u+="<input data-mini='true' type='radio' name='stype-"+h+"' id='stype_set-"+h+"' value='stype_set-"+h+"' "+("object"==typeof a.start?"checked='checked'":"")+"><label for='stype_set-"+h+"'>"+_("Fixed")+"</label>",u+="</fieldset>",u+="<div "+("object"==typeof a.start?"style='display:none'":"")+" id='input_stype_repeat-"+h+"'>",u+="<div class='ui-grid-a'>",u+="<div class='ui-block-a'><label class='pad_buttons center' for='interval-"+h+"'>"+_("Repeat Every")+"</label><button class='pad_buttons' data-mini='true' name='interval-"+h+"' id='interval-"+h+"' value='"+60*a.interval+"'>"+dhms2str(sec2dhms(60*a.interval))+"</button></div>",u+="<div class='ui-block-b'><label class='pad_buttons center' for='repeat-"+h+"'>"+_("Repeat Count")+"</label><button class='pad_buttons' data-mini='true' name='repeat-"+h+"' id='repeat-"+h+"' value='"+a.repeat+"'>"+a.repeat+"</button></div>",u+="</div></div>",u+="<table style='width:100%;"+("object"==typeof a.start?"":"display:none")+"' id='input_stype_set-"+h+"'><tr><th class='center'>"+_("Enable")+"</th><th>"+_("Start Time")+"</th></tr>",o=1;o<4;o++)u+="<tr><td data-role='controlgroup' data-type='horizontal' class='use_master center'><label for='ust_"+(o+1)+"'><input id='ust_"+(o+1)+"' type='checkbox' "+((c=-1===r[o])?"":"checked='checked'")+"></label></td>",u+="<td><button class='timefield' data-mini='true' type='time' id='start_"+(o+1)+"-"+h+"' value='"+(c?0:r[o])+"'>"+readStartTime(c?0:r[o])+"</button></td></tr>";return u+="</table>",u+="</div></div>",!0===e||"new"===t?u+="<button data-mini='true' data-icon='check' data-theme='b' id='submit-"+h+"'>"+_("Save New Program")+"</button>":(u+="<button data-mini='true' data-icon='check' data-theme='b' id='submit-"+h+"'>"+_("Save Changes to")+" <span class='program-name'>"+a.name+"</span></button>",u+="<button data-mini='true' data-icon='arrow-r' id='run-"+h+"'>"+_("Run")+" <span class='program-name'>"+a.name+"</span></button>",u+="<button data-mini='true' data-icon='delete' class='bold red' data-theme='b' id='delete-"+h+"'>"+_("Delete")+" <span class='program-name'>"+a.name+"</span></button>"),(s=$(u)).find("input[name^='rad_days'],input[name^='stype']").on("change",(function(){var t=$(this).val().split("-")[0].split("_");$("[id^='input_"+t[0]+"_']").hide(),$("#input_"+t[0]+"_"+t[1]+"-"+h).show()})),Supported.dateRange()&&s.find("#use-dr-"+h).on("click",(function(){s.find("#date-range-options-"+h).toggle()})),s.find("[id^='interval-']").on("click",(function(){var t=$(this),e=s.find("label[for='"+t.attr("id")+"']").text();showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e),t.text(dhms2str(sec2dhms(e)))},maximum:86340,granularity:1,preventCompression:!0})})),s.find(".timefield").on("click",(function(){var t=$(this);showTimeInput({minutes:t.val(),title:_("Start Time"),showSun:!!checkOSVersion(213),callback:function(e){t.val(e),t.text(readStartTime(e))}})})),s.find("[id^='repeat-']").on("click",(function(){var t=$(this),e=s.find("label[for='"+t.attr("id")+"']").text();showSingleDurationInput({data:t.val(),title:e,label:_("Repeat Count"),callback:function(e){t.val(e).text(e)},maximum:1440})})),s.find("[id^=station_]").on("click",(function(){var t=$(this),e=controller.stations.snames[t.attr("id").split("_")[1].split("-")[0]];showDurationBox({seconds:t.val(),title:e,callback:function(e){t.val(e).addClass("green"),t.text(getDurationText(e)),0===e&&t.removeClass("green")},maximum:65535,showSun:!!checkOSVersion(214)})})),fixInputClick(s),s}function addProgram(t){t=t>=0?t:"new";var e=$("<div data-role='page' id='addprogram'><div class='ui-content' role='main' id='newprogram'><fieldset id='program-new'></fieldset></div></div>"),n=changeHeader({title:_("Add Program"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:checkChangesBeforeBack},rightBtn:{icon:"check",text:_("Submit"),on:function(){return submitProgram("new"),!1}}});e.find("#program-new").html(makeProgram(t,!0)).one("change input",(function(){n.eq(2).prop("disabled",!1).addClass("hasChanges")})),e.find("[id^='submit-']").on("click",(function(){return submitProgram("new"),!1})),e.one("pagehide",(function(){e.remove()})),"string"==typeof t&&n.eq(2).prop("disabled",!0),$("#addprogram").remove(),$.mobile.pageContainer.append(e)}function deleteProgram(t){var e=pidname(parseInt(t)+1);areYouSure(_("Are you sure you want to delete program")+" "+e+"?","",(function(){$.mobile.loading("show"),sendToOS("/dp?pw=&pid="+t).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){$("#programs").trigger("programrefresh"),showerror(_("Program")+" "+e+" "+_("deleted"))}))}))}))}function submitProgram(t){$("#program-"+t).find(".hasChanges").removeClass("hasChanges"),checkOSVersion(210)?submitProgram21(t):submitProgram183(t)}function submitProgram183(t){var e,n,i,o=[],a=[0,0],s=0,r=$("#en-"+t).is(":checked")?1:0;if(o[0]=r,$("#days_week-"+t).is(":checked")){for(e=null===(e=$("#d-"+t).val())?[]:parseIntArray(e),n=0;n<7;n++)-1!==$.inArray(n,e)&&(a[0]|=1<<n);if(0===a[0])return void showerror(_("Error: You have not selected any days of the week."));"odd"===$("#days_rst-"+t).val()?(a[0]|=128,a[1]=1):"even"===$("#days_rst-"+t).val()&&(a[0]|=128,a[1]=0)}else if($("#days_n-"+t).is(":checked")){if(a[1]=parseInt($("#every-"+t).val(),10),!(a[1]>=2&&a[1]<=128))return void showerror(_("Error: Interval days must be between 2 and 128."));if(a[0]=parseInt($("#starting-"+t).val(),10),!(a[0]>=0&&a[0]<a[1]))return void showerror(_("Error: Starting in days wrong."));a[0]|=128}if(o[1]=a[0],o[2]=a[1],o[3]=parseInt($("#start-"+t).val()),o[4]=parseInt($("#end-"+t).val()),o[3]>o[4])showerror(_("Error: Start time must be prior to end time."));else{o[5]=parseInt($("#interval-"+t).val()/60);var l=$("[id^=station_][id$=-"+t+"]").length/8;o[6]=parseInt($("#duration-"+t).val());var c,d=[0];for(c=0;c<l;c++)for(d[c]=0,i=0;i<8;i++)$("#station_"+(8*c+i)+"-"+t).is(":checked")&&(d[c]|=1<<i,s=1);o=JSON.stringify(o.concat(d)),0!==s?($.mobile.loading("show"),"new"===t?sendToOS("/cp?pw=&pid=-1&v="+o).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Program added successfully"))})),goBack()}))})):sendToOS("/cp?pw=&pid="+t+"&v="+o).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){updateProgramHeader()})),showerror(_("Program has been updated"))}))):showerror(_("Error: You have not selected any stations."))}}function submitProgram21(t,e){var n,i,o,a,s,r=[],l=[0,0],c=[0,0,0,0],d=0,u=$("#en-"+t).is(":checked")?1:0,h=$("#uwt-"+t).is(":checked")?1:0,p=0,f=checkOSVersion(2199)?1:2;if(p|=u<<0,p|=h<<1,"odd"===$("#days_rst-"+t).val()?p|=4:"even"===$("#days_rst-"+t).val()&&(p|=8),$("#days_n-"+t).is(":checked")){if(p|=48,l[1]=parseInt($("#every-"+t).val(),10),!(l[1]>=f&&l[1]<=128))return void showerror(_("Error: Interval days must be between "+f+" and 128."));if(l[0]=parseInt($("#starting-"+t).val(),10),!(l[0]>=0&&l[0]<l[1]))return void showerror(_("Error: Starting in days wrong."))}else if($("#days_week-"+t).is(":checked")){for(p|=0,n=null===(n=$("#d-"+t).val())?[]:parseIntArray(n),i=0;i<7;i++)-1!==$.inArray(i,n)&&(l[0]|=1<<i);if(0===l[0])return void showerror(_("Error: You have not selected any days of the week."))}if($("#stype_repeat-"+t).is(":checked"))p|=0,c[0]=parseInt($("#start_1-"+t).val()),c[1]=parseInt($("#repeat-"+t).val()),c[2]=parseInt($("#interval-"+t).val()/60);else if($("#stype_set-"+t).is(":checked")){p|=64,$("[id^='start_'][id$='-"+t+"']").each((function(t,e){var n=parseInt(e.value);("number"!=typeof n||t>0&&!$("#ust_"+(t+1)).is(":checked"))&&(n=-1),c[t]=n}))}var m=$("[id^=station_][id$=-"+t+"]"),g=[];if(m.each((function(){var t=parseInt(this.value);parseInt(t)>0&&(d=1),g.push(t)})),r[0]=p,r[1]=l[0],r[2]=l[1],r[3]=c,r[4]=g,o=$("#name-"+t).val(),s="",Supported.dateRange()){var v=$("#use-dr-"+t).is(":checked"),b=$("#from-dr-"+t).val(),y=$("#to-dr-"+t).val();if(!isValidDateRange(b,y))return void showerror(_("Error: date range is malformed"));s="&endr="+(v?1:0)+"&from="+encodeDate(b)+"&to="+encodeDate(y),r[0]|=v?128:0}if(a="&v="+JSON.stringify(r)+"&name="+encodeURIComponent(o),0!==d){if(!e&&$("#stype_repeat-"+t).is(":checked")&&c[1]>0){var w=calculateTotalRunningTime(g),x=60*c[2];if(w>x)return void areYouSure(_("Warning: The repeat interval ("+x+" sec) is less than the program run time ("+w+" sec)."),_("Do you want to continue?"),(function(){submitProgram21(t,!0)}))}e||3!=(p>>4&3)||1&l[1]||!((p>>2&3)>0)?($.mobile.loading("show"),"new"===t?sendToOS("/cp?pw=&pid=-1"+a+s).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){$.mobile.document.one("pageshow",(function(){showerror(_("Program added successfully"))})),goBack()}))})):sendToOS("/cp?pw=&pid="+t+a+s).done((function(){$.mobile.loading("hide"),updateControllerPrograms((function(){updateProgramHeader(),$("#program-"+t).find(".program-name").text(o)})),showerror(_("Program has been updated"))}))):areYouSure(_("Warning: The use of odd/even restrictions with the selected interval day may result in the program not running at all."),_("Do you want to continue?"),(function(){submitProgram21(t,!0)}))}else showerror(_("Error: You have not selected any stations."))}function raindelay(t){return $.mobile.loading("show"),sendToOS("/cv?pw=&rd="+t/3600).done((function(){$.mobile.loading("hide"),showLoading("#footer-running"),refreshStatus(updateWeather),showerror(_("Rain delay has been successfully set"))})),!1}function getExportMethod(){var t=$("<div data-role='popup' data-theme='a'><div class='ui-bar ui-bar-a'>"+_("Select Export Method")+"</div><div data-role='controlgroup' class='tight'><a class='ui-btn hidden fileMethod'>"+_("File")+"</a><a class='ui-btn pasteMethod'>"+_("Email")+"</a><a class='ui-btn localMethod'>"+_("Internal (within app)")+"</a></div></div>"),e=encodeURIComponent(JSON.stringify(controller)),n="OpenSprinkler Data Export on "+dateToString(new Date);isFileCapable&&t.find(".fileMethod").removeClass("hidden").attr({href:"data:text/json;charset=utf-8,"+e,download:"backup-"+(new Date).toLocaleDateString().replace(/\//g,"-")+".json"}).on("click",(function(){t.popup("close")}));var i="mailto:?subject="+encodeURIComponent(n)+"&body="+e;t.find(".pasteMethod").attr("href",i).on("click",(function(){window.open(i,isOSXApp?"_system":void 0),t.popup("close")})),t.find(".localMethod").on("click",(function(){t.popup("close"),storage.set({backup:JSON.stringify(controller)},(function(){showerror(_("Backup saved on this device"))}))})),openPopup(t,{positionTo:$("#sprinklers-settings").find(".export_config")})}function getImportMethod(t){var e=function(){var t=$("<div data-role='popup' data-theme='a' id='paste_config'><p class='ui-bar'><textarea class='textarea' rows='10' placeholder='"+_("Paste your backup here")+"'></textarea><button data-mini='true' data-theme='b'>"+_("Import")+"</button></p></div>"),e=$.mobile.window.width();return t.find("button").on("click",(function(){var e=t.find("textarea").val();if(""!==e)try{e=JSON.parse($.trim(e).replace(/“|”|″/g,'"')),t.popup("close"),importConfig(e)}catch(e){t.find("textarea").val(""),showerror(_("Unable to read the configuration file. Please check the file and try again."))}})),t.css("width",e>600?.4*e+"px":"100%"),openPopup(t),!1},n=$("<div data-role='popup' data-theme='a'><div class='ui-bar ui-bar-a'>"+_("Select Import Method")+"</div><div data-role='controlgroup' class='tight'><button class='hidden fileMethod'>"+_("File")+"</button><button class='pasteMethod'>"+_("Email (copy/paste)")+"</button><button class='hidden localMethod'>"+_("Internal (within app)")+"</button></div></div>");if(isFileCapable)n.find(".fileMethod").removeClass("hidden").on("click",(function(){n.popup("close");var t=$("<input type='file' id='configInput' data-role='none' style='visibility:hidden;position:absolute;top:-50px;left:-50px'/>").on("change",(function(){var t=this.files[0],e=new FileReader;"object"==typeof t&&(e.onload=function(t){try{importConfig(JSON.parse($.trim(t.target.result)))}catch(t){showerror(_("Unable to read the configuration file. Please check the file and try again."))}},e.readAsText(t))}));return t.appendTo("#sprinklers-settings"),t.click(),!1}));else if(!t)return void e();n.find(".pasteMethod").on("click",(function(){return n.popup("close"),e(),!1})),t&&n.find(".localMethod").removeClass("hidden").on("click",(function(){return n.popup("close"),importConfig(JSON.parse(t)),!1})),openPopup(n,{positionTo:$("#sprinklers-settings").find(".import_config")})}function importConfig(t){var e="";"object"==typeof t&&t.settings?((checkOSVersion(210)&&"object"==typeof t.options&&(t.options.hp0!==controller.options.hp0||t.options.hp1!==controller.options.hp1)||t.options.dhcp!==controller.options.dhcp||t.options.devid!==controller.options.devid)&&(e=_("Warning: Network changes will be made and the device may no longer be accessible from this address.")),areYouSure(_("Are you sure you want to restore the configuration?"),e,(function(){$.mobile.loading("show");var e,n,i,o,a,s="/cs?pw=",r="/co?pw=",l=Math.ceil(t.stations.snames.length/16),c=new Array(l).fill("/cs?pw="),d=isOSPi(),u=function(t){return keyIndex[t]===i};for(e in t.options)if(t.options.hasOwnProperty(e)&&keyIndex.hasOwnProperty(e)){if(i=keyIndex[e],-1!==$.inArray(i,[2,14,16,21,22,25,36])&&0===t.options[e])continue;if(3===i){checkOSVersion(210)&&1===controller.options.dhcp&&(r+="&o3=1");continue}if(d&&void 0===(i=Object.keys(keyIndex).find(u)))continue;o=!0===checkOSVersion(208)&&"string"==typeof t.options[e]?t.options[e].replace(/\s/g,"_"):t.options[e],r+="&o"+i+"="+o}for(!d&&"number"==typeof t.options.fwv&&t.options.fwv<211&&checkOSVersion(211)&&(r+="&o36=1"),"object"==typeof t.settings.wto&&checkOSVersion(215)&&(r+="&wto="+escapeJSON(t.settings.wto)),"string"==typeof t.settings.ifkey&&checkOSVersion(217)&&(r+="&ifkey="+t.settings.ifkey),"string"==typeof t.settings.dname&&checkOSVersion(2191)&&(r+="&dname="+t.settings.dname),"object"==typeof t.settings.mqtt&&checkOSVersion(2191)&&(r+="&mqtt="+escapeJSON(t.settings.mqtt)),"object"==typeof t.settings.otc&&checkOSVersion(2191)&&(r+="&otc="+escapeJSON(t.settings.otc)),r+="&"+(d?"o":"")+"loc="+t.settings.loc,n=0;n<l;n++)for(e=16*n;e<16*(n+1)&&e<t.stations.snames.length;e++)a=!0===checkOSVersion(208)?t.stations.snames[e].replace(/\s/g,"_"):t.stations.snames[e],c[n]+="&s"+e+"="+encodeURIComponent(a);for(e=0;e<t.stations.masop.length;e++)s+="&m"+e+"="+t.stations.masop[e];if("object"==typeof t.stations.masop2)for(e=0;e<t.stations.masop2.length;e++)s+="&n"+e+"="+t.stations.masop2[e];if("object"==typeof t.stations.ignore_rain)for(e=0;e<t.stations.ignore_rain.length;e++)s+="&i"+e+"="+t.stations.ignore_rain[e];if("object"==typeof t.stations.ignore_sn1)for(e=0;e<t.stations.ignore_sn1.length;e++)s+="&j"+e+"="+t.stations.ignore_sn1[e];if("object"==typeof t.stations.ignore_sn2)for(e=0;e<t.stations.ignore_sn2.length;e++)s+="&k"+e+"="+t.stations.ignore_sn2[e];if("object"==typeof t.stations.stn_dis)for(e=0;e<t.stations.stn_dis.length;e++)s+="&d"+e+"="+t.stations.stn_dis[e];if("object"==typeof t.stations.stn_spe)for(e=0;e<t.stations.stn_spe.length;e++)s+="&p"+e+"="+t.stations.stn_spe[e];if("object"==typeof t.stations.stn_seq)for(e=0;e<t.stations.stn_seq.length;e++)s+="&q"+e+"="+t.stations.stn_seq[e];else if(!d&&"number"==typeof t.options.fwv&&t.options.fwv<211&&!checkOSVersion(211)){var h;for(h=0;h<t.settings.nbrd;h++)s+="&q"+h+"="+(1===t.options.seq?255:0)}if("object"==typeof t.stations.act_relay)for(e=0;e<t.stations.act_relay.length;e++)s+="&a"+e+"="+t.stations.act_relay[e];t.special=t.special||{},$.when(sendToOS(transformKeysinString(r)),sendToOS(s),sendToOS("/dp?pw=&pid=-1"),$.each(c,(function(t,e){sendToOS(e)})),$.each(t.programs.pd,(function(e,n){var i="";if(d&&"number"==typeof t.options.fwv&&t.options.fwv>=210)return showerror(_("Program data is newer than the device firmware and cannot be imported")),!1;if(!d&&"number"==typeof t.options.fwv&&t.options.fwv>=210&&!checkOSVersion(210))return showerror(_("Program data is newer than the device firmware and cannot be imported")),!1;if(!d&&"number"==typeof t.options.fwv&&t.options.fwv>=210&&checkOSVersion(210)&&(i="&name="+n[5],n=n.slice(0,5)),!d&&"number"==typeof t.options.fwv&&t.options.fwv<210&&checkOSVersion(210)){var o,a,s,r=readProgram183(n),l=n.length-7,c=[],u=0;for(u|=r.en<<0,r.is_even?u|=8:r.is_odd?u|=4:u|=0,r.is_interval?u|=48:u|=0,u|=0,n[0]=u,a=0;a<l;a++)for(o=n[7+a],s=0;s<8;s++)c.push(o&1<<s?r.duration:0);n[3]=[r.start,parseInt((r.end-r.start)/r.interval),r.interval,0],n[4]=c,n=n.slice(0,5),i="&name="+_("Program")+" "+(e+1)}sendToOS("/cp?pw=&pid=-1&v="+JSON.stringify(n)+i)})),$.each(t.special,(function(t,e){checkOSVersion(216)&&sendToOS("/cs?pw=&sid="+t+"&st="+e.st+"&sd="+encodeURIComponent(e.sd))}))).then((function(){setTimeout((function(){updateController((function(){$.mobile.loading("hide"),showerror(_("Backup restored to your device")),updateWeather(),goHome(!0)}),(function(){$.mobile.loading("hide"),networkFail()}))}),1500)}),(function(){$.mobile.loading("hide"),showerror(_("Unable to import configuration."))}))}))):showerror(_("Invalid configuration"))}var showAbout=function(){var t,e=$("<div data-role='page' id='about'><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'><li><p>"+_("User manual for OpenSprinkler is available at")+" <a class='iab' target='_blank' href='https://openthings.freshdesk.com/support/solutions/folders/5000147083'>https://support.openthings.io</a></p></li></ul><ul data-role='listview' data-inset='true'><li><p>"+_("This is open source software: source code and changelog for this application can be found at")+" <a class='iab squeeze' target='_blank' href='https://github.com/OpenSprinkler/OpenSprinkler-App/'>https://github.com/OpenSprinkler/OpenSprinkler-App/</a></p><p>"+_("Language localization is crowdsourced using Transifex available at")+" <a class='iab squeeze' target='_blank' href='https://www.transifex.com/albahra/opensprinkler/'>https://www.transifex.com/albahra/opensprinkler/</a></p><p>"+_("Open source attributions")+": <a class='iab iabNoScale squeeze' target='_blank' href='https://github.com/OpenSprinkler/OpenSprinkler-App/wiki/List-of-Integrated-Libraries'>https://github.com/OpenSprinkler/OpenSprinkler-App/wiki/List-of-Integrated-Libraries</a></p></li></ul><p class='smaller'>"+_("App Version")+": 2.3.0<br>"+_("Firmware")+": <span class='firmware'></span><br><span class='hardwareLabel'>"+_("Hardware Version")+":</span> <span class='hardware'></span></p></div></div>");return function(){t=void 0===controller.options.hwv,e.find(".hardware").toggleClass("hidden",t).text(getHWVersion()+getHWType()),e.find(".hardwareLabel").toggleClass("hidden",t),e.find(".firmware").text(getOSVersion()+getOSMinorVersion()),e.one("pagehide",(function(){e.detach()})),changeHeader({title:_("About"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#about").remove(),$.mobile.pageContainer.append(e)}}();function stopStations(t){$.mobile.loading("show"),sendToOS("/cv?pw=&rsn=1").done((function(){setTimeout((function(){$.mobile.loading("hide"),t()}),1e3)}))}function flowCountToVolume(t){return parseFloat((t*((controller.options.fpr1<<8)+controller.options.fpr0)/100).toFixed(2))}function isOSPi(){return!(!controller||"object"!=typeof controller.options||"string"!=typeof controller.options.fwv||-1===controller.options.fwv.search(/ospi/i))}function checkPW(t,e){var n="/sp?pw="+encodeURIComponent(t)+"&npw="+encodeURIComponent(t)+"&cpw="+encodeURIComponent(t);$.ajax({url:currToken?"https://cloud.openthings.io/forward/v1/"+currToken+n:currPrefix+currIp+n,cache:!1,crossDomain:!0,type:"GET"}).then((function(t){var n=t.result;e(!(void 0===n||n>1))}),(function(){e(!1)}))}function changePassword(t){t=$.extend({},{fixIncorrect:!1,name:"",callback:function(){},cancel:function(){}},t);var e=isOSPi(),n=!1,i=$("<div data-role='popup' class='modal' id='changePassword' data-theme='a' data-overlay-theme='b'><ul data-role='listview' data-inset='true'>"+(!0===t.fixIncorrect?"":"<li data-role='list-divider'>"+_("Change Password")+"</li>")+"<li>"+(!0===t.fixIncorrect?"<p class='rain-desc red-text bold'>"+_("Incorrect password for ")+t.name+". "+_("Please re-enter password to try again.")+"</p>":"")+"<form method='post' novalidate><label for='npw'>"+(!0===t.fixIncorrect?_("Password:"):_("New Password")+":")+"</label><input type='password' name='npw' id='npw' value=''"+(e?"":" maxlength='32'")+">"+(!0===t.fixIncorrect?"":"<label for='cpw'>"+_("Confirm New Password")+":</label><input type='password' name='cpw' id='cpw' value=''"+(e?"":" maxlength='32'")+">")+(!0===t.fixIncorrect?"<label for='save_pw'>"+_("Save Password")+"</label><input type='checkbox' data-wrapper-class='save_pw' name='save_pw' id='save_pw' data-mini='true'>":"")+"<input type='submit' value='"+_("Submit")+"'></form></li></ul></div>");i.find("form").on("submit",(function(){var o=i.find("#npw").val(),a=i.find("#cpw").val();return!0===t.fixIncorrect?(n=!0,storage.get(["sites"],(function(e){var n=parseSites(e.sites),a=function(e){currPass=e,n[t.name].os_pw=i.find("#save_pw").is(":checked")?e:"",storage.set({sites:JSON.stringify(n)},cloudSaveSites),i.popup("close"),t.callback()};checkPW(md5(o),(function(t){a(!0===t?md5(o):o)}))})),!1):o!==a?(showerror(_("The passwords don't match. Please try again.")),!1):""===o?(showerror(_("Password cannot be empty")),!1):(!e&&o.length>32&&showerror(_("Password cannot be longer than 32 characters")),checkOSVersion(213)&&(o=md5(o),a=md5(a)),$.mobile.loading("show"),sendToOS("/sp?pw=&npw="+encodeURIComponent(o)+"&cpw="+encodeURIComponent(a),"json").done((function(t){var e=t.result;!e||e>1?showerror(_(2===e?"Please check the current device password is correct then try again":"Unable to change password. Please try again.")):(storage.get(["sites","current_site"],(function(t){var e=parseSites(t.sites);e[t.current_site].os_pw=o,currPass=o,storage.set({sites:JSON.stringify(e)},cloudSaveSites)})),$.mobile.loading("hide"),i.popup("close"),showerror(_("Password changed successfully")))})),!1)})),i.one("popupafterclose",(function(){document.activeElement.blur(),i.remove(),t.fixIncorrect&&!n&&t.cancel()})).popup().enhanceWithin(),t.fixIncorrect?storage.get(["sites","current_site"],(function(e){var n=parseSites(e.sites),o=e.current_site,a=md5(n[o].os_pw);if(isMD5(n[o].os_pw))i.popup("open");else{var s="/jc?pw="+a;$.ajax({url:currToken?"https://cloud.openthings.io/forward/v1/"+currToken+s:currPrefix+currIp+s,type:"GET",dataType:"json"}).then((function(){n[o].os_pw=currPass=a,storage.set({sites:JSON.stringify(n)},cloudSaveSites),t.callback()}),(function(){i.popup("open")}))}})):i.popup("open")}function requestCloudAuth(t){t=t||function(){};var e=$("<div data-role='popup' class='modal' id='requestCloudAuth' data-theme='a'><ul data-role='listview' data-inset='true'><li data-role='list-divider'>"+_("OpenSprinkler.com Login")+"</li><li><p class='rain-desc tight'>"+_("Use your OpenSprinkler.com login and password to securely sync sites between all your devices.")+"<br><br>"+_("Don't have an account?")+" <a href='https://opensprinkler.com/my-account/' class='iab'>"+_("Register here")+"</a></p></li><li><form method='post' novalidate><label for='cloudUser'>"+_("Username:")+"</label><input type='text' name='cloudUser' id='cloudUser' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'><label for='cloudPass'>"+_("Password:")+"</label><input type='password' name='cloudPass' id='cloudPass'><input type='submit' value='"+_("Submit")+"'></form></li></ul></div>"),n=!1;e.find("form").on("submit",(function(){return $.mobile.loading("show"),cloudLogin(e.find("#cloudUser").val(),e.find("#cloudPass").val(),(function(t){!1!==t?($.mobile.loading("hide"),n=!0,e.popup("close")):showerror(_("Invalid username/password combination. Please try again."))})),!1})),e.one("popupafterclose",(function(){t(n),n&&cloudSyncStart()})),openPopup(e)}function cloudLogin(t,e,n){n=n||function(){},$.ajax({type:"POST",dataType:"json",url:"https://opensprinkler.com/wp-admin/admin-ajax.php",data:{action:"ajaxLogin",username:t,password:e},success:function(t){"string"==typeof t.token&&storage.set({cloudToken:t.token,cloudDataToken:sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(e))}),n(t.loggedin)},fail:function(){n(!1)}})}function cloudSaveSites(t){"function"!=typeof t&&(t=function(){}),storage.get(["cloudToken","cloudDataToken","sites"],(function(e){null!==e.cloudToken&&void 0!==e.cloudToken?$.ajax({type:"POST",dataType:"json",url:"https://opensprinkler.com/wp-admin/admin-ajax.php",data:{action:"saveSites",token:e.cloudToken,sites:encodeURIComponent(JSON.stringify(sjcl.encrypt(e.cloudDataToken,e.sites)))},success:function(e){!1===e.success?("BAD_TOKEN"===e.message&&handleExpiredLogin(),t(!1,e.message)):(storage.set({cloudToken:e.token}),t(e.success))},fail:function(){t(!1)}}):t(!1)}))}function cloudGetSites(t){t=t||function(){},storage.get(["cloudToken","cloudDataToken"],(function(e){if(void 0!==e.cloudToken&&null!==e.cloudToken)return void 0===e.cloudDataToken||null===e.cloudDataToken?(handleInvalidDataToken(),void t(!1)):void $.ajax({type:"POST",dataType:"json",url:"https://opensprinkler.com/wp-admin/admin-ajax.php",data:{action:"getSites",token:e.cloudToken},success:function(n){if(!1===n.success||""===n.sites)"BAD_TOKEN"===n.message&&handleExpiredLogin(),t(!1,n.message);else{var i;storage.set({cloudToken:n.token});try{i=sjcl.decrypt(e.cloudDataToken,n.sites)}catch(e){"ccm: tag doesn't match"===e.message&&handleInvalidDataToken(),t(!1)}try{t(JSON.parse(i))}catch(e){t(!1)}}},fail:function(){t(!1)}});t(!1)}))}function cloudSyncStart(){cloudGetSites((function(t){var e=$(".ui-page-active").attr("id");"start"===e?(Object.keys(t).length>0&&storage.set({sites:JSON.stringify(t)}),changePage("#site-control")):(updateLoginButtons(),storage.get("sites",(function(n){if(JSON.stringify(t)!==n.sites)if(n.sites=parseSites(n.sites),currLocal)findLocalSiteName(t,(function(e){!1===e?areYouSure(_("Do you wish to add this location to your cloud synced site list?"),_("This site is not found in the currently synced site list but may be added now."),(function(){t[currIp]=n.sites.Local,storage.set({sites:JSON.stringify(t)},cloudSaveSites),storage.set({current_site:currIp}),updateSiteList(Object.keys(t),currIp)}),(function(){storage.remove("cloudToken",updateLoginButtons)})):(storage.set({sites:JSON.stringify(t)},cloudSaveSites),storage.set({current_site:e}),updateSiteList(Object.keys(t),e))}));else if(Object.keys(t).length>0){var i=$("<div data-role='popup' data-theme='a' data-overlay-theme='b'><div class='ui-bar ui-bar-a'>"+_("Select Merge Method")+"</div><div data-role='controlgroup' class='tight'><button class='merge'>"+_("Merge")+"</button><button class='replaceLocal'>"+_("Replace local with cloud")+"</button><button class='replaceCloud'>"+_("Replace cloud with local")+"</button></div></div>"),o=function(){storage.set({sites:JSON.stringify(t)},cloudSaveSites),i.popup("close"),"site-control"===e&&changePage("#site-control")};i.find(".merge").on("click",(function(){t=$.extend({},n.sites,t),o()})),i.find(".replaceLocal").on("click",(function(){o()})),i.find(".replaceCloud").on("click",(function(){t=n.sites,o()})),i.one("popupafterclose",(function(){i.popup("destroy").remove()})).popup({history:!1,positionTo:"window"}).enhanceWithin().popup("open")}else cloudSaveSites()})))}))}function cloudSync(t){"function"!=typeof t&&(t=function(){}),storage.get(["cloudToken","current_site"],(function(e){"string"==typeof e.cloudToken&&cloudGetSites((function(n){!1!==n&&storage.set({sites:JSON.stringify(n)},(function(){updateSiteList(Object.keys(n),e.current_site),t(),$("html").trigger("siterefresh")}))}))}))}var corruptionNotificationShown=!1;function handleCorruptedWeatherOptions(t){corruptionNotificationShown||(addNotification({title:_("Weather Options have Corrupted"),desc:_("Click here to retrieve the partial weather option data"),on:function(){var e=$(this).parent(),n=$("<div data-role='popup' data-theme='a' class='modal ui-content' id='weatherOptionCorruption'><h3 class='center'>"+_("Weather option data has corrupted")+"</h3><h5 class='center'>"+_("Please note this may indicate other data corruption as well, please verify all settings.")+"</h5><h6 class='center'>"+_("Below is the corrupt data which could not be parsed but may be useful for restoration.")+"</h6><code>"+t[0].substr(7)+"</code><a class='ui-btn ui-corner-all ui-shadow red reset-options' style='width:80%;margin:5px auto;' href='#'>"+_("Reset All Options")+"</a><a class='ui-btn ui-corner-all ui-shadow submit' style='width:80%;margin:5px auto;' href='#'>"+_("Dismiss")+"</a></div>");return n.find(".submit").on("click",(function(){return removeNotification(e),n.popup("close"),!1})),n.find(".reset-options").on("click",(function(){return removeNotification(e),n.popup("close"),resetAllOptions((function(){showerror(_("Settings have been saved"))})),!1})),openPopup(n),!1}}),corruptionNotificationShown=!0)}function handleExpiredLogin(){storage.remove(["cloudToken"],updateLoginButtons),addNotification({title:_("OpenSprinkler.com Login Expired"),desc:_("Click here to re-login to OpenSprinkler.com"),on:function(){var t=$(this).parent();return requestCloudAuth((function(e){removeNotification(t),!0===e&&(updateLoginButtons(),cloudSync())})),!1}})}function handleInvalidDataToken(){storage.remove(["cloudDataToken"]),addNotification({title:_("Unable to read cloud data"),desc:_("Click here to enter a valid password to decrypt the data"),on:function(){var t=$(this).parent(),e=$("<div data-role='popup' data-theme='a' class='modal ui-content' id='dataPassword'><p class='tight rain-desc'>"+_("Please enter your OpenSprinkler.com password. If you have recently changed your password, you may need to enter your previous password to decrypt the data.")+"</p><form><input type='password' id='dataPasswordInput' name='dataPasswordInput' placeholder='"+_("Password")+"' /><input type='submit' data-theme='b' value='"+_("Submit")+"' /></form></div>"),n=!1;return e.find("form").on("submit",(function(){return removeNotification(t),n=!0,storage.set({cloudDataToken:sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(e.find("#dataPasswordInput").val()))},(function(){e.popup("close")})),!1})),e.one("popupafterclose",(function(){!0===n&&cloudSync()})),openPopup(e),!1}})}function getTokenUser(t){return atob(t).split("|")[0]}function detectUnusedExpansionBoards(){"number"==typeof controller.options.dexp&&controller.options.dexp<255&&controller.options.dexp>=0&&controller.options.ext<controller.options.dexp&&addNotification({title:_("Unused Expanders Detected"),desc:_("Click here to enable all connected stations."),on:function(){return removeNotification($(this).parent()),changePage("#os-options",{expandItem:"station"}),!1}})}function showUnifiedFirmwareNotification(){isOSPi()&&storage.get("ignoreUnifiedFirmware",(function(t){"1"!==t.ignoreUnifiedFirmware&&addNotification({title:_("Unified firmware is now avaialble"),desc:_("Click here for more details"),on:function(){var t=window.open("https://openthings.freshdesk.com/support/solutions/articles/5000631599","_blank","location="+(isAndroid?"yes":"no")+",enableViewportScale=yes,toolbarposition=top,closebuttoncaption="+_("Back"));return isIEMobile&&($.mobile.document.data("iabOpen",!0),t.addEventListener("exit",(function(){$.mobile.document.removeData("iabOpen")}))),!1},off:function(){return storage.set({ignoreUnifiedFirmware:"1"}),!0}})}))}function intToIP(t){return(t>>24&255)+"."+(t>>16&255)+"."+(t>>8&255)+"."+(255&t)}function checkPublicAccess(t){if(0!==t&&!currToken){var e=intToIP(t),n=currIp.match(/.*:(\d+)/),i=function(){storage.get("ignoreRemoteFailed",(function(t){"1"!==t.ignoreRemoteFailed&&addNotification({title:_("Remote access is not enabled"),desc:_("Click here to troubleshoot remote access issues"),on:function(){var t=window.open("https://openthings.freshdesk.com/support/solutions/articles/5000569763","_blank","location="+(isAndroid?"yes":"no")+",enableViewportScale=yes,toolbarposition=top,closebuttoncaption="+_("Back"));return isIEMobile&&($.mobile.document.data("iabOpen",!0),t.addEventListener("exit",(function(){$.mobile.document.removeData("iabOpen")}))),!1},off:function(){return storage.set({ignoreRemoteFailed:"1"}),!0}})}))};e!==currIp&&!isLocalIP(e)&&isLocalIP(currIp)&&(n=n?parseInt(n[1]):80,$.ajax({url:currPrefix+e+":"+n+"/jo?pw="+currPass,global:!1,dataType:"json",type:"GET"}).then((function(t){("object"!=typeof t||!t.hasOwnProperty("fwv")||t.fwv!==controller.options.fwv||checkOSVersion(214)&&controller.options.ip4!==t.ip4)&&i()}),i))}}function logout(t){"function"!=typeof t&&(t=function(){}),areYouSure(_("Are you sure you want to logout?"),"",(function(){currLocal?storage.remove(["sites","current_site","lang","provider","wapikey","runonce","cloudToken"],(function(){location.reload()})):storage.remove(["cloudToken"],(function(){updateLoginButtons(),t()}))}))}function updateLoginButtons(){var t=$(".ui-page-active");storage.get("cloudToken",(function(e){var n=$(".login-button"),i=$(".logout-button");null===e.cloudToken||void 0===e.cloudToken?(n.removeClass("hidden"),currLocal||i.addClass("hidden"),i.find("a").text(_("Logout")),"site-control"===t.attr("id")&&t.find(".logged-in-alert").remove()):(i.removeClass("hidden").find("a").text(_("Logout")+" ("+getTokenUser(e.cloudToken)+")"),n.addClass("hidden"),"site-control"===t.attr("id")&&0===t.find(".logged-in-alert").length&&t.find(".ui-content").prepend(addSyncStatus(e.cloudToken)))}))}function addNotification(t){notifications.push(t),updateNotificationBadge();var e=$("#notificationPanel");e.hasClass("ui-panel-open")&&e.find("ul").append(createNotificationItem(t)).listview("refresh")}function updateNotificationBadge(){var t=notifications.length,e=$("#header");0===t?e.find(".notifications").hide():(e.find(".notifications").show(),e.find(".notificationCount").text(t))}function createNotificationItem(t){var e=$("<li><a class='primary' href='#'><h2>"+t.title+"</h2>"+(t.desc?"<p>"+t.desc+"</p>":"")+"</a><a class='ui-btn ui-btn-icon-notext ui-icon-delete'></a></li>");return e.find(".primary").on("click",t.on),e.find(".ui-icon-delete").on("click",(function(){removeNotification($(this).parent())})),e}function showNotifications(){if(0!==notifications.length){for(var t=$("#notificationPanel"),e=$("#footer-menu"),n=[$("<li data-role='list-divider'>"+_("Notifications")+"<button class='ui-btn ui-btn-icon-notext ui-icon-delete btn-no-border clear-all delete'></button></li>").on("click",".clear-all",(function(){var t=$(this);t.hasClass("clear")?clearNotifications():(t.removeClass("delete ui-btn-icon-notext ui-icon-delete").addClass("clear").text(_("Clear")),setTimeout((function(){$.mobile.document.one("click",(function(){t.removeClass("clear").addClass("delete ui-btn-icon-notext ui-icon-delete").text("")}))}),1))}))],i=notifications.length-1;i>=0;i--)n.push(createNotificationItem(notifications[i]));t.find("ul").replaceWith($("<ul/>").append(n).listview()),t.on("panelbeforeclose",(function(){e.removeClass("moveLeft")})),t.panel().panel("option","classes.modal","needsclick ui-panel-dismiss"),e.addClass("moveLeft"),t.panel("open")}}function clearNotifications(){var t=$("#notificationPanel");notifications=[],updateNotificationBadge(),t.find("ul").empty(),t.hasClass("ui-panel-open")&&t.panel("close")}function removeNotification(t){var e=$("#notificationPanel"),n=notifications[t.index()-1].off;("function"!=typeof n||n())&&(notifications.remove(t.index()-1),t.remove(),updateNotificationBadge(),0===notifications.length&&e.hasClass("ui-panel-open")&&e.panel("close"))}function checkFirmwareUpdate(){checkOSVersion(200)&&("3.0"===getHWVersion()||isOSPi())&&$.getJSON("https://api.github.com/repos/opensprinkler/opensprinkler-firmware/releases").done((function(t){controller.options.fwv<t[0].tag_name&&storage.get("updateDismiss",(function(e){(!e.updateDismiss||e.updateDismiss<t[0].tag_name)&&addNotification({title:_("Firmware update available"),on:function(){var e=$(this).parent(),n=30===controller.options.hwv||controller.options.hwv>63&&checkOSVersion(216),i=t[0].html_url,o=$("<div data-role='popup' class='modal' data-theme='a'><h3 class='center' style='margin-bottom:0'>"+_("Latest")+" "+_("Firmware")+": "+t[0].name+"</h3><h5 class='center' style='margin:0'>"+_("This Controller")+": "+getOSVersion()+getOSMinorVersion()+"</h5><a class='iab ui-btn ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' target='_blank' href='"+i+"'>"+_("View Changelog")+"</a><a class='guide ui-btn ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' href='#'>"+_("Update Guide")+"</a>"+(n?"<a class='update ui-btn ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' href='#'>"+_("Update Now")+"</a>":"")+"<a class='dismiss ui-btn ui-btn-b ui-corner-all ui-shadow' style='width:80%;margin:5px auto;' href='#'>"+_("Dismiss")+"</a></div>");o.find(".update").on("click",(function(){30!==controller.options.hwv?sendToOS("/cv?pw=&update=1","json").then((function(){showerror(_("Update successful")),o.find(".dismiss").click()}),(function(){$.mobile.loading("show",{html:"<div class='center'>"+_("Update did not complete.")+"<br><a class='iab ui-btn' href='https://openthings.freshdesk.com/support/solutions/articles/5000631599-installing-and-updating-the-unified-firmware#upgrade'>"+_("Update Guide")+"</a></div>",textVisible:!0,theme:"b"}),setTimeout((function(){$.mobile.loading("hide")}),3e3)})):$("<a class='hidden iab' href='"+currPrefix+currIp+"/update'></a>").appendTo(o).click()})),o.find(".guide").on("click",(function(){var t=controller.options.hwv>63?"https://openthings.freshdesk.com/support/solutions/articles/5000631599-installing-and-updating-the-unified-firmware#upgrade":"https://openthings.freshdesk.com/support/solutions/articles/5000381694-opensprinkler-firmware-update-guide";$("<a class='hidden iab' href='"+t+"'></a>").appendTo(o).click()})),o.find(".dismiss").one("click",(function(){return storage.set({updateDismiss:t[0].tag_name}),o.popup("close"),removeNotification(e),!1})),openPopup(o)}})}))}))}function stopAllStations(){if(!isControllerConnected())return!1;areYouSure(_("Are you sure you want to stop all stations?"),"",(function(){$.mobile.loading("show"),sendToOS("/cv?pw=&rsn=1").done((function(){$.mobile.loading("hide"),removeStationTimers(),refreshStatus(),showerror(_("All stations have been stopped"))}))}))}function checkOSPiVersion(t){var e;return!!isOSPi()&&((e=controller.options.fwv.split("-")[0])===t||versionCompare(e=e.split("."),t=t.split(".")))}function checkOSVersion(t){var e=controller.options.fwv;if(t>=1e3){if(isNaN(controller.options.fwm))return!1;e=10*e+controller.options.fwm}return!isOSPi()&&(t===e||versionCompare(e.toString().split(""),t.toString().split("")))}function versionCompare(t,e){for(var n,i=Math.max(t.length,e.length);t.length<i;)t.push(0);for(;e.length<i;)e.push(0);for(var o=0;o<i&&0===(n=Math.max(-1,Math.min(1,t[o]-e[o])));o++);return-1===n&&(n=!1),n}function getOSVersion(t){return t||"object"!=typeof controller.options||(t=controller.options.fwv),"string"==typeof t&&-1!==t.search(/ospi/i)?t:(t/100>>0)+"."+(t/10>>0)%10+"."+t%10}function getOSMinorVersion(){return!isOSPi()&&"object"==typeof controller.options&&"number"==typeof controller.options.fwm&&controller.options.fwm>0?" ("+controller.options.fwm+")":""}function getHWVersion(t){if(!t){if("object"!=typeof controller.options||void 0===controller.options.hwv)return!1;t=controller.options.hwv}return"string"==typeof t?t:64===t?"OSPi":128===t?"OSBo":192===t?"Linux":255===t?"Demo":(t/10>>0)%10+"."+t%10}function getHWType(){return isOSPi()||"number"!=typeof controller.options.hwt||0===controller.options.hwt?"":172===controller.options.hwt?" - AC":220===controller.options.hwt?" - DC":26===controller.options.hwt?" - Latching":""}function areYouSure(t,e,n,i,o){$("#sure").popup("destroy").remove(),n=n||function(){},i=i||function(){};var a=0;"object"==typeof o&&(a=o.type===dialog.REMOVE_STATION&&Groups.canShift(o.gid)&&Station.isSequential(o.station));var s=$("<div data-role='popup' data-theme='a' id='sure'><h3 class='sure-1 center'>"+t+"</h3><p class='sure-2 center'>"+e+"</p><a class='sure-do ui-btn ui-btn-b ui-corner-all ui-shadow' href='#'>"+_("Yes")+"</a><a class='sure-dont ui-btn ui-corner-all ui-shadow' href='#'>"+_("No")+"</a>"+(a?"<label><input id='shift-sta' type='checkbox'>Move up remaining stations in the same sequential group?</label>":"")+"</div>");s.find(".sure-do").one("click.sure",(function(){return s.popup("close"),n(),!1})),s.find(".sure-dont").one("click.sure",(function(){return s.popup("close"),i(),!1})),openPopup(s)}function showIPRequest(t){var e={title:_("Enter IP Address"),ip:[0,0,0,0],showBack:!0,callback:function(){}};t=$.extend({},e,t),$("#ipInput").popup("destroy").remove();var n=$("<div data-role='popup' id='ipInput' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'><span><fieldset class='ui-grid-c incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-d'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div></fieldset><div class='ui-grid-c inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[0]+"'></div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[1]+"'></div><div class='ui-block-c'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[2]+"'></div><div class='ui-block-d'><input data-wrapper-class='pad_buttons' class='ip_addr' type='number' pattern='[0-9]*' max='255' value='"+t.ip[3]+"'></div></div><fieldset class='ui-grid-c decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-d'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div></fieldset></span>"+(t.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),i=function(e,i){var a=n.find(".inputs input").eq(e),s=parseInt(a.val());-1===i&&0===s||1===i&&s>=255||(a.val(s+i),t.callback(o()))},o=function(){return $.makeArray(n.find(".ip_addr").map((function(){return parseInt($(this).val())})))};n.find("button.submit").on("click",(function(){t.callback(o()),n.popup("destroy").remove()})),n.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){""===this.value&&(this.value="0")})),holdButton(n.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return i(e,1),!1})),holdButton(n.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return i(e,-1),!1})),n.css("max-width","350px").one("popupafterclose",(function(){t.callback(o())})),openPopup(n)}function showDurationBox(t){var e={seconds:0,title:_("Duration"),granularity:0,preventCompression:!1,incrementalUpdate:!0,showBack:!0,showSun:!1,minimum:0,callback:function(){}},n=0;t=$.extend({},e,t),$("#durationBox").popup("destroy").remove(),t.seconds=parseInt(t.seconds),65535===t.seconds?(n=1,t.seconds=0):65534===t.seconds&&(n=2,t.seconds=0),checkOSVersion(217)&&(t.preventCompression=!0);var i,o=["days","hours","minutes","seconds"],a=[_("Days"),_("Hours"),_("Minutes"),_("Seconds")],s=[86400,3600,60,1],r=[0,23,59,59],l=4-t.granularity,c=0,d=sec2dhms(t.seconds);if(!t.preventCompression&&checkOSVersion(210)&&t.maximum>64800&&(t.maximum=checkOSVersion(214)?57600:64800),t.maximum)for(i=s.length-1;i>=0;i--)if(t.maximum<s[i]){l=s.length-(c=i+1)-t.granularity;break}var u="<fieldset class='ui-grid-"+String.fromCharCode(95+l)+" incr'>",h="<div class='ui-grid-"+String.fromCharCode(95+l)+" inputs'>",p="<fieldset class='ui-grid-"+String.fromCharCode(95+l)+" decr'>",f=$("<div data-role='popup' id='durationBox' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'>"+(t.helptext?"<p class='rain-desc center smaller'>"+t.helptext+"</p>":"")+"<span></span>"+(t.showSun?"<div class='ui-grid-a useSun'><div class='ui-block-a'><button value='65534' class='ui-mini ui-btn rise "+(2===n?"ui-btn-active":"")+"'>"+_("Sunrise to Sunset")+"</button></div><div class='ui-block-b'><button value='65535' class='ui-mini ui-btn set "+(1===n?"ui-btn-active":"")+"'>"+_("Sunset to Sunrise")+"</button></div></div>":"")+(t.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),m=function(e,n){var i=f.find(".inputs input").eq(e),o=e+c,a=parseInt(i.val());if(!i.prop("disabled")&&!(-1===n&&(g()<=t.minimum||a<=0)||1===n&&g()+s[o]>t.maximum)&&(0!==r[o]&&0!==e&&Math.abs(a)>=r[o]&&(i.val(0),i=f.find(".inputs input").eq(e-1),a=parseInt(i.val())),i.val(a+n),t.incrementalUpdate&&t.callback(g()),!t.preventCompression&&checkOSVersion(210))){var l=1===n;1===n?(g()>=60&&v("seconds",l),g()>=10800&&v("minutes",l)):-1===n&&(g()<=-60?v("seconds",!l):g()<=-10800?v("minutes",!l):g()<60?v("seconds",l):g()<10800&&v("minutes",l))}},g=function(){var t=f.find(".useSun").find("button.ui-btn-active");return 1===t.length?parseInt(t.val()):dhms2sec({days:parseInt(f.find(".days").val())||0,hours:parseInt(f.find(".hours").val())||0,minutes:parseInt(f.find(".minutes").val())||0,seconds:parseInt(f.find(".seconds").val())||0})},v=function(t,e){f.find("."+t).toggleClass("ui-state-disabled",e).prop("disabled",e).val((function(){return e?0:this.value})).parent(".ui-input-text").toggleClass("ui-state-disabled",e)};for(i=c;i<s.length-t.granularity;i++)u+="<div "+(l>1?"class='ui-block-"+String.fromCharCode(97+i-c)+"'":"")+"><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>",h+="<div "+(l>1?"class='ui-block-"+String.fromCharCode(97+i-c)+"'":"")+"><label class='center'>"+_(a[i])+"</label><input data-wrapper-class='pad_buttons' class='"+o[i]+"' type='number' pattern='[0-9]*' value='"+d[o[i]]+"'></div>",p+="<div "+(l>1?"class='ui-block-"+String.fromCharCode(97+i-c)+"'":"")+"><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>";u+="</fieldset>",h+="</div>",p+="</fieldset>",f.find("span").prepend(u+h+p),f.find("button.submit").on("click",(function(){t.callback(g()),f.popup("destroy").remove()})),!t.preventCompression&&checkOSVersion(210)&&(t.seconds<=-60&&v("seconds",!0),t.seconds<=-10800&&v("minutes",!0),t.seconds>=60&&v("seconds",!0),t.seconds>=10800&&v("minutes",!0)),f.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){""===this.value&&(this.value="0")})),holdButton(f.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return m(e,1),!1})),holdButton(f.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return m(e,-1),!1})),t.showSun&&f.find(".useSun").on("click","button",(function(){var e=$(this),n=f.find(".useSun").find("button").not(e),i=f.find("span").find(".ui-btn,input");n.removeClass("ui-btn-active"),e.hasClass("ui-btn-active")?(e.removeClass("ui-btn-active"),i.prop("disabled",!1).removeClass("ui-disabled")):(e.addClass("ui-btn-active"),i.prop("disabled",!0).addClass("ui-disabled")),t.incrementalUpdate&&t.callback(g())})),f.css("max-width","350px").one("popupafteropen",(function(){0!==n&&f.find("span").find(".ui-btn,input").prop("disabled",!0).addClass("ui-disabled")})).one("popupafterclose",(function(){t.incrementalUpdate&&t.callback(g())})),openPopup(f)}function showSingleDurationInput(t){$("#singleDuration").popup("destroy").remove();var e={data:0,title:_("Duration"),minimum:0,label:"",updateOnChange:!0,showBack:!0,callback:function(){}};t=$.extend({},e,t);var n=$("<div data-role='popup' id='singleDuration' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'>"+(t.helptext?"<p class='rain-desc center smaller'>"+t.helptext+"</p>":"")+"<label class='center'>"+t.label+"</label><div class='input_with_buttons'><button class='decr ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input type='number' pattern='[0-9]*' value='"+t.data+"'><button class='incr ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div>"+(t.updateOnChange&&!t.showBack?"":"<input type='submit' data-theme='b' value='"+_("Submit")+"'>")+"</div></div>"),i=n.find("input"),o=function(e){t.callback(parseInt(e).clamp(t.minimum,t.maximum))},a=function(e){var n=parseInt(i.val());-1===e&&n===t.minimum||1===e&&n===t.maximum||(i.val(n+e),t.updateOnChange&&o(n+e))};holdButton(n.find(".incr"),(function(){return a(1),!1})),holdButton(n.find(".decr"),(function(){return a(-1),!1})),n.find("input[type='number']").on("focus",(function(){this.value=""})).on("blur",(function(){""===this.value&&(this.value="0")})),n.find("input[type='submit']").on("click",(function(){o(i.val()),n.popup("destroy").remove()})),n.one("popupafterclose",(function(){t.updateOnChange&&o(i.val())})),openPopup(n)}function showDateTimeInput(t,e){$("#datetimeInput").popup("destroy").remove(),t instanceof Date||(t=new Date(1e3*t)).setMinutes(t.getMinutes()-t.getTimezoneOffset()),e=e||function(){};var n=["Month","Date","FullYear","Hours","Minutes"],i=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")],o=$("<div data-role='popup' id='datetimeInput' data-theme='a'><div data-role='header' data-theme='b'><h1>"+_("Enter Date/Time")+"</h1></div><div class='ui-content'></div></div>"),a=function(n,i){t["setUTC"+n](t["getUTC"+n]()+i),e(new Date(t.getTime())),s()},s=function(){var e,s,r="<fieldset class='ui-grid-d incr'>",l="<div class='ui-grid-d inputs'>",c="<fieldset class='ui-grid-d decr'>";for(s=0;s<5;s++)e=t["getUTC"+n[s]](),"",e="Month"===n[s]?"<p class='center'>"+i[e]+"</p>":"Date"===n[s]?"<p class='center'>"+e+",</p>":"Hours"===n[s]?"<p style='width:90%;display:inline-block' class='center'>"+e+"</p><p style='display:inline-block'>:</p>":"<p class='center'>"+e+"</p>",r+="<div class='ui-block-"+String.fromCharCode(97+s)+"'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>",l+="<div id='"+n[s]+"' class='ui-block-"+String.fromCharCode(97+s)+"'>"+e+"</div>",c+="<div class='ui-block-"+String.fromCharCode(97+s)+"'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>";r+="</fieldset>",l+="</div>",c+="</fieldset>",o.find(".ui-content").html("<span>"+r+l+c+"</span>").enhanceWithin(),o.find(".incr").children().on("vclick",(function(){var t=$(this).index();return a(o.find(".inputs").children().eq(t).attr("id"),1),!1})),o.find(".decr").children().on("vclick",(function(){var t=$(this).index();return a(o.find(".inputs").children().eq(t).attr("id"),-1),!1}))};s(),o.css("width","280px").one("popupafterclose",(function(){e(t)})),openPopup(o)}function showTimeInput(t){var e={minutes:0,title:_("Time"),incrementalUpdate:!0,showBack:!0,showSun:!1,callback:function(){}};t=$.extend({},e,t),$("#timeInput").popup("destroy").remove();var n=2047&t.minutes,i=0;t.minutes>>12&1&&(n=-n),t.minutes>>14&1?i=1:t.minutes>>13&1&&(i=2);var o=t.minutes>719,a=function(){return _(o?"PM":"AM")},s=$("<div data-role='popup' id='timeInput' data-theme='a'><div data-role='header' data-theme='b'><h1>"+t.title+"</h1></div><div class='ui-content'>"+(t.helptext?"<p class='pad-top rain-desc center smaller'>"+t.helptext+"</p>":"")+"<span><fieldset class='ui-grid-"+(isMetric?"a":"b")+" incr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>"+(isMetric?"":"<div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='plus' data-iconpos='bottom'></a></div>")+"</fieldset><div class='ui-grid-"+(isMetric?"a":"b")+" inputs'><div class='ui-block-a'><input data-wrapper-class='pad_buttons' class='hour dontPad' type='number' pattern='[0-9]*' value='"+(isMetric?pad((t.minutes/60>>0)%24)+"'>":(parseInt(t.minutes/60)%12==0?12:parseInt(t.minutes/60)%12)+"'>")+"</div><div class='ui-block-b'><input data-wrapper-class='pad_buttons' class='minute' type='number' pattern='[0-9]*' value='"+pad(t.minutes%60)+"'></div>"+(isMetric?"":"<div class='ui-block-c'><p class='center period'>"+a()+"</p></div>")+"</div><fieldset class='ui-grid-"+(isMetric?"a":"b")+" decr'><div class='ui-block-a'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div><div class='ui-block-b'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>"+(isMetric?"":"<div class='ui-block-c'><a href='#' data-role='button' data-mini='true' data-corners='true' data-icon='minus' data-iconpos='bottom'></a></div>")+"</fieldset></span>"+(t.showSun?"<div class='ui-grid-a useSun'><div class='ui-block-a'><button class='ui-mini ui-btn rise "+(1===i?"ui-btn-active":"")+"'>"+_("Use Sunrise")+"</button></div><div class='ui-block-b'><button class='ui-mini ui-btn set "+(2===i?"ui-btn-active":"")+"'>"+_("Use Sunset")+"</button></div></div><div class='offsetInput'"+(0===i?" style='display: none;'":"")+"><h5 class='center tight'>"+_("Offset (minutes)")+"</h5><div class='input_with_buttons'><button class='decr ui-btn ui-btn-icon-notext ui-icon-carat-l btn-no-border'></button><input class='dontPad' type='number' pattern='[0-9]*' value='"+n+"'><button class='incr ui-btn ui-btn-icon-notext ui-icon-carat-r btn-no-border'></button></div></div>":"")+(t.showBack?"<button class='submit' data-theme='b'>"+_("Submit")+"</button>":"")+"</div></div>"),r=function(e,n){if(0===e||1===e){var i=l()+n*(0===e?60:1),r=s.find(".inputs input").eq(e),c=r.hasClass("hour"),d=parseInt(r.val());if(1===n){if(c&&(isMetric&&d>=24||!isMetric&&d>=12)&&(d=0),!c&&d>=59){d=-1;var u=s.find(".hour"),h=parseInt(u.val());isMetric||(12===h&&(h=0),u.val(h+1))}}else if(c&&d<=1)d=13;else if(!c&&d<=0)return;(!o&&i>719||o&&i<721||o&&i>1439||!o&&-1===n&&i<0)&&(o=!o,s.find(".period").text(a())),d=c?d+n:pad(d+n),r.val(d)}else 2===e&&(o=!o,s.find(".period").text(a()));t.incrementalUpdate&&t.callback(l())},l=function(){var t=s.find(".useSun").find("button.ui-btn-active");if(1===t.length){var e=0,n=parseInt(s.find(".offsetInput input").val());return t.hasClass("rise")?(n>=0?e=n:(e=-n,e|=4096),e|=16384):(n>=0?e=n:(e=-n,e|=4096),e|=8192),e}var i=parseInt(s.find(".hour").val());return isMetric||(o&&12!==i&&(i+=12),o||12!==i||(i=0)),60*i+parseInt(s.find(".minute").val())};if(s.find("button.submit").on("click",(function(){t.callback(l()),s.popup("destroy").remove()})),s.on("focus","input[type='number']",(function(t){t.target.value=""})).on("blur","input[type='number']",(function(t){var e=parseInt(t.target.value)||0;t.target.value=$(t.target).hasClass("dontPad")?e:pad(e)})),holdButton(s.find(".incr").children(),(function(t){var e=$(t.currentTarget),n=e.index();return 0===e.find(".ui-disabled").length&&r(n,1),!1})),holdButton(s.find(".decr").children(),(function(t){var e=$(t.currentTarget),n=e.index();return 0===e.find(".ui-disabled").length&&r(n,-1),!1})),t.showSun){s.find(".useSun").on("click","button",(function(){var e=$(this),n=s.find(".useSun").find("button").not(e),i=s.find(".offsetInput"),o=s.find("span").find(".ui-btn,input,p");n.removeClass("ui-btn-active"),e.hasClass("ui-btn-active")?(e.removeClass("ui-btn-active"),i.slideUp(),o.prop("disabled",!1).removeClass("ui-disabled")):(e.addClass("ui-btn-active"),i.slideDown(),o.prop("disabled",!0).addClass("ui-disabled")),t.incrementalUpdate&&t.callback(l())}));var c=s.find(".offsetInput").find("input"),d=function(e){var n=parseInt(c.val());-1===e&&-240===n||1===e&&240===n||(c.val(n+e),t.incrementalUpdate&&t.callback(l()))};c.on("focus",(function(){this.value=""})).on("blur",(function(){""===this.value?this.value="0":this.value>240?this.value="240":this.value<-240&&(this.value="-240")})),holdButton(s.find(".offsetInput").find(".incr"),(function(){return d(1),!1})),holdButton(s.find(".offsetInput").find(".decr"),(function(){return d(-1),!1}))}s.css("max-width","350px").one("popupafteropen",(function(){0!==i&&s.find("span").find(".ui-btn,input,p").prop("disabled",!0).addClass("ui-disabled")})).one("popupafterclose",(function(){t.incrementalUpdate&&t.callback(l())})),openPopup(s)}function showHelpText(t){t.stopImmediatePropagation();var e=$(this),n=e.data("helptext");return openPopup($("<div data-role='popup' data-theme='a'><p>"+n+"</p></div>"),{positionTo:e}),!1}function changePage(t,e){e=e||{},0!==t.indexOf("#")&&(t="#"+t),closePanel((function(){$.mobile.pageContainer.pagecontainer("change",t,e)}))}function openPopup(t,e){e=$.extend({},{history:!1,positionTo:"window",overlayTheme:"b"},e),$.mobile.pageContainer.append(t),t.one("popupafterclose",(function(){var e=$("#shift-sta").is(":checked");void 0!==e&&(popupData.shift=e),t.popup("destroy").remove()})).popup(e).enhanceWithin(),t.popup("open")}function closePanel(t){var e=$(".ui-panel-open");if(e.length>0)return e.one("panelclose",(function(){t()})),void e.panel("close");t()}function changeHeader(t){var e=$("#header");""===(t=$.extend(!0,{},{title:"",class:"",animate:!0,leftBtn:{icon:"",class:"",text:"",on:function(){}},rightBtn:{icon:"",class:"",text:"",on:function(){}}},t)).title&&""===t.class&&(t.class="logo");var n=$("<button data-icon='"+t.leftBtn.icon+"' "+(""===t.leftBtn.text?"data-iconpos='notext' ":"")+"class='ui-btn-left "+t.leftBtn.class+"'>"+t.leftBtn.text+"</button><h3 class='"+t.class+"'>"+t.title+"</h3><button data-icon='"+t.rightBtn.icon+"' "+(""===t.rightBtn.text?"data-iconpos='notext' ":"")+"class='ui-btn-right "+t.rightBtn.class+"'>"+t.rightBtn.text+"</button>"),i=t.animate?"fast":0;return e.children().stop().fadeOut(i,(function(){e.html(n).toolbar(e.hasClass("ui-header")?"refresh":null),e.find(".ui-btn-left").on("click",t.leftBtn.on),e.find(".ui-btn-right").on("click",t.rightBtn.on)})).fadeIn(i),n}function getPageTop(){var t=$.mobile.window;return{x:(t[0].innerWidth||t.width())/2+t.scrollLeft(),y:t.scrollTop()+22.5}}function showLoading(t){(t="string"==typeof t?$(t):t).off("click").html("<p class='ui-icon ui-icon-loading mini-load'></p>");var e=t.filter("#footer-running");1===e.length&&e.find(".mini-load").addClass("bottom")}function takePicture(t){"object"==typeof navigator.camera&&"function"==typeof navigator.camera.getPicture&&navigator.camera.getPicture(t,(function(){}),{quality:50,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY,allowEdit:!0,targetWidth:200,targetHeight:200})}function goHome(t){if("sprinklers"!==$(".ui-page-active").attr("id")){$.mobile.document.one("pageshow",(function(){delete $.mobile.navigate.history.getActive().transition}));var e={reverse:!0};!0===t&&(e={firstLoad:!0,showLoading:!1,transition:"none"}),changePage("#sprinklers",e)}}function goBack(){var t=$(".ui-page-active");if(1===t.length){var e="site-control"===(t=t.attr("id"))&&!isControllerConnected(),n=$(".ui-popup-active");if(n.length)n.find("[data-role='popup']").popup("close");else if("sprinklers"===t||"start"===t||e)try{navigator.app.exitApp()}catch(t){}else if(isChromeApp||"file:"===window.location.protocol){var i=$.mobile.navigate.history.getPrev().url;if("#"!==i.slice(0,1))return;changePage(i,{reverse:!0}),$.mobile.document.one("pagehide",(function(){$.mobile.navigate.history.activeIndex-=2}))}else pageHistoryCount>0&&pageHistoryCount--,0===pageHistoryCount?navigator.app.exitApp():(goingBack=!0,$.mobile.back())}}function checkChangesBeforeBack(){checkChanges(goBack)}function checkChanges(t){var e=$(".ui-page-active").find(".hasChanges");if(t=t||function(){},0!==e.length)return areYouSure(_("Do you want to save your changes?"),"",(function(){e.click(),e.hasClass("preventBack")||t()}),t),!1;t()}function showerror(t,e){e=e||2500,clearTimeout(errorTimeout),$.mobile.loading("show",{text:t,textVisible:!0,textonly:!0,theme:"b"}),errorTimeout=setTimeout((function(){$.mobile.loading("hide")}),e)}function loadLocalSettings(){storage.get("isMetric",(function(t){switch(t.isMetric){case"true":isMetric=!0;break;case"false":isMetric=!1}})),storage.get("groupView",(function(t){switch(t.groupView){case"true":groupView=!0;break;case"false":groupView=!1}}))}function fixInputClick(t){FastClick.notNeeded(document.body)||(t.find("input[type='checkbox']:not([data-role='flipswitch']),.ui-select > .ui-btn").addClass("needsclick"),t.find(".ui-collapsible-heading-toggle").on("click",(function(){var t=$(this);setTimeout((function(){t.removeClass("ui-btn-active")}),100)})))}function holdButton(t,e){var n;t.on(isTouchCapable?"tap":"click",e).on("taphold",(function(t){n=setInterval((function(){e(t)}),100)})).on("vmouseup vmouseout vmousecancel touchend",(function(){clearInterval(n)})).on("touchmove",(function(t){t.preventDefault()}))}function insertStyle(t){var e=document.createElement("style");e.innerHTML=t,document.head.appendChild(e)}function parseIntArray(t){for(var e=0;e<t.length;e++)t[e]=+t[e];return t}function getDurationText(t){return 65535===t?_("Sunset to Sunrise"):65534===t?_("Sunrise to Sunset"):dhms2str(sec2dhms(t))}function sec2hms(t){var e="",n=Math.max(0,parseInt(t/3600)%24),i=Math.max(0,parseInt(t/60)%60),o=t%60;return n&&(e+=pad(n)+":"),e+pad(i)+":"+pad(o)}function sec2dhms(t){var e=t<0?-1:1;return t=Math.abs(t),{days:Math.max(0,parseInt(t/86400))*e,hours:Math.max(0,parseInt(t%86400/3600))*e,minutes:Math.max(0,parseInt(t%86400%3600/60))*e,seconds:Math.max(0,parseInt(t%86400%3600%60))*e}}function dhms2str(t){var e="";return t.days&&(e+=t.days+_("d")+" "),t.hours&&(e+=t.hours+_("h")+" "),t.minutes&&(e+=t.minutes+_("m")+" "),t.seconds&&(e+=t.seconds+_("s")+" "),""===e&&(e="0"+_("s")),e.trim()}function dhms2sec(t){return parseInt(86400*t.days+3600*t.hours+60*t.minutes+t.seconds)}function isControllerConnected(){return!(!currIp&&!currToken||$.isEmptyObject(controller)||$.isEmptyObject(controller.options)||$.isEmptyObject(controller.programs)||$.isEmptyObject(controller.settings)||$.isEmptyObject(controller.status)||$.isEmptyObject(controller.stations))}function exportObj(t,e,n){if(e=encodeURIComponent(JSON.stringify(e)),isFileCapable)$(t).attr({href:"data:text/json;charset=utf-8,"+e,download:"backup-"+(new Date).toLocaleDateString().replace(/\//g,"-")+".json"});else{n=n||"OpenSprinkler Data Export on "+dateToString(new Date);var i="mailto:?subject="+encodeURIComponent(n)+"&body="+e;$(t).attr("href",i).on("click",(function(){window.open(i)}))}}function sortObj(t,e){var n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i);"function"==typeof e?n.sort(e):"value"===e?n.sort((function(e,n){var i=t[e],o=t[n];return i<o?-1:i>o?1:0})):n.sort();for(var o={},a=0;a<n.length;a++)o[n[a]]=t[n[a]];return o}function getDayName(t,e){var n=[_("Sunday"),_("Monday"),_("Tuesday"),_("Wednesday"),_("Thursday"),_("Friday"),_("Saturday")],i=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thu"),_("Fri"),_("Sat")];return"short"===e?i[t.getDay()]:n[t.getDay()]}function pad(t){var e=String(t);return 1===e.length&&(e="0"+e),e}function htmlEscape(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function _(t){if("object"==typeof language&&language.hasOwnProperty(t)){var e=language[t];return e||t}return t}function setLang(){$("[data-translate]").text((function(){var t=$(this),e=t.data("translate");if(!t.is("input[type='submit']"))return _(e);t.val(_(e)),t.parent("div.ui-btn").length>0&&t.button("refresh")})),$(".ui-toolbar-back-btn").text(_("Back")),checkCurrLang()}function updateLang(t){language={},void 0!==t?(storage.set({lang:t}),currLang=t,"en"!==t?$.getJSON(getAppURLPath()+"locale/"+t+".js",(function(t){language=t.messages,setLang()})).fail(setLang):setLang()):storage.get("lang",(function(t){updateLang((t.lang||navigator.language||navigator.browserLanguage||navigator.systemLanguage||navigator.userLanguage||"en").substring(0,2))}))}function languageSelect(){$("#localization").popup("destroy").remove();var t="<div data-role='popup' data-theme='a' id='localization' data-corners='false'><ul data-inset='true' data-role='listview' id='lang' data-corners='false'><li data-role='list-divider' data-theme='b' class='center' data-translate='Localization'>"+_("Localization")+"</li>";return $.each({af:"Afrikaans",am:"Amharic",bg:"Bulgarian",zh:"Chinese",hr:"Croatian",cs:"Czech",nl:"Dutch",en:"English",et:"Estonian",pes:"Farsi",fr:"French",de:"German",el:"Greek",he:"Hebrew",hu:"Hungarian",is:"Icelandic",it:"Italian",lv:"Latvian",mn:"Mongolian",no:"Norwegian",pl:"Polish",pt:"Portuguese",ru:"Russian",sk:"Slovak",sl:"Slovenian",es:"Spanish",ta:"Tamil",th:"Thai",tr:"Turkish",sv:"Swedish",ro:"Romanian"},(function(e,n){t+="<li><a href='#' data-lang-code='"+e+"'><span data-translate='"+n+"'>"+_(n)+"</span> ("+e.toUpperCase()+")</a></li>"})),t+="</ul></div>",(t=$(t)).find("a").on("click",(function(){updateLang($(this).data("lang-code"))})),openPopup(t),!1}function checkCurrLang(){storage.get("lang",(function(t){var e=$("#localization");e.find("a").each((function(){var e=$(this);e.data("lang-code")===t.lang?e.removeClass("ui-icon-carat-r").addClass("ui-icon-check"):e.removeClass("ui-icon-check").addClass("ui-icon-carat-r")})),e.find("li.ui-last-child").removeClass("ui-last-child")}))}function getAppURLPath(){return currLocal?$.mobile.path.parseUrl($("head").find("script[src$='app.js']").attr("src")).hrefNoHash.slice(0,-9):""}function getUrlVars(t){for(var e,n={},i=t.slice(t.indexOf("?")+1).split("&"),o=0;o<i.length;o++)n[(e=i[o].split("="))[0]]=decodeURIComponent(e[1].replace(/\+/g,"%20"));return n}function escapeJSON(t){return JSON.stringify(t).replace(/\{|\}/g,"")}function unescapeJSON(t){return JSON.parse("{"+t+"}")}function isMD5(t){return/^[a-f0-9]{32}$/i.test(t)}function sortByStation(t,e){return t.station<e.station?-1:t.station>e.station?1:0}function minutesToTime(t){var e=t>719?"PM":"AM",n=parseInt(t/60)%12;return 0===n&&(n=12),isMetric?pad((t/60>>0)%24)+":"+pad(t%60):n+":"+pad(t%60)+" "+e}function getBitFromByte(t,e){return 0!=(t&1<<e)}function getTimezoneOffset(){var t=controller.options.tz-48,e=t>=0?1:-1;return(t=60*(Math.abs(t)/4>>0)+(Math.abs(t)%4*15/10>>0)+Math.abs(t)%4*15%10)*e}function humaniseDuration(t,e){var n,i=Math.floor((e-t)/1e3),o=i>0;if((i=Math.abs(i))<10)return _("Just Now");var a=Math.floor(i/31536e3);return n=_(a>=1?a>1?"years":"year":(a=Math.floor(i/2592e3))>=1?a>1?"months":"month":(a=Math.floor(i/86400))>=1?a>1?"days":"day":(a=Math.floor(i/3600))>=1?a>1?"hours":"hour":(a=Math.floor(i/60))>=1?a>1?"minutes":"minute":(a=i)>1?"seconds":"second"),o?_("In")+" "+a+" "+n:a+" "+n+" "+_("ago")}function dateToString(t,e,n){var i=[_("Sun"),_("Mon"),_("Tue"),_("Wed"),_("Thu"),_("Fri"),_("Sat")],o=[_("Jan"),_("Feb"),_("Mar"),_("Apr"),_("May"),_("Jun"),_("Jul"),_("Aug"),_("Sep"),_("Oct"),_("Nov"),_("Dec")];return 0===t.getTime()?"--":(!1!==e&&t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),"de"===currLang?pad(t.getDate())+"."+pad(t.getMonth()+1)+"."+t.getFullYear()+" "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()):1===n?o[t.getMonth()]+" "+pad(t.getDate())+", "+t.getFullYear()+" "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()):2===n?o[t.getMonth()]+" "+pad(t.getDate())+", "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()):i[t.getDay()]+", "+pad(t.getDate())+" "+o[t.getMonth()]+" "+t.getFullYear()+" "+pad(t.getHours())+":"+pad(t.getMinutes())+":"+pad(t.getSeconds()))}function transformKeys(t){if(checkOSVersion(219)){var e={};return Object.keys(t).forEach((function(n){var i=n.match(/^o(\d+)$/);i&&i[1]?e[Object.keys(keyIndex).find((function(t){return keyIndex[t]===parseInt(i[1],10)}))]=t[n]:e[n]=t[n]})),e}return t}function transformKeysinString(t){var e={};t.split("&").forEach((function(t){t=t.split("="),e[t[0]]=t[1]})),e=transformKeys(e);var n=[];return Object.keys(e).forEach((function(t){n.push(t+"="+e[t])})),t=n.join("&")}function Supported(){}function Station(){}$.fn.focusInput=function(){if(this.get(0).setSelectionRange)this.focus(),this.get(0).setSelectionRange(0,this.val().length);else if(this.get(0).createTextRange){var t=this.get(0).createTextRange();t.collapse(!0),t.moveEnd("character",this.val().length),t.moveStart("character",0),t.select()}return this},Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)},Supported.master=function(t){switch(t){case MASTER_STATION_1:return!!controller.options.mas;case MASTER_STATION_2:return!!controller.options.mas2;default:return!1}},Supported.ignoreRain=function(){return"object"==typeof controller.stations.ignore_rain},Supported.ignoreSensor=function(t){switch(t){case IGNORE_SENSOR_1:return"object"==typeof controller.stations.ignore_sn1;case IGNORE_SENSOR_2:return"object"==typeof controller.stations.ignore_sn2;default:return!1}},Supported.actRelay=function(){return"object"==typeof controller.stations.act_relay},Supported.disabled=function(){return"object"==typeof controller.stations.stn_dis},Supported.sequential=function(){return!checkOSVersion(220)&&"object"==typeof controller.stations.stn_seq},Supported.special=function(){return"object"==typeof controller.stations.stn_spe},Supported.pausing=function(){return void 0!==controller.settings.pq},Supported.groups=function(){return getNumberProgramStatusOptions()>=4},Supported.dateRange=function(){return checkOSVersion(220)};var ProgramStatusOptions={PID:0,REM:1,START:2,GID:3};function getNumberProgramStatusOptions(){if(!(controller.settings.ps.length<=0))return controller.settings.ps[0].length}function StationAttribute(){}function CardList(){}function Card(){}function Groups(){}function StationQueue(){}function mapIndexToGIDValue(t){return t-NUM_SEQ_GROUPS?t:PARALLEL_GID_VALUE}function mapGIDValueToName(t){switch(t){case PARALLEL_GID_VALUE:return PARALLEL_GROUP_NAME;case MASTER_GID_VALUE:return MASTER_GROUP_NAME;default:return String.fromCharCode(65+t)}}function mapGIDNameToValue(t){switch(t){case PARALLEL_GROUP_NAME:return PARALLEL_GID_VALUE;case MASTER_GROUP_NAME:return MASTER_GID_VALUE;default:return t.charCodeAt(0)-65}}Station.getName=function(t){return controller.stations.snames[t]},Station.setName=function(t,e){controller.settings.snames[t]=e},Station.getPID=function(t){return controller.settings.ps[t][ProgramStatusOptions.PID]},Station.setPID=function(t,e){controller.settings.ps[t][ProgramStatusOptions.PID]=e},Station.getRemainingRuntime=function(t){return controller.settings.ps[t][ProgramStatusOptions.REM]},Station.setRemainingRuntime=function(t,e){controller.settings.ps[t][ProgramStatusOptions.REM]=e},Station.getStartTime=function(t){return controller.settings.ps[t][ProgramStatusOptions.START]},Station.setStartTime=function(t,e){controller.settings.ps[t][ProgramStatusOptions.START]=e},Station.getGIDValue=function(t){if(Supported.groups())return controller.settings.ps[t][ProgramStatusOptions.GID]},Station.setGIDValue=function(t,e){Supported.groups()&&(controller.settings.ps[t][ProgramStatusOptions.GID]=e)},Station.getStatus=function(t){return controller.status[t]},Station.setStatus=function(t,e){controller.status[t]=e},Station.isRunning=function(t){return Station.getStatus(t)>0},Station.isMaster=function(t){var e="number"==typeof controller.options.mas?controller.options.mas:0,n="number"==typeof controller.options.mas2?controller.options.mas2:0;return e===++t?1:n===t?2:0},Station.isSequential=function(t){return StationAttribute.getSequential(t)>0},Station.isSpecial=function(t){return StationAttribute.getSpecial(t)>0},Station.isDisabled=function(t){return StationAttribute.getDisabled(t)>0},StationAttribute.getMasterOperation=function(t,e){var n,i=t/8>>0;if(!Supported.master(e))return 0;switch(e){case MASTER_STATION_1:n=controller.stations.masop;break;case MASTER_STATION_2:n=controller.stations.masop2;break;default:return 0}return n[i]&1<<t%8?1:0},StationAttribute.getIgnoreRain=function(t){if(!Supported.ignoreRain())return 0;var e=t/8>>0;return controller.stations.ignore_rain[e]&1<<t%8?1:0},StationAttribute.getIgnoreSensor=function(t,e){var n,i=t/8>>0;if(!Supported.ignoreSensor(e))return 0;switch(e){case IGNORE_SENSOR_1:n=controller.stations.ignore_sn1;break;case IGNORE_SENSOR_2:n=controller.stations.ignore_sn2;break;default:return 0}return n[i]&1<<t%8?1:0},StationAttribute.getActRelay=function(t){if(!Supported.actRelay())return 0;var e=t/8>>0;return controller.stations.act_relay[e]&1<<t%8?1:0},StationAttribute.getDisabled=function(t){if(!Supported.disabled())return 0;var e=t/8>>0;return controller.stations.stn_dis[e]&1<<t%8?1:0},StationAttribute.getSequential=function(t){if(Supported.groups())return Station.getGIDValue!==PARALLEL_GID_VALUE?1:0;if(!Supported.sequential())return 0;var e=t/8>>0;return controller.stations.stn_seq[e]&1<<t%8?1:0},StationAttribute.getSpecial=function(t){if(!Supported.special())return 0;var e=t/8>>0;return controller.stations.stn_spe[e]&1<<t%8?1:0},CardList.getAllCards=function(t){return t.filter(".card")},CardList.getCardBySID=function(t,e){return t.filter("[data-station='"+e+"']")},CardList.getCardByIndex=function(t,e){return $(t[e])},Card.getSID=function(t){return t.data("station")},Card.getDivider=function(t){return t.find(".content-divider")},Card.getGroupLabel=function(t){if(Supported.groups())return t.find(".station-gid")},Card.setGroupLabel=function(t,e){if(Supported.groups()){var n=Card.getGroupLabel(t);n.removeClass("hidden"),n.text(e)}},Card.getGIDValue=function(t){if(!Supported.groups())return 0;var e=$(t.children()[0]).children().filter("span"),n=$(e[e.length-1]);return parseInt(n.attr("data-gid"))},Card.getGIDName=function(t){return mapGIDValueToName(Station.getGIDValue(Card.getSID(t)))},Card.isMasterStation=function(t){return Station.isMaster(Card.getSID(t))},Groups.numActiveStations=function(t){var e=$(".station-status.on, .station-status.wait").parents(".card"),n=0;return $.each(e,(function(i){var o=$(e[i]);Card.getGIDValue(o)!==t||Card.isMasterStation(o)||n++})),n},Groups.canShift=function(t){return Groups.numActiveStations(t)>1},StationQueue.isActive=function(){for(var t=0;t<controller.status.length;t++)if(Station.getStatus(t)>0&&Station.getPID(t)>0)return t;return-1},StationQueue.isPaused=function(){return controller.settings.pq},StationQueue.size=function(){return controller.settings.nq};var dateRegex=/[0-9]{1,2}[\/][0-9]{1,2}/g;function Program(){}function extractDateFromString(t){return t.match(dateRegex)}function isValidDateFormat(t){return null!==extractDateFromString(t)}function isValidDateRange(t,e){return isValidDateFormat(t)&&isValidDateFormat(e)}function encodeDate(t){var e=extractDateFromString(t);if(null===e)return-1;var n=e[0].split("/",2);return(parseInt(n[0])<<5)+parseInt(n[1])}Program.getDateRange=function(t){return controller.programs.pd[t][6]},Program.isDateRangeEnabled=function(t){return"new"===t?0:Program.getDateRange(t)[0]},Program.getDateRangeStart=function(t){return"new"===t?minEncodedDate:Program.getDateRange(t)[1]},Program.getDateRangeEnd=function(t){return"new"===t?maxEncodedDate:Program.getDateRange(t)[2]};var minEncodedDate=encodeDate("01/01"),maxEncodedDate=encodeDate("12/31");function decodeDate(t){var e,n,i=[];return minEncodedDate<=t&&t<=maxEncodedDate?(e=t>>5,n=t%32,i.push(e/10>>0,e%10,"/",n/10>>0,n%10),i.join("")):t<minEncodedDate?"01/01":"12/31"}
/*!
 * Analog Sensor API - GUI for OpenSprinkker App
 * https://github.com/opensprinklershop/
 * (c) 2023 OpenSprinklerShop
 * Released under the MIT License
 */
var analogSensors={},progAdjusts={};function refresh(){setTimeout((function(){location.reload()}),100)}function updateProgramAdjustments(t){return t=t||function(){},sendToOS("/se?pw=","json").then((function(e){progAdjusts=e.progAdjust,t()}))}function updateAnalogSensor(t){return t=t||function(){},sendToOS("/sl?pw=","json").then((function(e){analogSensors=e.sensors,t()}))}function updateSensorShowArea(t){if(checkOSVersion(230)){var e,n,i=t.find("#os-sensor-show"),o="";for(e=0;e<progAdjusts.length;e++){var a=progAdjusts[e],s="";for(n=0;n<analogSensors.length;n++)analogSensors[n].nr===a.sensor&&(s=analogSensors[n].name);var r="?";a.prog>=1&&a.prog<=controller.programs.pd.length&&(r=readProgram(controller.programs.pd[a.prog-1]).name),o+="<div id='progAdjust-show-"+a.nr+"' class='ui-body ui-body-a center'>",o+="<label>"+s+" - "+r+": "+Math.round(100*a.current)+"%</label>",o+="</div>"}for(e=0;e<analogSensors.length;e++){var l=analogSensors[e];l.show&&(o+="<div id='sensor-show-"+l.nr+"' class='ui-body ui-body-a center'>",o+="<label>"+l.name+": "+Math.round(l.data)+l.unit+"</label>",o+="</div>")}for(;i.firstChild;)i.removeChild(i.firstChild);i.html(o)}}function toByteArray(t){for(var e=[],n=4;n--;)e.push(Number(t%256)),t/=256;return Uint8Array.from(e)}function intFromBytes(t){try{for(var e=0,n=t.length-1;n>=0;n--)e*=256,e+=parseInt(t[n]);return e}catch(t){return 0}}function showAdjustmentsEditor(t,e){sendToOS("/sh?pw=","json").then((function(n){var i,o=n.progTypes;$(".ui-popup-active").find("[data-role='popup']").popup("close");var a="<div data-role='popup' data-theme='a' id='progAdjustEditor'><div data-role='header' data-theme='b'><h1>"+_(t.nr>0?"Edit Program Adjustment":"New Program Adjustment")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Notice: If you want to combine multiple sensors, then build a sensor group. ")+_("See Help Documentation for details.")+"</p><div class='ui-field-contain'><label>"+_("Adjustment-Nr")+"</label><input class='nr' type='number' min='1' max='99999' value='"+t.nr+(t.nr>0?"' disabled='disabled'>":"'>")+"<div class='ui-field-contain'><label for='type' class='select'>"+_("Type")+"</label><select data-mini='true' id='type'>";for(i=0;i<o.length;i++)a+="<option "+(t.type===o[i].type?"selected":"")+" value='"+o[i].type+"'>"+o[i].name+"</option>";for(a+="</select></div><div class='ui-field-contain'><label for='sensor' class='select'>"+_("Sensor")+"</label><select data-mini='true' id='sensor'>",i=0;i<analogSensors.length;i++)a+="<option "+(t.sensor===analogSensors[i].nr?"selected":"")+" value='"+analogSensors[i].nr+"'>"+analogSensors[i].nr+" - "+analogSensors[i].name+"</option>";for(a+="</select></div><div class='ui-field-contain'><label for='prog' class='select'>"+_("Program to adjust")+"</label><select data-mini='true' id='prog'>",i=0;i<controller.programs.pd.length;i++){var s=readProgram(controller.programs.pd[i]).name,r=i+1;a+="<option "+(t.prog===r?"selected":"")+" value='"+r+"'>"+s+"</option>"}a+="</select></div><label>"+_("Factor 1 (adjustment for Min)")+"</label><input class='factor1' type='number' value='"+t.factor1+"'><label>"+_("Factor 2 (adjustment for Max)")+"</label><input class='factor2' type='number' value='"+t.factor2+"'><label>"+_("Min Sensor value")+"</label><input class='min' type='number' value='"+t.min+"'><label>"+_("Max Sensor value")+"</label><input class='max' type='number' value='"+t.max+"'></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>";var l=$(a),c=function(t,e){var n=l.find(".inputs input").eq(t),i=parseInt(n.val());-1===e&&0===i||1===e&&100===i||n.val(i+e)};l.find(".submit").on("click",(function(){var t={nr:parseInt(l.find(".nr").val()),type:parseInt(l.find("#type").val()),sensor:parseInt(l.find("#sensor").val()),prog:parseInt(l.find("#prog").val()),factor1:parseFloat(l.find(".factor1").val()),factor2:parseFloat(l.find(".factor2").val()),min:parseFloat(l.find(".min").val()),max:parseFloat(l.find(".max").val())};return e(t),l.popup("close"),!1})),l.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),holdButton(l.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return c(e,1),!1})),holdButton(l.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return c(e,-1),!1})),$("#sensorEditor").remove(),l.css("max-width","580px"),openPopup(l,{positionTo:"window"})}))}function isSmt100(t){return!!t&&(1===t||2===t)}function showSensorEditor(t,e){sendToOS("/sf?pw=","json").then((function(n){var i,o=n.sensorTypes;$(".ui-popup-active").find("[data-role='popup']").popup("close");var a="<div data-role='popup' data-theme='a' id='sensorEditor'><div data-role='header' data-theme='b'><h1>"+_(t.nr>0?"Edit Sensor":"New Sensor")+"</h1></div><div class='ui-content'><p class='rain-desc center smaller'>"+_("Edit Sensor Configuration. ")+_("See Help Documentation for details.")+"</p><div class='ui-field-contain'><label>"+_("Sensor-Nr")+"</label><input class='nr' type='number' min='1' max='99999' value='"+t.nr+(t.nr>0?"' disabled='disabled'>":"'>")+"<div class='ui-field-contain'><label for='type' class='select'>"+_("Type")+"</label><select data-mini='true' id='type'>";for(i=0;i<o.length;i++)a+="<option "+(t.type===o[i].type?"selected":"")+" value='"+o[i].type+"'>"+o[i].name+"</option>";a+="</select></div>",a+="<button data-mini='true' class='center-div' id='smt100id' style='display:"+(isSmt100(t.type)?"block":"none")+"'>"+_("Set SMT100 Modbus ID")+"</button>",a+="<label>"+_("Group")+"</label><input class='group' type='number'  min='0' max='99999' value='"+t.group+"'><label>"+_("Name")+"</label><input class='name' type='text'  value='"+t.name+"'><label>"+_("IP-Address")+"</label><input class='ip' type='text'  value='"+(t.ip?toByteArray(t.ip).join("."):"")+"'><label>"+_("Port")+"</label><input class='port' type='number' min='0' max='65535' value='"+t.port+"'><label>"+_("ID")+"</label><input class='id' type='number' min='0' max='65535' value='"+t.id+"'><label>"+_("Read Interval (s)")+"</label><input class='ri' type='number' min='1' max='999999' value='"+t.ri+"'><label for='enable'><input data-mini='true' id='enable' type='checkbox' "+(1===t.enable?"checked='checked'":"")+">"+_("Sensor Enabled")+"</label><label for='log'><input data-mini='true' id='log' type='checkbox' "+(1===t.log?"checked='checked'":"")+">"+_("Enable Data Logging")+"</label><label for='log'><input data-mini='true' id='show' type='checkbox' "+(1===t.show?"checked='checked'":"")+">"+_("Show on Mainpage")+"</label></div><button class='submit' data-theme='b'>"+_("Submit")+"</button></div></div>";var s=$(a),r=function(t,e){var n=s.find(".inputs input").eq(t),i=parseInt(n.val());-1===e&&0===i||1===e&&100===i||n.val(i+e)};s.find("#smt100id").on("click",(function(){var t=parseInt(s.find(".nr").val()),e=parseInt(s.find(".id").val());s.popup("close"),areYouSure(_("This function sets the Modbus ID for one SMT100 sensor. Disconnect all other sensors on this Modbus port. Please confirm."),"new id="+e,(function(){sendToOS("/sa?pw=&nr="+t+"&id="+e).done((function(){window.alert("SMT100 id assigned!"),updateAnalogSensor(refresh)}))}))})),s.find("#type").change((function(){var t=parseInt(s.find("#type").val());document.getElementById("smt100id").style.display=isSmt100(t)?"block":"none"})),s.find(".submit").on("click",(function(){if(!t.nr)for(var n=parseInt(s.find(".nr").val()),i=0;i<analogSensors.length;i++)if(analogSensors[i].nr===n)return void window.alert(_("Sensor-Number exists!"));var o={nr:parseInt(s.find(".nr").val()),type:parseInt(s.find("#type").val()),group:parseInt(s.find(".group").val()),name:s.find(".name").val(),ip:intFromBytes(s.find(".ip").val().split(".")),port:parseInt(s.find(".port").val()),id:parseInt(s.find(".id").val()),ri:parseInt(s.find(".ri").val()),enable:s.find("#enable").is(":checked")?1:0,log:s.find("#log").is(":checked")?1:0,show:s.find("#show").is(":checked")?1:0};return e(o),s.popup("close"),!1})),s.on("focus","input[type='number']",(function(){this.value=""})).on("blur","input[type='number']",(function(){var t=parseFloat(this.min),e=parseFloat(this.max);""===this.value&&(this.value="0"),(this.value<t||this.value>e)&&(this.value=this.value<t?t:e)})),holdButton(s.find(".incr").children(),(function(t){var e=$(t.currentTarget).index();return r(e,1),!1})),holdButton(s.find(".decr").children(),(function(t){var e=$(t.currentTarget).index();return r(e,-1),!1})),$("#sensorEditor").remove(),s.css("max-width","580px"),openPopup(s,{positionTo:"window"})}))}var showAnalogSensorConfig=function(){var t=$("<div data-role='page' id='analogsensorconfig'><div class='ui-content' role='main' id='analogsensorlist'></div></div>");function e(){var n=$(buildSensorConfig());n.find("#delete-sensor").on("click",(function(){var t=$(this),n=t.attr("value"),i=t.attr("row");areYouSure(_("Are you sure you want to delete the sensor?"),n,(function(){sendToOS("/sc?pw=&nr="+n+"&type=0").done((function(){analogSensors.splice(i,1),e()}))}))})),n.find("#edit-sensor").on("click",(function(){var t=$(this).attr("row"),n=analogSensors[t];showSensorEditor(n,(function(i){i.nativedata=n.nativedata,i.data=n.data,i.last=n.last,sendToOS("/sc?pw=&nr="+i.nr+"&type="+i.type+"&group="+i.group+"&name="+i.name+"&ip="+i.ip+"&port="+i.port+"&id="+i.id+"&ri="+i.ri+"&enable="+i.enable+"&log="+i.log+"&show="+i.show).done((function(){analogSensors[t]=i,e()}))}))})),n.find("#add-sensor").on("click",(function(){showSensorEditor({name:"new sensor",type:1,ri:60,enable:1,log:1},(function(t){sendToOS("/sc?pw=&nr="+t.nr+"&type="+t.type+"&group="+t.group+"&name="+t.name+"&ip="+t.ip+"&port="+t.port+"&id="+t.id+"&ri="+t.ri+"&enable="+t.enable+"&log="+t.log+"&show="+t.show).done((function(){analogSensors.push(t),e()}))}))})),n.find("#refresh-sensor").on("click",(function(){updateProgramAdjustments((function(){updateAnalogSensor((function(){e()}))}))})),n.find("#delete-progadjust").on("click",(function(){var t=$(this),n=t.attr("value");row=t.attr("row"),areYouSure(_("Are you sure you want to delete this program adjustment?"),n,(function(){sendToOS("/sb?pw=&nr="+n+"&type=0").done((function(){progAdjusts.splice(row,1),e()}))}))})),n.find("#edit-progadjust").on("click",(function(){var t=$(this).attr("row");showAdjustmentsEditor(progAdjusts[t],(function(n){sendToOS("/sb?pw=&nr="+n.nr+"&type="+n.type+"&sensor="+n.sensor+"&prog="+n.prog+"&factor1="+n.factor1+"&factor2="+n.factor2+"&min="+n.min+"&max="+n.max).done((function(){progAdjusts[t]=n,e()}))}))})),n.find("#add-progadjust").on("click",(function(){showAdjustmentsEditor({type:1},(function(t){sendToOS("/sb?pw=&nr="+t.nr+"&type="+t.type+"&sensor="+t.sensor+"&prog="+t.prog+"&factor1="+t.factor1+"&factor2="+t.factor2+"&min="+t.min+"&max="+t.max).done((function(){progAdjusts.push(t),e()}))}))})),n.find("#clear-log").on("click",(function(){areYouSure(_("Are you sure you want to clear the sensor log?"),"",(function(){sendToOS("/sn?pw=&").done((function(t){window.alert(_("Log cleared: "+t.deleted+_(" records"))),e()}))}))})),n.find("#download-log").on("click",(function(){sendToOS("/so?pw=&").done((function(t){var e=t.log,n=Object.keys(e[0]),i=e.map((function(t){return n.map((function(e){return t[e],null===n?"":n;var n})).join(",")}));i.unshift(n.join(",")),i=i.join("\r\n");var o=new Blob([i],{type:"text/csv"}),a=encodeURI(o),s=document.createElement("a");s.setAttribute("href",a),s.setAttribute("download","sensorlog-"+(new Date).toLocaleDateString().replace(/\//g,"-")+".csv"),document.body.appendChild(s),s.click()}))})),n.find("#show-log").on("click",(function(){return changePage("#analogsensorchart"),!1})),t.find("#analogsensorlist").html(n.enhanceWithin())}return t.on("sensorrefresh",e).on("pagehide",(function(){t.detach()})),function(){changeHeader({title:_("Analog Sensor Config"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),e(),$("#analogsensorconfig").remove(),$.mobile.pageContainer.append(t)}}();function buildSensorConfig(){var t='<table id=\'analog_sensor_table\'><tr style=\'width:100%;vertical-align: top;\'><tr><th>Nr</th><th class="hidecol">Type</th><th class="hidecol">Group</th><th>Name</th><th class="hidecol">IP</th><th class="hidecol">Port</th><th class="hidecol">ID</th><th class="hidecol">Read<br>Interval</th><th class="hidecol">Data</th><th>Enabled</th><th class="hidecol">Log</th><th class="hidecol">Show</th><th class="hidecol2">Last</th></tr>',e=0;return $.each(analogSensors,(function(n,i){var o=$("<tr>").append($("<td>").text(i.nr),$('<td class="hidecol">').text(i.type),$('<td class="hidecol">').text(i.group?i.group:""),$("<td>").text(i.name),$('<td class="hidecol">').text(i.ip?toByteArray(i.ip).join("."):""),$('<td class="hidecol">').text(i.port?i.port:""),$('<td class="hidecol">').text(i.type<1e3?i.id:""),$('<td class="hidecol">').text(i.ri),$('<td class="hidecol">').text(Math.round(i.data)+i.unit),$("<td>").text(i.enable),$('<td class="hidecol">').text(i.log),$('<td class="hidecol">').text(i.show),$('<td class="hidecol2">').text(dateToString(new Date(1e3*i.last)),null,2),"<td><button data-mini='true' class='center-div' id='edit-sensor' value='"+i.nr+"' row='"+e+"'>"+_("Edit")+"</button></td>","<td><button data-mini='true' class='center-div' id='delete-sensor' value='"+i.nr+"' row='"+e+"'>"+_("Delete")+"</button></td>");t+=o.wrap("<p>").html()+"</tr>",e++})),t+="</table>",t+="<p><button data-mini='true' class='center-div' id='add-sensor' value='1'>"+_("Add Sensor")+"</button></p>",t+="<p><button data-mini='true' class='center-div' id='refresh-sensor' value='2'>"+_("Refresh Sensordata")+"</button></p>",t+='<table id=\'progadjusttable\'><tr style=\'width:100%;vertical-align: top;\'><tr><th>Nr</th><th class="hidecol">Type</th><th class="hidecol">Sensor-Nr</th><th class="hidecol2">Name</th><th>Program-Nr</th><th>Program</th><th class="hidecol2">Factor 1</th><th class="hidecol2">Factor 2</th><th class="hidecol2">Min Value</th><th class="hidecol2">Max Value</th><th class="hidecol">Current</th></tr>',e=0,$.each(progAdjusts,(function(n,i){for(var o="",a=0;a<analogSensors.length;a++)analogSensors[a].nr===i.sensor&&(o=analogSensors[a].name);var s="?";i.prog>=1&&i.prog<=controller.programs.pd.length&&(s=readProgram(controller.programs.pd[i.prog-1]).name);var r=$("<tr>").append($("<td>").text(i.nr),$('<td class="hidecol">').text(i.type),$('<td class="hidecol">').text(i.sensor),$('<td class="hidecol2">').text(o),$("<td>").text(i.prog),$("<td>").text(s),$('<td class="hidecol2">').text(i.factor1),$('<td class="hidecol2">').text(i.factor2),$('<td class="hidecol2">').text(i.min),$('<td class="hidecol2">').text(i.max),$('<td class="hidecol">').text(Math.round(100*i.current)+"%"),"<td><button data-mini='true' class='center-div' id='edit-progadjust' value='"+i.nr+"' row='"+e+"'>"+_("Edit")+"</button></td>","<td><button data-mini='true' class='center-div' id='delete-progadjust' value='"+i.nr+"' row='"+e+"'>"+_("Delete")+"</button></td>");t+=r.wrap("<p>").html()+"</tr>",e++})),t+="</table>",t+="<p><button data-mini='true' class='center-div' id='add-progadjust' value='3'>"+_("Add program adjustment")+"</button></p>",t+="<table id='logfunctions'><tr style='width:100%;vertical-align: top;'><tr><th><button data-mini='true' class='center-div' id='clear-log'>"+_("Clear Log")+"</button></th><th><button data-mini='true' class='center-div' id='download-log'>"+_("Download Log")+"</button></th><th><a href='#analogsensorchart'><button data-mini='true' class='center-div' id='show-log'>"+_("Show Log")+"</button></a></th></tr></table>"}var showAnalogSensorCharts=function(){var t,e=$("<div data-role='page' id='analogsensorchart'><div class='ui-content' role='main'><ul data-role='listview' data-inset='true'><h1>Analog sensor log last 24h</h1><canvas id='myChart'></canvas></div></div>");return function(){t=null,e.one("pagehide",(function(){t.destroy(),e.detach()})),changeHeader({title:_("Analog sensor log last 24h"),leftBtn:{icon:"carat-l",text:_("Back"),class:"ui-toolbar-back-btn",on:goBack}}),$("#analogsensorchart").remove(),$.mobile.pageContainer.append(e),sendToOS("/so?pw=&lasthours=24","json").then((function(e){var n,i,o=[],a=[];for(a.x={type:"time"},n=0;n<analogSensors.length;n++){var s=analogSensors[n].nr,r=[];for(i=0;i<e.log.length;i++)e.log[i].nr===s&&r.push({x:1e3*e.log[i].time,y:e.log[i].data});if(r.length>0){var l=analogSensors[n].unitid;o.push({label:analogSensors[n].name,data:r,fill:!1,xAxisID:"x",yAxisID:"y"+l}),a["y"+l]=1===l?{type:"linear",display:!0,position:"left",title:{display:!0,text:analogSensors[n].unit},suggestedMin:0,suggestedMax:50}:{type:"linear",display:!0,position:l%2?"left":"right",title:{display:!0,text:analogSensors[n].unit}}}}var c=document.getElementById("myChart").getContext("2d");t=new Chart(c,{type:"line",data:{datasets:o},options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:a}})}))}}();function q(t){throw t}!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Chart=e()}(this,(function(){"use strict";var t=Object.freeze({__proto__:null,get Colors(){return Da},get Decimation(){return Aa},get Filler(){return Ga},get Legend(){return Ka},get SubTitle(){return ns},get Title(){return ts},get Tooltip(){return vs}});function e(){}const n=(()=>{let t=0;return()=>t++})();function i(t){return null==t}function o(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function a(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function s(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function r(t,e){return s(t)?t:e}function l(t,e){return void 0===t?e:t}const c=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:+t/e,d=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function u(t,e,n){if(t&&"function"==typeof t.call)return t.apply(n,e)}function h(t,e,n,i){let s,r,l;if(o(t))if(r=t.length,i)for(s=r-1;s>=0;s--)e.call(n,t[s],s);else for(s=0;s<r;s++)e.call(n,t[s],s);else if(a(t))for(l=Object.keys(t),r=l.length,s=0;s<r;s++)e.call(n,t[l[s]],l[s])}function p(t,e){let n,i,o,a;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(o=t[n],a=e[n],o.datasetIndex!==a.datasetIndex||o.index!==a.index)return!1;return!0}function f(t){if(o(t))return t.map(f);if(a(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let o=0;for(;o<i;++o)e[n[o]]=f(t[n[o]]);return e}return t}function m(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function g(t,e,n,i){if(!m(t))return;const o=e[t],s=n[t];a(o)&&a(s)?v(o,s,i):e[t]=f(s)}function v(t,e,n){const i=o(e)?e:[e],s=i.length;if(!a(t))return t;const r=(n=n||{}).merger||g;let l;for(let e=0;e<s;++e){if(l=i[e],!a(l))continue;const o=Object.keys(l);for(let e=0,i=o.length;e<i;++e)r(o[e],t,l,n)}return t}function b(t,e){return v(t,e,{merger:y})}function y(t,e,n){if(!m(t))return;const i=e[t],o=n[t];a(i)&&a(o)?b(i,o):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=f(o))}const w={"":t=>t,x:t=>t.x,y:t=>t.y};function x(t){const e=t.split("."),n=[];let i="";for(const t of e)i+=t,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function _(t,e){const n=w[e]||(w[e]=function(t){const e=x(t);return t=>{for(const n of e){if(""===n)break;t=t&&t[n]}return t}}(e));return n(t)}function k(t){return t.charAt(0).toUpperCase()+t.slice(1)}const S=t=>void 0!==t,T=t=>"function"==typeof t,C=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function M(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}const D=Math.PI,O=2*D,E=O+D,A=Number.POSITIVE_INFINITY,I=D/180,P=D/2,L=D/4,N=2*D/3,R=Math.log10,j=Math.sign;function $(t,e,n){return Math.abs(t-e)<n}function B(t){const e=Math.round(t);t=$(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(R(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function H(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i==0&&(e.push(i),e.push(t/i));return n===(0|n)&&e.push(n),e.sort(((t,e)=>t-e)).pop(),e}function W(t){return!isNaN(parseFloat(t))&&isFinite(t)}function F(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function U(t,e,n){let i,o,a;for(i=0,o=t.length;i<o;i++)a=t[i][n],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function V(t){return t*(D/180)}function z(t){return t*(180/D)}function q(t){if(!s(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function Y(t,e){const n=e.x-t.x,i=e.y-t.y,o=Math.sqrt(n*n+i*i);let a=Math.atan2(i,n);return a<-.5*D&&(a+=O),{angle:a,distance:o}}function G(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function X(t,e){return(t-e+E)%O-D}function J(t){return(t%O+O)%O}function Q(t,e,n,i){const o=J(t),a=J(e),s=J(n),r=J(a-o),l=J(s-o),c=J(o-a),d=J(o-s);return o===a||o===s||i&&a===s||r>l&&c<d}function K(t,e,n){return Math.max(e,Math.min(n,t))}function Z(t){return K(t,-32768,32767)}function tt(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}function et(t,e,n){n=n||(n=>t[n]<e);let i,o=t.length-1,a=0;for(;o-a>1;)i=a+o>>1,n(i)?a=i:o=i;return{lo:a,hi:o}}const nt=(t,e,n,i)=>et(t,n,i?i=>{const o=t[i][e];return o<n||o===n&&t[i+1][e]===n}:i=>t[i][e]<n),it=(t,e,n)=>et(t,n,(i=>t[i][e]>=n));function ot(t,e,n){let i=0,o=t.length;for(;i<o&&t[i]<e;)i++;for(;o>i&&t[o-1]>n;)o--;return i>0||o<t.length?t.slice(i,o):t}const at=["push","pop","shift","splice","unshift"];function st(t,e){t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),at.forEach((e=>{const n="_onData"+k(e),i=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...e){const o=i.apply(this,e);return t._chartjs.listeners.forEach((t=>{"function"==typeof t[n]&&t[n](...e)})),o}})})))}function rt(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,o=i.indexOf(e);-1!==o&&i.splice(o,1),i.length>0||(at.forEach((e=>{delete t[e]})),delete t._chartjs)}function lt(t){const e=new Set;let n,i;for(n=0,i=t.length;n<i;++n)e.add(t[n]);return e.size===i?t:Array.from(e)}const ct="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function dt(t,e){let n=[],i=!1;return function(...o){n=o,i||(i=!0,ct.call(window,(()=>{i=!1,t.apply(e,n)})))}}function ut(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}const ht=t=>"start"===t?"left":"end"===t?"right":"center",pt=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2,ft=(t,e,n,i)=>t===(i?"left":"right")?n:"center"===t?(e+n)/2:e;function mt(t,e,n){const i=e.length;let o=0,a=i;if(t._sorted){const{iScale:s,_parsed:r}=t,l=s.axis,{min:c,max:d,minDefined:u,maxDefined:h}=s.getUserBounds();u&&(o=K(Math.min(nt(r,s.axis,c).lo,n?i:nt(e,l,s.getPixelForValue(c)).lo),0,i-1)),a=h?K(Math.max(nt(r,s.axis,d,!0).hi+1,n?0:nt(e,l,s.getPixelForValue(d),!0).hi+1),o,i)-o:i-o}return{start:o,count:a}}function gt(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,o={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=o,!0;const a=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,o),a}var vt=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,i){const o=e.listeners[i],a=e.duration;o.forEach((i=>i({chart:t,initial:e.initial,numSteps:a,currentStep:Math.min(n-e.start,a)})))}_refresh(){this._request||(this._running=!0,this._request=ct.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((n,i)=>{if(!n.running||!n.items.length)return;const o=n.items;let a,s=o.length-1,r=!1;for(;s>=0;--s)a=o[s],a._active?(a._total>n.duration&&(n.duration=a._total),a.tick(t),r=!0):(o[s]=o[o.length-1],o.pop());r&&(i.draw(),this._notify(i,n,t,"progress")),o.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),e+=o.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};
/*!
 * @kurkle/color v0.3.0
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function bt(t){return t+.5|0}const yt=(t,e,n)=>Math.max(Math.min(t,n),e);function wt(t){return yt(bt(2.55*t),0,255)}function xt(t){return yt(bt(255*t),0,255)}function _t(t){return yt(bt(t/2.55)/100,0,1)}function kt(t){return yt(bt(100*t),0,100)}const St={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Tt=[..."0123456789ABCDEF"],Ct=t=>Tt[15&t],Mt=t=>Tt[(240&t)>>4]+Tt[15&t],Dt=t=>(240&t)>>4==(15&t);const Ot=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Et(t,e,n){const i=e*Math.min(n,1-n),o=(e,o=(e+t/30)%12)=>n-i*Math.max(Math.min(o-3,9-o,1),-1);return[o(0),o(8),o(4)]}function At(t,e,n){const i=(i,o=(i+t/60)%6)=>n-n*e*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function It(t,e,n){const i=Et(t,1,.5);let o;for(e+n>1&&(o=1/(e+n),e*=o,n*=o),o=0;o<3;o++)i[o]*=1-e-n,i[o]+=e;return i}function Pt(t){const e=t.r/255,n=t.g/255,i=t.b/255,o=Math.max(e,n,i),a=Math.min(e,n,i),s=(o+a)/2;let r,l,c;return o!==a&&(c=o-a,l=s>.5?c/(2-o-a):c/(o+a),r=function(t,e,n,i,o){return t===o?(e-n)/i+(e<n?6:0):e===o?(n-t)/i+2:(t-e)/i+4}(e,n,i,c,o),r=60*r+.5),[0|r,l||0,s]}function Lt(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(xt)}function Nt(t,e,n){return Lt(Et,t,e,n)}function Rt(t){return(t%360+360)%360}const jt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},$t={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Bt;const Ht=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Wt=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,Ft=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Ut(t,e,n){if(t){let i=Pt(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,0===e?360:1)),i=Nt(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function Vt(t,e){return t?Object.assign(e||{},t):t}function zt(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=xt(t[3]))):(e=Vt(t,{r:0,g:0,b:0,a:1})).a=xt(e.a),e}function qt(t){return"r"===t.charAt(0)?function(t){const e=Ht.exec(t);let n,i,o,a=255;if(e){if(e[7]!==n){const t=+e[7];a=e[8]?wt(t):yt(255*t,0,255)}return n=+e[1],i=+e[3],o=+e[5],n=255&(e[2]?wt(n):yt(n,0,255)),i=255&(e[4]?wt(i):yt(i,0,255)),o=255&(e[6]?wt(o):yt(o,0,255)),{r:n,g:i,b:o,a:a}}}(t):function(t){const e=Ot.exec(t);let n,i=255;if(!e)return;e[5]!==n&&(i=e[6]?wt(+e[5]):xt(+e[5]));const o=Rt(+e[2]),a=+e[3]/100,s=+e[4]/100;return n="hwb"===e[1]?function(t,e,n){return Lt(It,t,e,n)}(o,a,s):"hsv"===e[1]?function(t,e,n){return Lt(At,t,e,n)}(o,a,s):Nt(o,a,s),{r:n[0],g:n[1],b:n[2],a:i}}(t)}class Yt{constructor(t){if(t instanceof Yt)return t;const e=typeof t;let n;var i,o,a;"object"===e?n=zt(t):"string"===e&&(a=(i=t).length,"#"===i[0]&&(4===a||5===a?o={r:255&17*St[i[1]],g:255&17*St[i[2]],b:255&17*St[i[3]],a:5===a?17*St[i[4]]:255}:7!==a&&9!==a||(o={r:St[i[1]]<<4|St[i[2]],g:St[i[3]]<<4|St[i[4]],b:St[i[5]]<<4|St[i[6]],a:9===a?St[i[7]]<<4|St[i[8]]:255})),n=o||function(t){Bt||(Bt=function(){const t={},e=Object.keys($t),n=Object.keys(jt);let i,o,a,s,r;for(i=0;i<e.length;i++){for(s=r=e[i],o=0;o<n.length;o++)a=n[o],r=r.replace(a,jt[a]);a=parseInt($t[s],16),t[r]=[a>>16&255,a>>8&255,255&a]}return t}(),Bt.transparent=[0,0,0,0]);const e=Bt[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(t)||qt(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=Vt(this._rgb);return t&&(t.a=_t(t.a)),t}set rgb(t){this._rgb=zt(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${_t(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?function(t){var e=(t=>Dt(t.r)&&Dt(t.g)&&Dt(t.b)&&Dt(t.a))(t)?Ct:Mt;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=Pt(t),n=e[0],i=kt(e[1]),o=kt(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${o}%, ${_t(t.a)})`:`hsl(${n}, ${i}%, ${o}%)`}(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,i=t.rgb;let o;const a=e===o?.5:e,s=2*a-1,r=n.a-i.a,l=((s*r==-1?s:(s+r)/(1+s*r))+1)/2;o=1-l,n.r=255&l*n.r+o*i.r+.5,n.g=255&l*n.g+o*i.g+.5,n.b=255&l*n.b+o*i.b+.5,n.a=a*n.a+(1-a)*i.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,n){const i=Ft(_t(t.r)),o=Ft(_t(t.g)),a=Ft(_t(t.b));return{r:xt(Wt(i+n*(Ft(_t(e.r))-i))),g:xt(Wt(o+n*(Ft(_t(e.g))-o))),b:xt(Wt(a+n*(Ft(_t(e.b))-a))),a:t.a+n*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new Yt(this.rgb)}alpha(t){return this._rgb.a=xt(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=bt(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Ut(this._rgb,2,t),this}darken(t){return Ut(this._rgb,2,-t),this}saturate(t){return Ut(this._rgb,1,t),this}desaturate(t){return Ut(this._rgb,1,-t),this}rotate(t){return function(t,e){var n=Pt(t);n[0]=Rt(n[0]+e),n=Nt(n),t.r=n[0],t.g=n[1],t.b=n[2]}(this._rgb,t),this}}function Gt(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function Xt(t){return Gt(t)?t:new Yt(t)}function Jt(t){return Gt(t)?t:new Yt(t).saturate(.5).darken(.1).hexString()}const Qt=["x","y","borderWidth","radius","tension"],Kt=["color","borderColor","backgroundColor"],Zt=new Map;function te(t,e,n){return function(t,e){e=e||{};const n=t+JSON.stringify(e);let i=Zt.get(n);return i||(i=new Intl.NumberFormat(t,e),Zt.set(n,i)),i}(e,n).format(t)}const ee={values:t=>o(t)?t:""+t,numeric(t,e,n){if(0===t)return"0";const i=this.chart.options.locale;let o,a=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(o="scientific"),a=function(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}(t,n)}const s=R(Math.abs(a)),r=Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:o,minimumFractionDigits:r,maximumFractionDigits:r};return Object.assign(l,this.options.ticks.format),te(t,i,l)},logarithmic(t,e,n){if(0===t)return"0";const i=n[e].significand||t/Math.pow(10,Math.floor(R(t)));return[1,2,3,5,10,15].includes(i)||e>.8*n.length?ee.numeric.call(this,t,e,n):""}};var ne={formatters:ee};const ie=Object.create(null),oe=Object.create(null);function ae(t,e){if(!e)return t;const n=e.split(".");for(let e=0,i=n.length;e<i;++e){const i=n[e];t=t[i]||(t[i]=Object.create(null))}return t}function se(t,e,n){return"string"==typeof e?v(ae(t,e),n):v(ae(t,""),e)}var re=new class{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>Jt(e.backgroundColor),this.hoverBorderColor=(t,e)=>Jt(e.borderColor),this.hoverColor=(t,e)=>Jt(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return se(this,t,e)}get(t){return ae(this,t)}describe(t,e){return se(oe,t,e)}override(t,e){return se(ie,t,e)}route(t,e,n,i){const o=ae(this,t),s=ae(this,n),r="_"+e;Object.defineProperties(o,{[r]:{value:o[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[r],e=s[i];return a(t)?Object.assign({},e,t):l(t,e)},set(t){this[r]=t}}})}apply(t){t.forEach((t=>t(this)))}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:Kt},numbers:{type:"number",properties:Qt}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ne.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function le(){return"undefined"!=typeof window&&"undefined"!=typeof document}function ce(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function de(t,e,n){let i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[n])):i=t,i}const ue=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function he(t,e){return ue(t).getPropertyValue(e)}const pe=["top","right","bottom","left"];function fe(t,e,n){const i={};n=n?"-"+n:"";for(let o=0;o<4;o++){const a=pe[o];i[a]=parseFloat(t[e+"-"+a+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}function me(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,o=ue(n),a="border-box"===o.boxSizing,s=fe(o,"padding"),r=fe(o,"border","width"),{x:l,y:c,box:d}=function(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:o,offsetY:a}=i;let s,r,l=!1;if(((t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot))(o,a,t.target))s=o,r=a;else{const t=e.getBoundingClientRect();s=i.clientX-t.left,r=i.clientY-t.top,l=!0}return{x:s,y:r,box:l}}(t,n),u=s.left+(d&&r.left),h=s.top+(d&&r.top);let{width:p,height:f}=e;return a&&(p-=s.width+r.width,f-=s.height+r.height),{x:Math.round((l-u)/p*n.width/i),y:Math.round((c-h)/f*n.height/i)}}const ge=t=>Math.round(10*t)/10;function ve(t,e,n,i){const o=ue(t),a=fe(o,"margin"),s=de(o.maxWidth,t,"clientWidth")||A,r=de(o.maxHeight,t,"clientHeight")||A,l=function(t,e,n){let i,o;if(void 0===e||void 0===n){const a=ce(t);if(a){const t=a.getBoundingClientRect(),s=ue(a),r=fe(s,"border","width"),l=fe(s,"padding");e=t.width-l.width-r.width,n=t.height-l.height-r.height,i=de(s.maxWidth,a,"clientWidth"),o=de(s.maxHeight,a,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:i||A,maxHeight:o||A}}(t,e,n);let{width:c,height:d}=l;if("content-box"===o.boxSizing){const t=fe(o,"border","width"),e=fe(o,"padding");c-=e.width+t.width,d-=e.height+t.height}return c=Math.max(0,c-a.width),d=Math.max(0,i?c/i:d-a.height),c=ge(Math.min(c,s,l.maxWidth)),d=ge(Math.min(d,r,l.maxHeight)),c&&!d&&(d=ge(c/2)),(void 0!==e||void 0!==n)&&i&&l.height&&d>l.height&&(d=l.height,c=ge(Math.floor(d*i))),{width:c,height:d}}function be(t,e,n){const i=e||1,o=Math.floor(t.height*i),a=Math.floor(t.width*i);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const s=t.canvas;return s.style&&(n||!s.style.height&&!s.style.width)&&(s.style.height=`${t.height}px`,s.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==i||s.height!==o||s.width!==a)&&(t.currentDevicePixelRatio=i,s.height=o,s.width=a,t.ctx.setTransform(i,0,0,i,0,0),!0)}const ye=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function we(t,e){const n=he(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function xe(t){return!t||i(t.size)||i(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function _e(t,e,n,i,o){let a=e[o];return a||(a=e[o]=t.measureText(o).width,n.push(o)),a>i&&(i=a),i}function ke(t,e,n,i){let a=(i=i||{}).data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(a=i.data={},s=i.garbageCollect=[],i.font=e),t.save(),t.font=e;let r=0;const l=n.length;let c,d,u,h,p;for(c=0;c<l;c++)if(h=n[c],null!=h&&!0!==o(h))r=_e(t,a,s,r,h);else if(o(h))for(d=0,u=h.length;d<u;d++)p=h[d],null==p||o(p)||(r=_e(t,a,s,r,p));t.restore();const f=s.length/2;if(f>n.length){for(c=0;c<f;c++)delete a[s[c]];s.splice(0,f)}return r}function Se(t,e,n){const i=t.currentDevicePixelRatio,o=0!==n?Math.max(n/2,.5):0;return Math.round((e-o)*i)/i+o}function Te(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function Ce(t,e,n,i){Me(t,e,n,i,null)}function Me(t,e,n,i,o){let a,s,r,l,c,d,u,h;const p=e.pointStyle,f=e.rotation,m=e.radius;let g=(f||0)*I;if(p&&"object"==typeof p&&(a=p.toString(),"[object HTMLImageElement]"===a||"[object HTMLCanvasElement]"===a))return t.save(),t.translate(n,i),t.rotate(g),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void t.restore();if(!(isNaN(m)||m<=0)){switch(t.beginPath(),p){default:o?t.ellipse(n,i,o/2,m,0,0,O):t.arc(n,i,m,0,O),t.closePath();break;case"triangle":d=o?o/2:m,t.moveTo(n+Math.sin(g)*d,i-Math.cos(g)*m),g+=N,t.lineTo(n+Math.sin(g)*d,i-Math.cos(g)*m),g+=N,t.lineTo(n+Math.sin(g)*d,i-Math.cos(g)*m),t.closePath();break;case"rectRounded":c=.516*m,l=m-c,s=Math.cos(g+L)*l,u=Math.cos(g+L)*(o?o/2-c:l),r=Math.sin(g+L)*l,h=Math.sin(g+L)*(o?o/2-c:l),t.arc(n-u,i-r,c,g-D,g-P),t.arc(n+h,i-s,c,g-P,g),t.arc(n+u,i+r,c,g,g+P),t.arc(n-h,i+s,c,g+P,g+D),t.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*m,d=o?o/2:l,t.rect(n-d,i-l,2*d,2*l);break}g+=L;case"rectRot":u=Math.cos(g)*(o?o/2:m),s=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(n-u,i-r),t.lineTo(n+h,i-s),t.lineTo(n+u,i+r),t.lineTo(n-h,i+s),t.closePath();break;case"crossRot":g+=L;case"cross":u=Math.cos(g)*(o?o/2:m),s=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(n-u,i-r),t.lineTo(n+u,i+r),t.moveTo(n+h,i-s),t.lineTo(n-h,i+s);break;case"star":u=Math.cos(g)*(o?o/2:m),s=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(n-u,i-r),t.lineTo(n+u,i+r),t.moveTo(n+h,i-s),t.lineTo(n-h,i+s),g+=L,u=Math.cos(g)*(o?o/2:m),s=Math.cos(g)*m,r=Math.sin(g)*m,h=Math.sin(g)*(o?o/2:m),t.moveTo(n-u,i-r),t.lineTo(n+u,i+r),t.moveTo(n+h,i-s),t.lineTo(n-h,i+s);break;case"line":s=o?o/2:Math.cos(g)*m,r=Math.sin(g)*m,t.moveTo(n-s,i-r),t.lineTo(n+s,i+r);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(g)*(o?o/2:m),i+Math.sin(g)*m);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}function De(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Oe(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Ee(t){t.restore()}function Ae(t,e,n,i,o){if(!e)return t.lineTo(n.x,n.y);if("middle"===o){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else"after"===o!=!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function Ie(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function Pe(t,e,n,a,s,r={}){const l=o(e)?e:[e],c=r.strokeWidth>0&&""!==r.strokeColor;let d,u;for(t.save(),t.font=s.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),i(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,r),d=0;d<l.length;++d)u=l[d],r.backdrop&&Ne(t,r.backdrop),c&&(r.strokeColor&&(t.strokeStyle=r.strokeColor),i(r.strokeWidth)||(t.lineWidth=r.strokeWidth),t.strokeText(u,n,a,r.maxWidth)),t.fillText(u,n,a,r.maxWidth),Le(t,n,a,u,r),a+=s.lineHeight;t.restore()}function Le(t,e,n,i,o){if(o.strikethrough||o.underline){const a=t.measureText(i),s=e-a.actualBoundingBoxLeft,r=e+a.actualBoundingBoxRight,l=n-a.actualBoundingBoxAscent,c=n+a.actualBoundingBoxDescent,d=o.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=o.decorationWidth||2,t.moveTo(s,d),t.lineTo(r,d),t.stroke()}}function Ne(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Re(t,e){const{x:n,y:i,w:o,h:a,radius:s}=e;t.arc(n+s.topLeft,i+s.topLeft,s.topLeft,-P,D,!0),t.lineTo(n,i+a-s.bottomLeft),t.arc(n+s.bottomLeft,i+a-s.bottomLeft,s.bottomLeft,D,P,!0),t.lineTo(n+o-s.bottomRight,i+a),t.arc(n+o-s.bottomRight,i+a-s.bottomRight,s.bottomRight,P,0,!0),t.lineTo(n+o,i+s.topRight),t.arc(n+o-s.topRight,i+s.topRight,s.topRight,0,-P,!0),t.lineTo(n+s.topLeft,i)}function je(t,e=[""],n=t,i,o=(()=>t[0])){S(i)||(i=Ge("_fallback",t));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:n,_fallback:i,_getTarget:o,override:o=>je([o,...t],e,n,i)};return new Proxy(a,{deleteProperty:(e,n)=>(delete e[n],delete e._keys,delete t[0][n],!0),get:(n,i)=>Fe(n,i,(()=>function(t,e,n,i){let o;for(const a of e)if(o=Ge(He(a,t),n),S(o))return We(t,o)?qe(n,i,t,o):o}(i,e,t,n))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>Xe(t).includes(e),ownKeys:t=>Xe(t),set(t,e,n){const i=t._storage||(t._storage=o());return t[e]=i[e]=n,delete t._keys,!0}})}function $e(t,e,n,i){const s={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Be(t,i),setContext:e=>$e(t,e,n,i),override:o=>$e(t.override(o),e,n,i)};return new Proxy(s,{deleteProperty:(e,n)=>(delete e[n],delete t[n],!0),get:(t,e,n)=>Fe(t,e,(()=>function(t,e,n){const{_proxy:i,_context:s,_subProxy:r,_descriptors:l}=t;let c=i[e];return T(c)&&l.isScriptable(e)&&(c=function(t,e,n,i){const{_proxy:o,_context:a,_subProxy:s,_stack:r}=n;if(r.has(t))throw new Error("Recursion detected: "+Array.from(r).join("->")+"->"+t);return r.add(t),e=e(a,s||i),r.delete(t),We(t,e)&&(e=qe(o._scopes,o,t,e)),e}(e,c,t,n)),o(c)&&c.length&&(c=function(t,e,n,i){const{_proxy:o,_context:s,_subProxy:r,_descriptors:l}=n;if(S(s.index)&&i(t))e=e[s.index%e.length];else if(a(e[0])){const n=e,i=o._scopes.filter((t=>t!==n));e=[];for(const a of n){const n=qe(i,o,t,a);e.push($e(n,s,r&&r[t],l))}}return e}(e,c,t,l.isIndexable)),We(e,c)&&(c=$e(c,s,r&&r[e],l)),c}(t,e,n))),getOwnPropertyDescriptor:(e,n)=>e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,n)=>Reflect.has(t,n),ownKeys:()=>Reflect.ownKeys(t),set:(e,n,i)=>(t[n]=i,delete e[n],!0)})}function Be(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:o=e.allKeys}=t;return{allKeys:o,scriptable:n,indexable:i,isScriptable:T(n)?n:()=>n,isIndexable:T(i)?i:()=>i}}const He=(t,e)=>t?t+k(e):e,We=(t,e)=>a(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function Fe(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const i=n();return t[e]=i,i}function Ue(t,e,n){return T(t)?t(e,n):t}const Ve=(t,e)=>!0===t?e:"string"==typeof t?_(e,t):void 0;function ze(t,e,n,i,o){for(const a of e){const e=Ve(n,a);if(e){t.add(e);const a=Ue(e._fallback,n,o);if(S(a)&&a!==n&&a!==i)return a}else if(!1===e&&S(i)&&n!==i)return null}return!1}function qe(t,e,n,i){const s=e._rootScopes,r=Ue(e._fallback,n,i),l=[...t,...s],c=new Set;c.add(i);let d=Ye(c,l,n,r||n,i);return null!==d&&(!S(r)||r===n||(d=Ye(c,l,r,d,i),null!==d))&&je(Array.from(c),[""],s,r,(()=>function(t,e,n){const i=t._getTarget();e in i||(i[e]={});const s=i[e];return o(s)&&a(n)?n:s||{}}(e,n,i)))}function Ye(t,e,n,i,o){for(;n;)n=ze(t,e,n,i,o);return n}function Ge(t,e){for(const n of e){if(!n)continue;const e=n[t];if(S(e))return e}}function Xe(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function Je(t,e,n,i){const{iScale:o}=t,{key:a="r"}=this._parsing,s=new Array(i);let r,l,c,d;for(r=0,l=i;r<l;++r)c=r+n,d=e[c],s[r]={r:o.parse(_(d,a),c)};return s}const Qe=Number.EPSILON||1e-14,Ke=(t,e)=>e<t.length&&!t[e].skip&&t[e],Ze=t=>"x"===t?"y":"x";function tn(t,e,n,i){const o=t.skip?e:t,a=e,s=n.skip?e:n,r=G(a,o),l=G(s,a);let c=r/(r+l),d=l/(r+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const u=i*c,h=i*d;return{previous:{x:a.x-u*(s.x-o.x),y:a.y-u*(s.y-o.y)},next:{x:a.x+h*(s.x-o.x),y:a.y+h*(s.y-o.y)}}}function en(t,e="x"){const n=Ze(e),i=t.length,o=Array(i).fill(0),a=Array(i);let s,r,l,c=Ke(t,0);for(s=0;s<i;++s)if(r=l,l=c,c=Ke(t,s+1),l){if(c){const t=c[e]-l[e];o[s]=0!==t?(c[n]-l[n])/t:0}a[s]=r?c?j(o[s-1])!==j(o[s])?0:(o[s-1]+o[s])/2:o[s-1]:o[s]}!function(t,e,n){const i=t.length;let o,a,s,r,l,c=Ke(t,0);for(let d=0;d<i-1;++d)l=c,c=Ke(t,d+1),l&&c&&($(e[d],0,Qe)?n[d]=n[d+1]=0:(o=n[d]/e[d],a=n[d+1]/e[d],r=Math.pow(o,2)+Math.pow(a,2),r<=9||(s=3/Math.sqrt(r),n[d]=o*s*e[d],n[d+1]=a*s*e[d])))}(t,o,a),function(t,e,n="x"){const i=Ze(n),o=t.length;let a,s,r,l=Ke(t,0);for(let c=0;c<o;++c){if(s=r,r=l,l=Ke(t,c+1),!r)continue;const o=r[n],d=r[i];s&&(a=(o-s[n])/3,r[`cp1${n}`]=o-a,r[`cp1${i}`]=d-a*e[c]),l&&(a=(l[n]-o)/3,r[`cp2${n}`]=o+a,r[`cp2${i}`]=d+a*e[c])}}(t,a,e)}function nn(t,e,n){return Math.max(Math.min(t,n),e)}function on(t,e,n,i,o){let a,s,r,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)en(t,o);else{let n=i?t[t.length-1]:t[0];for(a=0,s=t.length;a<s;++a)r=t[a],l=tn(n,r,t[Math.min(a+1,s-(i?0:1))%s],e.tension),r.cp1x=l.previous.x,r.cp1y=l.previous.y,r.cp2x=l.next.x,r.cp2y=l.next.y,n=r}e.capBezierPoints&&function(t,e){let n,i,o,a,s,r=De(t[0],e);for(n=0,i=t.length;n<i;++n)s=a,a=r,r=n<i-1&&De(t[n+1],e),a&&(o=t[n],s&&(o.cp1x=nn(o.cp1x,e.left,e.right),o.cp1y=nn(o.cp1y,e.top,e.bottom)),r&&(o.cp2x=nn(o.cp2x,e.left,e.right),o.cp2y=nn(o.cp2y,e.top,e.bottom)))}(t,n)}const an=t=>0===t||1===t,sn=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*O/n),rn=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*O/n)+1,ln={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*P),easeOutSine:t=>Math.sin(t*P),easeInOutSine:t=>-.5*(Math.cos(D*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>an(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>an(t)?t:sn(t,.075,.3),easeOutElastic:t=>an(t)?t:rn(t,.075,.3),easeInOutElastic(t){const e=.1125;return an(t)?t:t<.5?.5*sn(2*t,e,.45):.5+.5*rn(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-ln.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*ln.easeInBounce(2*t):.5*ln.easeOutBounce(2*t-1)+.5};function cn(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function dn(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:"middle"===i?n<.5?t.y:e.y:"after"===i?n<1?t.y:e.y:n>0?e.y:t.y}}function un(t,e,n,i){const o={x:t.cp2x,y:t.cp2y},a={x:e.cp1x,y:e.cp1y},s=cn(t,o,n),r=cn(o,a,n),l=cn(a,e,n),c=cn(s,r,n),d=cn(r,l,n);return cn(c,d,n)}const hn=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,pn=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function fn(t,e){const n=(""+t).match(hn);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t}function mn(t,e){const n={},i=a(e),o=i?Object.keys(e):e,s=a(t)?i?n=>l(t[n],t[e[n]]):e=>t[e]:()=>t;for(const t of o)n[t]=+s(t)||0;return n}function gn(t){return mn(t,{top:"y",right:"x",bottom:"y",left:"x"})}function vn(t){return mn(t,["topLeft","topRight","bottomLeft","bottomRight"])}function bn(t){const e=gn(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function yn(t,e){t=t||{},e=e||re.font;let n=l(t.size,e.size);"string"==typeof n&&(n=parseInt(n,10));let i=l(t.style,e.style);i&&!(""+i).match(pn)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const o={family:l(t.family,e.family),lineHeight:fn(l(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:l(t.weight,e.weight),string:""};return o.string=xe(o),o}function wn(t,e,n,i){let a,s,r,l=!0;for(a=0,s=t.length;a<s;++a)if(r=t[a],void 0!==r&&(void 0!==e&&"function"==typeof r&&(r=r(e),l=!1),void 0!==n&&o(r)&&(r=r[n%r.length],l=!1),void 0!==r))return i&&!l&&(i.cacheable=!1),r}function xn(t,e,n){const{min:i,max:o}=t,a=d(e,(o-i)/2),s=(t,e)=>n&&0===t?0:t+e;return{min:s(i,-Math.abs(a)),max:s(o,a)}}function _n(t,e){return Object.assign(Object.create(t),e)}function kn(t,e,n){return t?function(t,e){return{x:n=>t+t+e-n,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,n):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function Sn(t,e){let n,i;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function Tn(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Cn(t){return"angle"===t?{between:Q,compare:X,normalize:J}:{between:tt,compare:(t,e)=>t-e,normalize:t=>t}}function Mn({start:t,end:e,count:n,loop:i,style:o}){return{start:t%n,end:e%n,loop:i&&(e-t+1)%n==0,style:o}}function Dn(t,e,n){if(!n)return[t];const{property:i,start:o,end:a}=n,s=e.length,{compare:r,between:l,normalize:c}=Cn(i),{start:d,end:u,loop:h,style:p}=function(t,e,n){const{property:i,start:o,end:a}=n,{between:s,normalize:r}=Cn(i),l=e.length;let c,d,{start:u,end:h,loop:p}=t;if(p){for(u+=l,h+=l,c=0,d=l;c<d&&s(r(e[u%l][i]),o,a);++c)u--,h--;u%=l,h%=l}return h<u&&(h+=l),{start:u,end:h,loop:p,style:t.style}}(t,e,n),f=[];let m,g,v,b=!1,y=null;for(let t=d,n=d;t<=u;++t)g=e[t%s],g.skip||(m=c(g[i]),m!==v&&(b=l(m,o,a),null===y&&(b||l(o,v,m)&&0!==r(o,v))&&(y=0===r(m,o)?t:n),null!==y&&(!b||0===r(a,m)||l(a,v,m))&&(f.push(Mn({start:y,end:t,loop:h,count:s,style:p})),y=null),n=t,v=m));return null!==y&&f.push(Mn({start:y,end:u,loop:h,count:s,style:p})),f}function On(t,e){const n=[],i=t.segments;for(let o=0;o<i.length;o++){const a=Dn(i[o],t.points,e);a.length&&n.push(...a)}return n}function En(t,e){const n=t.points,i=t.options.spanGaps,o=n.length;if(!o)return[];const a=!!t._loop,{start:s,end:r}=function(t,e,n,i){let o=0,a=e-1;if(n&&!i)for(;o<e&&!t[o].skip;)o++;for(;o<e&&t[o].skip;)o++;for(o%=e,n&&(a+=o);a>o&&t[a%e].skip;)a--;return a%=e,{start:o,end:a}}(n,o,a,i);return An(t,!0===i?[{start:s,end:r,loop:a}]:function(t,e,n,i){const o=t.length,a=[];let s,r=e,l=t[e];for(s=e+1;s<=n;++s){const n=t[s%o];n.skip||n.stop?l.skip||(i=!1,a.push({start:e%o,end:(s-1)%o,loop:i}),e=r=n.stop?s:null):(r=s,l.skip&&(e=s)),l=n}return null!==r&&a.push({start:e%o,end:r%o,loop:i}),a}(n,s,r<s?r+o:r,!!t._fullLoop&&0===s&&r===o-1),n,e)}function An(t,e,n,i){return i&&i.setContext&&n?function(t,e,n,i){const o=t._chart.getContext(),a=In(t.options),{_datasetIndex:s,options:{spanGaps:r}}=t,l=n.length,c=[];let d=a,u=e[0].start,h=u;function p(t,e,i,o){const a=r?-1:1;if(t!==e){for(t+=l;n[t%l].skip;)t-=a;for(;n[e%l].skip;)e+=a;t%l!=e%l&&(c.push({start:t%l,end:e%l,loop:i,style:o}),d=o,u=e%l)}}for(const t of e){u=r?u:t.start;let e,a=n[u%l];for(h=u+1;h<=t.end;h++){const r=n[h%l];e=In(i.setContext(_n(o,{type:"segment",p0:a,p1:r,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:s}))),Pn(e,d)&&p(u,h-1,t.loop,d),a=r,d=e}u<h-1&&p(u,h-1,t.loop,d)}return c}(t,e,n,i):e}function In(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Pn(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}var Ln=Object.freeze({__proto__:null,easingEffects:ln,isPatternOrGradient:Gt,color:Xt,getHoverColor:Jt,noop:e,uid:n,isNullOrUndef:i,isArray:o,isObject:a,isFinite:s,finiteOrDefault:r,valueOrDefault:l,toPercentage:c,toDimension:d,callback:u,each:h,_elementsEqual:p,clone:f,_merger:g,merge:v,mergeIf:b,_mergerIf:y,_deprecated:function(t,e,n,i){void 0!==e&&console.warn(t+': "'+n+'" is deprecated. Please use "'+i+'" instead')},_splitKey:x,resolveObjectKey:_,_capitalize:k,defined:S,isFunction:T,setsEqual:C,_isClickEvent:M,toFontString:xe,_measureText:_e,_longestText:ke,_alignPixel:Se,clearCanvas:Te,drawPoint:Ce,drawPointLegend:Me,_isPointInArea:De,clipArea:Oe,unclipArea:Ee,_steppedLineTo:Ae,_bezierCurveTo:Ie,renderText:Pe,addRoundedRectPath:Re,_lookup:et,_lookupByKey:nt,_rlookupByKey:it,_filterBetween:ot,listenArrayEvents:st,unlistenArrayEvents:rt,_arrayUnique:lt,_createResolver:je,_attachContext:$e,_descriptors:Be,_parseObjectDataRadialScale:Je,splineCurve:tn,splineCurveMonotone:en,_updateBezierControlPoints:on,_isDomSupported:le,_getParentNode:ce,getStyle:he,getRelativePosition:me,getMaximumSize:ve,retinaScale:be,supportsEventListenerOptions:ye,readUsedSize:we,fontString:function(t,e,n){return e+" "+t+"px "+n},requestAnimFrame:ct,throttled:dt,debounce:ut,_toLeftRightCenter:ht,_alignStartEnd:pt,_textX:ft,_getStartAndCountOfVisiblePoints:mt,_scaleRangesChanged:gt,_pointInLine:cn,_steppedInterpolation:dn,_bezierInterpolation:un,formatNumber:te,toLineHeight:fn,_readValueToProps:mn,toTRBL:gn,toTRBLCorners:vn,toPadding:bn,toFont:yn,resolve:wn,_addGrace:xn,createContext:_n,PI:D,TAU:O,PITAU:E,INFINITY:A,RAD_PER_DEG:I,HALF_PI:P,QUARTER_PI:L,TWO_THIRDS_PI:N,log10:R,sign:j,almostEquals:$,niceNum:B,_factorize:H,isNumber:W,almostWhole:F,_setMinAndMaxByKey:U,toRadians:V,toDegrees:z,_decimalPlaces:q,getAngleFromPoint:Y,distanceBetweenPoints:G,_angleDiff:X,_normalizeAngle:J,_angleBetween:Q,_limitValue:K,_int16Range:Z,_isBetween:tt,getRtlAdapter:kn,overrideTextDirection:Sn,restoreTextDirection:Tn,_boundSegment:Dn,_boundSegments:On,_computeSegments:En});function Nn(t,e,n,i){const{controller:o,data:a,_sorted:s}=t,r=o._cachedMeta.iScale;if(r&&e===r.axis&&"r"!==e&&s&&a.length){const t=r._reversePixels?it:nt;if(!i)return t(a,e,n);if(o._sharedOptions){const i=a[0],o="function"==typeof i.getRange&&i.getRange(e);if(o){const i=t(a,e,n-o),s=t(a,e,n+o);return{lo:i.lo,hi:s.hi}}}}return{lo:0,hi:a.length-1}}function Rn(t,e,n,i,o){const a=t.getSortedVisibleDatasetMetas(),s=n[e];for(let t=0,n=a.length;t<n;++t){const{index:n,data:r}=a[t],{lo:l,hi:c}=Nn(a[t],e,s,o);for(let t=l;t<=c;++t){const e=r[t];e.skip||i(e,n,t)}}}function jn(t,e,n,i,o){const a=[];return o||t.isPointInArea(e)?(Rn(t,n,e,(function(n,s,r){(o||De(n,t.chartArea,0))&&n.inRange(e.x,e.y,i)&&a.push({element:n,datasetIndex:s,index:r})}),!0),a):a}function $n(t,e,n,i,o,a){return a||t.isPointInArea(e)?"r"!==n||i?function(t,e,n,i,o,a){let s=[];const r=function(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,i){const o=e?Math.abs(t.x-i.x):0,a=n?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(a,2))}}(n);let l=Number.POSITIVE_INFINITY;return Rn(t,n,e,(function(n,c,d){const u=n.inRange(e.x,e.y,o);if(i&&!u)return;const h=n.getCenterPoint(o);if(!a&&!t.isPointInArea(h)&&!u)return;const p=r(e,h);p<l?(s=[{element:n,datasetIndex:c,index:d}],l=p):p===l&&s.push({element:n,datasetIndex:c,index:d})})),s}(t,e,n,i,o,a):function(t,e,n,i){let o=[];return Rn(t,n,e,(function(t,n,a){const{startAngle:s,endAngle:r}=t.getProps(["startAngle","endAngle"],i),{angle:l}=Y(t,{x:e.x,y:e.y});Q(l,s,r)&&o.push({element:t,datasetIndex:n,index:a})})),o}(t,e,n,o):[]}function Bn(t,e,n,i,o){const a=[],s="x"===n?"inXRange":"inYRange";let r=!1;return Rn(t,n,e,((t,i,l)=>{t[s](e[n],o)&&(a.push({element:t,datasetIndex:i,index:l}),r=r||t.inRange(e.x,e.y,o))})),i&&!r?[]:a}var Hn={evaluateInteractionItems:Rn,modes:{index(t,e,n,i){const o=me(e,t),a=n.axis||"x",s=n.includeInvisible||!1,r=n.intersect?jn(t,o,a,i,s):$n(t,o,a,!1,i,s),l=[];return r.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=r[0].index,n=t.data[e];n&&!n.skip&&l.push({element:n,datasetIndex:t.index,index:e})})),l):[]},dataset(t,e,n,i){const o=me(e,t),a=n.axis||"xy",s=n.includeInvisible||!1;let r=n.intersect?jn(t,o,a,i,s):$n(t,o,a,!1,i,s);if(r.length>0){const e=r[0].datasetIndex,n=t.getDatasetMeta(e).data;r=[];for(let t=0;t<n.length;++t)r.push({element:n[t],datasetIndex:e,index:t})}return r},point:(t,e,n,i)=>jn(t,me(e,t),n.axis||"xy",i,n.includeInvisible||!1),nearest(t,e,n,i){const o=me(e,t),a=n.axis||"xy",s=n.includeInvisible||!1;return $n(t,o,a,n.intersect,i,s)},x:(t,e,n,i)=>Bn(t,me(e,t),"x",n.intersect,i),y:(t,e,n,i)=>Bn(t,me(e,t),"y",n.intersect,i)}};const Wn=["left","top","right","bottom"];function Fn(t,e){return t.filter((t=>t.pos===e))}function Un(t,e){return t.filter((t=>-1===Wn.indexOf(t.pos)&&t.box.axis===e))}function Vn(t,e){return t.sort(((t,n)=>{const i=e?n:t,o=e?t:n;return i.weight===o.weight?i.index-o.index:i.weight-o.weight}))}function zn(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function qn(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Yn(t,e,n,i){const{pos:o,box:s}=n,r=t.maxPadding;if(!a(o)){n.size&&(t[o]-=n.size);const e=i[n.stack]||{size:0,count:1};e.size=Math.max(e.size,n.horizontal?s.height:s.width),n.size=e.size/e.count,t[o]+=n.size}s.getPadding&&qn(r,s.getPadding());const l=Math.max(0,e.outerWidth-zn(r,t,"left","right")),c=Math.max(0,e.outerHeight-zn(r,t,"top","bottom")),d=l!==t.w,u=c!==t.h;return t.w=l,t.h=c,n.horizontal?{same:d,other:u}:{same:u,other:d}}function Gn(t,e){const n=e.maxPadding;return function(t){const i={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{i[t]=Math.max(e[t],n[t])})),i}(t?["left","right"]:["top","bottom"])}function Xn(t,e,n,i){const o=[];let a,s,r,l,c,d;for(a=0,s=t.length,c=0;a<s;++a){r=t[a],l=r.box,l.update(r.width||e.w,r.height||e.h,Gn(r.horizontal,e));const{same:s,other:u}=Yn(e,n,r,i);c|=s&&o.length,d=d||u,l.fullSize||o.push(r)}return c&&Xn(o,e,n,i)||d}function Jn(t,e,n,i,o){t.top=n,t.left=e,t.right=e+i,t.bottom=n+o,t.width=i,t.height=o}function Qn(t,e,n,i){const o=n.padding;let{x:a,y:s}=e;for(const r of t){const t=r.box,l=i[r.stack]||{count:1,placed:0,weight:1},c=r.stackWeight/l.weight||1;if(r.horizontal){const i=e.w*c,a=l.size||t.height;S(l.start)&&(s=l.start),t.fullSize?Jn(t,o.left,s,n.outerWidth-o.right-o.left,a):Jn(t,e.left+l.placed,s,i,a),l.start=s,l.placed+=i,s=t.bottom}else{const i=e.h*c,s=l.size||t.width;S(l.start)&&(a=l.start),t.fullSize?Jn(t,a,o.top,s,n.outerHeight-o.bottom-o.top):Jn(t,a,e.top+l.placed,s,i),l.start=a,l.placed+=i,a=t.right}}e.x=a,e.y=s}var Kn={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const o=bn(t.options.layout.padding),a=Math.max(e-o.width,0),s=Math.max(n-o.height,0),r=function(t){const e=function(t){const e=[];let n,i,o,a,s,r;for(n=0,i=(t||[]).length;n<i;++n)o=t[n],({position:a,options:{stack:s,stackWeight:r=1}}=o),e.push({index:n,box:o,pos:a,horizontal:o.isHorizontal(),weight:o.weight,stack:s&&a+s,stackWeight:r});return e}(t),n=Vn(e.filter((t=>t.box.fullSize)),!0),i=Vn(Fn(e,"left"),!0),o=Vn(Fn(e,"right")),a=Vn(Fn(e,"top"),!0),s=Vn(Fn(e,"bottom")),r=Un(e,"x"),l=Un(e,"y");return{fullSize:n,leftAndTop:i.concat(a),rightAndBottom:o.concat(l).concat(s).concat(r),chartArea:Fn(e,"chartArea"),vertical:i.concat(o).concat(l),horizontal:a.concat(s).concat(r)}}(t.boxes),l=r.vertical,c=r.horizontal;h(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const d=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,u=Object.freeze({outerWidth:e,outerHeight:n,padding:o,availableWidth:a,availableHeight:s,vBoxMaxWidth:a/2/d,hBoxMaxHeight:s/2}),p=Object.assign({},o);qn(p,bn(i));const f=Object.assign({maxPadding:p,w:a,h:s,x:o.left,y:o.top},o),m=function(t,e){const n=function(t){const e={};for(const n of t){const{stack:t,pos:i,stackWeight:o}=n;if(!t||!Wn.includes(i))continue;const a=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=o}return e}(t),{vBoxMaxWidth:i,hBoxMaxHeight:o}=e;let a,s,r;for(a=0,s=t.length;a<s;++a){r=t[a];const{fullSize:s}=r.box,l=n[r.stack],c=l&&r.stackWeight/l.weight;r.horizontal?(r.width=c?c*i:s&&e.availableWidth,r.height=o):(r.width=i,r.height=c?c*o:s&&e.availableHeight)}return n}(l.concat(c),u);Xn(r.fullSize,f,u,m),Xn(l,f,u,m),Xn(c,f,u,m)&&Xn(l,f,u,m),function(t){const e=t.maxPadding;function n(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(f),Qn(r.leftAndTop,f,u,m),f.x+=f.w,f.y+=f.h,Qn(r.rightAndBottom,f,u,m),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},h(r.chartArea,(e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}};class Zn{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,i){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):n)}}isAttached(t){return!0}updateConfig(t){}}class ti extends Zn{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const ei={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ni=t=>null===t||""===t,ii=!!ye&&{passive:!0};function oi(t,e,n){t.canvas.removeEventListener(e,n,ii)}function ai(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function si(t,e,n){const i=t.canvas,o=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||ai(n.addedNodes,i),e=e&&!ai(n.removedNodes,i);e&&n()}));return o.observe(document,{childList:!0,subtree:!0}),o}function ri(t,e,n){const i=t.canvas,o=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||ai(n.removedNodes,i),e=e&&!ai(n.addedNodes,i);e&&n()}));return o.observe(document,{childList:!0,subtree:!0}),o}const li=new Map;let ci=0;function di(){const t=window.devicePixelRatio;t!==ci&&(ci=t,li.forEach(((e,n)=>{n.currentDevicePixelRatio!==t&&e()})))}function ui(t,e,n){const i=t.canvas,o=i&&ce(i);if(!o)return;const a=dt(((t,e)=>{const i=o.clientWidth;n(t,e),i<o.clientWidth&&n()}),window),s=new ResizeObserver((t=>{const e=t[0],n=e.contentRect.width,i=e.contentRect.height;0===n&&0===i||a(n,i)}));return s.observe(o),function(t,e){li.size||window.addEventListener("resize",di),li.set(t,e)}(t,a),s}function hi(t,e,n){n&&n.disconnect(),"resize"===e&&function(t){li.delete(t),li.size||window.removeEventListener("resize",di)}(t)}function pi(t,e,n){const i=t.canvas,o=dt((e=>{null!==t.ctx&&n(function(t,e){const n=ei[t.type]||t.type,{x:i,y:o}=me(t,e);return{type:n,chart:e,native:t,x:void 0!==i?i:null,y:void 0!==o?o:null}}(e,t))}),t);return function(t,e,n){t.addEventListener(e,n,ii)}(i,e,o),o}class fi extends Zn{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(function(t,e){const n=t.style,i=t.getAttribute("height"),o=t.getAttribute("width");if(t.$chartjs={initial:{height:i,width:o,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",ni(o)){const e=we(t,"width");void 0!==e&&(t.width=e)}if(ni(i))if(""===t.style.height)t.height=t.width/(e||2);else{const e=we(t,"height");void 0!==e&&(t.height=e)}}(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e.$chartjs)return!1;const n=e.$chartjs.initial;["height","width"].forEach((t=>{const o=n[t];i(o)?e.removeAttribute(t):e.setAttribute(t,o)}));const o=n.style||{};return Object.keys(o).forEach((t=>{e.style[t]=o[t]})),e.width=e.width,delete e.$chartjs,!0}addEventListener(t,e,n){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),o={attach:si,detach:ri,resize:ui}[e]||pi;i[e]=o(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),i=n[e];i&&(({attach:hi,detach:hi,resize:hi}[e]||oi)(t,e,i),n[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,i){return ve(t,e,n,i)}isAttached(t){const e=ce(t);return!(!e||!e.isConnected)}}function mi(t){return!le()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?ti:fi}var gi=Object.freeze({__proto__:null,_detectPlatform:mi,BasePlatform:Zn,BasicPlatform:ti,DomPlatform:fi});const vi="transparent",bi={boolean:(t,e,n)=>n>.5?e:t,color(t,e,n){const i=Xt(t||vi),o=i.valid&&Xt(e||vi);return o&&o.valid?o.mix(i,n).hexString():e},number:(t,e,n)=>t+(e-t)*n};class yi{constructor(t,e,n,i){const o=e[n];i=wn([t.to,i,o,t.from]);const a=wn([t.from,o,i]);this._active=!0,this._fn=t.fn||bi[t.type||typeof a],this._easing=ln[t.easing]||ln.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=a,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const i=this._target[this._prop],o=n-this._start,a=this._duration-o;this._start=n,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=o,this._loop=!!t.loop,this._to=wn([t.to,e,i,t.from]),this._from=wn([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,i=this._prop,o=this._from,a=this._loop,s=this._to;let r;if(this._active=o!==s&&(a||e<n),!this._active)return this._target[i]=s,void this._notify(!0);e<0?this._target[i]=o:(r=e/n%2,r=a&&r>1?2-r:r,r=this._easing(Math.min(1,Math.max(0,r))),this._target[i]=this._fn(o,s,r))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,n)=>{t.push({res:e,rej:n})}))}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let t=0;t<n.length;t++)n[t][e]()}}class wi{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!a(t))return;const e=Object.keys(re.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach((i=>{const s=t[i];if(!a(s))return;const r={};for(const t of e)r[t]=s[t];(o(s.properties)&&s.properties||[i]).forEach((t=>{t!==i&&n.has(t)||n.set(t,r)}))}))}_animateOptions(t,e){const n=e.options,i=function(t,e){if(!e)return;let n=t.options;if(n)return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n;t.options=e}(t,n);if(!i)return[];const o=this._createAnimations(i,n);return n.$shared&&function(t,e){const n=[],i=Object.keys(e);for(let e=0;e<i.length;e++){const o=t[i[e]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}(t.options.$animations,n).then((()=>{t.options=n}),(()=>{})),o}_createAnimations(t,e){const n=this._properties,i=[],o=t.$animations||(t.$animations={}),a=Object.keys(e),s=Date.now();let r;for(r=a.length-1;r>=0;--r){const l=a[r];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(t,e));continue}const c=e[l];let d=o[l];const u=n.get(l);if(d){if(u&&d.active()){d.update(u,c,s);continue}d.cancel()}u&&u.duration?(o[l]=d=new yi(u,t,l,c),i.push(d)):t[l]=c}return i}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(vt.add(this._chart,n),!0):void 0}}function xi(t,e){const n=t&&t.options||{},i=n.reverse,o=void 0===n.min?e:0,a=void 0===n.max?e:0;return{start:i?a:o,end:i?o:a}}function _i(t,e){const n=[],i=t._getSortedDatasetMetas(e);let o,a;for(o=0,a=i.length;o<a;++o)n.push(i[o].index);return n}function ki(t,e,n,i={}){const o=t.keys,a="single"===i.mode;let r,l,c,d;if(null!==e){for(r=0,l=o.length;r<l;++r){if(c=+o[r],c===n){if(i.all)continue;break}d=t.values[c],s(d)&&(a||0===e||j(e)===j(d))&&(e+=d)}return e}}function Si(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function Ti(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function Ci(t,e,n,i){for(const o of e.getMatchingVisibleMetas(i).reverse()){const e=t[o.index];if(n&&e>0||!n&&e<0)return o.index}return null}function Mi(t,e){const{chart:n,_cachedMeta:i}=t,o=n._stacks||(n._stacks={}),{iScale:a,vScale:s,index:r}=i,l=a.axis,c=s.axis,d=function(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}(a,s,i),u=e.length;let h;for(let t=0;t<u;++t){const n=e[t],{[l]:a,[c]:u}=n;h=(n._stacks||(n._stacks={}))[c]=Ti(o,d,a),h[r]=u,h._top=Ci(h,s,!0,i.type),h._bottom=Ci(h,s,!1,i.type),(h._visualValues||(h._visualValues={}))[r]=u}}function Di(t,e){const n=t.scales;return Object.keys(n).filter((t=>n[t].axis===e)).shift()}function Oi(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[i]||void 0===e[i][n])return;delete e[i][n],void 0!==e[i]._visualValues&&void 0!==e[i]._visualValues[n]&&delete e[i]._visualValues[n]}}}const Ei=t=>"reset"===t||"none"===t,Ai=(t,e)=>e?t:Object.assign({},t);class Ii{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Si(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&Oi(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),i=(t,e,n,i)=>"x"===t?e:"r"===t?i:n,o=e.xAxisID=l(n.xAxisID,Di(t,"x")),a=e.yAxisID=l(n.yAxisID,Di(t,"y")),s=e.rAxisID=l(n.rAxisID,Di(t,"r")),r=e.indexAxis,c=e.iAxisID=i(r,o,a,s),d=e.vAxisID=i(r,a,o,s);e.xScale=this.getScaleForId(o),e.yScale=this.getScaleForId(a),e.rScale=this.getScaleForId(s),e.iScale=this.getScaleForId(c),e.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&rt(this._data,this),t._stacked&&Oi(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(a(e))this._data=function(t){const e=Object.keys(t),n=new Array(e.length);let i,o,a;for(i=0,o=e.length;i<o;++i)a=e[i],n[i]={x:a,y:t[a]};return n}(e);else if(n!==e){if(n){rt(n,this);const t=this._cachedMeta;Oi(t),t._parsed=[]}e&&Object.isExtensible(e)&&st(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const o=e._stacked;e._stacked=Si(e.vScale,e),e.stack!==n.stack&&(i=!0,Oi(e),e.stack=n.stack),this._resyncElements(t),(i||o!==e._stacked)&&Mi(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:r}=n,l=s.axis;let c,d,u,h=0===t&&e===i.length||n._sorted,p=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,u=i;else{u=o(i[t])?this.parseArrayData(n,i,t,e):a(i[t])?this.parseObjectData(n,i,t,e):this.parsePrimitiveData(n,i,t,e);const s=()=>null===d[l]||p&&d[l]<p[l];for(c=0;c<e;++c)n._parsed[c+t]=d=u[c],h&&(s()&&(h=!1),p=d);n._sorted=h}r&&Mi(this,u)}parsePrimitiveData(t,e,n,i){const{iScale:o,vScale:a}=t,s=o.axis,r=a.axis,l=o.getLabels(),c=o===a,d=new Array(i);let u,h,p;for(u=0,h=i;u<h;++u)p=u+n,d[u]={[s]:c||o.parse(l[p],p),[r]:a.parse(e[p],p)};return d}parseArrayData(t,e,n,i){const{xScale:o,yScale:a}=t,s=new Array(i);let r,l,c,d;for(r=0,l=i;r<l;++r)c=r+n,d=e[c],s[r]={x:o.parse(d[0],c),y:a.parse(d[1],c)};return s}parseObjectData(t,e,n,i){const{xScale:o,yScale:a}=t,{xAxisKey:s="x",yAxisKey:r="y"}=this._parsing,l=new Array(i);let c,d,u,h;for(c=0,d=i;c<d;++c)u=c+n,h=e[u],l[c]={x:o.parse(_(h,s),u),y:a.parse(_(h,r),u)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const i=this.chart,o=this._cachedMeta,a=e[t.axis];return ki({keys:_i(i,!0),values:e._stacks[t.axis]._visualValues},a,o.index,{mode:n})}updateRangeFromParsed(t,e,n,i){const o=n[e.axis];let a=null===o?NaN:o;const s=i&&n._stacks[e.axis];i&&s&&(i.values=s,a=ki(i,o,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,e){const n=this._cachedMeta,i=n._parsed,o=n._sorted&&t===n.iScale,a=i.length,r=this._getOtherScale(t),l=((t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:_i(n,!0),values:null})(e,n,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:u}=function(t){const{min:e,max:n,minDefined:i,maxDefined:o}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:o?n:Number.POSITIVE_INFINITY}}(r);let h,p;function f(){p=i[h];const e=p[r.axis];return!s(p[t.axis])||d>e||u<e}for(h=0;h<a&&(f()||(this.updateRangeFromParsed(c,t,p,l),!o));++h);if(o)for(h=a-1;h>=0;--h)if(!f()){this.updateRangeFromParsed(c,t,p,l);break}return c}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let i,o,a;for(i=0,o=e.length;i<o;++i)a=e[i][t.axis],s(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,i=e.vScale,o=this.getParsed(t);return{label:n?""+n.getLabelForValue(o[n.axis]):"",value:i?""+i.getLabelForValue(o[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,n,i,o;return a(t)?(e=t.top,n=t.right,i=t.bottom,o=t.left):e=n=i=o=t,{top:e,right:n,bottom:i,left:o,disabled:!1===t}}(l(this.options.clip,function(t,e,n){if(!1===n)return!1;const i=xi(t,n),o=xi(e,n);return{top:o.end,right:i.end,bottom:o.start,left:i.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,i=n.data||[],o=e.chartArea,a=[],s=this._drawStart||0,r=this._drawCount||i.length-s,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(t,o,s,r),c=s;c<s+r;++c){const e=i[c];e.hidden||(e.active&&l?a.push(e):e.draw(t,o))}for(c=0;c<a.length;++c)a[c].draw(t,o)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const i=this.getDataset();let o;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];o=e.$context||(e.$context=function(t,e,n){return _n(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),o.parsed=this.getParsed(t),o.raw=i.data[t],o.index=o.dataIndex=t}else o=this.$context||(this.$context=function(t,e){return _n(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),o.dataset=i,o.index=o.datasetIndex=this.index;return o.active=!!e,o.mode=n,o}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const i="active"===e,o=this._cachedDataOpts,a=t+"-"+e,s=o[a],r=this.enableOptionSharing&&S(n);if(s)return Ai(s,r);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),d=i?[`${t}Hover`,"hover",t,""]:[t,""],u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(re.elements[t]),p=l.resolveNamedOptions(u,h,(()=>this.getContext(n,i,e)),d);return p.$shared&&(p.$shared=r,o[a]=Object.freeze(Ai(p,r))),p}_resolveAnimations(t,e,n){const i=this.chart,o=this._cachedDataOpts,a=`animation-${e}`,s=o[a];if(s)return s;let r;if(!1!==i.options.animation){const i=this.chart.config,o=i.datasetAnimationScopeKeys(this._type,e),a=i.getOptionScopes(this.getDataset(),o);r=i.createResolver(a,this.getContext(t,n,e))}const l=new wi(i,r&&r.animations);return r&&r._cacheable&&(o[a]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Ei(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),i=this._sharedOptions,o=this.getSharedOptions(n),a=this.includeOptions(e,o)||o!==i;return this.updateSharedOptions(o,e,n),{sharedOptions:o,includeOptions:a}}updateElement(t,e,n,i){Ei(i)?Object.assign(t,n):this._resolveAnimations(e,i).update(t,n)}updateSharedOptions(t,e,n){t&&!Ei(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,i){t.active=i;const o=this.getStyle(e,i);this._resolveAnimations(e,n,i).update(t,{options:!i&&this.getSharedOptions(o)||o})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[t,e,n]of this._syncList)this[t](e,n);this._syncList=[];const i=n.length,o=e.length,a=Math.min(o,i);a&&this.parse(0,a),o>i?this._insertElements(i,o-i,t):o<i&&this._removeElements(o,i-o)}_insertElements(t,e,n=!0){const i=this._cachedMeta,o=i.data,a=t+e;let s;const r=t=>{for(t.length+=e,s=t.length-1;s>=a;s--)t[s]=t[s-e]};for(r(o),s=t;s<a;++s)o[s]=new this.dataElementType;this._parsing&&r(i._parsed),this.parse(t,e),n&&this.updateElements(o,t,e,"reset")}updateElements(t,e,n,i){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,e);n._stacked&&Oi(n,i)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,i]=t;this[e](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}class Pi{static defaults={};static defaultRoutes=void 0;active=!1;tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return W(this.x)&&W(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const i={};return t.forEach((t=>{i[t]=n[t]&&n[t].active()?n[t]._to:this[t]})),i}}function Li(t,e){const n=t.options.ticks,o=function(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),o=t._maxLength/n;return Math.floor(Math.min(i,o))}(t),a=Math.min(n.maxTicksLimit||o,o),s=n.major.enabled?function(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}(e):[],r=s.length,l=s[0],c=s[r-1],d=[];if(r>a)return function(t,e,n,i){let o,a=0,s=n[0];for(i=Math.ceil(i),o=0;o<t.length;o++)o===s&&(e.push(t[o]),a++,s=n[a*i])}(e,d,s,r/a),d;const u=function(t,e,n){const i=function(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}(t),o=e.length/n;if(!i)return Math.max(o,1);const a=H(i);for(let t=0,e=a.length-1;t<e;t++){const e=a[t];if(e>o)return e}return Math.max(o,1)}(s,e,a);if(r>0){let t,n;const o=r>1?Math.round((c-l)/(r-1)):null;for(Ni(e,d,u,i(o)?0:l-o,l),t=0,n=r-1;t<n;t++)Ni(e,d,u,s[t],s[t+1]);return Ni(e,d,u,c,i(o)?e.length:c+o),d}return Ni(e,d,u),d}function Ni(t,e,n,i,o){const a=l(i,0),s=Math.min(l(o,t.length),t.length);let r,c,d,u=0;for(n=Math.ceil(n),o&&(r=o-i,n=r/Math.floor(r/n)),d=a;d<0;)u++,d=Math.round(a+u*n);for(c=Math.max(a,0);c<s;c++)c===d&&(e.push(t[c]),u++,d=Math.round(a+u*n))}const Ri=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n,ji=(t,e)=>Math.min(e||t,t);function $i(t,e){const n=[],i=t.length/e,o=t.length;let a=0;for(;a<o;a+=i)n.push(t[Math.floor(a)]);return n}function Bi(t,e,n){const i=t.ticks.length,o=Math.min(e,i-1),a=t._startPixel,s=t._endPixel,r=1e-6;let l,c=t.getPixelForTick(o);if(!(n&&(l=1===i?Math.max(c-a,s-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(o-1))/2,c+=o<e?l:-l,c<a-r||c>s+r)))return c}function Hi(t){return t.drawTicks?t.tickLength:0}function Wi(t,e){if(!t.display)return 0;const n=yn(t.font,e),i=bn(t.padding);return(o(t.text)?t.text.length:1)*n.lineHeight+i.height}function Fi(t,e,n){let i=ht(t);return(n&&"right"!==e||!n&&"right"===e)&&(i=(t=>"left"===t?"right":"right"===t?"left":t)(i)),i}class Ui extends Pi{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:i}=this;return t=r(t,Number.POSITIVE_INFINITY),e=r(e,Number.NEGATIVE_INFINITY),n=r(n,Number.POSITIVE_INFINITY),i=r(i,Number.NEGATIVE_INFINITY),{min:r(t,n),max:r(e,i),minDefined:s(t),maxDefined:s(e)}}getMinMax(t){let e,{min:n,max:i,minDefined:o,maxDefined:a}=this.getUserBounds();if(o&&a)return{min:n,max:i};const s=this.getMatchingVisibleMetas();for(let r=0,l=s.length;r<l;++r)e=s[r].controller.getMinMax(this,t),o||(n=Math.min(n,e.min)),a||(i=Math.max(i,e.max));return n=a&&n>i?i:n,i=o&&n>i?n:i,{min:r(n,r(i,n)),max:r(i,r(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){u(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:i,grace:o,ticks:a}=this.options,s=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=xn(this,o,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const r=s<this.ticks.length;this._convertTicksToLabels(r?$i(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||"auto"===a.source)&&(this.ticks=Li(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),r&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,n=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,n=!n),this._startPixel=t,this._endPixel=e,this._reversePixels=n,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){u(this.options.afterUpdate,[this])}beforeSetDimensions(){u(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){u(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),u(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){u(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,i,o;for(n=0,i=t.length;n<i;n++)o=t[n],o.label=u(e.callback,[o.value,n,t],this)}afterTickToLabelConversion(){u(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){u(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=ji(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,o=e.maxRotation;let a,s,r,l=i;if(!this._isVisible()||!e.display||i>=o||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=K(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/n:h/(n-1),d+6>a&&(a=h/(n-(t.offset?.5:1)),s=this.maxHeight-Hi(t.grid)-e.padding-Wi(t.title,this.chart.options.font),r=Math.sqrt(d*d+u*u),l=z(Math.min(Math.asin(K((c.highest.height+6)/a,-1,1)),Math.asin(K(s/r,-1,1))-Math.asin(K(u/r,-1,1)))),l=Math.max(i,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){u(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){u(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:i,grid:o}}=this,a=this._isVisible(),s=this.isHorizontal();if(a){const a=Wi(i,e.options.font);if(s?(t.width=this.maxWidth,t.height=Hi(o)+a):(t.height=this.maxHeight,t.width=Hi(o)+a),n.display&&this.ticks.length){const{first:e,last:i,widest:o,highest:a}=this._getLabelSizes(),r=2*n.padding,l=V(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(s){const e=n.mirror?0:d*o.width+c*a.height;t.height=Math.min(this.maxHeight,t.height+e+r)}else{const e=n.mirror?0:c*o.width+d*a.height;t.width=Math.min(this.maxWidth,t.width+e+r)}this._calculatePadding(e,i,d,c)}}this._handleMargins(),s?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,i){const{ticks:{align:o,padding:a},position:s}=this.options,r=0!==this.labelRotation,l="top"!==s&&"x"===this.axis;if(this.isHorizontal()){const s=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,u=0;r?l?(d=i*t.width,u=n*e.height):(d=n*t.height,u=i*e.width):"start"===o?u=e.width:"end"===o?d=t.width:"inner"!==o&&(d=t.width/2,u=e.width/2),this.paddingLeft=Math.max((d-s+a)*this.width/(this.width-s),0),this.paddingRight=Math.max((u-c+a)*this.width/(this.width-c),0)}else{let n=e.height/2,i=t.height/2;"start"===o?(n=0,i=t.height):"end"===o&&(n=e.height,i=0),this.paddingTop=n+a,this.paddingBottom=i+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){u(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,n=t.length;e<n;e++)i(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=$i(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){const{ctx:a,_longestTextCache:s}=this,r=[],l=[],c=Math.floor(e/ji(e,n));let d,u,p,f,m,g,v,b,y,w,x,_=0,k=0;for(d=0;d<e;d+=c){if(f=t[d].label,m=this._resolveTickFontOptions(d),a.font=g=m.string,v=s[g]=s[g]||{data:{},gc:[]},b=m.lineHeight,y=w=0,i(f)||o(f)){if(o(f))for(u=0,p=f.length;u<p;++u)x=f[u],i(x)||o(x)||(y=_e(a,v.data,v.gc,y,x),w+=b)}else y=_e(a,v.data,v.gc,y,f),w=b;r.push(y),l.push(w),_=Math.max(y,_),k=Math.max(w,k)}!function(t,e){h(t,(t=>{const n=t.gc,i=n.length/2;let o;if(i>e){for(o=0;o<i;++o)delete t.data[n[o]];n.splice(0,i)}}))}(s,e);const S=r.indexOf(_),T=l.indexOf(k),C=t=>({width:r[t]||0,height:l[t]||0});return{first:C(0),last:C(e-1),widest:C(S),highest:C(T),widths:r,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return Z(this._alignToPixels?Se(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=function(t,e,n){return _n(t,{tick:n,index:e,type:"tick"})}(this.getContext(),t,n))}return this.$context||(this.$context=_n(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const t=this.options.ticks,e=V(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),o=this._getLabelSizes(),a=t.autoSkipPadding||0,s=o?o.widest.width+a:0,r=o?o.highest.height+a:0;return this.isHorizontal()?r*n>s*i?s/n:r/i:r*i<s*n?r/n:s/i}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,i=this.options,{grid:o,position:s,border:r}=i,c=o.offset,d=this.isHorizontal(),u=this.ticks.length+(c?1:0),h=Hi(o),p=[],f=r.setContext(this.getContext()),m=f.display?f.width:0,g=m/2,v=function(t){return Se(n,t,m)};let b,y,w,x,_,k,S,T,C,M,D,O;if("top"===s)b=v(this.bottom),k=this.bottom-h,T=b-g,M=v(t.top)+g,O=t.bottom;else if("bottom"===s)b=v(this.top),M=t.top,O=v(t.bottom)-g,k=b+g,T=this.top+h;else if("left"===s)b=v(this.right),_=this.right-h,S=b-g,C=v(t.left)+g,D=t.right;else if("right"===s)b=v(this.left),C=t.left,D=v(t.right)-g,_=b+g,S=this.left+h;else if("x"===e){if("center"===s)b=v((t.top+t.bottom)/2+.5);else if(a(s)){const t=Object.keys(s)[0],e=s[t];b=v(this.chart.scales[t].getPixelForValue(e))}M=t.top,O=t.bottom,k=b+g,T=k+h}else if("y"===e){if("center"===s)b=v((t.left+t.right)/2);else if(a(s)){const t=Object.keys(s)[0],e=s[t];b=v(this.chart.scales[t].getPixelForValue(e))}_=b-g,S=_-h,C=t.left,D=t.right}const E=l(i.ticks.maxTicksLimit,u),A=Math.max(1,Math.ceil(u/E));for(y=0;y<u;y+=A){const t=this.getContext(y),e=o.setContext(t),i=r.setContext(t),a=e.lineWidth,s=e.color,l=i.dash||[],u=i.dashOffset,h=e.tickWidth,f=e.tickColor,m=e.tickBorderDash||[],g=e.tickBorderDashOffset;w=Bi(this,y,c),void 0!==w&&(x=Se(n,w,a),d?_=S=C=D=x:k=T=M=O=x,p.push({tx1:_,ty1:k,tx2:S,ty2:T,x1:C,y1:M,x2:D,y2:O,width:a,color:s,borderDash:l,borderDashOffset:u,tickWidth:h,tickColor:f,tickBorderDash:m,tickBorderDashOffset:g}))}return this._ticksLength=u,this._borderValue=b,p}_computeLabelItems(t){const e=this.axis,n=this.options,{position:i,ticks:s}=n,r=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:u,mirror:h}=s,p=Hi(n.grid),f=p+u,m=h?-u:f,g=-V(this.labelRotation),v=[];let b,y,w,x,_,k,S,T,C,M,D,O,E="middle";if("top"===i)k=this.bottom-m,S=this._getXAxisLabelAlignment();else if("bottom"===i)k=this.top+m,S=this._getXAxisLabelAlignment();else if("left"===i){const t=this._getYAxisLabelAlignment(p);S=t.textAlign,_=t.x}else if("right"===i){const t=this._getYAxisLabelAlignment(p);S=t.textAlign,_=t.x}else if("x"===e){if("center"===i)k=(t.top+t.bottom)/2+f;else if(a(i)){const t=Object.keys(i)[0],e=i[t];k=this.chart.scales[t].getPixelForValue(e)+f}S=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===i)_=(t.left+t.right)/2-f;else if(a(i)){const t=Object.keys(i)[0],e=i[t];_=this.chart.scales[t].getPixelForValue(e)}S=this._getYAxisLabelAlignment(p).textAlign}"y"===e&&("start"===c?E="top":"end"===c&&(E="bottom"));const A=this._getLabelSizes();for(b=0,y=l.length;b<y;++b){w=l[b],x=w.label;const t=s.setContext(this.getContext(b));T=this.getPixelForTick(b)+s.labelOffset,C=this._resolveTickFontOptions(b),M=C.lineHeight,D=o(x)?x.length:1;const e=D/2,n=t.color,a=t.textStrokeColor,c=t.textStrokeWidth;let u,p=S;if(r?(_=T,"inner"===S&&(p=b===y-1?this.options.reverse?"left":"right":0===b?this.options.reverse?"right":"left":"center"),O="top"===i?"near"===d||0!==g?-D*M+M/2:"center"===d?-A.highest.height/2-e*M+M:-A.highest.height+M/2:"near"===d||0!==g?M/2:"center"===d?A.highest.height/2-e*M:A.highest.height-D*M,h&&(O*=-1),0===g||t.showLabelBackdrop||(_+=M/2*Math.sin(g))):(k=T,O=(1-D)*M/2),t.showLabelBackdrop){const e=bn(t.backdropPadding),n=A.heights[b],i=A.widths[b];let o=O-e.top,a=0-e.left;switch(E){case"middle":o-=n/2;break;case"bottom":o-=n}switch(S){case"center":a-=i/2;break;case"right":a-=i}u={left:a,top:o,width:i+e.width,height:n+e.height,color:t.backdropColor}}v.push({label:x,font:C,textOffset:O,options:{rotation:g,color:n,strokeColor:a,strokeWidth:c,textAlign:p,textBaseline:E,translation:[_,k],backdrop:u}})}return v}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-V(this.labelRotation))return"top"===t?"left":"right";let n="center";return"start"===e.align?n="left":"end"===e.align?n="right":"inner"===e.align&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:i,padding:o}}=this.options,a=t+o,s=this._getLabelSizes().widest.width;let r,l;return"left"===e?i?(l=this.right+o,"near"===n?r="left":"center"===n?(r="center",l+=s/2):(r="right",l+=s)):(l=this.right-a,"near"===n?r="right":"center"===n?(r="center",l-=s/2):(r="left",l=this.left)):"right"===e?i?(l=this.left+o,"near"===n?r="right":"center"===n?(r="center",l-=s/2):(r="left",l-=s)):(l=this.left+a,"near"===n?r="left":"center"===n?(r="center",l+=s/2):(r="right",l=this.right)):r="right",{textAlign:r,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:i,width:o,height:a}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,i,o,a),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex((e=>e.value===t));return n>=0?e.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){const e=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let o,a;const s=(t,e,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.restore())};if(e.display)for(o=0,a=i.length;o<a;++o){const t=i[o];e.drawOnChartArea&&s({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&s({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:n,grid:i}}=this,o=n.setContext(this.getContext()),a=n.display?o.width:0;if(!a)return;const s=i.setContext(this.getContext(0)).lineWidth,r=this._borderValue;let l,c,d,u;this.isHorizontal()?(l=Se(t,this.left,a)-a/2,c=Se(t,this.right,s)+s/2,d=u=r):(d=Se(t,this.top,a)-a/2,u=Se(t,this.bottom,s)+s/2,l=c=r),e.save(),e.lineWidth=o.width,e.strokeStyle=o.color,e.beginPath(),e.moveTo(l,d),e.lineTo(c,u),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,n=this._computeLabelArea();n&&Oe(e,n);const i=this.getLabelItems(t);for(const t of i){const n=t.options,i=t.font;Pe(e,t.label,0,t.textOffset,i,n)}n&&Ee(e)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:i}}=this;if(!n.display)return;const s=yn(n.font),r=bn(n.padding),l=n.align;let c=s.lineHeight/2;"bottom"===e||"center"===e||a(e)?(c+=r.bottom,o(n.text)&&(c+=s.lineHeight*(n.text.length-1))):c+=r.top;const{titleX:d,titleY:u,maxWidth:h,rotation:p}=function(t,e,n,i){const{top:o,left:s,bottom:r,right:l,chart:c}=t,{chartArea:d,scales:u}=c;let h,p,f,m=0;const g=r-o,v=l-s;if(t.isHorizontal()){if(p=pt(i,s,l),a(n)){const t=Object.keys(n)[0],i=n[t];f=u[t].getPixelForValue(i)+g-e}else f="center"===n?(d.bottom+d.top)/2+g-e:Ri(t,n,e);h=l-s}else{if(a(n)){const t=Object.keys(n)[0],i=n[t];p=u[t].getPixelForValue(i)-v+e}else p="center"===n?(d.left+d.right)/2-v+e:Ri(t,n,e);f=pt(i,r,o),m="left"===n?-P:P}return{titleX:p,titleY:f,maxWidth:h,rotation:m}}(this,c,e,l);Pe(t,n.text,0,0,s,{color:n.color,maxWidth:h,rotation:p,textAlign:Fi(l,e,i),textBaseline:"middle",translation:[d,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=l(t.grid&&t.grid.z,-1),i=l(t.border&&t.border.z,0);return this._isVisible()&&this.draw===Ui.prototype.draw?[{z:n,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let o,a;for(o=0,a=e.length;o<a;++o){const a=e[o];a[n]!==this.id||t&&a.type!==t||i.push(a)}return i}_resolveTickFontOptions(t){return yn(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Vi{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;(function(t){return"id"in t&&"defaults"in t})(e)&&(n=this.register(e));const i=this.items,o=t.id,a=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+t);return o in i||(i[o]=t,function(t,e,n){const i=v(Object.create(null),[n?re.get(n):{},re.get(e),t.defaults]);re.set(e,i),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((n=>{const i=n.split("."),o=i.pop(),a=[t].concat(i).join("."),s=e[n].split("."),r=s.pop(),l=s.join(".");re.route(a,o,l,r)}))}(e,t.defaultRoutes),t.descriptors&&re.describe(e,t.descriptors)}(t,a,n),this.override&&re.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,i=this.scope;n in e&&delete e[n],i&&n in re[i]&&(delete re[i][n],this.override&&delete ie[n])}}var zi=new class{constructor(){this.controllers=new Vi(Ii,"datasets",!0),this.elements=new Vi(Pi,"elements"),this.plugins=new Vi(Object,"plugins"),this.scales=new Vi(Ui,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach((e=>{const i=n||this._getRegistryForType(e);n||i.isForType(e)||i===this.plugins&&e.id?this._exec(t,i,e):h(e,(e=>{const i=n||this._getRegistryForType(e);this._exec(t,i,e)}))}))}_exec(t,e,n){const i=k(t);u(n["before"+i],[],n),e[t](n),u(n["after"+i],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const i=e.get(t);if(void 0===i)throw new Error('"'+t+'" is not a registered '+n+".");return i}};class qi{constructor(){this._init=[]}notify(t,e,n,i){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const o=i?this._descriptors(t).filter(i):this._descriptors(t),a=this._notify(o,t,e,n);return"afterDestroy"===e&&(this._notify(o,t,"stop"),this._notify(this._init,t,"uninstall")),a}_notify(t,e,n,i){i=i||{};for(const o of t){const t=o.plugin;if(!1===u(t[n],[e,i,o.options],t)&&i.cancelable)return!1}return!0}invalidate(){i(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,i=l(n.options&&n.options.plugins,{}),o=function(t){const e={},n=[],i=Object.keys(zi.plugins.items);for(let t=0;t<i.length;t++)n.push(zi.getPlugin(i[t]));const o=t.plugins||[];for(let t=0;t<o.length;t++){const i=o[t];-1===n.indexOf(i)&&(n.push(i),e[i.id]=!0)}return{plugins:n,localIds:e}}(n);return!1!==i||e?function(t,{plugins:e,localIds:n},i,o){const a=[],s=t.getContext();for(const r of e){const e=r.id,l=Yi(i[e],o);null!==l&&a.push({plugin:r,options:Gi(t.config,{plugin:r,local:n[e]},l,s)})}return a}(t,o,i,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,i=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(i(e,n),t,"stop"),this._notify(i(n,e),t,"start")}}function Yi(t,e){return e||!1!==t?!0===t?{}:t:null}function Gi(t,{plugin:e,local:n},i,o){const a=t.pluginScopeKeys(e),s=t.getOptionScopes(i,a);return n&&e.defaults&&s.push(e.defaults),t.createResolver(s,o,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Xi(t,e){const n=re.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function Ji(t,e){if("x"===t||"y"===t||"r"===t)return t;var n;if(t=e.axis||("top"===(n=e.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||t.length>1&&Ji(t[0].toLowerCase(),e))return t;throw new Error(`Cannot determine type of '${name}' axis. Please provide 'axis' or 'position' option.`)}function Qi(t){const e=t.options||(t.options={});e.plugins=l(e.plugins,{}),e.scales=function(t,e){const n=ie[t.type]||{scales:{}},i=e.scales||{},o=Xi(t.type,e),s=Object.create(null);return Object.keys(i).forEach((t=>{const e=i[t];if(!a(e))return console.error(`Invalid scale configuration for scale: ${t}`);if(e._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const r=Ji(t,e),l=function(t,e){return t===e?"_index_":"_value_"}(r,o),c=n.scales||{};s[t]=b(Object.create(null),[{axis:r},e,c[r],c[l]])})),t.data.datasets.forEach((n=>{const o=n.type||t.type,a=n.indexAxis||Xi(o,e),r=(ie[o]||{}).scales||{};Object.keys(r).forEach((t=>{const e=function(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}(t,a),o=n[e+"AxisID"]||e;s[o]=s[o]||Object.create(null),b(s[o],[{axis:e},i[o],r[t]])}))})),Object.keys(s).forEach((t=>{const e=s[t];b(e,[re.scales[e.type],re.scale])})),s}(t,e)}function Ki(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const Zi=new Map,to=new Set;function eo(t,e){let n=Zi.get(t);return n||(n=e(),Zi.set(t,n),to.add(n)),n}const no=(t,e,n)=>{const i=_(e,n);void 0!==i&&t.add(i)};class io{constructor(t){this._config=function(t){return(t=t||{}).data=Ki(t.data),Qi(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Ki(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Qi(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return eo(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return eo(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return eo(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return eo(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const n=this._scopeCache;let i=n.get(t);return i&&!e||(i=new Map,n.set(t,i)),i}getOptionScopes(t,e,n){const{options:i,type:o}=this,a=this._cachedScopes(t,n),s=a.get(e);if(s)return s;const r=new Set;e.forEach((e=>{t&&(r.add(t),e.forEach((e=>no(r,t,e)))),e.forEach((t=>no(r,i,t))),e.forEach((t=>no(r,ie[o]||{},t))),e.forEach((t=>no(r,re,t))),e.forEach((t=>no(r,oe,t)))}));const l=Array.from(r);return 0===l.length&&l.push(Object.create(null)),to.has(e)&&a.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,ie[e]||{},re.datasets[e]||{},{type:e},re,oe]}resolveNamedOptions(t,e,n,i=[""]){const a={$shared:!0},{resolver:s,subPrefixes:r}=oo(this._resolverCache,t,i);let l=s;(function(t,e){const{isScriptable:n,isIndexable:i}=Be(t);for(const a of e){const e=n(a),s=i(a),r=(s||e)&&t[a];if(e&&(T(r)||ao(r))||s&&o(r))return!0}return!1})(s,e)&&(a.$shared=!1,l=$e(s,n=T(n)?n():n,this.createResolver(t,n,r)));for(const t of e)a[t]=l[t];return a}createResolver(t,e,n=[""],i){const{resolver:o}=oo(this._resolverCache,t,n);return a(e)?$e(o,e,void 0,i):o}}function oo(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const o=n.join();let a=i.get(o);return a||(a={resolver:je(e,n),subPrefixes:n.filter((t=>!t.toLowerCase().includes("hover")))},i.set(o,a)),a}const ao=t=>a(t)&&Object.getOwnPropertyNames(t).reduce(((e,n)=>e||T(t[n])),!1),so=["top","bottom","left","right","chartArea"];function ro(t,e){return"top"===t||"bottom"===t||-1===so.indexOf(t)&&"x"===e}function lo(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function co(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),u(n&&n.onComplete,[t],e)}function uo(t){const e=t.chart,n=e.options.animation;u(n&&n.onProgress,[t],e)}function ho(t){return le()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const po={},fo=t=>{const e=ho(t);return Object.values(po).filter((t=>t.canvas===e)).pop()};function mo(t,e,n){const i=Object.keys(t);for(const o of i){const i=+o;if(i>=e){const a=t[o];delete t[o],(n>0||i>e)&&(t[i+n]=a)}}}class go{static defaults=re;static instances=po;static overrides=ie;static registry=zi;static version="4.2.1";static getChart=fo;static register(...t){zi.add(...t),vo()}static unregister(...t){zi.remove(...t),vo()}constructor(t,e){const i=this.config=new io(e),o=ho(t),a=fo(o);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const s=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||mi(o)),this.platform.updateConfig(i);const r=this.platform.acquireContext(o,s.aspectRatio),l=r&&r.canvas,c=l&&l.height,d=l&&l.width;this.id=n(),this.ctx=r,this.canvas=l,this.width=d,this.height=c,this._options=s,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new qi,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=ut((t=>this.update(t)),s.resizeDelay||0),this._dataChanges=[],po[this.id]=this,r&&l?(vt.listen(this,"complete",co),vt.listen(this,"progress",uo),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:o,_aspectRatio:a}=this;return i(t)?e&&a?a:o?n/o:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return zi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():be(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Te(this.canvas,this.ctx),this}stop(){return vt.stop(this),this}resize(t,e){vt.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,i=this.canvas,o=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(i,t,e,o),s=n.devicePixelRatio||this.platform.getDevicePixelRatio(),r=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,be(this,s,!0)&&(this.notifyPlugins("resize",{size:a}),u(n.onResize,[this,a],this),this.attached&&this._doResize(r)&&this.render())}ensureScalesHaveIDs(){h(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,i=Object.keys(n).reduce(((t,e)=>(t[e]=!1,t)),{});let o=[];e&&(o=o.concat(Object.keys(e).map((t=>{const n=e[t],i=Ji(t,n),o="r"===i,a="x"===i;return{options:n,dposition:o?"chartArea":a?"bottom":"left",dtype:o?"radialLinear":a?"category":"linear"}})))),h(o,(e=>{const o=e.options,a=o.id,s=Ji(a,o),r=l(o.type,e.dtype);void 0!==o.position&&ro(o.position,s)===ro(e.dposition)||(o.position=e.dposition),i[a]=!0;let c=null;a in n&&n[a].type===r?c=n[a]:(c=new(zi.getScale(r))({id:a,type:r,ctx:this.ctx,chart:this}),n[c.id]=c),c.init(o,t)})),h(i,((t,e)=>{t||delete n[e]})),h(n,(t=>{Kn.configure(this,t,t.options),Kn.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort(((t,e)=>t.index-e.index)),n>e){for(let t=e;t<n;++t)this._destroyDatasetMeta(t);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(lo("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,n)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=e.length;n<i;n++){const i=e[n];let o=this.getDatasetMeta(n);const a=i.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=a,o.indexAxis=i.indexAxis||Xi(a,this.options),o.order=i.order||0,o.index=n,o.label=""+i.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const e=zi.getController(a),{datasetElementType:i,dataElementType:s}=re.datasets[a];Object.assign(e,{dataElementType:zi.getElement(s),datasetElementType:i&&zi.getElement(i)}),o.controller=new e(this,n),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){h(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let t=0,e=this.data.datasets.length;t<e;t++){const{controller:e}=this.getDatasetMeta(t),n=!i&&-1===o.indexOf(e);e.buildOrUpdateElements(n),a=Math.max(+e.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),i||h(o,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(lo("z","_idx"));const{_active:s,_lastEvent:r}=this;r?this._eventHandler(r,!0):s.length&&this._updateHoverStyles(s,s,!0),this.render()}_updateScales(){h(this.scales,(t=>{Kn.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);C(e,n)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:o}of e)mo(t,i,"_removeElements"===n?-o:o)}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),i=n(0);for(let t=1;t<e;t++)if(!C(i,n(t)))return;return Array.from(i).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Kn.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],h(this.boxes,(t=>{n&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,T(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(vt.has(this)?this.attached&&!vt.running(this)&&vt.start(this):(this.draw(),co({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let i,o;for(i=0,o=e.length;i<o;++i){const o=e[i];t&&!o.visible||n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n=t._clip,i=!n.disabled,o=function(t){const{xScale:e,yScale:n}=t;if(e&&n)return{left:e.left,right:e.right,top:n.top,bottom:n.bottom}}(t)||this.chartArea,a={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",a)&&(i&&Oe(e,{left:!1===n.left?0:o.left-n.left,right:!1===n.right?this.width:o.right+n.right,top:!1===n.top?0:o.top-n.top,bottom:!1===n.bottom?this.height:o.bottom+n.bottom}),t.controller.draw(),i&&Ee(e),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return De(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,i){const o=Hn.modes[e];return"function"==typeof o?o(this,t,n,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let i=n.filter((t=>t&&t._dataset===e)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=_n(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"==typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const i=n?"show":"hide",o=this.getDatasetMeta(t),a=o.controller._resolveAnimations(void 0,i);S(e)?(o.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),a.update(o,{visible:n}),this.update((e=>e.datasetIndex===t?i:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),vt.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Te(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete po[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(t,e,n)=>{t.offsetX=e,t.offsetY=n,this._eventHandler(t)};h(this.options.events,(t=>n(t,i)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(n,i)=>{t[n]&&(e.removeEventListener(this,n,i),delete t[n])},o=(t,e)=>{this.canvas&&this.resize(t,e)};let a;const s=()=>{i("attach",s),this.attached=!0,this.resize(),n("resize",o),n("detach",a)};a=()=>{this.attached=!1,i("resize",o),this._stop(),this._resize(0,0),n("attach",s)},e.isAttached(this.canvas)?s():a()}unbindEvents(){h(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},h(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const i=n?"set":"remove";let o,a,s,r;for("dataset"===e&&(o=this.getDatasetMeta(t[0].datasetIndex),o.controller["_"+i+"DatasetHoverStyle"]()),s=0,r=t.length;s<r;++s){a=t[s];const e=a&&this.getDatasetMeta(a.datasetIndex).controller;e&&e[i+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map((({datasetIndex:t,index:e})=>{const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[e],index:e}}));!p(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}isPluginEnabled(t){return 1===this._plugins._cache.filter((e=>e.plugin.id===t)).length}_updateHoverStyles(t,e,n){const i=this.options.hover,o=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),a=o(e,t),s=n?t:o(t,e);a.length&&this.updateHoverStyle(a,i.mode,!1),s.length&&i.mode&&this.updateHoverStyle(s,i.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const o=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(o||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:i=[],options:o}=this,a=e,s=this._getActiveElements(t,i,n,a),r=M(t),l=function(t,e,n,i){return n&&"mouseout"!==t.type?i?e:t:null}(t,this._lastEvent,n,r);n&&(this._lastEvent=null,u(o.onHover,[t,s,this],this),r&&u(o.onClick,[t,s,this],this));const c=!p(s,i);return(c||e)&&(this._active=s,this._updateHoverStyles(s,i,e)),this._lastEvent=l,c}_getActiveElements(t,e,n,i){if("mouseout"===t.type)return[];if(!n)return e;const o=this.options.hover;return this.getElementsAtEventForMode(t,o.mode,o,i)}}function vo(){return h(go.instances,(t=>t._plugins.invalidate()))}function bo(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class yo{static override(t){Object.assign(yo.prototype,t)}constructor(t){this.options=t||{}}init(){}formats(){return bo()}parse(){return bo()}format(){return bo()}add(){return bo()}diff(){return bo()}startOf(){return bo()}endOf(){return bo()}}var wo={_date:yo};function xo(t){const e=t.iScale,n=function(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let e=0,o=n.length;e<o;e++)i=i.concat(n[e].controller.getAllParsedValues(t));t._cache.$bar=lt(i.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let i,o,a,s,r=e._length;const l=()=>{32767!==a&&-32768!==a&&(S(s)&&(r=Math.min(r,Math.abs(a-s)||r)),s=a)};for(i=0,o=n.length;i<o;++i)a=e.getPixelForValue(n[i]),l();for(s=void 0,i=0,o=e.ticks.length;i<o;++i)a=e.getPixelForTick(i),l();return r}function _o(t,e,n,i){return o(t)?function(t,e,n,i){const o=n.parse(t[0],i),a=n.parse(t[1],i),s=Math.min(o,a),r=Math.max(o,a);let l=s,c=r;Math.abs(s)>Math.abs(r)&&(l=r,c=s),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:o,end:a,min:s,max:r}}(t,e,n,i):e[n.axis]=n.parse(t,i),e}function ko(t,e,n,i){const o=t.iScale,a=t.vScale,s=o.getLabels(),r=o===a,l=[];let c,d,u,h;for(c=n,d=n+i;c<d;++c)h=e[c],u={},u[o.axis]=r||o.parse(s[c],c),l.push(_o(h,u,a,c));return l}function So(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function To(t,e,n,i){let o=e.borderSkipped;const a={};if(!o)return void(t.borderSkipped=a);if(!0===o)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:s,end:r,reverse:l,top:c,bottom:d}=function(t){let e,n,i,o,a;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(o="end",a="start"):(o="start",a="end"),{start:n,end:i,reverse:e,top:o,bottom:a}}(t);"middle"===o&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?o=c:(n._bottom||0)===i?o=d:(a[Co(d,s,r,l)]=!0,o=c)),a[Co(o,s,r,l)]=!0,t.borderSkipped=a}function Co(t,e,n,i){var o,a,s;return i?(s=n,t=Mo(t=(o=t)===(a=e)?s:o===s?a:o,n,e)):t=Mo(t,e,n),t}function Mo(t,e,n){return"start"===t?e:"end"===t?n:t}function Do(t,{inflateAmount:e},n){t.inflateAmount="auto"===e?1===n?.33:0:e}class Oo extends Ii{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:i}}=t.legend.options;return e.labels.map(((e,o)=>{const a=t.getDatasetMeta(0).controller.getStyle(o);return{text:e,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,fontColor:i,lineWidth:a.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(o),index:o}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{let o,s,r=t=>+n[t];if(a(n[t])){const{key:t="value"}=this._parsing;r=e=>+_(n[e],t)}for(o=t,s=t+e;o<s;++o)i._parsed[o]=r(o)}}_getRotation(){return V(this.options.rotation-90)}_getCircumference(){return V(this.options.circumference)}_getRotationExtents(){let t=O,e=-O;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,o=i._getRotation(),a=i._getCircumference();t=Math.min(t,o),e=Math.max(e,o+a)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,i=this._cachedMeta,o=i.data,a=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,s=Math.max((Math.min(n.width,n.height)-a)/2,0),r=Math.min(c(this.options.cutout,s),1),l=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:p,ratioY:f,offsetX:m,offsetY:g}=function(t,e,n){let i=1,o=1,a=0,s=0;if(e<O){const r=t,l=r+e,c=Math.cos(r),d=Math.sin(r),u=Math.cos(l),h=Math.sin(l),p=(t,e,i)=>Q(t,r,l,!0)?1:Math.max(e,e*n,i,i*n),f=(t,e,i)=>Q(t,r,l,!0)?-1:Math.min(e,e*n,i,i*n),m=p(0,c,u),g=p(P,d,h),v=f(D,c,u),b=f(D+P,d,h);i=(m-v)/2,o=(g-b)/2,a=-(m+v)/2,s=-(g+b)/2}return{ratioX:i,ratioY:o,offsetX:a,offsetY:s}}(h,u,r),v=(n.width-a)/p,b=(n.height-a)/f,y=Math.max(Math.min(v,b)/2,0),w=d(this.options.radius,y),x=(w-Math.max(w*r,0))/this._getVisibleDatasetWeightTotal();this.offsetX=m*w,this.offsetY=g*w,i.total=this.calculateTotal(),this.outerRadius=w-x*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-x*l,0),this.updateElements(o,0,o.length,t)}_circumference(t,e){const n=this.options,i=this._cachedMeta,o=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||null===i._parsed[t]||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*o/O)}updateElements(t,e,n,i){const o="reset"===i,a=this.chart,s=a.chartArea,r=a.options.animation,l=(s.left+s.right)/2,c=(s.top+s.bottom)/2,d=o&&r.animateScale,u=d?0:this.innerRadius,h=d?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(e,i);let m,g=this._getRotation();for(m=0;m<e;++m)g+=this._circumference(m,o);for(m=e;m<e+n;++m){const e=this._circumference(m,o),n=t[m],a={x:l+this.offsetX,y:c+this.offsetY,startAngle:g,endAngle:g+e,circumference:e,outerRadius:h,innerRadius:u};f&&(a.options=p||this.resolveDataElementOptions(m,n.active?"active":i)),g+=e,this.updateElement(n,m,a,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let n,i=0;for(n=0;n<e.length;n++){const o=t._parsed[n];null===o||isNaN(o)||!this.chart.getDataVisibility(n)||e[n].hidden||(i+=Math.abs(o))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?O*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],o=te(e._parsed[t],n.options.locale);return{label:i[t]||"",value:o}}getMaxBorderWidth(t){let e=0;const n=this.chart;let i,o,a,s,r;if(!t)for(i=0,o=n.data.datasets.length;i<o;++i)if(n.isDatasetVisible(i)){a=n.getDatasetMeta(i),t=a.data,s=a.controller;break}if(!t)return 0;for(i=0,o=t.length;i<o;++i)r=s.resolveDataElementOptions(i),"inner"!==r.borderAlign&&(e=Math.max(e,r.borderWidth||0,r.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,i=t.length;n<i;++n){const t=this.resolveDataElementOptions(n);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(l(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Eo extends Ii{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:i}}=t.legend.options;return e.labels.map(((e,o)=>{const a=t.getDatasetMeta(0).controller.getStyle(o);return{text:e,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,fontColor:i,lineWidth:a.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(o),index:o}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],o=te(e._parsed[t].r,n.options.locale);return{label:i[t]||"",value:o}}parseObjectData(t,e,n,i){return Je.bind(this)(t,e,n,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,n)=>{const i=this.getParsed(n).r;!isNaN(i)&&this.chart.getDataVisibility(n)&&(i<e.min&&(e.min=i),i>e.max&&(e.max=i))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,n=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),o=Math.max(i/2,0),a=(o-Math.max(n.cutoutPercentage?o/100*n.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=o-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,n,i){const o="reset"===i,a=this.chart,s=a.options.animation,r=this._cachedMeta.rScale,l=r.xCenter,c=r.yCenter,d=r.getIndexAngle(0)-.5*D;let u,h=d;const p=360/this.countVisibleElements();for(u=0;u<e;++u)h+=this._computeAngle(u,i,p);for(u=e;u<e+n;u++){const e=t[u];let n=h,f=h+this._computeAngle(u,i,p),m=a.getDataVisibility(u)?r.getDistanceFromCenterForValue(this.getParsed(u).r):0;h=f,o&&(s.animateScale&&(m=0),s.animateRotate&&(n=f=d));const g={x:l,y:c,innerRadius:0,outerRadius:m,startAngle:n,endAngle:f,options:this.resolveDataElementOptions(u,e.active?"active":i)};this.updateElement(e,u,g,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&e++})),e}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?V(this.resolveDataElementOptions(t,e).angle||n):0}}var Ao=Object.freeze({__proto__:null,BarController:class extends Ii{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,n,i){return ko(t,e,n,i)}parseArrayData(t,e,n,i){return ko(t,e,n,i)}parseObjectData(t,e,n,i){const{iScale:o,vScale:a}=t,{xAxisKey:s="x",yAxisKey:r="y"}=this._parsing,l="x"===o.axis?s:r,c="x"===a.axis?s:r,d=[];let u,h,p,f;for(u=n,h=n+i;u<h;++u)f=e[u],p={},p[o.axis]=o.parse(_(f,l),u),d.push(_o(_(f,c),p,a,u));return d}updateRangeFromParsed(t,e,n,i){super.updateRangeFromParsed(t,e,n,i);const o=n._custom;o&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,o.min),t.max=Math.max(t.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:i}=e,o=this.getParsed(t),a=o._custom,s=So(a)?"["+a.start+", "+a.end+"]":""+i.getLabelForValue(o[i.axis]);return{label:""+n.getLabelForValue(o[n.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,o){const a="reset"===o,{index:s,_cachedMeta:{vScale:r}}=this,l=r.getBasePixel(),c=r.isHorizontal(),d=this._getRuler(),{sharedOptions:u,includeOptions:h}=this._getSharedOptions(e,o);for(let p=e;p<e+n;p++){const e=this.getParsed(p),n=a||i(e[r.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),f=this._calculateBarIndexPixels(p,d),m=(e._stacks||{})[r.axis],g={horizontal:c,base:n.base,enableBorderRadius:!m||So(e._custom)||s===m._top||s===m._bottom,x:c?n.head:f.center,y:c?f.center:n.head,height:c?f.size:Math.abs(n.size),width:c?Math.abs(n.size):f.size};h&&(g.options=u||this.resolveDataElementOptions(p,t[p].active?"active":o));const v=g.options||t[p].options;To(g,v,m,s),Do(g,v,d.ratio),this.updateElement(t[p],p,g,o)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,o=n.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),a=n.options.stacked,s=[],r=t=>{const n=t.controller.getParsed(e),o=n&&n[t.vScale.axis];if(i(o)||isNaN(o))return!0};for(const n of o)if((void 0===e||!r(n))&&((!1===a||-1===s.indexOf(n.stack)||void 0===a&&void 0===n.stack)&&s.push(n.stack),n.index===t))break;return s.length||s.push(void 0),s}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const i=this._getStacks(t,n),o=void 0!==e?i.indexOf(e):-1;return-1===o?i.length-1:o}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,i=[];let o,a;for(o=0,a=e.data.length;o<a;++o)i.push(n.getPixelForValue(this.getParsed(o)[n.axis],o));const s=t.barThickness;return{min:s||xo(e),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:s?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n,index:o},options:{base:a,minBarLength:s}}=this,r=a||0,l=this.getParsed(t),c=l._custom,d=So(c);let u,h,p=l[e.axis],f=0,m=n?this.applyStack(e,l,n):p;m!==p&&(f=m-p,m=p),d&&(p=c.barStart,m=c.barEnd-c.barStart,0!==p&&j(p)!==j(c.barEnd)&&(f=0),f+=p);const g=i(a)||d?f:a;let v=e.getPixelForValue(g);if(u=this.chart.getDataVisibility(t)?e.getPixelForValue(f+m):v,h=u-v,Math.abs(h)<s){h=function(t,e,n){return 0!==t?j(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}(h,e,r)*s,p===r&&(v-=h/2);const t=e.getPixelForDecimal(0),i=e.getPixelForDecimal(1),a=Math.min(t,i),c=Math.max(t,i);v=Math.max(Math.min(v,c),a),u=v+h,n&&!d&&(l._stacks[e.axis]._visualValues[o]=e.getValueForPixel(u)-e.getValueForPixel(v))}if(v===e.getPixelForValue(r)){const t=j(h)*e.getLineWidthForValue(r)/2;v+=t,h-=t}return{size:h,base:v,head:u,center:u+h/2}}_calculateBarIndexPixels(t,e){const n=e.scale,o=this.options,a=o.skipNull,s=l(o.maxBarThickness,1/0);let r,c;if(e.grouped){const n=a?this._getStackCount(t):e.stackCount,l="flex"===o.barThickness?function(t,e,n,i){const o=e.pixels,a=o[t];let s=t>0?o[t-1]:null,r=t<o.length-1?o[t+1]:null;const l=n.categoryPercentage;null===s&&(s=a-(null===r?e.end-e.start:r-a)),null===r&&(r=a+a-s);const c=a-(a-Math.min(s,r))/2*l;return{chunk:Math.abs(r-s)/2*l/i,ratio:n.barPercentage,start:c}}(t,e,o,n):function(t,e,n,o){const a=n.barThickness;let s,r;return i(a)?(s=e.min*n.categoryPercentage,r=n.barPercentage):(s=a*o,r=1),{chunk:s/o,ratio:r,start:e.pixels[t]-s/2}}(t,e,o,n),d=this._getStackIndex(this.index,this._cachedMeta.stack,a?t:void 0);r=l.start+l.chunk*d+l.chunk/2,c=Math.min(s,l.chunk*l.ratio)}else r=n.getPixelForValue(this.getParsed(t)[n.axis],t),c=Math.min(s,e.min*e.ratio);return{base:r-c/2,head:r+c/2,center:r,size:c}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,i=n.length;let o=0;for(;o<i;++o)null!==this.getParsed(o)[e.axis]&&n[o].draw(this._ctx)}},BubbleController:class extends Ii{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,n,i){const o=super.parsePrimitiveData(t,e,n,i);for(let t=0;t<o.length;t++)o[t]._custom=this.resolveDataElementOptions(t+n).radius;return o}parseArrayData(t,e,n,i){const o=super.parseArrayData(t,e,n,i);for(let t=0;t<o.length;t++){const i=e[n+t];o[t]._custom=l(i[2],this.resolveDataElementOptions(t+n).radius)}return o}parseObjectData(t,e,n,i){const o=super.parseObjectData(t,e,n,i);for(let t=0;t<o.length;t++){const i=e[n+t];o[t]._custom=l(i&&i.r&&+i.r,this.resolveDataElementOptions(t+n).radius)}return o}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:o}=e,a=this.getParsed(t),s=i.getLabelForValue(a.x),r=o.getLabelForValue(a.y),l=a._custom;return{label:n[t]||"",value:"("+s+", "+r+(l?", "+l:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,n,i){const o="reset"===i,{iScale:a,vScale:s}=this._cachedMeta,{sharedOptions:r,includeOptions:l}=this._getSharedOptions(e,i),c=a.axis,d=s.axis;for(let u=e;u<e+n;u++){const e=t[u],n=!o&&this.getParsed(u),h={},p=h[c]=o?a.getPixelForDecimal(.5):a.getPixelForValue(n[c]),f=h[d]=o?s.getBasePixel():s.getPixelForValue(n[d]);h.skip=isNaN(p)||isNaN(f),l&&(h.options=r||this.resolveDataElementOptions(u,e.active?"active":i),o&&(h.options.radius=0)),this.updateElement(e,u,h,i)}}resolveDataElementOptions(t,e){const n=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const o=i.radius;return"active"!==e&&(i.radius=0),i.radius+=l(n&&n._custom,o),i}},DoughnutController:Oo,LineController:class extends Ii{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:n,data:i=[],_dataset:o}=e,a=this.chart._animationsDisabled;let{start:s,count:r}=mt(e,i,a);this._drawStart=s,this._drawCount=r,gt(e)&&(s=0,r=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!o._decimated,n.points=i;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:l},t),this.updateElements(i,s,r,t)}updateElements(t,e,n,o){const a="reset"===o,{iScale:s,vScale:r,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:d,includeOptions:u}=this._getSharedOptions(e,o),h=s.axis,p=r.axis,{spanGaps:f,segment:m}=this.options,g=W(f)?f:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||a||"none"===o,b=e+n,y=t.length;let w=e>0&&this.getParsed(e-1);for(let n=0;n<y;++n){const f=t[n],y=v?f:{};if(n<e||n>=b){y.skip=!0;continue}const x=this.getParsed(n),_=i(x[p]),k=y[h]=s.getPixelForValue(x[h],n),S=y[p]=a||_?r.getBasePixel():r.getPixelForValue(l?this.applyStack(r,x,l):x[p],n);y.skip=isNaN(k)||isNaN(S)||_,y.stop=n>0&&Math.abs(x[h]-w[h])>g,m&&(y.parsed=x,y.raw=c.data[n]),u&&(y.options=d||this.resolveDataElementOptions(n,f.active?"active":o)),v||this.updateElement(f,n,y,o),w=x}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,n=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const o=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,o,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}},PolarAreaController:Eo,PieController:class extends Oo{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}},RadarController:class extends Ii{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,n=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(n[e.axis])}}parseObjectData(t,e,n,i){return Je.bind(this)(t,e,n,i)}update(t){const e=this._cachedMeta,n=e.dataset,i=e.data||[],o=e.iScale.getLabels();if(n.points=i,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const a={_loop:!0,_fullLoop:o.length===i.length,options:e};this.updateElement(n,void 0,a,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,n,i){const o=this._cachedMeta.rScale,a="reset"===i;for(let s=e;s<e+n;s++){const e=t[s],n=this.resolveDataElementOptions(s,e.active?"active":i),r=o.getPointPositionForValue(s,this.getParsed(s).r),l=a?o.xCenter:r.x,c=a?o.yCenter:r.y,d={x:l,y:c,angle:r.angle,skip:isNaN(l)||isNaN(c),options:n};this.updateElement(e,s,d,i)}}},ScatterController:class extends Ii{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:o}=e,a=this.getParsed(t),s=i.getLabelForValue(a.x),r=o.getLabelForValue(a.y);return{label:n[t]||"",value:"("+s+", "+r+")"}}update(t){const e=this._cachedMeta,{data:n=[]}=e,i=this.chart._animationsDisabled;let{start:o,count:a}=mt(e,n,i);if(this._drawStart=o,this._drawCount=a,gt(e)&&(o=0,a=n.length),this.options.showLine){const{dataset:o,_dataset:a}=e;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!a._decimated,o.points=n;const s=this.resolveDatasetElementOptions(t);s.segment=this.options.segment,this.updateElement(o,void 0,{animated:!i,options:s},t)}this.updateElements(n,o,a,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,n,o){const a="reset"===o,{iScale:s,vScale:r,_stacked:l,_dataset:c}=this._cachedMeta,d=this.resolveDataElementOptions(e,o),u=this.getSharedOptions(d),h=this.includeOptions(o,u),p=s.axis,f=r.axis,{spanGaps:m,segment:g}=this.options,v=W(m)?m:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||a||"none"===o;let y=e>0&&this.getParsed(e-1);for(let d=e;d<e+n;++d){const e=t[d],n=this.getParsed(d),m=b?e:{},w=i(n[f]),x=m[p]=s.getPixelForValue(n[p],d),_=m[f]=a||w?r.getBasePixel():r.getPixelForValue(l?this.applyStack(r,n,l):n[f],d);m.skip=isNaN(x)||isNaN(_)||w,m.stop=d>0&&Math.abs(n[p]-y[p])>v,g&&(m.parsed=n,m.raw=c.data[d]),h&&(m.options=u||this.resolveDataElementOptions(d,e.active?"active":o)),b||this.updateElement(e,d,m,o),y=n}this.updateSharedOptions(u,o,d)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}const n=t.dataset,i=n.options&&n.options.borderWidth||0;if(!e.length)return i;const o=e[0].size(this.resolveDataElementOptions(0)),a=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,o,a)/2}}});function Io(t,e,n,i){return{x:n+t*Math.cos(e),y:i+t*Math.sin(e)}}function Po(t,e,n,i,o,a){const{x:s,y:r,startAngle:l,pixelMargin:c,innerRadius:d}=e,u=Math.max(e.outerRadius+i+n-c,0),h=d>0?d+i+n+c:0;let p=0;const f=o-l;if(i){const t=((d>0?d-i:0)+(u>0?u-i:0))/2;p=(f-(0!==t?f*t/(t+i):f))/2}const m=(f-Math.max(.001,f*u-n/D)/u)/2,g=l+m+p,v=o-m-p,{outerStart:b,outerEnd:y,innerStart:w,innerEnd:x}=function(t,e,n,i){const o=mn(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),a=(n-e)/2,s=Math.min(a,i*e/2),r=t=>{const e=(n-Math.min(a,t))*i/2;return K(t,0,Math.min(a,e))};return{outerStart:r(o.outerStart),outerEnd:r(o.outerEnd),innerStart:K(o.innerStart,0,s),innerEnd:K(o.innerEnd,0,s)}}(e,h,u,v-g),_=u-b,k=u-y,S=g+b/_,T=v-y/k,C=h+w,M=h+x,O=g+w/C,E=v-x/M;if(t.beginPath(),a){const e=(S+T)/2;if(t.arc(s,r,u,S,e),t.arc(s,r,u,e,T),y>0){const e=Io(k,T,s,r);t.arc(e.x,e.y,y,T,v+P)}const n=Io(M,v,s,r);if(t.lineTo(n.x,n.y),x>0){const e=Io(M,E,s,r);t.arc(e.x,e.y,x,v+P,E+Math.PI)}const i=(v-x/h+(g+w/h))/2;if(t.arc(s,r,h,v-x/h,i,!0),t.arc(s,r,h,i,g+w/h,!0),w>0){const e=Io(C,O,s,r);t.arc(e.x,e.y,w,O+Math.PI,g-P)}const o=Io(_,g,s,r);if(t.lineTo(o.x,o.y),b>0){const e=Io(_,S,s,r);t.arc(e.x,e.y,b,g-P,S)}}else{t.moveTo(s,r);const e=Math.cos(S)*u+s,n=Math.sin(S)*u+r;t.lineTo(e,n);const i=Math.cos(T)*u+s,o=Math.sin(T)*u+r;t.lineTo(i,o)}t.closePath()}function Lo(t,e,n=e){t.lineCap=l(n.borderCapStyle,e.borderCapStyle),t.setLineDash(l(n.borderDash,e.borderDash)),t.lineDashOffset=l(n.borderDashOffset,e.borderDashOffset),t.lineJoin=l(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=l(n.borderWidth,e.borderWidth),t.strokeStyle=l(n.borderColor,e.borderColor)}function No(t,e,n){t.lineTo(n.x,n.y)}function Ro(t,e,n={}){const i=t.length,{start:o=0,end:a=i-1}=n,{start:s,end:r}=e,l=Math.max(o,s),c=Math.min(a,r),d=o<s&&a<s||o>r&&a>r;return{count:i,start:l,loop:e.loop,ilen:c<l&&!d?i+c-l:c-l}}function jo(t,e,n,i){const{points:o,options:a}=e,{count:s,start:r,loop:l,ilen:c}=Ro(o,n,i),d=function(t){return t.stepped?Ae:t.tension||"monotone"===t.cubicInterpolationMode?Ie:No}(a);let u,h,p,{move:f=!0,reverse:m}=i||{};for(u=0;u<=c;++u)h=o[(r+(m?c-u:u))%s],h.skip||(f?(t.moveTo(h.x,h.y),f=!1):d(t,p,h,m,a.stepped),p=h);return l&&(h=o[(r+(m?c:0))%s],d(t,p,h,m,a.stepped)),!!l}function $o(t,e,n,i){const o=e.points,{count:a,start:s,ilen:r}=Ro(o,n,i),{move:l=!0,reverse:c}=i||{};let d,u,h,p,f,m,g=0,v=0;const b=t=>(s+(c?r-t:t))%a,y=()=>{p!==f&&(t.lineTo(g,f),t.lineTo(g,p),t.lineTo(g,m))};for(l&&(u=o[b(0)],t.moveTo(u.x,u.y)),d=0;d<=r;++d){if(u=o[b(d)],u.skip)continue;const e=u.x,n=u.y,i=0|e;i===h?(n<p?p=n:n>f&&(f=n),g=(v*g+e)/++v):(y(),t.lineTo(e,n),h=i,v=0,p=f=n),m=n}y()}function Bo(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||n?jo:$o}const Ho="function"==typeof Path2D;class Wo extends Pi{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;on(this._points,n,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=En(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,i=t[e],o=this.points,a=On(this,{property:e,start:i,end:i});if(!a.length)return;const s=[],r=function(t){return t.stepped?dn:t.tension||"monotone"===t.cubicInterpolationMode?un:cn}(n);let l,c;for(l=0,c=a.length;l<c;++l){const{start:c,end:d}=a[l],u=o[c],h=o[d];if(u===h){s.push(u);continue}const p=r(u,h,Math.abs((i-u[e])/(h[e]-u[e])),n.stepped);p[e]=t[e],s.push(p)}return 1===s.length?s[0]:s}pathSegment(t,e,n){return Bo(this)(t,this,e,n)}path(t,e,n){const i=this.segments,o=Bo(this);let a=this._loop;e=e||0,n=n||this.points.length-e;for(const s of i)a&=o(t,this,s,{start:e,end:e+n-1});return!!a}draw(t,e,n,i){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(t.save(),function(t,e,n,i){Ho&&!e.options.segment?function(t,e,n,i){let o=e._path;o||(o=e._path=new Path2D,e.path(o,n,i)&&o.closePath()),Lo(t,e.options),t.stroke(o)}(t,e,n,i):function(t,e,n,i){const{segments:o,options:a}=e,s=Bo(e);for(const r of o)Lo(t,a,r.style),t.beginPath(),s(t,e,r,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}(t,e,n,i)}(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Fo(t,e,n,i){const o=t.options,{[n]:a}=t.getProps([n],i);return Math.abs(e-a)<o.radius+o.hitRadius}function Uo(t,e){const{x:n,y:i,base:o,width:a,height:s}=t.getProps(["x","y","base","width","height"],e);let r,l,c,d,u;return t.horizontal?(u=s/2,r=Math.min(n,o),l=Math.max(n,o),c=i-u,d=i+u):(u=a/2,r=n-u,l=n+u,c=Math.min(i,o),d=Math.max(i,o)),{left:r,top:c,right:l,bottom:d}}function Vo(t,e,n,i){return t?0:K(e,n,i)}function zo(t){const e=Uo(t),n=e.right-e.left,i=e.bottom-e.top,o=function(t,e,n){const i=t.options.borderWidth,o=t.borderSkipped,a=gn(i);return{t:Vo(o.top,a.top,0,n),r:Vo(o.right,a.right,0,e),b:Vo(o.bottom,a.bottom,0,n),l:Vo(o.left,a.left,0,e)}}(t,n/2,i/2),s=function(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),o=t.options.borderRadius,s=vn(o),r=Math.min(e,n),l=t.borderSkipped,c=i||a(o);return{topLeft:Vo(!c||l.top||l.left,s.topLeft,0,r),topRight:Vo(!c||l.top||l.right,s.topRight,0,r),bottomLeft:Vo(!c||l.bottom||l.left,s.bottomLeft,0,r),bottomRight:Vo(!c||l.bottom||l.right,s.bottomRight,0,r)}}(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:s},inner:{x:e.left+o.l,y:e.top+o.t,w:n-o.l-o.r,h:i-o.t-o.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(o.t,o.l)),topRight:Math.max(0,s.topRight-Math.max(o.t,o.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(o.b,o.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(o.b,o.r))}}}}function qo(t,e,n,i){const o=null===e,a=null===n,s=t&&!(o&&a)&&Uo(t,i);return s&&(o||tt(e,s.left,s.right))&&(a||tt(n,s.top,s.bottom))}function Yo(t,e){t.rect(e.x,e.y,e.w,e.h)}function Go(t,e,n={}){const i=t.x!==n.x?-e:0,o=t.y!==n.y?-e:0,a=(t.x+t.w!==n.x+n.w?e:0)-i,s=(t.y+t.h!==n.y+n.h?e:0)-o;return{x:t.x+i,y:t.y+o,w:t.w+a,h:t.h+s,radius:t.radius}}var Xo=Object.freeze({__proto__:null,ArcElement:class extends Pi{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.getProps(["x","y"],n),{angle:o,distance:a}=Y(i,{x:t,y:e}),{startAngle:s,endAngle:r,innerRadius:c,outerRadius:d,circumference:u}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),h=this.options.spacing/2,p=l(u,r-s)>=O||Q(o,s,r),f=tt(a,c+h,d+h);return p&&f}getCenterPoint(t){const{x:e,y:n,startAngle:i,endAngle:o,innerRadius:a,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:r,spacing:l}=this.options,c=(i+o)/2,d=(a+s+l+r)/2;return{x:e+Math.cos(c)*d,y:n+Math.sin(c)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:n}=this,i=(e.offset||0)/4,o=(e.spacing||0)/2,a=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=n>O?Math.floor(n/O):0,0===n||this.innerRadius<0||this.outerRadius<0)return;t.save();const s=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(s)*i,Math.sin(s)*i);const r=i*(1-Math.sin(Math.min(D,n||0)));t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,function(t,e,n,i,o){const{fullCircles:a,startAngle:s,circumference:r}=e;let l=e.endAngle;if(a){Po(t,e,n,i,l,o);for(let e=0;e<a;++e)t.fill();isNaN(r)||(l=s+(r%O||O))}Po(t,e,n,i,l,o),t.fill()}(t,this,r,o,a),function(t,e,n,i,o){const{fullCircles:a,startAngle:s,circumference:r,options:l}=e,{borderWidth:c,borderJoinStyle:d}=l,u="inner"===l.borderAlign;if(!c)return;u?(t.lineWidth=2*c,t.lineJoin=d||"round"):(t.lineWidth=c,t.lineJoin=d||"bevel");let h=e.endAngle;if(a){Po(t,e,n,i,h,o);for(let e=0;e<a;++e)t.stroke();isNaN(r)||(h=s+(r%O||O))}u&&function(t,e,n){const{startAngle:i,pixelMargin:o,x:a,y:s,outerRadius:r,innerRadius:l}=e;let c=o/r;t.beginPath(),t.arc(a,s,r,i-c,n+c),l>o?(c=o/l,t.arc(a,s,l,n+c,i-c,!0)):t.arc(a,s,o,n+P,i-P),t.closePath(),t.clip()}(t,e,h),a||(Po(t,e,n,i,h,o),t.stroke())}(t,this,r,o,a),t.restore()}},LineElement:Wo,PointElement:class extends Pi{static id="point";static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.options,{x:o,y:a}=this.getProps(["x","y"],n);return Math.pow(t-o,2)+Math.pow(e-a,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return Fo(this,t,"x",e)}inYRange(t,e){return Fo(this,t,"y",e)}getCenterPoint(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}size(t){let e=(t=t||this.options||{}).radius||0;return e=Math.max(e,e&&t.hoverRadius||0),2*(e+(e&&t.borderWidth||0))}draw(t,e){const n=this.options;this.skip||n.radius<.1||!De(this,e,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,Ce(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}},BarElement:class extends Pi{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:i}}=this,{inner:o,outer:a}=zo(this),s=(r=a.radius).topLeft||r.topRight||r.bottomLeft||r.bottomRight?Re:Yo;var r;t.save(),a.w===o.w&&a.h===o.h||(t.beginPath(),s(t,Go(a,e,o)),t.clip(),s(t,Go(o,-e,a)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),s(t,Go(o,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,n){return qo(this,t,e,n)}inXRange(t,e){return qo(this,t,null,e)}inYRange(t,e){return qo(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:i,horizontal:o}=this.getProps(["x","y","base","horizontal"],t);return{x:o?(e+i)/2:e,y:o?n:(n+i)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}});function Jo(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}function Qo(t,e,{horizontal:n,minRotation:i}){const o=V(i),a=(n?Math.sin(o):Math.cos(o))||.001,s=.75*e*(""+t).length;return Math.min(e/a,s)}class Ko extends Ui{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return i(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:o}=this;const a=t=>i=e?i:t,s=t=>o=n?o:t;if(t){const t=j(i),e=j(o);t<0&&e<0?s(0):t>0&&e>0&&a(0)}if(i===o){let e=0===o?1:Math.abs(.05*o);s(o+e),t||a(i-e)}this.min=i,this.max=o}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:n,stepSize:i}=t;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const o=function(t,e){const n=[],{bounds:o,step:a,min:s,max:r,precision:l,count:c,maxTicks:d,maxDigits:u,includeBounds:h}=t,p=a||1,f=d-1,{min:m,max:g}=e,v=!i(s),b=!i(r),y=!i(c),w=(g-m)/(u+1);let x,_,k,S,T=B((g-m)/f/p)*p;if(T<1e-14&&!v&&!b)return[{value:m},{value:g}];S=Math.ceil(g/T)-Math.floor(m/T),S>f&&(T=B(S*T/f/p)*p),i(l)||(x=Math.pow(10,l),T=Math.ceil(T*x)/x),"ticks"===o?(_=Math.floor(m/T)*T,k=Math.ceil(g/T)*T):(_=m,k=g),v&&b&&a&&F((r-s)/a,T/1e3)?(S=Math.round(Math.min((r-s)/T,d)),T=(r-s)/S,_=s,k=r):y?(_=v?s:_,k=b?r:k,S=c-1,T=(k-_)/S):(S=(k-_)/T,S=$(S,Math.round(S),T/1e3)?Math.round(S):Math.ceil(S));const C=Math.max(q(T),q(_));x=Math.pow(10,i(l)?C:l),_=Math.round(_*x)/x,k=Math.round(k*x)/x;let M=0;for(v&&(h&&_!==s?(n.push({value:s}),_<s&&M++,$(Math.round((_+M*T)*x)/x,s,Qo(s,w,t))&&M++):_<s&&M++);M<S;++M)n.push({value:Math.round((_+M*T)*x)/x});return b&&h&&k!==r?n.length&&$(n[n.length-1].value,r,Qo(r,w,t))?n[n.length-1].value=r:n.push({value:r}):b&&k!==r||n.push({value:k}),n}({maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&U(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-e)/Math.max(t.length-1,1)/2;e-=i,n+=i}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return te(t,this.chart.options.locale,this.options.ticks.format)}}class Zo extends Ko{static id="linear";static defaults={ticks:{callback:ne.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=s(t)?t:0,this.max=s(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=V(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,o.lineHeight/i))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const ta=t=>Math.floor(R(t)),ea=(t,e)=>Math.pow(10,ta(t)+e);function na(t){return 1==t/Math.pow(10,ta(t))}function ia(t,e,n){const i=Math.pow(10,n),o=Math.floor(t/i);return Math.ceil(e/i)-o}class oa extends Ui{static id="logarithmic";static defaults={ticks:{callback:ne.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=Ko.prototype.parse.apply(this,[t,e]);if(0!==n)return s(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=s(t)?Math.max(0,t):null,this.max=s(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!s(this._userMin)&&(this.min=t===ea(this.min,0)?ea(this.min,-1):ea(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let n=this.min,i=this.max;const o=e=>n=t?n:e,a=t=>i=e?i:t;n===i&&(n<=0?(o(1),a(10)):(o(ea(n,-1)),a(ea(i,1)))),n<=0&&o(ea(i,-1)),i<=0&&a(ea(n,1)),this.min=n,this.max=i}buildTicks(){const t=this.options,e=function(t,{min:e,max:n}){e=r(t.min,e);const i=[],o=ta(e);let a=function(t,e){let n=ta(e-t);for(;ia(t,e,n)>10;)n++;for(;ia(t,e,n)<10;)n--;return Math.min(n,ta(t))}(e,n),s=a<0?Math.pow(10,Math.abs(a)):1;const l=Math.pow(10,a),c=o>a?Math.pow(10,o):0,d=Math.round((e-c)*s)/s,u=Math.floor((e-c)/l/10)*l*10;let h=Math.floor((d-u)/Math.pow(10,a)),p=r(t.min,Math.round((c+u+h*Math.pow(10,a))*s)/s);for(;p<n;)i.push({value:p,major:na(p),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(a++,h=2,s=a>=0?1:s),p=Math.round((c+u+h*Math.pow(10,a))*s)/s;const f=r(t.max,p);return i.push({value:f,major:na(f),significand:h}),i}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&U(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":te(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=R(t),this._valueRange=R(this.max)-R(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(R(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function aa(t){const e=t.ticks;if(e.display&&t.display){const t=bn(e.backdropPadding);return l(e.font&&e.font.size,re.font.size)+t.height}return 0}function sa(t,e,n,i,o){return t===i||t===o?{start:e-n/2,end:e+n/2}:t<i||t>o?{start:e-n,end:e}:{start:e,end:e+n}}function ra(t,e,n,i,o){const a=Math.abs(Math.sin(n)),s=Math.abs(Math.cos(n));let r=0,l=0;i.start<e.l?(r=(e.l-i.start)/a,t.l=Math.min(t.l,e.l-r)):i.end>e.r&&(r=(i.end-e.r)/a,t.r=Math.max(t.r,e.r+r)),o.start<e.t?(l=(e.t-o.start)/s,t.t=Math.min(t.t,e.t-l)):o.end>e.b&&(l=(o.end-e.b)/s,t.b=Math.max(t.b,e.b+l))}function la(t){return 0===t||180===t?"center":t<180?"left":"right"}function ca(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function da(t,e,n){return 90===n||270===n?t-=e/2:(n>270||n<90)&&(t-=e),t}function ua(t,e,n,i){const{ctx:o}=t;if(n)o.arc(t.xCenter,t.yCenter,e,0,O);else{let n=t.getPointPosition(0,e);o.moveTo(n.x,n.y);for(let a=1;a<i;a++)n=t.getPointPosition(a,e),o.lineTo(n.x,n.y)}}class ha extends Ko{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ne.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=bn(aa(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=s(t)&&!isNaN(t)?t:0,this.max=s(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/aa(this.options))}generateTickLabels(t){Ko.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const n=u(this.options.pointLabels.callback,[t,e],this);return n||0===n?n:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?function(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),i=[],a=[],s=t._pointLabels.length,r=t.options.pointLabels,l=r.centerPointLabels?D/s:0;for(let h=0;h<s;h++){const s=r.setContext(t.getPointLabelContext(h));a[h]=s.padding;const p=t.getPointPosition(h,t.drawingArea+a[h],l),f=yn(s.font),m=(c=t.ctx,d=f,u=o(u=t._pointLabels[h])?u:[u],{w:ke(c,d.string,u),h:u.length*d.lineHeight});i[h]=m;const g=J(t.getIndexAngle(h)+l),v=Math.round(z(g));ra(n,e,g,sa(v,p.x,m.w,0,180),sa(v,p.y,m.h,90,270))}var c,d,u;t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=function(t,e,n){const i=[],o=t._pointLabels.length,a=t.options,s=aa(a)/2,r=t.drawingArea,l=a.pointLabels.centerPointLabels?D/o:0;for(let a=0;a<o;a++){const o=t.getPointPosition(a,r+s+n[a],l),c=Math.round(z(J(o.angle+P))),d=e[a],u=da(o.y,d.h,c),h=la(c),p=ca(o.x,d.w,h);i.push({x:o.x,y:u,textAlign:h,left:p,top:u,right:p+d.w,bottom:u+d.h})}return i}(t,i,a)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,i))}getIndexAngle(t){return J(t*(O/(this._pointLabels.length||1))+V(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(i(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(i(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const n=e[t];return function(t,e,n){return _n(t,{label:n,index:e,type:"pointLabel"})}(this.getContext(),t,n)}}getPointPosition(t,e,n=0){const i=this.getIndexAngle(t)-P+n;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:i,bottom:o}=this._pointLabelItems[t];return{left:e,top:n,right:i,bottom:o}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),ua(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:n,grid:o,border:a}=e,s=this._pointLabels.length;let r,l,c;if(e.pointLabels.display&&function(t,e){const{ctx:n,options:{pointLabels:o}}=t;for(let a=e-1;a>=0;a--){const e=o.setContext(t.getPointLabelContext(a)),s=yn(e.font),{x:r,y:l,textAlign:c,left:d,top:u,right:h,bottom:p}=t._pointLabelItems[a],{backdropColor:f}=e;if(!i(f)){const t=vn(e.borderRadius),i=bn(e.backdropPadding);n.fillStyle=f;const o=d-i.left,a=u-i.top,s=h-d+i.width,r=p-u+i.height;Object.values(t).some((t=>0!==t))?(n.beginPath(),Re(n,{x:o,y:a,w:s,h:r,radius:t}),n.fill()):n.fillRect(o,a,s,r)}Pe(n,t._pointLabels[a],r,l+s.lineHeight/2,s,{color:e.color,textAlign:c,textBaseline:"middle"})}}(this,s),o.display&&this.ticks.forEach(((t,e)=>{if(0!==e){l=this.getDistanceFromCenterForValue(t.value);const n=this.getContext(e),i=o.setContext(n),r=a.setContext(n);!function(t,e,n,i,o){const a=t.ctx,s=e.circular,{color:r,lineWidth:l}=e;!s&&!i||!r||!l||n<0||(a.save(),a.strokeStyle=r,a.lineWidth=l,a.setLineDash(o.dash),a.lineDashOffset=o.dashOffset,a.beginPath(),ua(t,n,s,i),a.closePath(),a.stroke(),a.restore())}(this,i,l,s,r)}})),n.display){for(t.save(),r=s-1;r>=0;r--){const i=n.setContext(this.getPointLabelContext(r)),{color:o,lineWidth:a}=i;a&&o&&(t.lineWidth=a,t.strokeStyle=o,t.setLineDash(i.borderDash),t.lineDashOffset=i.borderDashOffset,l=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),c=this.getPointPosition(r,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let o,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((i,s)=>{if(0===s&&!e.reverse)return;const r=n.setContext(this.getContext(s)),l=yn(r.font);if(o=this.getDistanceFromCenterForValue(this.ticks[s].value),r.showLabelBackdrop){t.font=l.string,a=t.measureText(i.label).width,t.fillStyle=r.backdropColor;const e=bn(r.backdropPadding);t.fillRect(-a/2-e.left,-o-l.size/2-e.top,a+e.width,l.size+e.height)}Pe(t,i.label,0,-o,l,{color:r.color})})),t.restore()}drawTitle(){}}const pa={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},fa=Object.keys(pa);function ma(t,e){return t-e}function ga(t,e){if(i(e))return null;const n=t._adapter,{parser:o,round:a,isoWeekday:r}=t._parseOpts;let l=e;return"function"==typeof o&&(l=o(l)),s(l)||(l="string"==typeof o?n.parse(l,o):n.parse(l)),null===l?null:(a&&(l="week"!==a||!W(r)&&!0!==r?n.startOf(l,a):n.startOf(l,"isoWeek",r)),+l)}function va(t,e,n,i){const o=fa.length;for(let a=fa.indexOf(t);a<o-1;++a){const t=pa[fa[a]],o=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(o*t.size))<=i)return fa[a]}return fa[o-1]}function ba(t,e,n){if(n){if(n.length){const{lo:i,hi:o}=et(n,e);t[n[i]>=e?n[i]:n[o]]=!0}}else t[e]=!0}function ya(t,e,n){const i=[],o={},a=e.length;let s,r;for(s=0;s<a;++s)r=e[s],o[r]=s,i.push({value:r,major:!1});return 0!==a&&n?function(t,e,n,i){const o=t._adapter,a=+o.startOf(e[0].value,i),s=e[e.length-1].value;let r,l;for(r=a;r<=s;r=+o.add(r,1,i))l=n[r],l>=0&&(e[l].major=!0);return e}(t,i,o,n):i}class wa extends Ui{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const n=t.time||(t.time={}),i=this._adapter=new wo._date(t.adapters.date);i.init(e),b(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:ga(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:i,max:o,minDefined:a,maxDefined:r}=this.getUserBounds();function l(t){a||isNaN(t.min)||(i=Math.min(i,t.min)),r||isNaN(t.max)||(o=Math.max(o,t.max))}a&&r||(l(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||l(this.getMinMax(!1))),i=s(i)&&!isNaN(i)?i:+e.startOf(Date.now(),n),o=s(o)&&!isNaN(o)?o:+e.endOf(Date.now(),n)+1,this.min=Math.min(i,o-1),this.max=Math.max(i+1,o)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const o=this.min,a=ot(i,o,this.max);return this._unit=e.unit||(n.autoSkip?va(e.minUnit,this.min,this.max,this._getLabelCapacity(o)):function(t,e,n,i,o){for(let a=fa.length-1;a>=fa.indexOf(n);a--){const n=fa[a];if(pa[n].common&&t._adapter.diff(o,i,n)>=e-1)return n}return fa[n?fa.indexOf(n):0]}(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(t){for(let e=fa.indexOf(t)+1,n=fa.length;e<n;++e)if(pa[fa[e]].common)return fa[e]}(this._unit):void 0,this.initOffsets(i),t.reverse&&a.reverse(),ya(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t=[]){let e,n,i=0,o=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),i=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,n=this.getDecimalForValue(t[t.length-1]),o=1===t.length?n:(n-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;i=K(i,0,a),o=K(o,0,a),this._offsets={start:i,end:o,factor:1/(i+1+o)}}_generate(){const t=this._adapter,e=this.min,n=this.max,i=this.options,o=i.time,a=o.unit||va(o.minUnit,e,n,this._getLabelCapacity(e)),s=l(i.ticks.stepSize,1),r="week"===a&&o.isoWeekday,c=W(r)||!0===r,d={};let u,h,p=e;if(c&&(p=+t.startOf(p,"isoWeek",r)),p=+t.startOf(p,c?"day":a),t.diff(n,e,a)>1e5*s)throw new Error(e+" and "+n+" are too far apart with stepSize of "+s+" "+a);const f="data"===i.ticks.source&&this.getDataTimestamps();for(u=p,h=0;u<n;u=+t.add(u,s,a),h++)ba(d,u,f);return u!==n&&"ticks"!==i.bounds&&1!==h||ba(d,u,f),Object.keys(d).sort(((t,e)=>t-e)).map((t=>+t))}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}format(t,e){const n=this.options.time.displayFormats,i=this._unit,o=e||n[i];return this._adapter.format(t,o)}_tickFormatFunction(t,e,n,i){const o=this.options,a=o.ticks.callback;if(a)return u(a,[t,e,n],this);const s=o.time.displayFormats,r=this._unit,l=this._majorUnit,c=r&&s[r],d=l&&s[l],h=n[e],p=l&&d&&h&&h.major;return this._adapter.format(t,i||(p?d:c))}generateTickLabels(t){let e,n,i;for(e=0,n=t.length;e<n;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,i=V(this.isHorizontal()?e.maxRotation:e.minRotation),o=Math.cos(i),a=Math.sin(i),s=this._resolveTickFontOptions(0).size;return{w:n*o+s*a,h:n*a+s*o}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,i=n[e.unit]||n.millisecond,o=this._tickFormatFunction(t,0,ya(this,[t],this._majorUnit),i),a=this._getLabelSize(o),s=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return s>0?s:1}getDataTimestamps(){let t,e,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,e=i.length;t<e;++t)n=n.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const i=this.getLabels();for(e=0,n=i.length;e<n;++e)t.push(ga(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return lt(t.sort(ma))}}function xa(t,e,n){let i,o,a,s,r=0,l=t.length-1;n?(e>=t[r].pos&&e<=t[l].pos&&({lo:r,hi:l}=nt(t,"pos",e)),({pos:i,time:a}=t[r]),({pos:o,time:s}=t[l])):(e>=t[r].time&&e<=t[l].time&&({lo:r,hi:l}=nt(t,"time",e)),({time:i,pos:a}=t[r]),({time:o,pos:s}=t[l]));const c=o-i;return c?a+(s-a)*(e-i)/c:a}var _a=Object.freeze({__proto__:null,CategoryScale:class extends Ui{static id="category";static defaults={ticks:{callback:Jo}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:n,label:i}of e)t[n]===i&&t.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(i(t))return null;const n=this.getLabels();return((t,e)=>null===t?null:K(Math.round(t),0,e))(e=isFinite(e)&&n[e]===t?e:function(t,e,n,i){const o=t.indexOf(e);return-1===o?((t,e,n,i)=>("string"==typeof e?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n))(t,e,n,i):o!==t.lastIndexOf(e)?n:o}(n,t,l(e,t),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(n=0),e||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,i=[];let o=this.getLabels();o=0===t&&e===o.length-1?o:o.slice(t,e+1),this._valueRange=Math.max(o.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let n=t;n<=e;n++)i.push({value:n});return i}getLabelForValue(t){return Jo.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}},LinearScale:Zo,LogarithmicScale:oa,RadialLinearScale:ha,TimeScale:wa,TimeSeriesScale:class extends wa{static id="timeseries";static defaults=wa.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=xa(e,this.min),this._tableRange=xa(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,i=[],o=[];let a,s,r,l,c;for(a=0,s=t.length;a<s;++a)l=t[a],l>=e&&l<=n&&i.push(l);if(i.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(a=0,s=i.length;a<s;++a)c=i[a+1],r=i[a-1],l=i[a],Math.round((c+r)/2)!==l&&o.push({time:l,pos:a/(s-1)});return o}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return t=e.length&&n.length?this.normalize(e.concat(n)):e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(xa(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return xa(this._table,n*this._tableRange+this._minPos,!0)}}});const ka=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Sa=ka.map((t=>t.replace("rgb(","rgba(").replace(")",", 0.5)")));function Ta(t){return ka[t%ka.length]}function Ca(t){return Sa[t%Sa.length]}function Ma(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}var Da={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,n){if(!n.enabled)return;const{data:{datasets:i},options:o}=t.config,{elements:a}=o;if(!n.forceOverride&&(Ma(i)||(s=o)&&(s.borderColor||s.backgroundColor)||a&&Ma(a)))return;var s;const r=function(t){let e=0;return(n,i)=>{const o=t.getDatasetMeta(i).controller;o instanceof Oo?e=function(t,e){return t.backgroundColor=t.data.map((()=>Ta(e++))),e}(n,e):o instanceof Eo?e=function(t,e){return t.backgroundColor=t.data.map((()=>Ca(e++))),e}(n,e):o&&(e=function(t,e){return t.borderColor=Ta(e),t.backgroundColor=Ca(e),++e}(n,e))}}(t);i.forEach(r)}};function Oa(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function Ea(t){t.data.datasets.forEach((t=>{Oa(t)}))}var Aa={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled)return void Ea(t);const o=t.width;t.data.datasets.forEach(((e,a)=>{const{_data:s,indexAxis:r}=e,l=t.getDatasetMeta(a),c=s||e.data;if("y"===wn([r,t.options.indexAxis]))return;if(!l.controller.supportsDecimation)return;const d=t.scales[l.xAxisID];if("linear"!==d.type&&"time"!==d.type)return;if(t.options.parsing)return;let u,{start:h,count:p}=function(t,e){const n=e.length;let i,o=0;const{iScale:a}=t,{min:s,max:r,minDefined:l,maxDefined:c}=a.getUserBounds();return l&&(o=K(nt(e,a.axis,s).lo,0,n-1)),i=c?K(nt(e,a.axis,r).hi+1,o,n)-o:n-o,{start:o,count:i}}(l,c);if(p<=(n.threshold||4*o))Oa(e);else{switch(i(s)&&(e._data=c,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),n.algorithm){case"lttb":u=function(t,e,n,i,o){const a=o.samples||i;if(a>=n)return t.slice(e,e+n);const s=[],r=(n-2)/(a-2);let l=0;const c=e+n-1;let d,u,h,p,f,m=e;for(s[l++]=t[m],d=0;d<a-2;d++){let i,o=0,a=0;const c=Math.floor((d+1)*r)+1+e,g=Math.min(Math.floor((d+2)*r)+1,n)+e,v=g-c;for(i=c;i<g;i++)o+=t[i].x,a+=t[i].y;o/=v,a/=v;const b=Math.floor(d*r)+1+e,y=Math.min(Math.floor((d+1)*r)+1,n)+e,{x:w,y:x}=t[m];for(h=p=-1,i=b;i<y;i++)p=.5*Math.abs((w-o)*(t[i].y-x)-(w-t[i].x)*(a-x)),p>h&&(h=p,u=t[i],f=i);s[l++]=u,m=f}return s[l++]=t[c],s}(c,h,p,o,n);break;case"min-max":u=function(t,e,n,o){let a,s,r,l,c,d,u,h,p,f,m=0,g=0;const v=[],b=e+n-1,y=t[e].x,w=t[b].x-y;for(a=e;a<e+n;++a){s=t[a],r=(s.x-y)/w*o,l=s.y;const e=0|r;if(e===c)l<p?(p=l,d=a):l>f&&(f=l,u=a),m=(g*m+s.x)/++g;else{const n=a-1;if(!i(d)&&!i(u)){const e=Math.min(d,u),i=Math.max(d,u);e!==h&&e!==n&&v.push({...t[e],x:m}),i!==h&&i!==n&&v.push({...t[i],x:m})}a>0&&n!==h&&v.push(t[n]),v.push(s),c=e,g=0,p=f=l,d=u=h=a}}return v}(c,h,p,o);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}e._decimated=u}}))},destroy(t){Ea(t)}};function Ia(t,e,n,i){if(i)return;let o=e[t],a=n[t];return"angle"===t&&(o=J(o),a=J(a)),{property:t,start:o,end:a}}function Pa(t,e,n){for(;e>t;e--){const t=n[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function La(t,e,n,i){return t&&e?i(t[n],e[n]):t?t[n]:e?e[n]:0}function Na(t,e){let n=[],i=!1;return o(t)?(i=!0,n=t):n=function(t,e){const{x:n=null,y:i=null}=t||{},o=e.points,a=[];return e.segments.forEach((({start:t,end:e})=>{e=Pa(t,e,o);const s=o[t],r=o[e];null!==i?(a.push({x:s.x,y:i}),a.push({x:r.x,y:i})):null!==n&&(a.push({x:n,y:s.y}),a.push({x:n,y:r.y}))})),a}(t,e),n.length?new Wo({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function Ra(t){return t&&!1!==t.fill}function ja(t,e,n){let i=t[e].fill;const o=[e];let a;if(!n)return i;for(;!1!==i&&-1===o.indexOf(i);){if(!s(i))return i;if(a=t[i],!a)return!1;if(a.visible)return i;o.push(i),i=a.fill}return!1}function $a(t,e,n){const i=function(t){const e=t.options,n=e.fill;let i=l(n&&n.target,n);return void 0===i&&(i=!!e.backgroundColor),!1!==i&&null!==i&&(!0===i?"origin":i)}(t);if(a(i))return!isNaN(i.value)&&i;let o=parseFloat(i);return s(o)&&Math.floor(o)===o?function(t,e,n,i){return"-"!==t&&"+"!==t||(n=e+n),!(n===e||n<0||n>=i)&&n}(i[0],e,o,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function Ba(t,e,n){const i=[];for(let o=0;o<n.length;o++){const a=n[o],{first:s,last:r,point:l}=Ha(a,e,"x");if(!(!l||s&&r))if(s)i.unshift(l);else if(t.push(l),!r)break}t.push(...i)}function Ha(t,e,n){const i=t.interpolate(e,n);if(!i)return{};const o=i[n],a=t.segments,s=t.points;let r=!1,l=!1;for(let t=0;t<a.length;t++){const e=a[t],i=s[e.start][n],c=s[e.end][n];if(tt(o,i,c)){r=o===i,l=o===c;break}}return{first:r,last:l,point:i}}class Wa{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:i,y:o,radius:a}=this;return e=e||{start:0,end:O},t.arc(i,o,a,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:i}=this,o=t.angle;return{x:e+Math.cos(o)*i,y:n+Math.sin(o)*i,angle:o}}}function Fa(t){const{chart:e,fill:n,line:i}=t;if(s(n))return function(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}(e,n);if("stack"===n)return function(t){const{scale:e,index:n,line:i}=t,o=[],a=i.segments,s=i.points,r=function(t,e){const n=[],i=t.getMatchingVisibleMetas("line");for(let t=0;t<i.length;t++){const o=i[t];if(o.index===e)break;o.hidden||n.unshift(o.dataset)}return n}(e,n);r.push(Na({x:null,y:e.bottom},i));for(let t=0;t<a.length;t++){const e=a[t];for(let t=e.start;t<=e.end;t++)Ba(o,s[t],r)}return new Wo({points:o,options:{}})}(t);if("shape"===n)return!0;const o=function(t){return(t.scale||{}).getPointPositionForValue?function(t){const{scale:e,fill:n}=t,i=e.options,o=e.getLabels().length,s=i.reverse?e.max:e.min,r=function(t,e,n){let i;return i="start"===t?n:"end"===t?e.options.reverse?e.min:e.max:a(t)?t.value:e.getBaseValue(),i}(n,e,s),l=[];if(i.grid.circular){const t=e.getPointPositionForValue(0,s);return new Wa({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(r)})}for(let t=0;t<o;++t)l.push(e.getPointPositionForValue(t,r));return l}(t):function(t){const{scale:e={},fill:n}=t,i=function(t,e){let n=null;return"start"===t?n=e.bottom:"end"===t?n=e.top:a(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}(n,e);if(s(i)){const t=e.isHorizontal();return{x:t?i:null,y:t?null:i}}return null}(t)}(t);return o instanceof Wa?o:Na(o,i)}function Ua(t,e,n){const i=Fa(e),{line:o,scale:a,axis:s}=e,r=o.options,l=r.fill,c=r.backgroundColor,{above:d=c,below:u=c}=l||{};i&&o.points.length&&(Oe(t,n),function(t,e){const{line:n,target:i,above:o,below:a,area:s,scale:r}=e,l=n._loop?"angle":e.axis;t.save(),"x"===l&&a!==o&&(Va(t,i,s.top),za(t,{line:n,target:i,color:o,scale:r,property:l}),t.restore(),t.save(),Va(t,i,s.bottom)),za(t,{line:n,target:i,color:a,scale:r,property:l}),t.restore()}(t,{line:o,target:i,above:d,below:u,area:n,scale:a,axis:s}),Ee(t))}function Va(t,e,n){const{segments:i,points:o}=e;let a=!0,s=!1;t.beginPath();for(const r of i){const{start:i,end:l}=r,c=o[i],d=o[Pa(i,l,o)];a?(t.moveTo(c.x,c.y),a=!1):(t.lineTo(c.x,n),t.lineTo(c.x,c.y)),s=!!e.pathSegment(t,r,{move:s}),s?t.closePath():t.lineTo(d.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function za(t,e){const{line:n,target:i,property:o,color:a,scale:s}=e,r=function(t,e,n){const i=t.segments,o=t.points,a=e.points,s=[];for(const t of i){let{start:i,end:r}=t;r=Pa(i,r,o);const l=Ia(n,o[i],o[r],t.loop);if(!e.segments){s.push({source:t,target:l,start:o[i],end:o[r]});continue}const c=On(e,l);for(const e of c){const i=Ia(n,a[e.start],a[e.end],e.loop),r=Dn(t,o,i);for(const t of r)s.push({source:t,target:e,start:{[n]:La(l,i,"start",Math.max)},end:{[n]:La(l,i,"end",Math.min)}})}}return s}(n,i,o);for(const{source:e,target:l,start:c,end:d}of r){const{style:{backgroundColor:r=a}={}}=e,u=!0!==i;t.save(),t.fillStyle=r,qa(t,s,u&&Ia(o,c,d)),t.beginPath();const h=!!n.pathSegment(t,e);let p;if(u){h?t.closePath():Ya(t,i,d,o);const e=!!i.pathSegment(t,l,{move:h,reverse:!0});p=h&&e,p||Ya(t,i,c,o)}t.closePath(),t.fill(p?"evenodd":"nonzero"),t.restore()}}function qa(t,e,n){const{top:i,bottom:o}=e.chart.chartArea,{property:a,start:s,end:r}=n||{};"x"===a&&(t.beginPath(),t.rect(s,i,r-s,o-i),t.clip())}function Ya(t,e,n,i){const o=e.interpolate(n,i);o&&t.lineTo(o.x,o.y)}var Ga={id:"filler",afterDatasetsUpdate(t,e,n){const i=(t.data.datasets||[]).length,o=[];let a,s,r,l;for(s=0;s<i;++s)a=t.getDatasetMeta(s),r=a.dataset,l=null,r&&r.options&&r instanceof Wo&&(l={visible:t.isDatasetVisible(s),index:s,fill:$a(r,s,i),chart:t,axis:a.controller.options.indexAxis,scale:a.vScale,line:r}),a.$filler=l,o.push(l);for(s=0;s<i;++s)l=o[s],l&&!1!==l.fill&&(l.fill=ja(o,s,n.propagate))},beforeDraw(t,e,n){const i="beforeDraw"===n.drawTime,o=t.getSortedVisibleDatasetMetas(),a=t.chartArea;for(let e=o.length-1;e>=0;--e){const n=o[e].$filler;n&&(n.line.updateControlPoints(a,n.axis),i&&n.fill&&Ua(t.ctx,n,a))}},beforeDatasetsDraw(t,e,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=t.getSortedVisibleDatasetMetas();for(let e=i.length-1;e>=0;--e){const n=i[e].$filler;Ra(n)&&Ua(t.ctx,n,t.chartArea)}},beforeDatasetDraw(t,e,n){const i=e.meta.$filler;Ra(i)&&"beforeDatasetDraw"===n.drawTime&&Ua(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Xa=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=t.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}};class Ja extends Pi{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=u(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,n)=>t.sort(e,n,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const n=t.labels,i=yn(n.font),o=i.size,a=this._computeTitleHeight(),{boxWidth:s,itemHeight:r}=Xa(n,o);let l,c;e.font=i.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(a,o,s,r)+10):(c=this.maxHeight,l=this._fitCols(a,i,s,r)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,i){const{ctx:o,maxWidth:a,options:{labels:{padding:s}}}=this,r=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+s;let d=t;o.textAlign="left",o.textBaseline="middle";let u=-1,h=-c;return this.legendItems.forEach(((t,p)=>{const f=n+e/2+o.measureText(t.text).width;(0===p||l[l.length-1]+f+2*s>a)&&(d+=c,l[l.length-(p>0?0:1)]=0,h+=c,u++),r[p]={left:0,top:h,row:u,width:f,height:i},l[l.length-1]+=f+s})),d}_fitCols(t,e,n,i){const{ctx:o,maxHeight:a,options:{labels:{padding:s}}}=this,r=this.legendHitBoxes=[],l=this.columnSizes=[],c=a-t;let d=s,u=0,h=0,p=0,f=0;return this.legendItems.forEach(((t,a)=>{const{itemWidth:m,itemHeight:g}=function(t,e,n,i,o){const a=function(t,e,n,i){let o=t.text;return o&&"string"!=typeof o&&(o=o.reduce(((t,e)=>t.length>e.length?t:e))),e+n.size/2+i.measureText(o).width}(i,t,e,n),s=function(t,e,n){let i=t;return"string"!=typeof e.text&&(i=Qa(e,n)),i}(o,i,e.lineHeight);return{itemWidth:a,itemHeight:s}}(n,e,o,t,i);a>0&&h+g+2*s>c&&(d+=u+s,l.push({width:u,height:h}),p+=u+s,f++,u=h=0),r[a]={left:p,top:h,col:f,width:m,height:g},u=Math.max(u,m),h+=g+s})),d+=u,l.push({width:u,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:i},rtl:o}}=this,a=kn(o,this.left,this.width);if(this.isHorizontal()){let o=0,s=pt(n,this.left+i,this.right-this.lineWidths[o]);for(const r of e)o!==r.row&&(o=r.row,s=pt(n,this.left+i,this.right-this.lineWidths[o])),r.top+=this.top+t+i,r.left=a.leftForLtr(a.x(s),r.width),s+=r.width+i}else{let o=0,s=pt(n,this.top+t+i,this.bottom-this.columnSizes[o].height);for(const r of e)r.col!==o&&(o=r.col,s=pt(n,this.top+t+i,this.bottom-this.columnSizes[o].height)),r.top=s,r.left+=this.left+i,r.left=a.leftForLtr(a.x(r.left),r.width),s+=r.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;Oe(t,this),this._draw(),Ee(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:i}=this,{align:o,labels:a}=t,s=re.color,r=kn(t.rtl,this.left,this.width),c=yn(a.font),{padding:d}=a,u=c.size,h=u/2;let p;this.drawTitle(),i.textAlign=r.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:f,boxHeight:m,itemHeight:g}=Xa(a,u),v=this.isHorizontal(),b=this._computeTitleHeight();p=v?{x:pt(o,this.left+d,this.right-n[0]),y:this.top+d+b,line:0}:{x:this.left+d,y:pt(o,this.top+b+d,this.bottom-e[0].height),line:0},Sn(this.ctx,t.textDirection);const y=g+d;this.legendItems.forEach(((w,x)=>{i.strokeStyle=w.fontColor,i.fillStyle=w.fontColor;const _=i.measureText(w.text).width,k=r.textAlign(w.textAlign||(w.textAlign=a.textAlign)),S=f+h+_;let T=p.x,C=p.y;if(r.setWidth(this.width),v?x>0&&T+S+d>this.right&&(C=p.y+=y,p.line++,T=p.x=pt(o,this.left+d,this.right-n[p.line])):x>0&&C+y>this.bottom&&(T=p.x=T+e[p.line].width+d,p.line++,C=p.y=pt(o,this.top+b+d,this.bottom-e[p.line].height)),function(t,e,n){if(isNaN(f)||f<=0||isNaN(m)||m<0)return;i.save();const o=l(n.lineWidth,1);if(i.fillStyle=l(n.fillStyle,s),i.lineCap=l(n.lineCap,"butt"),i.lineDashOffset=l(n.lineDashOffset,0),i.lineJoin=l(n.lineJoin,"miter"),i.lineWidth=o,i.strokeStyle=l(n.strokeStyle,s),i.setLineDash(l(n.lineDash,[])),a.usePointStyle){const s={radius:m*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:o},l=r.xPlus(t,f/2);Me(i,s,l,e+h,a.pointStyleWidth&&f)}else{const a=e+Math.max((u-m)/2,0),s=r.leftForLtr(t,f),l=vn(n.borderRadius);i.beginPath(),Object.values(l).some((t=>0!==t))?Re(i,{x:s,y:a,w:f,h:m,radius:l}):i.rect(s,a,f,m),i.fill(),0!==o&&i.stroke()}i.restore()}(r.x(T),C,w),T=ft(k,T+f+h,v?T+S:this.right,t.rtl),function(t,e,n){Pe(i,n.text,t,e+g/2,c,{strikethrough:n.hidden,textAlign:r.textAlign(n.textAlign)})}(r.x(T),C,w),v)p.x+=S+d;else if("string"!=typeof w.text){const t=c.lineHeight;p.y+=Qa(w,t)}else p.y+=y})),Tn(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=yn(e.font),i=bn(e.padding);if(!e.display)return;const o=kn(t.rtl,this.left,this.width),a=this.ctx,s=e.position,r=n.size/2,l=i.top+r;let c,d=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,d=pt(t.align,d,this.right-u);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);c=l+pt(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const h=pt(s,d,d+u);a.textAlign=o.textAlign(ht(s)),a.textBaseline="middle",a.strokeStyle=e.color,a.fillStyle=e.color,a.font=n.string,Pe(a,e.text,h,c,n)}_computeTitleHeight(){const t=this.options.title,e=yn(t.font),n=bn(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,i,o;if(tt(t,this.left,this.right)&&tt(e,this.top,this.bottom))for(o=this.legendHitBoxes,n=0;n<o.length;++n)if(i=o[n],tt(t,i.left,i.left+i.width)&&tt(e,i.top,i.top+i.height))return this.legendItems[n];return null}handleEvent(t){const e=this.options;if(!function(t,e){return!("mousemove"!==t&&"mouseout"!==t||!e.onHover&&!e.onLeave)||!(!e.onClick||"click"!==t&&"mouseup"!==t)}(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const a=this._hoveredItem,s=(o=n,null!==(i=a)&&null!==o&&i.datasetIndex===o.datasetIndex&&i.index===o.index);a&&!s&&u(e.onLeave,[t,a,this],this),this._hoveredItem=n,n&&!s&&u(e.onHover,[t,n,this],this)}else n&&u(e.onClick,[t,n,this],this);var i,o}}function Qa(t,e){return e*(t.text?t.text.length+.5:0)}var Ka={id:"legend",_element:Ja,start(t,e,n){const i=t.legend=new Ja({ctx:t.ctx,options:n,chart:t});Kn.configure(t,i,n),Kn.addBox(t,i)},stop(t){Kn.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;Kn.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,o=n.chart;o.isDatasetVisible(i)?(o.hide(i),e.hidden=!0):(o.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:o,color:a,useBorderRadius:s,borderRadius:r}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const l=t.controller.getStyle(n?0:void 0),c=bn(l.borderWidth);return{text:e[t.index].label,fillStyle:l.backgroundColor,fontColor:a,hidden:!t.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:o||l.textAlign,borderRadius:s&&(r||l.borderRadius),datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Za extends Pi{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const i=o(n.text)?n.text.length:1;this._padding=bn(n.padding);const a=i*yn(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:i,right:o,options:a}=this,s=a.align;let r,l,c,d=0;return this.isHorizontal()?(l=pt(s,n,o),c=e+t,r=o-n):("left"===a.position?(l=n+t,c=pt(s,i,e),d=-.5*D):(l=o-t,c=pt(s,e,i),d=.5*D),r=i-e),{titleX:l,titleY:c,maxWidth:r,rotation:d}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=yn(e.font),i=n.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:s,rotation:r}=this._drawArgs(i);Pe(t,e.text,0,0,n,{color:e.color,maxWidth:s,rotation:r,textAlign:ht(e.align),textBaseline:"middle",translation:[o,a]})}}var ts={id:"title",_element:Za,start(t,e,n){!function(t,e){const n=new Za({ctx:t.ctx,options:e,chart:t});Kn.configure(t,n,e),Kn.addBox(t,n),t.titleBlock=n}(t,n)},stop(t){const e=t.titleBlock;Kn.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;Kn.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const es=new WeakMap;var ns={id:"subtitle",start(t,e,n){const i=new Za({ctx:t.ctx,options:n,chart:t});Kn.configure(t,i,n),Kn.addBox(t,i),es.set(t,i)},stop(t){Kn.removeBox(t,es.get(t)),es.delete(t)},beforeUpdate(t,e,n){const i=es.get(t);Kn.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const is={average(t){if(!t.length)return!1;let e,n,i=0,o=0,a=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();i+=t.x,o+=t.y,++a}}return{x:i/a,y:o/a}},nearest(t,e){if(!t.length)return!1;let n,i,o,a=e.x,s=e.y,r=Number.POSITIVE_INFINITY;for(n=0,i=t.length;n<i;++n){const i=t[n].element;if(i&&i.hasValue()){const t=G(e,i.getCenterPoint());t<r&&(r=t,o=i)}}if(o){const t=o.tooltipPosition();a=t.x,s=t.y}return{x:a,y:s}}};function os(t,e){return e&&(o(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function as(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function ss(t,e){const{element:n,datasetIndex:i,index:o}=e,a=t.getDatasetMeta(i).controller,{label:s,value:r}=a.getLabelAndValue(o);return{chart:t,label:s,parsed:a.getParsed(o),raw:t.data.datasets[i].data[o],formattedValue:r,dataset:a.getDataset(),dataIndex:o,datasetIndex:i,element:n}}function rs(t,e){const n=t.chart.ctx,{body:i,footer:o,title:a}=t,{boxWidth:s,boxHeight:r}=e,l=yn(e.bodyFont),c=yn(e.titleFont),d=yn(e.footerFont),u=a.length,p=o.length,f=i.length,m=bn(e.padding);let g=m.height,v=0,b=i.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);b+=t.beforeBody.length+t.afterBody.length,u&&(g+=u*c.lineHeight+(u-1)*e.titleSpacing+e.titleMarginBottom),b&&(g+=f*(e.displayColors?Math.max(r,l.lineHeight):l.lineHeight)+(b-f)*l.lineHeight+(b-1)*e.bodySpacing),p&&(g+=e.footerMarginTop+p*d.lineHeight+(p-1)*e.footerSpacing);let y=0;const w=function(t){v=Math.max(v,n.measureText(t).width+y)};return n.save(),n.font=c.string,h(t.title,w),n.font=l.string,h(t.beforeBody.concat(t.afterBody),w),y=e.displayColors?s+2+e.boxPadding:0,h(i,(t=>{h(t.before,w),h(t.lines,w),h(t.after,w)})),y=0,n.font=d.string,h(t.footer,w),n.restore(),v+=m.width,{width:v,height:g}}function ls(t,e,n,i){const{x:o,width:a}=n,{width:s,chartArea:{left:r,right:l}}=t;let c="center";return"center"===i?c=o<=(r+l)/2?"left":"right":o<=a/2?c="left":o>=s-a/2&&(c="right"),function(t,e,n,i){const{x:o,width:a}=i,s=n.caretSize+n.caretPadding;return"left"===t&&o+a+s>e.width||"right"===t&&o-a-s<0||void 0}(c,t,e,n)&&(c="center"),c}function cs(t,e,n){const i=n.yAlign||e.yAlign||function(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}(t,n);return{xAlign:n.xAlign||e.xAlign||ls(t,e,n,i),yAlign:i}}function ds(t,e,n,i){const{caretSize:o,caretPadding:a,cornerRadius:s}=t,{xAlign:r,yAlign:l}=n,c=o+a,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=vn(s);let f=function(t,e){let{x:n,width:i}=t;return"right"===e?n-=i:"center"===e&&(n-=i/2),n}(e,r);const m=function(t,e,n){let{y:i,height:o}=t;return"top"===e?i+=n:i-="bottom"===e?o+n:o/2,i}(e,l,c);return"center"===l?"left"===r?f+=c:"right"===r&&(f-=c):"left"===r?f-=Math.max(d,h)+o:"right"===r&&(f+=Math.max(u,p)+o),{x:K(f,0,i.width-e.width),y:K(m,0,i.height-e.height)}}function us(t,e,n){const i=bn(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-i.right:t.x+i.left}function hs(t){return os([],as(t))}function ps(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const fs={beforeTitle:e,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:e,beforeBody:e,beforeLabel:e,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return i(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:e,afterBody:e,beforeFooter:e,footer:e,afterFooter:e};function ms(t,e,n,i){const o=t[e].call(n,i);return void 0===o?fs[e].call(n,i):o}class gs extends Pi{static positioners=is;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&e.options.animation&&n.animations,o=new wi(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=(this,_n(this.chart.getContext(),{tooltip:this,tooltipItems:this._tooltipItems,type:"tooltip"})))}getTitle(t,e){const{callbacks:n}=e,i=ms(n,"beforeTitle",this,t),o=ms(n,"title",this,t),a=ms(n,"afterTitle",this,t);let s=[];return s=os(s,as(i)),s=os(s,as(o)),s=os(s,as(a)),s}getBeforeBody(t,e){return hs(ms(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:n}=e,i=[];return h(t,(t=>{const e={before:[],lines:[],after:[]},o=ps(n,t);os(e.before,as(ms(o,"beforeLabel",this,t))),os(e.lines,ms(o,"label",this,t)),os(e.after,as(ms(o,"afterLabel",this,t))),i.push(e)})),i}getAfterBody(t,e){return hs(ms(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:n}=e,i=ms(n,"beforeFooter",this,t),o=ms(n,"footer",this,t),a=ms(n,"afterFooter",this,t);let s=[];return s=os(s,as(i)),s=os(s,as(o)),s=os(s,as(a)),s}_createItems(t){const e=this._active,n=this.chart.data,i=[],o=[],a=[];let s,r,l=[];for(s=0,r=e.length;s<r;++s)l.push(ss(this.chart,e[s]));return t.filter&&(l=l.filter(((e,i,o)=>t.filter(e,i,o,n)))),t.itemSort&&(l=l.sort(((e,i)=>t.itemSort(e,i,n)))),h(l,(e=>{const n=ps(t.callbacks,e);i.push(ms(n,"labelColor",this,e)),o.push(ms(n,"labelPointStyle",this,e)),a.push(ms(n,"labelTextColor",this,e))})),this.labelColors=i,this.labelPointStyles=o,this.labelTextColors=a,this.dataPoints=l,l}update(t,e){const n=this.options.setContext(this.getContext()),i=this._active;let o,a=[];if(i.length){const t=is[n.position].call(this,i,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const e=this._size=rs(this,n),s=Object.assign({},t,e),r=cs(this.chart,n,s),l=ds(n,s,r,this.chart);this.xAlign=r.xAlign,this.yAlign=r.yAlign,o={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(o={opacity:0});this._tooltipItems=a,this.$context=void 0,o&&this._resolveAnimations().update(this,o),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,i){const o=this.getCaretPosition(t,n,i);e.lineTo(o.x1,o.y1),e.lineTo(o.x2,o.y2),e.lineTo(o.x3,o.y3)}getCaretPosition(t,e,n){const{xAlign:i,yAlign:o}=this,{caretSize:a,cornerRadius:s}=n,{topLeft:r,topRight:l,bottomLeft:c,bottomRight:d}=vn(s),{x:u,y:h}=t,{width:p,height:f}=e;let m,g,v,b,y,w;return"center"===o?(y=h+f/2,"left"===i?(m=u,g=m-a,b=y+a,w=y-a):(m=u+p,g=m+a,b=y-a,w=y+a),v=m):(g="left"===i?u+Math.max(r,c)+a:"right"===i?u+p-Math.max(l,d)-a:this.caretX,"top"===o?(b=h,y=b-a,m=g-a,v=g+a):(b=h+f,y=b+a,m=g+a,v=g-a),w=b),{x1:m,x2:g,x3:v,y1:b,y2:y,y3:w}}drawTitle(t,e,n){const i=this.title,o=i.length;let a,s,r;if(o){const l=kn(n.rtl,this.x,this.width);for(t.x=us(this,n.titleAlign,n),e.textAlign=l.textAlign(n.titleAlign),e.textBaseline="middle",a=yn(n.titleFont),s=n.titleSpacing,e.fillStyle=n.titleColor,e.font=a.string,r=0;r<o;++r)e.fillText(i[r],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+s,r+1===o&&(t.y+=n.titleMarginBottom-s)}}_drawColorBox(t,e,n,i,o){const s=this.labelColors[n],r=this.labelPointStyles[n],{boxHeight:l,boxWidth:c,boxPadding:d}=o,u=yn(o.bodyFont),h=us(this,"left",o),p=i.x(h),f=l<u.lineHeight?(u.lineHeight-l)/2:0,m=e.y+f;if(o.usePointStyle){const e={radius:Math.min(c,l)/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:1},n=i.leftForLtr(p,c)+c/2,a=m+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,Ce(t,e,n,a),t.strokeStyle=s.borderColor,t.fillStyle=s.backgroundColor,Ce(t,e,n,a)}else{t.lineWidth=a(s.borderWidth)?Math.max(...Object.values(s.borderWidth)):s.borderWidth||1,t.strokeStyle=s.borderColor,t.setLineDash(s.borderDash||[]),t.lineDashOffset=s.borderDashOffset||0;const e=i.leftForLtr(p,c-d),n=i.leftForLtr(i.xPlus(p,1),c-d-2),r=vn(s.borderRadius);Object.values(r).some((t=>0!==t))?(t.beginPath(),t.fillStyle=o.multiKeyBackground,Re(t,{x:e,y:m,w:c,h:l,radius:r}),t.fill(),t.stroke(),t.fillStyle=s.backgroundColor,t.beginPath(),Re(t,{x:n,y:m+1,w:c-2,h:l-2,radius:r}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(e,m,c,l),t.strokeRect(e,m,c,l),t.fillStyle=s.backgroundColor,t.fillRect(n,m+1,c-2,l-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:i}=this,{bodySpacing:o,bodyAlign:a,displayColors:s,boxHeight:r,boxWidth:l,boxPadding:c}=n,d=yn(n.bodyFont);let u=d.lineHeight,p=0;const f=kn(n.rtl,this.x,this.width),m=function(n){e.fillText(n,f.x(t.x+p),t.y+u/2),t.y+=u+o},g=f.textAlign(a);let v,b,y,w,x,_,k;for(e.textAlign=a,e.textBaseline="middle",e.font=d.string,t.x=us(this,g,n),e.fillStyle=n.bodyColor,h(this.beforeBody,m),p=s&&"right"!==g?"center"===a?l/2+c:l+2+c:0,w=0,_=i.length;w<_;++w){for(v=i[w],b=this.labelTextColors[w],e.fillStyle=b,h(v.before,m),y=v.lines,s&&y.length&&(this._drawColorBox(e,t,w,f,n),u=Math.max(d.lineHeight,r)),x=0,k=y.length;x<k;++x)m(y[x]),u=d.lineHeight;h(v.after,m)}p=0,u=d.lineHeight,h(this.afterBody,m),t.y-=o}drawFooter(t,e,n){const i=this.footer,o=i.length;let a,s;if(o){const r=kn(n.rtl,this.x,this.width);for(t.x=us(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=r.textAlign(n.footerAlign),e.textBaseline="middle",a=yn(n.footerFont),e.fillStyle=n.footerColor,e.font=a.string,s=0;s<o;++s)e.fillText(i[s],r.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+n.footerSpacing}}drawBackground(t,e,n,i){const{xAlign:o,yAlign:a}=this,{x:s,y:r}=t,{width:l,height:c}=n,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:p}=vn(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(s+d,r),"top"===a&&this.drawCaret(t,e,n,i),e.lineTo(s+l-u,r),e.quadraticCurveTo(s+l,r,s+l,r+u),"center"===a&&"right"===o&&this.drawCaret(t,e,n,i),e.lineTo(s+l,r+c-p),e.quadraticCurveTo(s+l,r+c,s+l-p,r+c),"bottom"===a&&this.drawCaret(t,e,n,i),e.lineTo(s+h,r+c),e.quadraticCurveTo(s,r+c,s,r+c-h),"center"===a&&"left"===o&&this.drawCaret(t,e,n,i),e.lineTo(s,r+d),e.quadraticCurveTo(s,r,s+d,r),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,i=n&&n.x,o=n&&n.y;if(i||o){const n=is[t.position].call(this,this._active,this._eventPosition);if(!n)return;const a=this._size=rs(this,t),s=Object.assign({},n,this._size),r=cs(e,t,s),l=ds(t,s,r,e);i._to===l.x&&o._to===l.y||(this.xAlign=r.xAlign,this.yAlign=r.yAlign,this.width=a.width,this.height=a.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},o={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=bn(e.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&s&&(t.save(),t.globalAlpha=n,this.drawBackground(o,t,i,e),Sn(t,e.textDirection),o.y+=a.top,this.drawTitle(o,t,e),this.drawBody(o,t,e),this.drawFooter(o,t,e),Tn(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,i=t.map((({datasetIndex:t,index:e})=>{const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[e],index:e}})),o=!p(n,i),a=this._positionChanged(i,e);(o||a)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,o=this._active||[],a=this._getActiveElements(t,o,e,n),s=this._positionChanged(a,t),r=e||!p(a,o)||s;return r&&(this._active=a,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),r}_getActiveElements(t,e,n,i){const o=this.options;if("mouseout"===t.type)return[];if(!i)return e;const a=this.chart.getElementsAtEventForMode(t,o.mode,o,n);return o.reverse&&a.reverse(),a}_positionChanged(t,e){const{caretX:n,caretY:i,options:o}=this,a=is[o.position].call(this,t,e);return!1!==a&&(n!==a.x||i!==a.y)}}var vs={id:"tooltip",_element:gs,positioners:is,afterInit(t,e,n){n&&(t.tooltip=new gs({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fs},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};return go.register(Ao,_a,Xo,t),go.helpers={...Ln},go._adapters=wo,go.Animation=yi,go.Animations=wi,go.animator=vt,go.controllers=zi.controllers.items,go.DatasetController=Ii,go.Element=Pi,go.elements=Xo,go.Interaction=Hn,go.layouts=Kn,go.platforms=gi,go.Scale=Ui,go.Ticks=ne,Object.assign(go,Ao,_a,Xo,t,gi),go.Chart=go,"undefined"!=typeof window&&(window.Chart=go),go})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Chart)}(this,(function(t){"use strict";function e(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function n(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function i(t){n(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function o(t,o){n(2,arguments);var a=i(t),s=e(o);return isNaN(s)?new Date(NaN):s?(a.setDate(a.getDate()+s),a):a}function a(t,o){n(2,arguments);var a=i(t),s=e(o);if(isNaN(s))return new Date(NaN);if(!s)return a;var r=a.getDate(),l=new Date(a.getTime());return l.setMonth(a.getMonth()+s+1,0),r>=l.getDate()?l:(a.setFullYear(l.getFullYear(),l.getMonth(),r),a)}function s(t,o){n(2,arguments);var a=i(t).getTime(),s=e(o);return new Date(a+s)}var r=36e5;function l(t,o){n(1,arguments);var a=o||{},s=a.locale,r=s&&s.options&&s.options.weekStartsOn,l=null==r?0:e(r),c=null==a.weekStartsOn?l:e(a.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=i(t),u=d.getDay(),h=(u<c?7:0)+u-c;return d.setDate(d.getDate()-h),d.setHours(0,0,0,0),d}function c(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function d(t){n(1,arguments);var e=i(t);return e.setHours(0,0,0,0),e}var u=864e5;function h(t,e){n(2,arguments);var i=d(t),o=d(e),a=i.getTime()-c(i),s=o.getTime()-c(o);return Math.round((a-s)/u)}function p(t,e){n(2,arguments);var o=i(t),a=i(e),s=o.getTime()-a.getTime();return s<0?-1:s>0?1:s}function f(t){n(1,arguments);var e=i(t);return!isNaN(e)}function m(t,e){var n=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function g(t,e){n(2,arguments);var o=i(t),a=i(e),s=m(o,a),r=Math.abs(h(o,a));o.setDate(o.getDate()-s*r);var l=s*(r-(m(o,a)===-s));return 0===l?0:l}function v(t,e){n(2,arguments);var o=i(t),a=i(e);return o.getTime()-a.getTime()}var b=36e5;function y(t){n(1,arguments);var e=i(t);return e.setHours(23,59,59,999),e}function w(t){n(1,arguments);var e=i(t),o=e.getMonth();return e.setFullYear(e.getFullYear(),o+1,0),e.setHours(23,59,59,999),e}function x(t,e){n(2,arguments);var o,a=i(t),s=i(e),r=p(a,s),l=Math.abs(function(t,e){n(2,arguments);var o=i(t),a=i(e);return 12*(o.getFullYear()-a.getFullYear())+(o.getMonth()-a.getMonth())}(a,s));if(l<1)o=0;else{1===a.getMonth()&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-r*l);var c=p(a,s)===-r;(function(t){n(1,arguments);var e=i(t);return y(e).getTime()===w(e).getTime()})(i(t))&&1===l&&1===p(t,s)&&(c=!1),o=r*(l-c)}return 0===o?0:o}var _={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function k(t){return function(e){var n=e||{},i=n.width?String(n.width):t.defaultWidth;return t.formats[i]||t.formats[t.defaultWidth]}}var S={date:k({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:k({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:k({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},T={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function C(t){return function(e,n){var i,o=n||{};if("formatting"===(o.context?String(o.context):"standalone")&&t.formattingValues){var a=t.defaultFormattingWidth||t.defaultWidth,s=o.width?String(o.width):a;i=t.formattingValues[s]||t.formattingValues[a]}else{var r=t.defaultWidth,l=o.width?String(o.width):t.defaultWidth;i=t.values[l]||t.values[r]}return i[t.argumentCallback?t.argumentCallback(e):e]}}function M(t){return function(e,n){var i=String(e),o=n||{},a=o.width,s=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],r=i.match(s);if(!r)return null;var l,c=r[0],d=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth];return l="[object Array]"===Object.prototype.toString.call(d)?function(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n}(d,(function(t){return t.test(c)})):function(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e(t[n]))return n}(d,(function(t){return t.test(c)})),l=t.valueCallback?t.valueCallback(l):l,{value:l=o.valueCallback?o.valueCallback(l):l,rest:i.slice(c.length)}}}var D,O={code:"en-US",formatDistance:function(t,e,n){var i;return n=n||{},i="string"==typeof _[t]?_[t]:1===e?_[t].one:_[t].other.replace("{{count}}",e),n.addSuffix?n.comparison>0?"in "+i:i+" ago":i},formatLong:S,formatRelative:function(t,e,n,i){return T[t]},localize:{ordinalNumber:function(t,e){var n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:C({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:C({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(t){return Number(t)-1}}),month:C({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:C({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:C({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(D={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}},function(t,e){var n=String(t),i=e||{},o=n.match(D.matchPattern);if(!o)return null;var a=o[0],s=n.match(D.parsePattern);if(!s)return null;var r=D.valueCallback?D.valueCallback(s[0]):s[0];return{value:r=i.valueCallback?i.valueCallback(r):r,rest:n.slice(a.length)}}),era:M({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:M({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:M({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:M({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:M({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function E(t,i){return n(2,arguments),s(t,-e(i))}function A(t,e){for(var n=t<0?"-":"",i=Math.abs(t).toString();i.length<e;)i="0"+i;return n+i}var I=function(t,e){var n=t.getUTCFullYear(),i=n>0?n:1-n;return A("yy"===e?i%100:i,e.length)},P=function(t,e){var n=t.getUTCMonth();return"M"===e?String(n+1):A(n+1,2)},L=function(t,e){return A(t.getUTCDate(),e.length)},N=function(t,e){return A(t.getUTCHours()%12||12,e.length)},R=function(t,e){return A(t.getUTCHours(),e.length)},j=function(t,e){return A(t.getUTCMinutes(),e.length)},$=function(t,e){return A(t.getUTCSeconds(),e.length)},B=function(t,e){var n=e.length,i=t.getUTCMilliseconds();return A(Math.floor(i*Math.pow(10,n-3)),e.length)},H=864e5;function W(t){n(1,arguments);var e=i(t),o=e.getUTCDay(),a=(o<1?7:0)+o-1;return e.setUTCDate(e.getUTCDate()-a),e.setUTCHours(0,0,0,0),e}function F(t){n(1,arguments);var e=i(t),o=e.getUTCFullYear(),a=new Date(0);a.setUTCFullYear(o+1,0,4),a.setUTCHours(0,0,0,0);var s=W(a),r=new Date(0);r.setUTCFullYear(o,0,4),r.setUTCHours(0,0,0,0);var l=W(r);return e.getTime()>=s.getTime()?o+1:e.getTime()>=l.getTime()?o:o-1}var U=6048e5;function V(t){n(1,arguments);var e=i(t),o=W(e).getTime()-function(t){n(1,arguments);var e=F(t),i=new Date(0);return i.setUTCFullYear(e,0,4),i.setUTCHours(0,0,0,0),W(i)}(e).getTime();return Math.round(o/U)+1}function z(t,o){n(1,arguments);var a=o||{},s=a.locale,r=s&&s.options&&s.options.weekStartsOn,l=null==r?0:e(r),c=null==a.weekStartsOn?l:e(a.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=i(t),u=d.getUTCDay(),h=(u<c?7:0)+u-c;return d.setUTCDate(d.getUTCDate()-h),d.setUTCHours(0,0,0,0),d}function q(t,o){n(1,arguments);var a=i(t,o),s=a.getUTCFullYear(),r=o||{},l=r.locale,c=l&&l.options&&l.options.firstWeekContainsDate,d=null==c?1:e(c),u=null==r.firstWeekContainsDate?d:e(r.firstWeekContainsDate);if(!(u>=1&&u<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=new Date(0);h.setUTCFullYear(s+1,0,u),h.setUTCHours(0,0,0,0);var p=z(h,o),f=new Date(0);f.setUTCFullYear(s,0,u),f.setUTCHours(0,0,0,0);var m=z(f,o);return a.getTime()>=p.getTime()?s+1:a.getTime()>=m.getTime()?s:s-1}function Y(t,i){n(1,arguments);var o=i||{},a=o.locale,s=a&&a.options&&a.options.firstWeekContainsDate,r=null==s?1:e(s),l=null==o.firstWeekContainsDate?r:e(o.firstWeekContainsDate),c=q(t,i),d=new Date(0);return d.setUTCFullYear(c,0,l),d.setUTCHours(0,0,0,0),z(d,i)}var G=6048e5;function X(t,e){n(1,arguments);var o=i(t),a=z(o,e).getTime()-Y(o,e).getTime();return Math.round(a/G)+1}var J={G:function(t,e,n){var i=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(t,e,n){if("yo"===e){var i=t.getUTCFullYear(),o=i>0?i:1-i;return n.ordinalNumber(o,{unit:"year"})}return I(t,e)},Y:function(t,e,n,i){var o=q(t,i),a=o>0?o:1-o;return"YY"===e?A(a%100,2):"Yo"===e?n.ordinalNumber(a,{unit:"year"}):A(a,e.length)},R:function(t,e){return A(F(t),e.length)},u:function(t,e){return A(t.getUTCFullYear(),e.length)},Q:function(t,e,n){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return A(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,n){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return A(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,n){var i=t.getUTCMonth();switch(e){case"M":case"MM":return P(t,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,n){var i=t.getUTCMonth();switch(e){case"L":return String(i+1);case"LL":return A(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,n,i){var o=X(t,i);return"wo"===e?n.ordinalNumber(o,{unit:"week"}):A(o,e.length)},I:function(t,e,n){var i=V(t);return"Io"===e?n.ordinalNumber(i,{unit:"week"}):A(i,e.length)},d:function(t,e,n){return"do"===e?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):L(t,e)},D:function(t,e,o){var a=function(t){n(1,arguments);var e=i(t),o=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var a=o-e.getTime();return Math.floor(a/H)+1}(t);return"Do"===e?o.ordinalNumber(a,{unit:"dayOfYear"}):A(a,e.length)},E:function(t,e,n){var i=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,n,i){var o=t.getUTCDay(),a=(o-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return A(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(o,{width:"short",context:"formatting"});default:return n.day(o,{width:"wide",context:"formatting"})}},c:function(t,e,n,i){var o=t.getUTCDay(),a=(o-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return A(a,e.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(o,{width:"narrow",context:"standalone"});case"cccccc":return n.day(o,{width:"short",context:"standalone"});default:return n.day(o,{width:"wide",context:"standalone"})}},i:function(t,e,n){var i=t.getUTCDay(),o=0===i?7:i;switch(e){case"i":return String(o);case"ii":return A(o,e.length);case"io":return n.ordinalNumber(o,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,n){var i=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,e,n){var i,o=t.getUTCHours();switch(i=12===o?"noon":0===o?"midnight":o/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,e,n){var i,o=t.getUTCHours();switch(i=o>=17?"evening":o>=12?"afternoon":o>=4?"morning":"night",e){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,e,n){if("ho"===e){var i=t.getUTCHours()%12;return 0===i&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return N(t,e)},H:function(t,e,n){return"Ho"===e?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):R(t,e)},K:function(t,e,n){var i=t.getUTCHours()%12;return"Ko"===e?n.ordinalNumber(i,{unit:"hour"}):A(i,e.length)},k:function(t,e,n){var i=t.getUTCHours();return 0===i&&(i=24),"ko"===e?n.ordinalNumber(i,{unit:"hour"}):A(i,e.length)},m:function(t,e,n){return"mo"===e?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):j(t,e)},s:function(t,e,n){return"so"===e?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):$(t,e)},S:function(t,e){return B(t,e)},X:function(t,e,n,i){var o=(i._originalDate||t).getTimezoneOffset();if(0===o)return"Z";switch(e){case"X":return K(o);case"XXXX":case"XX":return Z(o);default:return Z(o,":")}},x:function(t,e,n,i){var o=(i._originalDate||t).getTimezoneOffset();switch(e){case"x":return K(o);case"xxxx":case"xx":return Z(o);default:return Z(o,":")}},O:function(t,e,n,i){var o=(i._originalDate||t).getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Q(o,":");default:return"GMT"+Z(o,":")}},z:function(t,e,n,i){var o=(i._originalDate||t).getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Q(o,":");default:return"GMT"+Z(o,":")}},t:function(t,e,n,i){var o=i._originalDate||t;return A(Math.floor(o.getTime()/1e3),e.length)},T:function(t,e,n,i){return A((i._originalDate||t).getTime(),e.length)}};function Q(t,e){var n=t>0?"-":"+",i=Math.abs(t),o=Math.floor(i/60),a=i%60;if(0===a)return n+String(o);var s=e||"";return n+String(o)+s+A(a,2)}function K(t,e){return t%60==0?(t>0?"-":"+")+A(Math.abs(t)/60,2):Z(t,e)}function Z(t,e){var n=e||"",i=t>0?"-":"+",o=Math.abs(t);return i+A(Math.floor(o/60),2)+n+A(o%60,2)}var tt=J;function et(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}}function nt(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}}var it={p:nt,P:function(t,e){var n,i=t.match(/(P+)(p+)?/),o=i[1],a=i[2];if(!a)return et(t,e);switch(o){case"P":n=e.dateTime({width:"short"});break;case"PP":n=e.dateTime({width:"medium"});break;case"PPP":n=e.dateTime({width:"long"});break;default:n=e.dateTime({width:"full"})}return n.replace("{{date}}",et(o,e)).replace("{{time}}",nt(a,e))}},ot=it,at=["D","DD"],st=["YY","YYYY"];function rt(t){return-1!==at.indexOf(t)}function lt(t){return-1!==st.indexOf(t)}function ct(t,e,n){if("YYYY"===t)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://git.io/fxCyr"));if("YY"===t)throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://git.io/fxCyr"));if("D"===t)throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://git.io/fxCyr"));if("DD"===t)throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://git.io/fxCyr"))}var dt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ut=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ht=/^'([^]*?)'?$/,pt=/''/g,ft=/[a-zA-Z]/;function mt(t,e){if(null==t)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in e=e||{})e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function gt(t,o,a){n(2,arguments);var s=a||{},r=s.locale,l=r&&r.options&&r.options.weekStartsOn,c=null==l?0:e(l),d=null==s.weekStartsOn?c:e(s.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var u=i(t),h=e(o),p=((h%7+7)%7<d?7:0)+h-u.getUTCDay();return u.setUTCDate(u.getUTCDate()+p),u}var vt=/^(1[0-2]|0?\d)/,bt=/^(3[0-1]|[0-2]?\d)/,yt=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,wt=/^(5[0-3]|[0-4]?\d)/,xt=/^(2[0-3]|[0-1]?\d)/,_t=/^(2[0-4]|[0-1]?\d)/,kt=/^(1[0-1]|0?\d)/,St=/^(1[0-2]|0?\d)/,Tt=/^[0-5]?\d/,Ct=/^[0-5]?\d/,Mt=/^\d/,Dt=/^\d{1,2}/,Ot=/^\d{1,3}/,Et=/^\d{1,4}/,At=/^-?\d+/,It=/^-?\d/,Pt=/^-?\d{1,2}/,Lt=/^-?\d{1,3}/,Nt=/^-?\d{1,4}/,Rt=/^([+-])(\d{2})(\d{2})?|Z/,jt=/^([+-])(\d{2})(\d{2})|Z/,$t=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Bt=/^([+-])(\d{2}):(\d{2})|Z/,Ht=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Wt(t,e,n){var i=e.match(t);if(!i)return null;var o=parseInt(i[0],10);return{value:n?n(o):o,rest:e.slice(i[0].length)}}function Ft(t,e){var n=e.match(t);return n?"Z"===n[0]?{value:0,rest:e.slice(1)}:{value:("+"===n[1]?1:-1)*(36e5*(n[2]?parseInt(n[2],10):0)+6e4*(n[3]?parseInt(n[3],10):0)+1e3*(n[5]?parseInt(n[5],10):0)),rest:e.slice(n[0].length)}:null}function Ut(t,e){return Wt(At,t,e)}function Vt(t,e,n){switch(t){case 1:return Wt(Mt,e,n);case 2:return Wt(Dt,e,n);case 3:return Wt(Ot,e,n);case 4:return Wt(Et,e,n);default:return Wt(new RegExp("^\\d{1,"+t+"}"),e,n)}}function zt(t,e,n){switch(t){case 1:return Wt(It,e,n);case 2:return Wt(Pt,e,n);case 3:return Wt(Lt,e,n);case 4:return Wt(Nt,e,n);default:return Wt(new RegExp("^-?\\d{1,"+t+"}"),e,n)}}function qt(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function Yt(t,e){var n,i=e>0,o=i?e:1-e;if(o<=50)n=t||100;else{var a=o+50;n=t+100*Math.floor(a/100)-(t>=a%100?100:0)}return i?n:1-n}var Gt=[31,28,31,30,31,30,31,31,30,31,30,31],Xt=[31,29,31,30,31,30,31,31,30,31,30,31];function Jt(t){return t%400==0||t%4==0&&t%100!=0}var Qt={G:{priority:140,parse:function(t,e,n,i){switch(e){case"G":case"GG":case"GGG":return n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"});case"GGGGG":return n.era(t,{width:"narrow"});default:return n.era(t,{width:"wide"})||n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"})}},set:function(t,e,n,i){return e.era=n,t.setUTCFullYear(n,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(t,e,n,i){var o=function(t){return{year:t,isTwoDigitYear:"yy"===e}};switch(e){case"y":return Vt(4,t,o);case"yo":return n.ordinalNumber(t,{unit:"year",valueCallback:o});default:return Vt(e.length,t,o)}},validate:function(t,e,n){return e.isTwoDigitYear||e.year>0},set:function(t,e,n,i){var o=t.getUTCFullYear();if(n.isTwoDigitYear){var a=Yt(n.year,o);return t.setUTCFullYear(a,0,1),t.setUTCHours(0,0,0,0),t}var s="era"in e&&1!==e.era?1-n.year:n.year;return t.setUTCFullYear(s,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(t,e,n,i){var o=function(t){return{year:t,isTwoDigitYear:"YY"===e}};switch(e){case"Y":return Vt(4,t,o);case"Yo":return n.ordinalNumber(t,{unit:"year",valueCallback:o});default:return Vt(e.length,t,o)}},validate:function(t,e,n){return e.isTwoDigitYear||e.year>0},set:function(t,e,n,i){var o=q(t,i);if(n.isTwoDigitYear){var a=Yt(n.year,o);return t.setUTCFullYear(a,0,i.firstWeekContainsDate),t.setUTCHours(0,0,0,0),z(t,i)}var s="era"in e&&1!==e.era?1-n.year:n.year;return t.setUTCFullYear(s,0,i.firstWeekContainsDate),t.setUTCHours(0,0,0,0),z(t,i)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(t,e,n,i){return zt("R"===e?4:e.length,t)},set:function(t,e,n,i){var o=new Date(0);return o.setUTCFullYear(n,0,4),o.setUTCHours(0,0,0,0),W(o)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(t,e,n,i){return zt("u"===e?4:e.length,t)},set:function(t,e,n,i){return t.setUTCFullYear(n,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(t,e,n,i){switch(e){case"Q":case"QQ":return Vt(e.length,t);case"Qo":return n.ordinalNumber(t,{unit:"quarter"});case"QQQ":return n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(t,{width:"narrow",context:"formatting"});default:return n.quarter(t,{width:"wide",context:"formatting"})||n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=1&&e<=4},set:function(t,e,n,i){return t.setUTCMonth(3*(n-1),1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(t,e,n,i){switch(e){case"q":case"qq":return Vt(e.length,t);case"qo":return n.ordinalNumber(t,{unit:"quarter"});case"qqq":return n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(t,{width:"narrow",context:"standalone"});default:return n.quarter(t,{width:"wide",context:"standalone"})||n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=1&&e<=4},set:function(t,e,n,i){return t.setUTCMonth(3*(n-1),1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(t,e,n,i){var o=function(t){return t-1};switch(e){case"M":return Wt(vt,t,o);case"MM":return Vt(2,t,o);case"Mo":return n.ordinalNumber(t,{unit:"month",valueCallback:o});case"MMM":return n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(t,{width:"narrow",context:"formatting"});default:return n.month(t,{width:"wide",context:"formatting"})||n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.setUTCMonth(n,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(t,e,n,i){var o=function(t){return t-1};switch(e){case"L":return Wt(vt,t,o);case"LL":return Vt(2,t,o);case"Lo":return n.ordinalNumber(t,{unit:"month",valueCallback:o});case"LLL":return n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(t,{width:"narrow",context:"standalone"});default:return n.month(t,{width:"wide",context:"standalone"})||n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.setUTCMonth(n,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(t,e,n,i){switch(e){case"w":return Wt(wt,t);case"wo":return n.ordinalNumber(t,{unit:"week"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=53},set:function(t,o,a,s){return z(function(t,o,a){n(2,arguments);var s=i(t),r=e(o),l=X(s,a)-r;return s.setUTCDate(s.getUTCDate()-7*l),s}(t,a,s),s)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(t,e,n,i){switch(e){case"I":return Wt(wt,t);case"Io":return n.ordinalNumber(t,{unit:"week"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=53},set:function(t,o,a,s){return W(function(t,o){n(2,arguments);var a=i(t),s=e(o),r=V(a)-s;return a.setUTCDate(a.getUTCDate()-7*r),a}(t,a,s),s)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(t,e,n,i){switch(e){case"d":return Wt(bt,t);case"do":return n.ordinalNumber(t,{unit:"date"});default:return Vt(e.length,t)}},validate:function(t,e,n){var i=Jt(t.getUTCFullYear()),o=t.getUTCMonth();return i?e>=1&&e<=Xt[o]:e>=1&&e<=Gt[o]},set:function(t,e,n,i){return t.setUTCDate(n),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(t,e,n,i){switch(e){case"D":case"DD":return Wt(yt,t);case"Do":return n.ordinalNumber(t,{unit:"date"});default:return Vt(e.length,t)}},validate:function(t,e,n){return Jt(t.getUTCFullYear())?e>=1&&e<=366:e>=1&&e<=365},set:function(t,e,n,i){return t.setUTCMonth(0,n),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(t,e,n,i){switch(e){case"E":case"EE":case"EEE":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return(t=gt(t,n,i)).setUTCHours(0,0,0,0),t},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(t,e,n,i){var o=function(t){var e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"e":case"ee":return Vt(e.length,t,o);case"eo":return n.ordinalNumber(t,{unit:"day",valueCallback:o});case"eee":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeeee":return n.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return(t=gt(t,n,i)).setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(t,e,n,i){var o=function(t){var e=7*Math.floor((t-1)/7);return(t+i.weekStartsOn+6)%7+e};switch(e){case"c":case"cc":return Vt(e.length,t,o);case"co":return n.ordinalNumber(t,{unit:"day",valueCallback:o});case"ccc":return n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"ccccc":return n.day(t,{width:"narrow",context:"standalone"});case"cccccc":return n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});default:return n.day(t,{width:"wide",context:"standalone"})||n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return(t=gt(t,n,i)).setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(t,e,n,i){var o=function(t){return 0===t?7:t};switch(e){case"i":case"ii":return Vt(e.length,t);case"io":return n.ordinalNumber(t,{unit:"day"});case"iii":return n.day(t,{width:"abbreviated",context:"formatting",valueCallback:o})||n.day(t,{width:"short",context:"formatting",valueCallback:o})||n.day(t,{width:"narrow",context:"formatting",valueCallback:o});case"iiiii":return n.day(t,{width:"narrow",context:"formatting",valueCallback:o});case"iiiiii":return n.day(t,{width:"short",context:"formatting",valueCallback:o})||n.day(t,{width:"narrow",context:"formatting",valueCallback:o});default:return n.day(t,{width:"wide",context:"formatting",valueCallback:o})||n.day(t,{width:"abbreviated",context:"formatting",valueCallback:o})||n.day(t,{width:"short",context:"formatting",valueCallback:o})||n.day(t,{width:"narrow",context:"formatting",valueCallback:o})}},validate:function(t,e,n){return e>=1&&e<=7},set:function(t,o,a,s){return t=function(t,o){n(2,arguments);var a=e(o);a%7==0&&(a-=7);var s=i(t),r=((a%7+7)%7<1?7:0)+a-s.getUTCDay();return s.setUTCDate(s.getUTCDate()+r),s}(t,a,s),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(t,e,n,i){switch(e){case"a":case"aa":case"aaa":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(qt(n),0,0,0),t},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(t,e,n,i){switch(e){case"b":case"bb":case"bbb":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(qt(n),0,0,0),t},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(t,e,n,i){switch(e){case"B":case"BB":case"BBB":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(qt(n),0,0,0),t},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(t,e,n,i){switch(e){case"h":return Wt(St,t);case"ho":return n.ordinalNumber(t,{unit:"hour"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=12},set:function(t,e,n,i){var o=t.getUTCHours()>=12;return o&&n<12?t.setUTCHours(n+12,0,0,0):o||12!==n?t.setUTCHours(n,0,0,0):t.setUTCHours(0,0,0,0),t},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(t,e,n,i){switch(e){case"H":return Wt(xt,t);case"Ho":return n.ordinalNumber(t,{unit:"hour"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=23},set:function(t,e,n,i){return t.setUTCHours(n,0,0,0),t},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(t,e,n,i){switch(e){case"K":return Wt(kt,t);case"Ko":return n.ordinalNumber(t,{unit:"hour"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.getUTCHours()>=12&&n<12?t.setUTCHours(n+12,0,0,0):t.setUTCHours(n,0,0,0),t},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(t,e,n,i){switch(e){case"k":return Wt(_t,t);case"ko":return n.ordinalNumber(t,{unit:"hour"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=24},set:function(t,e,n,i){var o=n<=24?n%24:n;return t.setUTCHours(o,0,0,0),t},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(t,e,n,i){switch(e){case"m":return Wt(Tt,t);case"mo":return n.ordinalNumber(t,{unit:"minute"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=59},set:function(t,e,n,i){return t.setUTCMinutes(n,0,0),t},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(t,e,n,i){switch(e){case"s":return Wt(Ct,t);case"so":return n.ordinalNumber(t,{unit:"second"});default:return Vt(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=59},set:function(t,e,n,i){return t.setUTCSeconds(n,0),t},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(t,e,n,i){return Vt(e.length,t,(function(t){return Math.floor(t*Math.pow(10,3-e.length))}))},set:function(t,e,n,i){return t.setUTCMilliseconds(n),t},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(t,e,n,i){switch(e){case"X":return Ft(Rt,t);case"XX":return Ft(jt,t);case"XXXX":return Ft($t,t);case"XXXXX":return Ft(Ht,t);default:return Ft(Bt,t)}},set:function(t,e,n,i){return e.timestampIsSet?t:new Date(t.getTime()-n)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(t,e,n,i){switch(e){case"x":return Ft(Rt,t);case"xx":return Ft(jt,t);case"xxxx":return Ft($t,t);case"xxxxx":return Ft(Ht,t);default:return Ft(Bt,t)}},set:function(t,e,n,i){return e.timestampIsSet?t:new Date(t.getTime()-n)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(t,e,n,i){return Ut(t)},set:function(t,e,n,i){return[new Date(1e3*n),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(t,e,n,i){return Ut(t)},set:function(t,e,n,i){return[new Date(n),{timestampIsSet:!0}]},incompatibleTokens:"*"}},Kt=Qt,Zt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,te=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ee=/^'([^]*?)'?$/,ne=/''/g,ie=/\S/,oe=/[a-zA-Z]/;function ae(t,e){if(e.timestampIsSet)return t;var n=new Date(0);return n.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),n.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),n}function se(t){return t.match(ee)[1].replace(ne,"'")}var re=36e5,le={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ce=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,de=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ue=/^([+-])(\d{2})(?::?(\d{2}))?$/;function he(t){return t?parseInt(t):1}function pe(t){return t&&parseFloat(t.replace(",","."))||0}var fe=[31,null,31,30,31,30,31,31,30,31,30,31];function me(t){return t%400==0||t%4==0&&t%100}const ge={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};t._adapters._date.override({_id:"date-fns",formats:function(){return ge},parse:function(t,o){if(null==t)return null;const a=typeof t;return"number"===a||t instanceof Date?t=i(t):"string"===a&&(t="string"==typeof o?function(t,o,a,s){n(3,arguments);var r=String(t),l=String(o),d=s||{},u=d.locale||O;if(!u.match)throw new RangeError("locale must contain match property");var h=u.options&&u.options.firstWeekContainsDate,p=null==h?1:e(h),f=null==d.firstWeekContainsDate?p:e(d.firstWeekContainsDate);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=u.options&&u.options.weekStartsOn,g=null==m?0:e(m),v=null==d.weekStartsOn?g:e(d.weekStartsOn);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===l)return""===r?i(a):new Date(NaN);var b,y={firstWeekContainsDate:f,weekStartsOn:v,locale:u},w=[{priority:10,subPriority:-1,set:ae,index:0}],x=l.match(te).map((function(t){var e=t[0];return"p"===e||"P"===e?(0,ot[e])(t,u.formatLong,y):t})).join("").match(Zt),_=[];for(b=0;b<x.length;b++){var k=x[b];!d.useAdditionalWeekYearTokens&&lt(k)&&ct(k,l,t),!d.useAdditionalDayOfYearTokens&&rt(k)&&ct(k,l,t);var S=k[0],T=Kt[S];if(T){var C=T.incompatibleTokens;if(Array.isArray(C)){for(var M=void 0,D=0;D<_.length;D++){var A=_[D].token;if(-1!==C.indexOf(A)||A===S){M=_[D];break}}if(M)throw new RangeError("The format string mustn't contain `".concat(M.fullToken,"` and `").concat(k,"` at the same time"))}else if("*"===T.incompatibleTokens&&_.length)throw new RangeError("The format string mustn't contain `".concat(k,"` and any other token at the same time"));_.push({token:S,fullToken:k});var I=T.parse(r,k,u.match,y);if(!I)return new Date(NaN);w.push({priority:T.priority,subPriority:T.subPriority||0,set:T.set,validate:T.validate,value:I.value,index:w.length}),r=I.rest}else{if(S.match(oe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");if("''"===k?k="'":"'"===S&&(k=se(k)),0!==r.indexOf(k))return new Date(NaN);r=r.slice(k.length)}}if(r.length>0&&ie.test(r))return new Date(NaN);var P=w.map((function(t){return t.priority})).sort((function(t,e){return e-t})).filter((function(t,e,n){return n.indexOf(t)===e})).map((function(t){return w.filter((function(e){return e.priority===t})).sort((function(t,e){return e.subPriority-t.subPriority}))})).map((function(t){return t[0]})),L=i(a);if(isNaN(L))return new Date(NaN);var N=E(L,c(L)),R={};for(b=0;b<P.length;b++){var j=P[b];if(j.validate&&!j.validate(N,j.value,y))return new Date(NaN);var $=j.set(N,R,j.value,y);$[0]?(N=$[0],mt(R,$[1])):N=$}return N}(t,o,new Date,this.options):function(t,i){n(1,arguments);var o=i||{},a=null==o.additionalDigits?2:e(o.additionalDigits);if(2!==a&&1!==a&&0!==a)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof t&&"[object String]"!==Object.prototype.toString.call(t))return new Date(NaN);var s,r=function(t){var e,n={},i=t.split(le.dateTimeDelimiter);if(i.length>2)return n;if(/:/.test(i[0])?(n.date=null,e=i[0]):(n.date=i[0],e=i[1],le.timeZoneDelimiter.test(n.date)&&(n.date=t.split(le.timeZoneDelimiter)[0],e=t.substr(n.date.length,t.length))),e){var o=le.timezone.exec(e);o?(n.time=e.replace(o[1],""),n.timezone=o[1]):n.time=e}return n}(t);if(r.date){var l=function(t,e){var n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),i=t.match(n);if(!i)return{year:null};var o=i[1]&&parseInt(i[1]),a=i[2]&&parseInt(i[2]);return{year:null==a?o:100*a,restDateString:t.slice((i[1]||i[2]).length)}}(r.date,a);s=function(t,e){if(null===e)return null;var n=t.match(ce);if(!n)return null;var i=!!n[4],o=he(n[1]),a=he(n[2])-1,s=he(n[3]),r=he(n[4]),l=he(n[5])-1;if(i)return function(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}(0,r,l)?function(t,e,n){var i=new Date(0);i.setUTCFullYear(t,0,4);var o=7*(e-1)+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+o),i}(e,r,l):new Date(NaN);var c=new Date(0);return function(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(fe[e]||(me(t)?29:28))}(e,a,s)&&function(t,e){return e>=1&&e<=(me(t)?366:365)}(e,o)?(c.setUTCFullYear(e,a,Math.max(o,s)),c):new Date(NaN)}(l.restDateString,l.year)}if(isNaN(s)||!s)return new Date(NaN);var c,d=s.getTime(),u=0;if(r.time&&(u=function(t){var e=t.match(de);if(!e)return null;var n=pe(e[1]),i=pe(e[2]),o=pe(e[3]);return function(t,e,n){return 24===t?0===e&&0===n:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}(n,i,o)?n*re+6e4*i+1e3*o:NaN}(r.time),isNaN(u)||null===u))return new Date(NaN);if(!r.timezone){var h=new Date(d+u),p=new Date(0);return p.setFullYear(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate()),p.setHours(h.getUTCHours(),h.getUTCMinutes(),h.getUTCSeconds(),h.getUTCMilliseconds()),p}return c=function(t){if("Z"===t)return 0;var e=t.match(ue);if(!e)return 0;var n="+"===e[1]?-1:1,i=parseInt(e[2]),o=e[3]&&parseInt(e[3])||0;return function(t,e){return e>=0&&e<=59}(0,o)?n*(i*re+6e4*o):NaN}(r.timezone),isNaN(c)?new Date(NaN):new Date(d+u+c)}(t,this.options)),f(t)?t.getTime():null},format:function(t,o){return function(t,o,a){n(2,arguments);var s=String(o),r=a||{},l=r.locale||O,d=l.options&&l.options.firstWeekContainsDate,u=null==d?1:e(d),h=null==r.firstWeekContainsDate?u:e(r.firstWeekContainsDate);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var p=l.options&&l.options.weekStartsOn,m=null==p?0:e(p),g=null==r.weekStartsOn?m:e(r.weekStartsOn);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!l.localize)throw new RangeError("locale must contain localize property");if(!l.formatLong)throw new RangeError("locale must contain formatLong property");var v=i(t);if(!f(v))throw new RangeError("Invalid time value");var b=E(v,c(v)),y={firstWeekContainsDate:h,weekStartsOn:g,locale:l,_originalDate:v},w=s.match(ut).map((function(t){var e=t[0];return"p"===e||"P"===e?(0,ot[e])(t,l.formatLong,y):t})).join("").match(dt).map((function(e){if("''"===e)return"'";var n=e[0];if("'"===n)return function(t){return t.match(ht)[1].replace(pt,"'")}(e);var i=tt[n];if(i)return!r.useAdditionalWeekYearTokens&&lt(e)&&ct(e,o,t),!r.useAdditionalDayOfYearTokens&&rt(e)&&ct(e,o,t),i(b,e,l.localize,y);if(n.match(ft))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");return e})).join("");return w}(t,o,this.options)},add:function(t,i,l){switch(l){case"millisecond":return s(t,i);case"second":return function(t,i){return n(2,arguments),s(t,1e3*e(i))}(t,i);case"minute":return function(t,i){return n(2,arguments),s(t,6e4*e(i))}(t,i);case"hour":return function(t,i){return n(2,arguments),s(t,e(i)*r)}(t,i);case"day":return o(t,i);case"week":return function(t,i){return n(2,arguments),o(t,7*e(i))}(t,i);case"month":return a(t,i);case"quarter":return function(t,i){return n(2,arguments),a(t,3*e(i))}(t,i);case"year":return function(t,i){return n(2,arguments),a(t,12*e(i))}(t,i);default:return t}},diff:function(t,e,o){switch(o){case"millisecond":return v(t,e);case"second":return function(t,e){n(2,arguments);var i=v(t,e)/1e3;return i>0?Math.floor(i):Math.ceil(i)}(t,e);case"minute":return function(t,e){n(2,arguments);var i=v(t,e)/6e4;return i>0?Math.floor(i):Math.ceil(i)}(t,e);case"hour":return function(t,e){n(2,arguments);var i=v(t,e)/b;return i>0?Math.floor(i):Math.ceil(i)}(t,e);case"day":return g(t,e);case"week":return function(t,e){n(2,arguments);var i=g(t,e)/7;return i>0?Math.floor(i):Math.ceil(i)}(t,e);case"month":return x(t,e);case"quarter":return function(t,e){n(2,arguments);var i=x(t,e)/3;return i>0?Math.floor(i):Math.ceil(i)}(t,e);case"year":return function(t,e){n(2,arguments);var o=i(t),a=i(e),s=p(o,a),r=Math.abs(function(t,e){n(2,arguments);var o=i(t),a=i(e);return o.getFullYear()-a.getFullYear()}(o,a));o.setFullYear("1584"),a.setFullYear("1584");var l=s*(r-(p(o,a)===-s));return 0===l?0:l}(t,e);default:return 0}},startOf:function(t,e,o){switch(e){case"second":return function(t){n(1,arguments);var e=i(t);return e.setMilliseconds(0),e}(t);case"minute":return function(t){n(1,arguments);var e=i(t);return e.setSeconds(0,0),e}(t);case"hour":return function(t){n(1,arguments);var e=i(t);return e.setMinutes(0,0,0),e}(t);case"day":return d(t);case"week":return l(t);case"isoWeek":return l(t,{weekStartsOn:+o});case"month":return function(t){n(1,arguments);var e=i(t);return e.setDate(1),e.setHours(0,0,0,0),e}(t);case"quarter":return function(t){n(1,arguments);var e=i(t),o=e.getMonth(),a=o-o%3;return e.setMonth(a,1),e.setHours(0,0,0,0),e}(t);case"year":return function(t){n(1,arguments);var e=i(t),o=new Date(0);return o.setFullYear(e.getFullYear(),0,1),o.setHours(0,0,0,0),o}(t);default:return t}},endOf:function(t,o){switch(o){case"second":return function(t){n(1,arguments);var e=i(t);return e.setMilliseconds(999),e}(t);case"minute":return function(t){n(1,arguments);var e=i(t);return e.setSeconds(59,999),e}(t);case"hour":return function(t){n(1,arguments);var e=i(t);return e.setMinutes(59,59,999),e}(t);case"day":return y(t);case"week":return function(t,o){n(1,arguments);var a=o||{},s=a.locale,r=s&&s.options&&s.options.weekStartsOn,l=null==r?0:e(r),c=null==a.weekStartsOn?l:e(a.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=i(t),u=d.getDay(),h=6+(u<c?-7:0)-(u-c);return d.setDate(d.getDate()+h),d.setHours(23,59,59,999),d}(t);case"month":return w(t);case"quarter":return function(t){n(1,arguments);var e=i(t),o=e.getMonth(),a=o-o%3+3;return e.setMonth(a,0),e.setHours(23,59,59,999),e}(t);case"year":return function(t){n(1,arguments);var e=i(t),o=e.getFullYear();return e.setFullYear(o+1,0,0),e.setHours(23,59,59,999),e}(t);default:return t}}})})),function(t){"use strict";var e="__RETRY__"+(new Date).getTime();t.ajaxPrefilter((function(n,i,o){if(!n[e]&&void 0!==n.shouldRetry){i[e]=!0;var a,s=t.Deferred(),r=t.Deferred(),l={},c=0,d=function(e,i,o){var a,s=n.shouldRetry;switch(typeof s){case"number":a=s>i;break;case"boolean":a=s;break;case"function":a=s(e,i,o)}return"object"==typeof a&&"function"==typeof a.then?t.Deferred((function(t){a.then(t.resolve,(function(){t.resolve(!1)}))})).promise():t.when(a)};(function e(n,i,u){(i?d(i,c++,n.type||"GET"):t.when(!0)).done((function(c){!0===c?(i?t.ajax(n):o).then((function(t,e,n){a=n.status,s.resolveWith(this,arguments),s.done(l[a]),r.resolveWith(this,[n,e])}),(function(t,i){var o=arguments,c=this;e(n,t,(function(){a=t.status,s.rejectWith(c,o),s.fail(l[a]),r.resolveWith(c,[t,i])}))})):u()}))})(t.extend({},i,{success:t.noop,error:t.noop,complete:t.noop,statusCode:{}})),o.complete&&(o.complete=r.done,o.success=s.done,o.error=s.fail),t.extend(o,s.promise()),o.statusCode=function(t){var e;if(t)if(function(t){return t.state?"pending"!==t.state():t.isResolved()||t.isRejected()}(s))s.then(t[a],t[a]);else for(e in t)l[e]=[l[e],t[e]];return this}}}))}(jQuery),function(){"use strict";function t(e,i){var o;if(i=i||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=i.touchBoundary||10,this.layer=e,this.tapDelay=i.tapDelay||200,this.tapTimeout=i.tapTimeout||700,!t.notNeeded(e)){for(var a=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],s=this,r=0,l=a.length;r<l;r++)s[a[r]]=c(s[a[r]],s);n&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,i){var o=Node.prototype.removeEventListener;"click"===t?o.call(e,t,n.hijacked||n,i):o.call(e,t,n,i)},e.addEventListener=function(t,n,i){var o=Node.prototype.addEventListener;"click"===t?o.call(e,t,n.hijacked||(n.hijacked=function(t){t.propagationStopped||n(t)}),i):o.call(e,t,n,i)}),"function"==typeof e.onclick&&(o=e.onclick,e.addEventListener("click",(function(t){o(t)}),!1),e.onclick=null)}function c(t,e){return function(){return t.apply(e,arguments)}}}var e=navigator.userAgent.indexOf("Windows Phone")>=0,n=navigator.userAgent.indexOf("Android")>0&&!e,i=/iP(ad|hone|od)/.test(navigator.userAgent)&&!e,o=i&&/OS 4_\d(_\d)?/.test(navigator.userAgent),a=i&&/OS [6-7]_\d/.test(navigator.userAgent),s=navigator.userAgent.indexOf("BB10")>0;t.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled)return!0;break;case"input":if(i&&"file"===t.type||t.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(t.className)},t.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!n;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}},t.prototype.sendClick=function(t,e){var n,i;document.activeElement&&document.activeElement!==t&&document.activeElement.blur(),i=e.changedTouches[0],(n=document.createEvent("MouseEvents")).initMouseEvent(this.determineEventType(t),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,t.dispatchEvent(n)},t.prototype.determineEventType=function(t){return n&&"select"===t.tagName.toLowerCase()?"mousedown":"click"},t.prototype.focus=function(t){var e;i&&t.setSelectionRange&&0!==t.type.indexOf("date")&&"time"!==t.type&&"month"!==t.type&&"email"!==t.type?(e=t.value.length,t.focus(),t.setSelectionRange(e,e)):t.focus()},t.prototype.updateScrollParent=function(t){var e,n;if(!(e=t.fastClickScrollParent)||!e.contains(t)){n=t;do{if(n.scrollHeight>n.offsetHeight){e=n,t.fastClickScrollParent=n;break}n=n.parentElement}while(n)}e&&(e.fastClickLastScrollTop=e.scrollTop)},t.prototype.getTargetElementFromEventTarget=function(t){return t.nodeType===Node.TEXT_NODE?t.parentNode:t},t.prototype.onTouchStart=function(t){var e,n,a,s;if(t.timeStamp<0?(s=(new Date).getTime(),this.isTrackingClickStartFromEvent=!1):(s=t.timeStamp,this.isTrackingClickStartFromEvent=!0),t.targetTouches.length>1)return!0;if(e=this.getTargetElementFromEventTarget(t.target),n=t.targetTouches[0],i){if((a=window.getSelection()).rangeCount&&!a.isCollapsed)return!0;if(!o){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return t.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(e)}}return this.trackingClick=!0,this.trackingClickStart=s,this.targetElement=e,this.touchStartX=n.pageX,this.touchStartY=n.pageY,s-this.lastClickTime<this.tapDelay&&t.preventDefault(),!0},t.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],n=this.touchBoundary;return Math.abs(e.pageX-this.touchStartX)>n||Math.abs(e.pageY-this.touchStartY)>n},t.prototype.onTouchMove=function(t){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t))&&(this.trackingClick=!1,this.targetElement=null),!0)},t.prototype.findControl=function(t){return void 0!==t.control?t.control:t.htmlFor?document.getElementById(t.htmlFor):t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},t.prototype.onTouchEnd=function(t){var e,s,r,l,c,d,u=this.targetElement;if(d=this.isTrackingClickStartFromEvent?t.timeStamp:(new Date).getTime(),!this.trackingClick)return!0;if(d-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(d-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=d,s=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,a&&(c=t.changedTouches[0],(u=document.elementFromPoint(c.pageX-window.pageXOffset,c.pageY-window.pageYOffset)||u).fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(r=u.tagName.toLowerCase())){if(e=this.findControl(u)){if(this.focus(u),n)return!1;u=e}}else if(this.needsFocus(u))return d-s>100||i&&window.top!==window&&"input"===r?(this.targetElement=null,!1):(this.focus(u),this.sendClick(u,t),i&&"select"===r||(this.targetElement=null,t.preventDefault()),!1);return!(!i||o||!(l=u.fastClickScrollParent)||l.fastClickLastScrollTop===l.scrollTop)||(this.needsClick(u)||(t.preventDefault(),this.sendClick(u,t)),!1)},t.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},t.prototype.onMouse=function(t){return!(this.targetElement&&!t.forwardedTouchEvent&&t.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)&&(t.stopImmediatePropagation?t.stopImmediatePropagation():t.propagationStopped=!0,t.stopPropagation(),t.preventDefault(),1))},t.prototype.onClick=function(t){var e;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===t.target.type&&0===t.detail||((e=this.onMouse(t))||(this.targetElement=null),e)},t.prototype.destroy=function(){var t=this.layer;n&&(t.removeEventListener("mouseover",this.onMouse,!0),t.removeEventListener("mousedown",this.onMouse,!0),t.removeEventListener("mouseup",this.onMouse,!0)),t.removeEventListener("click",this.onClick,!0),t.removeEventListener("touchstart",this.onTouchStart,!1),t.removeEventListener("touchmove",this.onTouchMove,!1),t.removeEventListener("touchend",this.onTouchEnd,!1),t.removeEventListener("touchcancel",this.onTouchCancel,!1)},t.notNeeded=function(t){var e,i,o;if(void 0===window.ontouchstart)return!0;if(i=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!n)return!0;if(e=document.querySelector("meta[name=viewport]")){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(i>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(s&&(o=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/))[1]>=10&&o[2]>=3&&(e=document.querySelector("meta[name=viewport]"))){if(-1!==e.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===t.style.msTouchAction||"manipulation"===t.style.touchAction||!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(e=document.querySelector("meta[name=viewport]"))&&(-1!==e.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||"none"===t.style.touchAction||"manipulation"===t.style.touchAction},t.attach=function(e,n){return new t(e,n)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define((function(){return t})):"undefined"!=typeof module&&module.exports?(module.exports=t.attach,module.exports.FastClick=t):window.FastClick=t}(),"undefined"==typeof links&&(links={}),"undefined"==typeof google&&(google=void 0),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=0;e<this.length;e++)if(this[e]==t)return e;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(t,e){for(var n=0,i=this.length;i>n;++n)t.call(e||this,this[n],n,this)}),links.Timeline=function(t,e){if(t){this.dom={},this.conversion={},this.eventParams={},this.groups=[],this.groupIndexes={},this.items=[],this.renderQueue={show:[],hide:[],update:[]},this.renderedItems=[],this.clusterGenerator=new links.Timeline.ClusterGenerator(this),this.currentClusters=[],this.selection=void 0,this.listeners={},this.size={actualHeight:0,axis:{characterMajorHeight:0,characterMajorWidth:0,characterMinorHeight:0,characterMinorWidth:0,height:0,labelMajorTop:0,labelMinorTop:0,line:0,lineMajorWidth:0,lineMinorHeight:0,lineMinorTop:0,lineMinorWidth:0,top:0},contentHeight:0,contentLeft:0,contentWidth:0,frameHeight:0,frameWidth:0,groupsLeft:0,groupsWidth:0,items:{top:0}},this.dom.container=t,this.options={width:"100%",height:"auto",minHeight:0,groupMinHeight:0,autoHeight:!0,eventMargin:10,eventMarginAxis:20,dragAreaWidth:10,min:void 0,max:void 0,zoomMin:10,zoomMax:31536e10,moveable:!0,zoomable:!0,selectable:!0,unselectable:!0,editable:!1,snapEvents:!0,groupChangeable:!0,timeChangeable:!0,showCurrentTime:!0,showCustomTime:!1,showMajorLabels:!0,showMinorLabels:!0,showNavigation:!1,showButtonNew:!1,groupsOnRight:!1,groupsOrder:!0,axisOnTop:!1,stackEvents:!0,animate:!0,animateZoom:!0,cluster:!1,clusterMaxItems:5,style:"box",customStackOrder:!1,locale:"en",MONTHS:["January","February","March","April","May","June","July","August","September","October","November","December"],MONTHS_SHORT:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAYS:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DAYS_SHORT:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ZOOM_IN:"Zoom in",ZOOM_OUT:"Zoom out",MOVE_LEFT:"Move left",MOVE_RIGHT:"Move right",NEW:"New",CREATE_NEW_EVENT:"Create new event"},this.setOptions(e),this.clientTimeOffset=0;for(var n=this.dom;n.container.hasChildNodes();)n.container.removeChild(n.container.firstChild);this.step=new links.Timeline.StepDate,this.itemTypes={box:links.Timeline.ItemBox,range:links.Timeline.ItemRange,floatingRange:links.Timeline.ItemFloatingRange,dot:links.Timeline.ItemDot},this.data=[],this.firstDraw=!0,this.setVisibleChartRange(void 0,void 0,!1),this.render();var i=this;setTimeout((function(){i.trigger("ready")}),0)}},links.Timeline.prototype.draw=function(t,e){e&&console.log("WARNING: Passing options in draw() is deprecated. Pass options to the constructur or use setOptions() instead!"),this.setOptions(e),this.options.selectable&&links.Timeline.addClassName(this.dom.frame,"timeline-selectable"),this.setData(t),e&&(e.start||e.end)?this.setVisibleChartRange(e.start,e.end):this.firstDraw&&this.setVisibleChartRangeAuto(),this.firstDraw=!1},links.Timeline.prototype.setOptions=function(t){if(t){for(var e in t)t.hasOwnProperty(e)&&(this.options[e]=t[e]);if(void 0!==links.locales&&"en"!==this.options.locale){var n=links.locales[this.options.locale];if(n)for(var i in n)n.hasOwnProperty(i)&&(this.options[i]=n[i])}null!=t.showButtonAdd&&(this.options.showButtonNew=t.showButtonAdd,console.log("WARNING: Option showButtonAdd is deprecated. Use showButtonNew instead")),null!=t.intervalMin&&(this.options.zoomMin=t.intervalMin,console.log("WARNING: Option intervalMin is deprecated. Use zoomMin instead")),null!=t.intervalMax&&(this.options.zoomMax=t.intervalMax,console.log("WARNING: Option intervalMax is deprecated. Use zoomMax instead")),t.scale&&t.step&&this.step.setScale(t.scale,t.step)}this.options.autoHeight="auto"===this.options.height},links.Timeline.prototype.getOptions=function(){return this.options},links.Timeline.prototype.addItemType=function(t,e){this.itemTypes[t]=e},links.Timeline.mapColumnIds=function(t){for(var e={},n=t.getNumberOfColumns(),i=!0,o=0;n>o;o++){var a=t.getColumnId(o)||t.getColumnLabel(o);e[a]=o,("start"==a||"end"==a||"content"==a||"group"==a||"className"==a||"editable"==a||"type"==a)&&(i=!1)}return i&&(e.start=0,e.end=1,e.content=2,n>3&&(e.group=3),n>4&&(e.className=4),n>5&&(e.editable=5),n>6&&(e.type=6)),e},links.Timeline.prototype.setData=function(t){this.unselectItem(),t||(t=[]),this.stackCancelAnimation(),this.clearItems(),this.data=t;var e=this.items;if(this.deleteGroups(),google&&google.visualization&&t instanceof google.visualization.DataTable)for(var n=links.Timeline.mapColumnIds(t),i=0,o=t.getNumberOfRows();o>i;i++)e.push(this.createItem({start:null!=n.start?t.getValue(i,n.start):void 0,end:null!=n.end?t.getValue(i,n.end):void 0,content:null!=n.content?t.getValue(i,n.content):void 0,group:null!=n.group?t.getValue(i,n.group):void 0,className:null!=n.className?t.getValue(i,n.className):void 0,editable:null!=n.editable?t.getValue(i,n.editable):void 0,type:null!=n.type?t.getValue(i,n.type):void 0}));else{if(!links.Timeline.isArray(t))throw"Unknown data type. DataTable or Array expected.";for(i=0,o=t.length;o>i;i++){var a=t[i],s=this.createItem(a);e.push(s)}}this.options.cluster&&this.clusterGenerator.setData(this.items),this.render({animate:!1})},links.Timeline.prototype.getData=function(){return this.data},links.Timeline.prototype.updateData=function(t,e){var n,i=this.data;if(google&&google.visualization&&i instanceof google.visualization.DataTable){var o=t+1-i.getNumberOfRows();o>0&&i.addRows(o);var a=links.Timeline.mapColumnIds(i);for(n in e)if(e.hasOwnProperty(n)){var s=a[n];if(null==s){var r=e[n],l="string";"number"==typeof r?l="number":"boolean"==typeof r?l="boolean":r instanceof Date&&(l="datetime"),s=i.addColumn(l,n)}i.setValue(t,s,e[n])}}else{if(!links.Timeline.isArray(i))throw"Cannot update data, unknown type of data";var c=i[t];for(n in null==c&&(c={},i[t]=c),e)e.hasOwnProperty(n)&&(c[n]=e[n])}},links.Timeline.prototype.getItemIndex=function(t){for(var e=t,n=this.dom.items.frame,i=this.items,o=void 0;e.parentNode&&e.parentNode!==n;)e=e.parentNode;if(e.parentNode===n)for(var a=0,s=i.length;s>a;a++)if(i[a].dom===e){o=a;break}return o},links.Timeline.prototype.getClusterIndex=function(t){var e=t,n=this.dom.items.frame,i=this.clusters,o=void 0;if(this.clusters){for(;e.parentNode&&e.parentNode!==n;)e=e.parentNode;if(e.parentNode===n)for(var a=0,s=i.length;s>a;a++)if(i[a].dom===e){o=a;break}}return o},links.Timeline.prototype.getVisibleItems=function(t,e){var n=this.items,i=[];if(n)for(var o=0,a=n.length;a>o;o++){var s=n[o];s.end?t<=s.start&&s.end<=e&&i.push({row:o}):t<=s.start&&s.start<=e&&i.push({row:o})}return i},links.Timeline.prototype.setSize=function(t,e){t&&(this.options.width=t,this.dom.frame.style.width=t),e&&(this.options.height=e,this.options.autoHeight="auto"===this.options.height,"auto"!==e&&(this.dom.frame.style.height=e)),this.render({animate:!1})},links.Timeline.prototype.setVisibleChartRange=function(t,e,n){var i={};t&&e||(i=this.getDataRange(!0)),t||(e?i.min&&i.min.valueOf()<e.valueOf()?t=i.min:(t=new Date(e.valueOf())).setDate(t.getDate()-7):(t=new Date).setDate(t.getDate()-3)),e||(i.max?e=i.max:(e=new Date(t.valueOf())).setDate(e.getDate()+7)),t>=e&&(e=new Date(t.valueOf())).setDate(e.getDate()+7);var o=this.options.min?this.options.min:void 0;null!=o&&t.valueOf()<o.valueOf()&&(t=new Date(o.valueOf()));var a=this.options.max?this.options.max:void 0;null!=a&&e.valueOf()>a.valueOf()&&(e=new Date(a.valueOf())),this.applyRange(t,e),null==n||1==n?this.render({animate:!1}):this.recalcConversion()},links.Timeline.prototype.setVisibleChartRangeAuto=function(){var t=this.getDataRange(!0);this.setVisibleChartRange(t.min,t.max)},links.Timeline.prototype.setVisibleChartRangeNow=function(){var t=new Date,e=this.end.valueOf()-this.start.valueOf(),n=new Date(t.valueOf()-e/2),i=new Date(n.valueOf()+e);this.setVisibleChartRange(n,i)},links.Timeline.prototype.getVisibleChartRange=function(){return{start:new Date(this.start.valueOf()),end:new Date(this.end.valueOf())}},links.Timeline.prototype.getDataRange=function(t){var e=this.items,n=void 0,i=void 0;if(e)for(var o=0,a=e.length;a>o;o++){var s=e[o],r=null!=s.start?s.start.valueOf():void 0,l=null!=s.end?s.end.valueOf():r;null!=r&&(n=null!=n?Math.min(n.valueOf(),r.valueOf()):r),null!=l&&(i=null!=i?Math.max(i.valueOf(),l.valueOf()):l)}if(n&&i&&t){var c=i-n;n-=.05*c,i+=.05*c}return{min:null!=n?new Date(n):void 0,max:null!=i?new Date(i):void 0}},links.Timeline.prototype.render=function(t){var e=(this.reflowFrame(),this.reflowAxis(),this.reflowGroups(),this.reflowItems(),this.options.animate);if(t&&null!=t.animate&&(e=t.animate),this.recalcConversion(),this.clusterItems(),this.filterItems(),this.stackItems(e),this.recalcItems(),this.repaint()){var n=t?t.renderTimesLeft:void 0;null==n&&(n=5),n>0&&this.render({animate:t?t.animate:void 0,renderTimesLeft:n-1})}},links.Timeline.prototype.repaint=function(){var t=this.repaintFrame(),e=this.repaintAxis(),n=this.repaintGroups(),i=this.repaintItems();return this.repaintCurrentTime(),this.repaintCustomTime(),t||e||n||i},links.Timeline.prototype.reflowFrame=function(){var t=this.dom,e=(this.options,this.size),n=!1,i=t.frame?t.frame.offsetWidth:0,o=t.frame?t.frame.clientHeight:0;return n=(n=n||e.frameWidth!==i)||e.frameHeight!==o,e.frameWidth=i,e.frameHeight=o,n},links.Timeline.prototype.repaintFrame=function(){var t=!1,e=this.dom,n=this.options,i=this.size;e.frame||(e.frame=document.createElement("DIV"),e.frame.className="timeline-frame ui-widget ui-widget-content ui-corner-all",e.container.appendChild(e.frame),t=!0);var o=n.autoHeight?i.actualHeight+"px":n.height||"100%",a=n.width||"100%";if(t=(t=t||e.frame.style.height!=o)||e.frame.style.width!=a,e.frame.style.height=o,e.frame.style.width=a,!e.content){e.content=document.createElement("DIV"),e.content.className="timeline-content",e.frame.appendChild(e.content);var s=document.createElement("DIV");s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.height="100%",s.style.width="0px",e.content.appendChild(s),e.contentTimelines=s;var r=this.eventParams,l=this;r.onMouseDown||(r.onMouseDown=function(t){l.onMouseDown(t)},links.Timeline.addEventListener(e.content,"mousedown",r.onMouseDown)),r.onTouchStart||(r.onTouchStart=function(t){l.onTouchStart(t)},links.Timeline.addEventListener(e.content,"touchstart",r.onTouchStart)),r.onMouseWheel||(r.onMouseWheel=function(t){l.onMouseWheel(t)},links.Timeline.addEventListener(e.content,"mousewheel",r.onMouseWheel)),r.onDblClick||(r.onDblClick=function(t){l.onDblClick(t)},links.Timeline.addEventListener(e.content,"dblclick",r.onDblClick)),t=!0}return e.content.style.left=i.contentLeft+"px",e.content.style.top="0px",e.content.style.width=i.contentWidth+"px",e.content.style.height=i.frameHeight+"px",this.repaintNavigation(),t},links.Timeline.prototype.reflowAxis=function(){var t=!1,e=this.dom,n=this.options,i=this.size,o=e.axis,a=o&&o.characterMinor?o.characterMinor.clientWidth:0,s=o&&o.characterMinor?o.characterMinor.clientHeight:0,r=o&&o.characterMajor?o.characterMajor.clientWidth:0,l=o&&o.characterMajor?o.characterMajor.clientHeight:0,c=(n.showMinorLabels?s:0)+(n.showMajorLabels?l:0),d=n.axisOnTop?0:i.frameHeight-c,u=n.axisOnTop?c:d;t=(t=(t=t||i.axis.top!==d)||i.axis.line!==u)||i.axis.height!==c,i.axis.top=d,i.axis.line=u,i.axis.height=c,i.axis.labelMajorTop=n.axisOnTop?0:u+(n.showMinorLabels?s:0),i.axis.labelMinorTop=n.axisOnTop?n.showMajorLabels?l:0:u,i.axis.lineMinorTop=n.axisOnTop?i.axis.labelMinorTop:0,i.axis.lineMinorHeight=n.showMajorLabels?i.frameHeight-l:i.frameHeight,i.axis.lineMinorWidth=o&&o.minorLines&&o.minorLines.length?o.minorLines[0].offsetWidth:1,i.axis.lineMajorWidth=o&&o.majorLines&&o.majorLines.length?o.majorLines[0].offsetWidth:1,t=(t=(t=(t=t||i.axis.characterMinorWidth!==a)||i.axis.characterMinorHeight!==s)||i.axis.characterMajorWidth!==r)||i.axis.characterMajorHeight!==l,i.axis.characterMinorWidth=a,i.axis.characterMinorHeight=s,i.axis.characterMajorWidth=r,i.axis.characterMajorHeight=l;var h=Math.max(i.frameHeight-c,0);return i.contentLeft=n.groupsOnRight?0:i.groupsWidth,i.contentWidth=Math.max(i.frameWidth-i.groupsWidth,0),i.contentHeight=h,t},links.Timeline.prototype.repaintAxis=function(){var t=!1,e=this.dom,n=this.options,i=this.size,o=this.step,a=e.axis;a||(a={},e.axis=a),i.axis.properties||(i.axis.properties={}),a.minorTexts||(a.minorTexts=[]),a.minorLines||(a.minorLines=[]),a.majorTexts||(a.majorTexts=[]),a.majorLines||(a.majorLines=[]),a.frame||(a.frame=document.createElement("DIV"),a.frame.style.position="absolute",a.frame.style.left="0px",a.frame.style.top="0px",e.content.appendChild(a.frame)),e.content.removeChild(a.frame),a.frame.style.width=i.contentWidth+"px",a.frame.style.height=i.axis.height+"px";var s=this.screenToTime(0),r=this.screenToTime(i.contentWidth);i.axis.characterMinorWidth&&(this.minimumStep=this.screenToTime(6*i.axis.characterMinorWidth)-this.screenToTime(0),o.setRange(s,r,this.minimumStep));var l=this.repaintAxisCharacters();t=t||l,this.repaintAxisStartOverwriting(),o.start();for(var c=void 0,d=0;!o.end()&&1e3>d;){d++;var u=o.getCurrent(),h=this.timeToScreen(u),p=o.isMajor();n.showMinorLabels&&this.repaintAxisMinorText(h,o.getLabelMinor(n)),p&&n.showMajorLabels?(h>0&&(null==c&&(c=h),this.repaintAxisMajorText(h,o.getLabelMajor(n))),this.repaintAxisMajorLine(h)):this.repaintAxisMinorLine(h),o.next()}if(n.showMajorLabels){var f=this.screenToTime(0),m=this.step.getLabelMajor(n,f),g=m.length*i.axis.characterMajorWidth+10;(null==c||c>g)&&this.repaintAxisMajorText(0,m,f)}return this.repaintAxisEndOverwriting(),this.repaintAxisHorizontal(),e.content.insertBefore(a.frame,e.content.firstChild),t},links.Timeline.prototype.repaintAxisCharacters=function(){var t,e=!1,n=this.dom.axis;if(!n.characterMinor){t=document.createTextNode("0");var i=document.createElement("DIV");i.className="timeline-axis-text timeline-axis-text-minor",i.appendChild(t),i.style.position="absolute",i.style.visibility="hidden",i.style.paddingLeft="0px",i.style.paddingRight="0px",n.frame.appendChild(i),n.characterMinor=i,e=!0}if(!n.characterMajor){t=document.createTextNode("0");var o=document.createElement("DIV");o.className="timeline-axis-text timeline-axis-text-major",o.appendChild(t),o.style.position="absolute",o.style.visibility="hidden",o.style.paddingLeft="0px",o.style.paddingRight="0px",n.frame.appendChild(o),n.characterMajor=o,e=!0}return e},links.Timeline.prototype.repaintAxisStartOverwriting=function(){var t=this.size.axis.properties;t.minorTextNum=0,t.minorLineNum=0,t.majorTextNum=0,t.majorLineNum=0},links.Timeline.prototype.repaintAxisEndOverwriting=function(){var t,e=this.dom,n=this.size.axis.properties,i=this.dom.axis.frame,o=e.axis.minorTexts;for(t=n.minorTextNum;o.length>t;){var a=o[t];i.removeChild(a),o.splice(t,1)}var s=e.axis.minorLines;for(t=n.minorLineNum;s.length>t;){var r=s[t];i.removeChild(r),s.splice(t,1)}var l=e.axis.majorTexts;for(t=n.majorTextNum;l.length>t;){var c=l[t];i.removeChild(c),l.splice(t,1)}var d=e.axis.majorLines;for(t=n.majorLineNum;d.length>t;){var u=d[t];i.removeChild(u),d.splice(t,1)}},links.Timeline.prototype.repaintAxisHorizontal=function(){var t=this.dom.axis,e=this.size,n=this.options,i=n.showMinorLabels||n.showMajorLabels;if(i){if(!t.backgroundLine){var o=document.createElement("DIV");o.className="timeline-axis",o.style.position="absolute",o.style.left="0px",o.style.width="100%",o.style.border="none",t.frame.insertBefore(o,t.frame.firstChild),t.backgroundLine=o}t.backgroundLine&&(t.backgroundLine.style.top=e.axis.top+"px",t.backgroundLine.style.height=e.axis.height+"px")}else t.backgroundLine&&(t.frame.removeChild(t.backgroundLine),delete t.backgroundLine);if(i){if(t.line){var a=t.frame.removeChild(t.line);t.frame.appendChild(a)}else{(a=document.createElement("DIV")).className="timeline-axis",a.style.position="absolute",a.style.left="0px",a.style.width="100%",a.style.height="0px",t.frame.appendChild(a),t.line=a}t.line.style.top=e.axis.line+"px"}else t.line&&t.line.parentElement&&(t.frame.removeChild(t.line),delete t.line)},links.Timeline.prototype.repaintAxisMinorText=function(t,e){var n,i=this.size,o=this.dom,a=i.axis.properties,s=o.axis.frame,r=o.axis.minorTexts,l=a.minorTextNum;if(l<r.length)n=r[l];else{var c=document.createTextNode("");(n=document.createElement("DIV")).appendChild(c),n.className="timeline-axis-text timeline-axis-text-minor",n.style.position="absolute",s.appendChild(n),r.push(n)}n.childNodes[0].nodeValue=e,n.style.left=t+"px",n.style.top=i.axis.labelMinorTop+"px",a.minorTextNum++},links.Timeline.prototype.repaintAxisMinorLine=function(t){var e,n=this.size.axis,i=this.dom,o=n.properties,a=i.axis.frame,s=i.axis.minorLines,r=o.minorLineNum;r<s.length?e=s[r]:((e=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-minor",e.style.position="absolute",e.style.width="0px",a.appendChild(e),s.push(e)),e.style.top=n.lineMinorTop+"px",e.style.height=n.lineMinorHeight+"px",e.style.left=t-n.lineMinorWidth/2+"px",o.minorLineNum++},links.Timeline.prototype.repaintAxisMajorText=function(t,e){var n,i=this.size,o=i.axis.properties,a=this.dom.axis.frame,s=this.dom.axis.majorTexts,r=o.majorTextNum;if(r<s.length)n=s[r];else{var l=document.createTextNode(e);(n=document.createElement("DIV")).className="timeline-axis-text timeline-axis-text-major",n.appendChild(l),n.style.position="absolute",n.style.top="0px",a.appendChild(n),s.push(n)}n.childNodes[0].nodeValue=e,n.style.top=i.axis.labelMajorTop+"px",n.style.left=t+"px",o.majorTextNum++},links.Timeline.prototype.repaintAxisMajorLine=function(t){var e,n=this.size,i=n.axis.properties,o=this.size.axis,a=this.dom.axis.frame,s=this.dom.axis.majorLines,r=i.majorLineNum;r<s.length?e=s[r]:((e=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-major",e.style.position="absolute",e.style.top="0px",e.style.width="0px",a.appendChild(e),s.push(e)),e.style.left=t-o.lineMajorWidth/2+"px",e.style.height=n.frameHeight+"px",i.majorLineNum++},links.Timeline.prototype.reflowItems=function(){var t,e,n,i=!1,o=this.groups,a=this.renderedItems;for(o&&o.forEach((function(t){t.itemsHeight=0})),t=0,e=a.length;e>t;t++){var s=a[t],r=s.dom;if(n=s.group,r){var l=r?r.clientWidth:0,c=r?r.clientHeight:0;i=(i=i||s.width!=l)||s.height!=c,s.width=l,s.height=c,s.reflow()}n&&(n.itemsHeight=Math.max(this.options.groupMinHeight,n.itemsHeight?Math.max(n.itemsHeight,s.height):s.height))}return i},links.Timeline.prototype.recalcItems=function(){var t,e,n,i,o,a,s=!1,r=this.groups,l=this.size,c=this.options,d=this.renderedItems,u=0;if(0==r.length){if(c.autoHeight||c.cluster){var h=0,p=0;if(this.stack&&this.stack.finalItems)for((i=(o=this.stack.finalItems)[0])&&i.top&&(h=i.top,p=i.top+i.height),t=1,e=o.length;e>t;t++)i=o[t],h=Math.min(h,i.top),p=Math.max(p,i.top+i.height);else for((n=d[0])&&n.top&&(h=n.top,p=n.top+n.height),t=1,e=d.length;e>t;t++)(n=d[t]).top&&(h=Math.min(h,n.top),p=Math.max(p,n.top+n.height));if((u=p-h+2*c.eventMarginAxis+l.axis.height)<c.minHeight&&(u=c.minHeight),l.actualHeight!=u&&c.autoHeight&&!c.axisOnTop){var f=u-l.actualHeight;if(this.stack&&this.stack.finalItems)for(t=0,e=(o=this.stack.finalItems).length;e>t;t++)o[t].top+=f,o[t].item.top+=f;else for(t=0,e=d.length;e>t;t++)d[t].top+=f}}}else{for(u=l.axis.height+2*c.eventMarginAxis,t=0,e=r.length;e>t;t++){var m=(a=r[t]).itemsHeight;s=s||m!=a.height,a.height=Math.max(m,c.groupMinHeight),u+=r[t].height+c.eventMargin}var g=c.eventMargin,v=c.axisOnTop?c.eventMarginAxis+g/2:l.contentHeight-c.eventMarginAxis+g/2,b=l.axis.height;for(t=0,e=r.length;e>t;t++)a=r[t],c.axisOnTop?(a.top=v+b,a.labelTop=v+b+(a.height-a.labelHeight)/2,a.lineTop=v+b+a.height+g/2,v+=a.height+g):(v-=a.height+g,a.top=v,a.labelTop=v+(a.height-a.labelHeight)/2,a.lineTop=v-g/2);s=!0}return u<c.minHeight&&(u=c.minHeight),s=s||u!=l.actualHeight,l.actualHeight=u,s},links.Timeline.prototype.clearItems=function(){var t=this.renderQueue.hide;this.renderedItems.forEach((function(e){t.push(e)})),this.clusterGenerator.clear(),this.items=[]},links.Timeline.prototype.repaintItems=function(){var t,e,n=!1,i=this.dom,o=this.size,a=this,s=this.renderedItems;i.items||(i.items={});var r=i.items.frame;r||((r=document.createElement("DIV")).style.position="relative",i.content.appendChild(r),i.items.frame=r),r.style.left="0px",r.style.top=o.items.top+"px",r.style.height="0px",i.content.removeChild(r);var l=this.renderQueue,c=[];for(n=n||l.show.length>0||l.update.length>0||l.hide.length>0;t=l.show.shift();)t.showDOM(r),t.getImageUrls(c),s.push(t);for(;t=l.update.shift();)t.updateDOM(r),t.getImageUrls(c),-1==(e=this.renderedItems.indexOf(t))&&s.push(t);for(;t=l.hide.shift();)t.hideDOM(r),-1!=(e=this.renderedItems.indexOf(t))&&s.splice(e,1);if(s.forEach((function(t){t.updatePosition(a)})),this.repaintDeleteButton(),this.repaintDragAreas(),i.content.appendChild(r),c.length){links.imageloader.loadAll(c,(function(){a.render()}),!1)}return n},links.Timeline.prototype.reflowGroups=function(){for(var t=!1,e=this.options,n=this.size,i=this.dom,o=0,a=this.groups,s=this.dom.groups?this.dom.groups.labels:[],r=0,l=a.length;l>r;r++){var c=a[r],d=s[r];c.labelWidth=d?d.clientWidth:0,c.labelHeight=d?d.clientHeight:0,c.width=c.labelWidth,o=Math.max(o,c.width)}void 0!==e.groupsWidth&&(o=i.groups.frame?i.groups.frame.clientWidth:0),o+=1;var u=e.groupsOnRight?n.frameWidth-o:0;return t=(t=t||n.groupsWidth!==o)||n.groupsLeft!==u,n.groupsWidth=o,n.groupsLeft=u,t},links.Timeline.prototype.repaintGroups=function(){var t=this.dom,e=this,n=this.options,i=this.size,o=this.groups;void 0===t.groups&&(t.groups={});var a=t.groups.labels;a||(a=[],t.groups.labels=a);var s=t.groups.labelLines;s||(s=[],t.groups.labelLines=s);var r=t.groups.itemLines;r||(r=[],t.groups.itemLines=r);var l=t.groups.frame;l||((l=document.createElement("DIV")).className="timeline-groups-axis",l.style.position="absolute",l.style.overflow="hidden",l.style.top="0px",l.style.height="100%",t.frame.appendChild(l),t.groups.frame=l),l.style.left=i.groupsLeft+"px",l.style.width=void 0!==n.groupsWidth?n.groupsWidth:i.groupsWidth+"px",l.style.display=0==o.length?"none":"";for(var c=a.length,d=o.length,u=0,h=Math.min(c,d);h>u;u++){var p=o[u];(f=a[u]).innerHTML=this.getGroupName(p),f.style.display=""}for(u=c;d>u;u++){p=o[u];(f=document.createElement("DIV")).className="timeline-groups-text",f.style.position="absolute",void 0===n.groupsWidth&&(f.style.whiteSpace="nowrap"),f.innerHTML=this.getGroupName(p),l.appendChild(f),a[u]=f,(m=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-minor",m.style.position="absolute",m.style.left="0px",m.style.width="100%",m.style.height="0px",m.style.borderTopStyle="solid",l.appendChild(m),s[u]=m,(g=document.createElement("DIV")).className="timeline-axis-grid timeline-axis-grid-minor",g.style.position="absolute",g.style.left="0px",g.style.width="100%",g.style.height="0px",g.style.borderTopStyle="solid",t.content.insertBefore(g,t.content.firstChild),r[u]=g}for(u=d;c>u;u++){var f=a[u],m=s[u],g=r[u];l.removeChild(f),l.removeChild(m),t.content.removeChild(g)}a.splice(d,c-d),s.splice(d,c-d),r.splice(d,c-d),links.Timeline.addClassName(l,n.groupsOnRight?"timeline-groups-axis-onright":"timeline-groups-axis-onleft");for(u=0,h=o.length;h>u;u++){p=o[u],f=a[u],m=s[u],g=r[u];f.style.top=p.labelTop+"px",m.style.top=p.lineTop+"px",g.style.top=p.lineTop+"px",g.style.width=i.contentWidth+"px"}if(!t.groups.background){var v=document.createElement("DIV");v.className="timeline-axis",v.style.position="absolute",v.style.left="0px",v.style.width="100%",v.style.border="none",l.appendChild(v),t.groups.background=v}if(t.groups.background.style.top=i.axis.top+"px",t.groups.background.style.height=i.axis.height+"px",!t.groups.line){var b=document.createElement("DIV");b.className="timeline-axis",b.style.position="absolute",b.style.left="0px",b.style.width="100%",b.style.height="0px",l.appendChild(b),t.groups.line=b}if(t.groups.line.style.top=i.axis.line+"px",t.groups.frame&&o.length){var y=[];if(links.imageloader.filterImageUrls(t.groups.frame,y),y.length){links.imageloader.loadAll(y,(function(){e.render()}),!1)}}},links.Timeline.prototype.repaintCurrentTime=function(){var t=this.options,e=this.dom,n=this.size;if(t.showCurrentTime){if(!e.currentTime){var i=document.createElement("DIV");i.className="timeline-currenttime",i.style.position="absolute",i.style.top="0px",i.style.height="100%",e.contentTimelines.appendChild(i),e.currentTime=i}var o=new Date,a=new Date(o.valueOf()+this.clientTimeOffset),s=this.timeToScreen(a),r=s>-n.contentWidth&&s<2*n.contentWidth;e.currentTime.style.display=r?"":"none",e.currentTime.style.left=s+"px",e.currentTime.title="Current time: "+a,null!=this.currentTimeTimer&&(clearTimeout(this.currentTimeTimer),delete this.currentTimeTimer);var l=this,c=1/this.conversion.factor/2;30>c&&(c=30),this.currentTimeTimer=setTimeout((function(){l.repaintCurrentTime()}),c)}else e.currentTime&&(e.contentTimelines.removeChild(e.currentTime),delete e.currentTime)},links.Timeline.prototype.repaintCustomTime=function(){var t=this.options,e=this.dom,n=this.size;if(t.showCustomTime){if(!e.customTime){var i=document.createElement("DIV");i.className="timeline-customtime",i.style.position="absolute",i.style.top="0px",i.style.height="100%";var o=document.createElement("DIV");o.style.position="relative",o.style.top="0px",o.style.left="-10px",o.style.height="100%",o.style.width="20px",i.appendChild(o),e.contentTimelines.appendChild(i),e.customTime=i,this.customTime=new Date}var a=this.timeToScreen(this.customTime),s=a>-n.contentWidth&&a<2*n.contentWidth;e.customTime.style.display=s?"":"none",e.customTime.style.left=a+"px",e.customTime.title="Time: "+this.customTime}else e.customTime&&(e.contentTimelines.removeChild(e.customTime),delete e.customTime)},links.Timeline.prototype.repaintDeleteButton=function(){var t=this.dom,e=t.items.frame,n=t.items.deleteButton;n||((n=document.createElement("DIV")).className="timeline-navigation-delete",n.style.position="absolute",e.appendChild(n),t.items.deleteButton=n);var i=this.selection&&void 0!==this.selection.index?this.selection.index:-1,o=this.selection&&void 0!==this.selection.index?this.items[i]:void 0;if(o&&o.rendered&&this.isEditable(o)){var a=o.getRight(this),s=o.top;n.style.left=a+"px",n.style.top=s+"px",n.style.display="",e.removeChild(n),e.appendChild(n)}else n.style.display="none"},links.Timeline.prototype.repaintDragAreas=function(){var t=this.options,e=this.dom,n=this.dom.items.frame,i=e.items.dragLeft;i||((i=document.createElement("DIV")).className="timeline-event-range-drag-left",i.style.position="absolute",n.appendChild(i),e.items.dragLeft=i);var o=e.items.dragRight;o||((o=document.createElement("DIV")).className="timeline-event-range-drag-right",o.style.position="absolute",n.appendChild(o),e.items.dragRight=o);var a=this.selection&&void 0!==this.selection.index?this.selection.index:-1,s=this.selection&&void 0!==this.selection.index?this.items[a]:void 0;if(s&&s.rendered&&this.isEditable(s)&&(s instanceof links.Timeline.ItemRange||s instanceof links.Timeline.ItemFloatingRange)){var r=s.getLeft(this),l=s.getRight(this),c=s.top,d=s.height;i.style.left=r+"px",i.style.top=c+"px",i.style.width=t.dragAreaWidth+"px",i.style.height=d+"px",i.style.display="",n.removeChild(i),n.appendChild(i),o.style.left=l-t.dragAreaWidth+"px",o.style.top=c+"px",o.style.width=t.dragAreaWidth+"px",o.style.height=d+"px",o.style.display="",n.removeChild(o),n.appendChild(o)}else i.style.display="none",o.style.display="none"},links.Timeline.prototype.repaintNavigation=function(){var t=this,e=this.options,n=this.dom,i=n.frame,o=n.navBar;if(!o){var a=e.showButtonNew&&e.editable,s=e.showNavigation&&(e.zoomable||e.moveable);if((s||a)&&((o=document.createElement("DIV")).style.position="absolute",o.className="timeline-navigation ui-widget ui-state-highlight ui-corner-all",e.groupsOnRight?o.style.left="10px":o.style.right="10px",e.axisOnTop?o.style.bottom="10px":o.style.top="10px",n.navBar=o,i.appendChild(o)),a){o.addButton=document.createElement("DIV"),o.addButton.className="timeline-navigation-new",o.addButton.title=e.CREATE_NEW_EVENT;var r=document.createElement("SPAN");r.className="ui-icon ui-icon-circle-plus",o.addButton.appendChild(r);links.Timeline.addEventListener(o.addButton,"mousedown",(function(n){links.Timeline.preventDefault(n),links.Timeline.stopPropagation(n);var i=t.size.contentWidth/2,o=t.screenToTime(i);e.snapEvents&&t.step.snap(o);var a=e.NEW,s=t.groups.length?t.groups[0].content:void 0;t.addItem({start:o,content:a,group:s},!0);var r=t.items.length-1;t.selectItem(r),t.applyAdd=!0,t.trigger("add"),t.applyAdd?(t.render({animate:!1}),t.selectItem(r)):t.deleteItem(r)})),o.appendChild(o.addButton)}if(a&&s&&links.Timeline.addClassName(o.addButton,"timeline-navigation-new-line"),s){if(e.zoomable){o.zoomInButton=document.createElement("DIV"),o.zoomInButton.className="timeline-navigation-zoom-in",o.zoomInButton.title=this.options.ZOOM_IN;var l=document.createElement("SPAN");l.className="ui-icon ui-icon-circle-zoomin",o.zoomInButton.appendChild(l);links.Timeline.addEventListener(o.zoomInButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.zoom(.4),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.zoomInButton),o.zoomOutButton=document.createElement("DIV"),o.zoomOutButton.className="timeline-navigation-zoom-out",o.zoomOutButton.title=this.options.ZOOM_OUT;var c=document.createElement("SPAN");c.className="ui-icon ui-icon-circle-zoomout",o.zoomOutButton.appendChild(c);links.Timeline.addEventListener(o.zoomOutButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.zoom(-.4),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.zoomOutButton)}if(e.moveable){o.moveLeftButton=document.createElement("DIV"),o.moveLeftButton.className="timeline-navigation-move-left",o.moveLeftButton.title=this.options.MOVE_LEFT;var d=document.createElement("SPAN");d.className="ui-icon ui-icon-circle-arrow-w",o.moveLeftButton.appendChild(d);links.Timeline.addEventListener(o.moveLeftButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.move(-.2),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.moveLeftButton),o.moveRightButton=document.createElement("DIV"),o.moveRightButton.className="timeline-navigation-move-right",o.moveRightButton.title=this.options.MOVE_RIGHT;var u=document.createElement("SPAN");u.className="ui-icon ui-icon-circle-arrow-e",o.moveRightButton.appendChild(u);links.Timeline.addEventListener(o.moveRightButton,"mousedown",(function(e){links.Timeline.preventDefault(e),links.Timeline.stopPropagation(e),t.move(.2),t.trigger("rangechange"),t.trigger("rangechanged")})),o.appendChild(o.moveRightButton)}}}},links.Timeline.prototype.setCurrentTime=function(t){var e=new Date;this.clientTimeOffset=t.valueOf()-e.valueOf(),this.repaintCurrentTime()},links.Timeline.prototype.getCurrentTime=function(){var t=new Date;return new Date(t.valueOf()+this.clientTimeOffset)},links.Timeline.prototype.setCustomTime=function(t){this.customTime=new Date(t.valueOf()),this.repaintCustomTime()},links.Timeline.prototype.getCustomTime=function(){return new Date(this.customTime.valueOf())},links.Timeline.prototype.setScale=function(t,e){this.step.setScale(t,e),this.render()},links.Timeline.prototype.setAutoScale=function(t){this.step.setAutoScale(t),this.render()},links.Timeline.prototype.redraw=function(){this.setData(this.data)},links.Timeline.prototype.checkResize=function(){this.render()},links.Timeline.prototype.isEditable=function(t){return!!t&&(null!=t.editable?t.editable:this.options.editable)},links.Timeline.prototype.recalcConversion=function(){this.conversion.offset=this.start.valueOf(),this.conversion.factor=this.size.contentWidth/(this.end.valueOf()-this.start.valueOf())},links.Timeline.prototype.screenToTime=function(t){var e=this.conversion;return new Date(t/e.factor+e.offset)},links.Timeline.prototype.timeToScreen=function(t){var e=this.conversion;return(t.valueOf()-e.offset)*e.factor},links.Timeline.prototype.onTouchStart=function(t){var e=this.eventParams,n=this;if(!e.touchDown){e.touchDown=!0,e.zoomed=!1,this.onMouseDown(t),e.onTouchMove||(e.onTouchMove=function(t){n.onTouchMove(t)},links.Timeline.addEventListener(document,"touchmove",e.onTouchMove)),e.onTouchEnd||(e.onTouchEnd=function(t){n.onTouchEnd(t)},links.Timeline.addEventListener(document,"touchend",e.onTouchEnd));var i=links.Timeline.getTarget(t),o=this.getItemIndex(i);e.doubleTapStartPrev=e.doubleTapStart,e.doubleTapStart=(new Date).valueOf(),e.doubleTapItemPrev=e.doubleTapItem,e.doubleTapItem=o,links.Timeline.preventDefault(t)}},links.Timeline.prototype.onTouchMove=function(t){var e=this.eventParams;if(t.scale&&1!==t.scale&&(e.zoomed=!0),e.zoomed){if(this.options.zoomable){e.zoomed=!0;var n=t.scale,i=e.end.valueOf()-e.start.valueOf(),o=i/n-i,a=new Date(parseInt(e.start.valueOf()-o/2)),s=new Date(parseInt(e.end.valueOf()+o/2));this.setVisibleChartRange(a,s),this.trigger("rangechange")}}else this.onMouseMove(t);links.Timeline.preventDefault(t)},links.Timeline.prototype.onTouchEnd=function(t){var e=this.eventParams;e.touchDown=!1,e.zoomed&&this.trigger("rangechanged"),e.onTouchMove&&(links.Timeline.removeEventListener(document,"touchmove",e.onTouchMove),delete e.onTouchMove),e.onTouchEnd&&(links.Timeline.removeEventListener(document,"touchend",e.onTouchEnd),delete e.onTouchEnd),this.onMouseUp(t);var n=(new Date).valueOf(),i=links.Timeline.getTarget(t);this.getItemIndex(i),e.doubleTapStartPrev&&n-e.doubleTapStartPrev<500&&e.doubleTapItem==e.doubleTapItemPrev&&(e.touchDown=!0,this.onDblClick(t),e.touchDown=!1),links.Timeline.preventDefault(t)},links.Timeline.prototype.onMouseDown=function(t){t=t||window.event;var e=this.eventParams,n=this.options,i=this.dom;if((t.which?1==t.which:1==t.button)||e.touchDown){e.mouseX=links.Timeline.getPageX(t),e.mouseY=links.Timeline.getPageY(t),e.frameLeft=links.Timeline.getAbsoluteLeft(this.dom.content),e.frameTop=links.Timeline.getAbsoluteTop(this.dom.content),e.previousLeft=0,e.previousOffset=0,e.moved=!1,e.start=new Date(this.start.valueOf()),e.end=new Date(this.end.valueOf()),e.target=links.Timeline.getTarget(t);var o=i.items&&i.items.dragLeft?i.items.dragLeft:void 0,a=i.items&&i.items.dragRight?i.items.dragRight:void 0;if(e.itemDragLeft=e.target===o,e.itemDragRight=e.target===a,e.itemDragLeft||e.itemDragRight?(e.itemIndex=this.selection&&void 0!==this.selection.index?this.selection.index:void 0,delete e.clusterIndex):(e.itemIndex=this.getItemIndex(e.target),e.clusterIndex=this.getClusterIndex(e.target)),e.customTime=e.target===i.customTime||e.target.parentNode===i.customTime?this.customTime:void 0,e.addItem=n.editable&&t.ctrlKey,e.addItem){var s=e.mouseX-e.frameLeft,r=e.mouseY-e.frameTop,l=this.screenToTime(s);n.snapEvents&&this.step.snap(l);var c=new Date(l.valueOf()),d=n.NEW,u=this.getGroupFromHeight(r);this.addItem({start:l,end:c,content:d,group:this.getGroupName(u)}),e.itemIndex=this.items.length-1,delete e.clusterIndex,this.selectItem(e.itemIndex),e.itemDragRight=!0}var h=this.items[e.itemIndex],p=this.isSelected(e.itemIndex);if(e.editItem=p&&this.isEditable(h),e.editItem?(e.itemStart=h.start,e.itemEnd=h.end,e.itemGroup=h.group,e.itemLeft=h.getLeft(this),e.itemRight=h.getRight(this)):this.dom.frame.style.cursor="move",!e.touchDown){var f=this;e.onMouseMove||(e.onMouseMove=function(t){f.onMouseMove(t)},links.Timeline.addEventListener(document,"mousemove",e.onMouseMove)),e.onMouseUp||(e.onMouseUp=function(t){f.onMouseUp(t)},links.Timeline.addEventListener(document,"mouseup",e.onMouseUp)),links.Timeline.preventDefault(t)}}},links.Timeline.prototype.onMouseMove=function(t){t=t||window.event;var e=this.eventParams,n=this.size,i=this.dom,o=this.options,a=links.Timeline.getPageX(t),s=links.Timeline.getPageY(t);null==e.mouseX&&(e.mouseX=a),null==e.mouseY&&(e.mouseY=s);var r=a-e.mouseX,l=s-e.mouseY;if(Math.abs(l)>=1&&(newy=$.mobile.window.scrollTop(),$.mobile.window.scrollTop(newy-l)),Math.abs(r)>=1&&(e.moved=!0),e.customTime){var c=this.timeToScreen(e.customTime)+r;this.customTime=this.screenToTime(c),this.repaintCustomTime(),this.trigger("timechange")}else if(e.editItem){var d,u,h=this.items[e.itemIndex];e.itemDragLeft&&o.timeChangeable?(d=e.itemLeft+r,u=e.itemRight,h.start=this.screenToTime(d),o.snapEvents&&(this.step.snap(h.start),d=this.timeToScreen(h.start)),d>u&&(d=u,h.start=this.screenToTime(d)),this.trigger("change")):e.itemDragRight&&o.timeChangeable?(d=e.itemLeft,u=e.itemRight+r,h.end=this.screenToTime(u),o.snapEvents&&(this.step.snap(h.end),u=this.timeToScreen(h.end)),d>u&&(u=d,h.end=this.screenToTime(u)),this.trigger("change")):o.timeChangeable&&(d=e.itemLeft+r,h.start=this.screenToTime(d),o.snapEvents&&(this.step.snap(h.start),d=this.timeToScreen(h.start)),h.end&&(u=d+(e.itemRight-e.itemLeft),h.end=this.screenToTime(u)),this.trigger("change")),h.setPosition(d,u);var p=e.itemDragLeft||e.itemDragRight;if(this.groups.length&&!p){var f=s-e.frameTop,m=this.getGroupFromHeight(f);if(o.groupsChangeable&&h.group!==m){var g=this.items.indexOf(h);this.changeItem(g,{group:this.getGroupName(m)})}else this.repaintDeleteButton(),this.repaintDragAreas()}else this.render()}else if(o.moveable){var v=e.end.valueOf()-e.start.valueOf(),b=Math.round(-r/n.contentWidth*v),y=new Date(e.start.valueOf()+b),w=new Date(e.end.valueOf()+b);this.applyRange(y,w);var x=this.start.valueOf()-y.valueOf();x&&(b+=x),this.recalcConversion();var _=e.previousLeft||0,k=parseFloat(i.items.frame.style.left)||0,S=(e.previousOffset||0)+(k-_),T=-b/v*n.contentWidth+S;i.items.frame.style.left=T+"px",e.previousOffset=S,e.previousLeft=parseFloat(i.items.frame.style.left)||T,this.repaintCurrentTime(),this.repaintCustomTime(),this.repaintAxis(),this.trigger("rangechange")}links.Timeline.preventDefault(t)},links.Timeline.prototype.onMouseUp=function(t){var e=this.eventParams,n=this.options;if(t=t||window.event,this.dom.frame.style.cursor="auto",e.onMouseMove&&(links.Timeline.removeEventListener(document,"mousemove",e.onMouseMove),delete e.onMouseMove),e.onMouseUp&&(links.Timeline.removeEventListener(document,"mouseup",e.onMouseUp),delete e.onMouseUp),e.customTime)this.trigger("timechanged");else if(e.editItem){var i=this.items[e.itemIndex];if(e.moved||e.addItem){if(this.applyChange=!0,this.applyAdd=!0,this.updateData(e.itemIndex,{start:i.start,end:i.end}),this.trigger(e.addItem?"add":"changed"),i=this.items[e.itemIndex],e.addItem)this.applyAdd?this.updateData(e.itemIndex,{start:i.start,end:i.end,content:i.content,group:this.getGroupName(i.group)}):this.deleteItem(e.itemIndex);else if(this.applyChange)this.updateData(e.itemIndex,{start:i.start,end:i.end});else{delete this.applyChange,delete this.applyAdd,(i=this.items[e.itemIndex]).dom,i.start=e.itemStart,i.end=e.itemEnd,i.group=e.itemGroup,i.setPosition(e.itemLeft,e.itemRight),this.updateData(e.itemIndex,{start:e.itemStart,end:e.itemEnd})}this.options.cluster&&this.clusterGenerator.updateData(),this.render()}}else e.moved||e.zoomed?(this.render(),(e.moved&&n.moveable||e.zoomed&&n.zoomable)&&this.trigger("rangechanged")):e.target===this.dom.items.deleteButton?this.selection&&void 0!==this.selection.index&&this.confirmDeleteItem(this.selection.index):n.selectable&&(null!=e.itemIndex?this.isSelected(e.itemIndex)||(this.selectItem(e.itemIndex),this.trigger("select")):null!=e.clusterIndex?(this.selectCluster(e.clusterIndex),this.trigger("select")):n.unselectable&&(this.unselectItem(),this.trigger("select")))},links.Timeline.prototype.onDblClick=function(t){var e=this.eventParams,n=this.options,i=this.dom;if(this.size,t=t||window.event,null!=e.itemIndex){var o=this.items[e.itemIndex];o&&this.isEditable(o)&&this.trigger("edit")}else if(n.editable){e.mouseX=links.Timeline.getPageX(t),e.mouseY=links.Timeline.getPageY(t);var a=e.mouseX-links.Timeline.getAbsoluteLeft(i.content),s=e.mouseY-links.Timeline.getAbsoluteTop(i.content),r=this.screenToTime(a);n.snapEvents&&this.step.snap(r);var l=n.NEW,c=this.getGroupFromHeight(s);this.addItem({start:r,content:l,group:this.getGroupName(c)},!0),e.itemIndex=this.items.length-1,this.selectItem(e.itemIndex),this.applyAdd=!0,this.trigger("add"),this.applyAdd?(this.render({animate:!1}),this.selectItem(e.itemIndex)):this.deleteItem(e.itemIndex)}links.Timeline.preventDefault(t)},links.Timeline.prototype.onMouseWheel=function(t){if(this.options.zoomable){t||(t=window.event);var e=0;if(t.wheelDelta?e=t.wheelDelta/120:t.detail&&(e=-t.detail/3),e){var n=this;t.shiftKey?(n.move(-.2*e),n.trigger("rangechange"),n.trigger("rangechanged")):function(){var i=e/5,o=links.Timeline.getAbsoluteLeft(n.dom.content),a=links.Timeline.getPageX(t),s=null!=a&&null!=o?n.screenToTime(a-o):void 0;n.zoom(i,s),n.trigger("rangechange"),n.trigger("rangechanged")}()}links.Timeline.preventDefault(t)}},links.Timeline.prototype.zoom=function(t,e){null==e&&(e=new Date((this.start.valueOf()+this.end.valueOf())/2)),t>=1&&(t=.9),-1>=t&&(t=-.9),0>t&&(t/=1+t);var n=this.start.valueOf()-e,i=this.end.valueOf()-e,o=new Date(this.start.valueOf()-n*t),a=new Date(this.end.valueOf()-i*t),s=a.valueOf()-o.valueOf(),r=Number(this.options.zoomMin)||10;10>r&&(r=10),s>=r&&(this.applyRange(o,a,e),this.render({animate:this.options.animate&&this.options.animateZoom}))},links.Timeline.prototype.move=function(t){var e=this.end.valueOf()-this.start.valueOf(),n=new Date(this.start.valueOf()+e*t),i=new Date(this.end.valueOf()+e*t);this.applyRange(n,i),this.render()},links.Timeline.prototype.applyRange=function(t,e,n){var i=t.valueOf(),o=e.valueOf(),a=o-i,s=this.options,r=31536e6,l=Number(s.zoomMin)||10;10>l&&(l=10);var c=Number(s.zoomMax)||1e4*r;c>1e4*r&&(c=1e4*r),l>c&&(c=l);var d=s.min?s.min.valueOf():void 0,u=s.max?s.max.valueOf():void 0;if(null!=d&&null!=u){if(d>=u){u=d+864e5}c>u-d&&(c=u-d),l>u-d&&(l=u-d)}if(i>=o&&(o+=864e5),l>a){var h=l-a,p=n?(n.valueOf()-i)/a:.5;i-=Math.round(h*p),o+=Math.round(h*(1-p))}if(a>c){var h=a-c;p=n?(n.valueOf()-i)/a:.5;i+=Math.round(h*p),o-=Math.round(h*(1-p))}null!=d&&(0>(h=i-d)&&(i-=h,o-=h));null!=u&&(0>(h=u-o)&&(i+=h,o+=h));this.start=new Date(i),this.end=new Date(o)},links.Timeline.prototype.confirmDeleteItem=function(t){this.applyDelete=!0,this.isSelected(t)||this.selectItem(t),this.trigger("delete"),this.applyDelete&&this.deleteItem(t),delete this.applyDelete},links.Timeline.prototype.deleteItem=function(t,e){if(t>=this.items.length)throw"Cannot delete row, index out of range";this.selection&&void 0!==this.selection.index&&(this.selection.index==t?this.unselectItem():this.selection.index>t&&this.selection.index--);var n=this.items.splice(t,1)[0];if(this.renderQueue.hide.push(n),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRow(t);else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(t,1)}this.options.cluster&&this.clusterGenerator.updateData(),e||this.render()},links.Timeline.prototype.deleteAllItems=function(){if(this.unselectItem(),this.clearItems(),this.deleteGroups(),this.data)if(google&&google.visualization&&this.data instanceof google.visualization.DataTable)this.data.removeRows(0,this.data.getNumberOfRows());else{if(!links.Timeline.isArray(this.data))throw"Cannot delete row from data, unknown data type";this.data.splice(0,this.data.length)}this.options.cluster&&this.clusterGenerator.updateData(),this.render()},links.Timeline.prototype.getGroupFromHeight=function(t){var e,n,i=this.groups;if(i.length){if(this.options.axisOnTop){for(e=i.length-1;e>=0;e--)if(t>(n=i[e]).top)return n}else for(e=0;e<i.length;e++)if(t>(n=i[e]).top)return n;return n}},links.Timeline.Item=function(t,e){if(t&&(this.start=t.start,this.end=t.end,this.content=t.content,this.className=t.className,this.editable=t.editable,this.group=t.group,this.type=t.type),this.top=0,this.left=0,this.width=0,this.height=0,this.lineWidth=0,this.dotWidth=0,this.dotHeight=0,this.rendered=!1,e)for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n])},links.Timeline.Item.prototype.reflow=function(){return!1},links.Timeline.Item.prototype.getImageUrls=function(t){this.dom&&links.imageloader.filterImageUrls(this.dom,t)},links.Timeline.Item.prototype.select=function(){},links.Timeline.Item.prototype.unselect=function(){},links.Timeline.Item.prototype.createDOM=function(){},links.Timeline.Item.prototype.showDOM=function(){},links.Timeline.Item.prototype.hideDOM=function(){},links.Timeline.Item.prototype.updateDOM=function(){},links.Timeline.Item.prototype.updatePosition=function(){},links.Timeline.Item.prototype.isRendered=function(){return this.rendered},links.Timeline.Item.prototype.isVisible=function(){return!1},links.Timeline.Item.prototype.setPosition=function(){},links.Timeline.Item.prototype.getLeft=function(){return 0},links.Timeline.Item.prototype.getRight=function(){return 0},links.Timeline.Item.prototype.getWidth=function(){return this.width||0},links.Timeline.ItemBox=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemBox.prototype=new links.Timeline.Item,links.Timeline.ItemBox.prototype.reflow=function(){var t=this.dom,e=t.dot.offsetHeight,n=t.dot.offsetWidth,i=t.line.offsetWidth,o=this.dotHeight!=e||this.dotWidth!=n||this.lineWidth!=i;return this.dotHeight=e,this.dotWidth=n,this.lineWidth=i,o},links.Timeline.ItemBox.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active"),links.Timeline.addClassName(t.line,"timeline-event-selected ui-state-active"),links.Timeline.addClassName(t.dot,"timeline-event-selected ui-state-active")},links.Timeline.ItemBox.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active"),links.Timeline.removeClassName(t.line,"timeline-event-selected ui-state-active"),links.Timeline.removeClassName(t.dot,"timeline-event-selected ui-state-active")},links.Timeline.ItemBox.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute",t.style.left=this.left+"px",t.style.top=this.top+"px";var e=document.createElement("DIV");e.className="timeline-event-content",e.innerHTML=this.content,t.appendChild(e);var n=document.createElement("DIV");n.style.position="absolute",n.style.width="0px",t.line=n;var i=document.createElement("DIV");return i.style.position="absolute",i.style.width="0px",i.style.height="0px",t.dot=i,this.dom=t,this.updateDOM(),t},links.Timeline.ItemBox.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),t.insertBefore(e.line,t.firstChild),t.appendChild(e.dot),this.rendered=!0)},links.Timeline.ItemBox.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),t.line&&t.line.parentNode&&t.line.parentNode.removeChild(t.line),t.dot&&t.dot.parentNode&&t.dot.parentNode.removeChild(t.dot),this.rendered=!1)},links.Timeline.ItemBox.prototype.updateDOM=function(){var t=this.dom;if(t){var e=t.line,n=t.dot;t.firstChild.innerHTML=this.content,t.className="timeline-event timeline-event-box ui-widget ui-state-default",e.className="timeline-event timeline-event-line ui-widget ui-state-default",n.className="timeline-event timeline-event-dot ui-widget ui-state-default",this.isCluster&&(links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(e,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(n,"timeline-event-cluster ui-widget-header")),this.className&&(links.Timeline.addClassName(t,this.className),links.Timeline.addClassName(e,this.className),links.Timeline.addClassName(n,this.className))}},links.Timeline.ItemBox.prototype.updatePosition=function(t){var e=this.dom;if(e){var n=t.timeToScreen(this.start),i=t.options.axisOnTop,o=t.size.axis.top,a=t.size.axis.height,s=t.options.box&&t.options.box.align?t.options.box.align:void 0;e.style.top=this.top+"px",e.style.left="right"==s?n-this.width+"px":"left"==s?n+"px":n-this.width/2+"px";var r=e.line,l=e.dot;r.style.left=n-this.lineWidth/2+"px",l.style.left=n-this.dotWidth/2+"px",i?(r.style.top=a+"px",r.style.height=Math.max(this.top-a,0)+"px",l.style.top=a-this.dotHeight/2+"px"):(r.style.top=this.top+this.height+"px",r.style.height=Math.max(o-this.top-this.height,0)+"px",l.style.top=o-this.dotHeight/2+"px")}},links.Timeline.ItemBox.prototype.isVisible=function(t,e){return!this.cluster&&(this.start>t&&this.start<e)},links.Timeline.ItemBox.prototype.setPosition=function(t){var e=this.dom;e.style.left=t-this.width/2+"px",e.line.style.left=t-this.lineWidth/2+"px",e.dot.style.left=t-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,e.style.top=this.top+"px")},links.Timeline.ItemBox.prototype.getLeft=function(t){var e=t.options.box&&t.options.box.align?t.options.box.align:void 0;return t.timeToScreen(this.start)-("right"==e?width:this.width/2)},links.Timeline.ItemBox.prototype.getRight=function(t){var e=t.options.box&&t.options.box.align?t.options.box.align:void 0,n=t.timeToScreen(this.start);return"right"==e?n:"left"==e?n+this.width:n+this.width/2},links.Timeline.ItemRange=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemRange.prototype=new links.Timeline.Item,links.Timeline.ItemRange.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemRange.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemRange.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute";var e=document.createElement("DIV");return e.className="timeline-event-content",t.appendChild(e),this.dom=t,this.updateDOM(),t},links.Timeline.ItemRange.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),this.rendered=!0)},links.Timeline.ItemRange.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),this.rendered=!1)},links.Timeline.ItemRange.prototype.updateDOM=function(){var t=this.dom;t&&(t.firstChild.innerHTML=this.content,t.className="timeline-event timeline-event-range ui-widget ui-state-default",this.isCluster&&links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),this.className&&links.Timeline.addClassName(t,this.className))},links.Timeline.ItemRange.prototype.updatePosition=function(t){var e=this.dom;if(e){var n=t.size.contentWidth,i=t.timeToScreen(this.start),o=t.timeToScreen(this.end);-n>i&&(i=-n),o>2*n&&(o=2*n),e.style.top=this.top+"px",e.style.left=i+"px",e.style.width=Math.max(o-i,1)+"px"}},links.Timeline.ItemRange.prototype.isVisible=function(t,e){return!this.cluster&&(this.end>t&&this.start<e)},links.Timeline.ItemRange.prototype.setPosition=function(t,e){var n=this.dom;n.style.left=t+"px",n.style.width=e-t+"px",this.group&&(this.top=this.group.top,n.style.top=this.top+"px")},links.Timeline.ItemRange.prototype.getLeft=function(t){return t.timeToScreen(this.start)},links.Timeline.ItemRange.prototype.getRight=function(t){return t.timeToScreen(this.end)},links.Timeline.ItemRange.prototype.getWidth=function(t){return t.timeToScreen(this.end)-t.timeToScreen(this.start)},links.Timeline.ItemFloatingRange=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemFloatingRange.prototype=new links.Timeline.Item,links.Timeline.ItemFloatingRange.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemFloatingRange.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemFloatingRange.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute";var e=document.createElement("DIV");return e.className="timeline-event-content",t.appendChild(e),this.dom=t,this.updateDOM(),t},links.Timeline.ItemFloatingRange.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),this.rendered=!0)},links.Timeline.ItemFloatingRange.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),this.rendered=!1)},links.Timeline.ItemFloatingRange.prototype.updateDOM=function(){var t=this.dom;t&&(t.firstChild.innerHTML=this.content,t.className="timeline-event timeline-event-range ui-widget ui-state-default",this.isCluster&&links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),this.className&&links.Timeline.addClassName(t,this.className))},links.Timeline.ItemFloatingRange.prototype.updatePosition=function(t){var e=this.dom;if(e){var n=t.size.contentWidth,i=this.getLeft(t),o=this.getRight(t);-n>i&&(i=-n),o>2*n&&(o=2*n),e.style.top=this.top+"px",e.style.left=i+"px",e.style.width=Math.max(o-i,1)+"px"}},links.Timeline.ItemFloatingRange.prototype.isVisible=function(t,e){return!this.cluster&&(this.end&&this.start?this.end>t&&this.start<e:this.start?this.start<e:!this.end||this.end>t)},links.Timeline.ItemFloatingRange.prototype.setPosition=function(t,e){var n=this.dom;n.style.left=t+"px",n.style.width=e-t+"px",this.group&&(this.top=this.group.top,n.style.top=this.top+"px")},links.Timeline.ItemFloatingRange.prototype.getLeft=function(t){return this.start?t.timeToScreen(this.start):0},links.Timeline.ItemFloatingRange.prototype.getRight=function(t){return this.end?t.timeToScreen(this.end):t.size.contentWidth},links.Timeline.ItemFloatingRange.prototype.getWidth=function(t){return this.getRight(t)-this.getLeft(t)},links.Timeline.ItemDot=function(t,e){links.Timeline.Item.call(this,t,e)},links.Timeline.ItemDot.prototype=new links.Timeline.Item,links.Timeline.ItemDot.prototype.reflow=function(){var t=this.dom,e=t.dot.offsetHeight,n=t.dot.offsetWidth,i=t.content.offsetHeight,o=this.dotHeight!=e||this.dotWidth!=n||this.contentHeight!=i;return this.dotHeight=e,this.dotWidth=n,this.contentHeight=i,o},links.Timeline.ItemDot.prototype.select=function(){var t=this.dom;links.Timeline.addClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemDot.prototype.unselect=function(){var t=this.dom;links.Timeline.removeClassName(t,"timeline-event-selected ui-state-active")},links.Timeline.ItemDot.prototype.createDOM=function(){var t=document.createElement("DIV");t.style.position="absolute";var e=document.createElement("DIV");e.className="timeline-event-content",t.appendChild(e);var n=document.createElement("DIV");return n.style.position="absolute",n.style.width="0px",n.style.height="0px",t.appendChild(n),t.content=e,t.dot=n,this.dom=t,this.updateDOM(),t},links.Timeline.ItemDot.prototype.showDOM=function(t){var e=this.dom;e||(e=this.createDOM()),e.parentNode!=t&&(e.parentNode&&this.hideDOM(),t.appendChild(e),this.rendered=!0)},links.Timeline.ItemDot.prototype.hideDOM=function(){var t=this.dom;t&&(t.parentNode&&t.parentNode.removeChild(t),this.rendered=!1)},links.Timeline.ItemDot.prototype.updateDOM=function(){if(this.dom){var t=this.dom,e=t.dot;t.firstChild.innerHTML=this.content,t.className="timeline-event-dot-container",e.className="timeline-event timeline-event-dot ui-widget ui-state-default",this.isCluster&&(links.Timeline.addClassName(t,"timeline-event-cluster ui-widget-header"),links.Timeline.addClassName(e,"timeline-event-cluster ui-widget-header")),this.className&&(links.Timeline.addClassName(t,this.className),links.Timeline.addClassName(e,this.className))}},links.Timeline.ItemDot.prototype.updatePosition=function(t){var e=this.dom;if(e){var n=t.timeToScreen(this.start);e.style.top=this.top+"px",e.style.left=n-this.dotWidth/2+"px",e.content.style.marginLeft=1.5*this.dotWidth+"px",e.dot.style.top=(this.height-this.dotHeight)/2+"px"}},links.Timeline.ItemDot.prototype.isVisible=function(t,e){return!this.cluster&&(this.start>t&&this.start<e)},links.Timeline.ItemDot.prototype.setPosition=function(t){var e=this.dom;e.style.left=t-this.dotWidth/2+"px",this.group&&(this.top=this.group.top,e.style.top=this.top+"px")},links.Timeline.ItemDot.prototype.getLeft=function(t){return t.timeToScreen(this.start)},links.Timeline.ItemDot.prototype.getRight=function(t){return t.timeToScreen(this.start)+this.width},links.Timeline.prototype.getItem=function(t){if(t>=this.items.length)throw"Cannot get item, index out of range";var e,n=this.data;if(google&&google.visualization&&n instanceof google.visualization.DataTable){var i=links.Timeline.mapColumnIds(n);for(var o in e={},i)i.hasOwnProperty(o)&&(e[o]=this.data.getValue(t,i[o]))}else{if(!links.Timeline.isArray(this.data))throw"Unknown data type. DataTable or Array expected.";e=links.Timeline.clone(this.data[t])}var a=this.items[t];return e.start=new Date(a.start.valueOf()),a.end&&(e.end=new Date(a.end.valueOf())),e.content=a.content,a.group&&(e.group=this.getGroupName(a.group)),a.className&&(e.className=a.className),void 0!==a.editable&&(e.editable=a.editable),a.type&&(e.type=a.type),e},links.Timeline.prototype.getCluster=function(t){if(t>=this.clusters.length)throw"Cannot get cluster, index out of range";var e={},n=this.clusters[t],i=n.items;e.start=new Date(n.start.valueOf()),n.type&&(e.type=n.type),e.items=[];for(var o=0;o<i.length;o++)for(var a=0;a<this.items.length;a++)if(this.items[a]==i[o]){e.items.push(this.getItem(a));break}return e},links.Timeline.prototype.addItem=function(t,e){var n=[t];this.addItems(n,e)},links.Timeline.prototype.addItems=function(t,e){var n=this,i=this.items;t.forEach((function(t){var e=i.length;i.push(n.createItem(t)),n.updateData(e,t)})),this.options.cluster&&this.clusterGenerator.updateData(),e||this.render({animate:!1})},links.Timeline.prototype.createItem=function(t){var e=t.type||(t.end?"range":this.options.style),n=links.Timeline.clone(t);n.type=e,n.group=this.getGroup(t.group);var i,o=this.options;return i=o.axisOnTop?this.size.axis.height+o.eventMarginAxis+o.eventMargin/2:this.size.contentHeight-o.eventMarginAxis-o.eventMargin/2,e in this.itemTypes?new this.itemTypes[e](n,{top:i}):(console.log('ERROR: Unknown event type "'+e+'"'),new links.Timeline.Item(n,{top:i}))},links.Timeline.prototype.changeItem=function(t,e,n){var i=this.items[t];if(!i)throw"Cannot change item, index out of range";var o=this.createItem({start:e.hasOwnProperty("start")?e.start:i.start,end:e.hasOwnProperty("end")?e.end:i.end,content:e.hasOwnProperty("content")?e.content:i.content,group:e.hasOwnProperty("group")?e.group:this.getGroupName(i.group),className:e.hasOwnProperty("className")?e.className:i.className,editable:e.hasOwnProperty("editable")?e.editable:i.editable,type:e.hasOwnProperty("type")?e.type:i.type});this.items[t]=o,this.renderQueue.hide.push(i),this.renderQueue.show.push(o),this.updateData(t,e),this.options.cluster&&this.clusterGenerator.updateData(),n||(this.render({animate:!1}),this.selection&&this.selection.index==t&&o.select())},links.Timeline.prototype.deleteGroups=function(){this.groups=[],this.groupIndexes={}},links.Timeline.prototype.getGroup=function(t){var e=this.groups,n=this.groupIndexes,i=void 0,o=n[t];if(null==o&&null!=t){i={content:t,labelTop:0,lineTop:0},e.push(i),1==this.options.groupsOrder?e=e.sort((function(t,e){return t.content>e.content?1:t.content<e.content?-1:0})):"function"==typeof this.options.groupsOrder&&(e=e.sort(this.options.groupsOrder));for(var a=0,s=e.length;s>a;a++)n[e[a].content]=a}else i=e[o];return i},links.Timeline.prototype.getGroupName=function(t){return t?t.content:void 0},links.Timeline.prototype.cancelChange=function(){this.applyChange=!1},links.Timeline.prototype.cancelDelete=function(){this.applyDelete=!1},links.Timeline.prototype.cancelAdd=function(){this.applyAdd=!1},links.Timeline.prototype.setSelection=function(t){if(null!=t&&t.length>0){if(null!=t[0].row){var e=t[0].row;if(this.items[e]){var n=this.items[e];this.selectItem(e);var i,o=n.start,a=n.end;i=null!=a?(a.valueOf()+o.valueOf())/2:o.valueOf();var s=this.end.valueOf()-this.start.valueOf(),r=new Date(i-s/2),l=new Date(i+s/2);return this.setVisibleChartRange(r,l),!0}}}else this.unselectItem();return!1},links.Timeline.prototype.getSelection=function(){var t=[];return this.selection&&t.push(void 0!==this.selection.index?{row:this.selection.index}:{cluster:this.selection.cluster}),t},links.Timeline.prototype.selectItem=function(t){if(this.unselectItem(),this.selection=void 0,null!=this.items[t]){var e=this.items[t];e.dom,this.selection={index:t},e&&e.dom&&(this.isEditable(e)&&(e.dom.style.cursor="move"),e.select()),this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.selectCluster=function(t){this.unselectItem(),this.selection=void 0,null!=this.clusters[t]&&(this.selection={cluster:t},this.repaintDeleteButton(),this.repaintDragAreas())},links.Timeline.prototype.isSelected=function(t){return this.selection&&this.selection.index==t},links.Timeline.prototype.unselectItem=function(){if(this.selection&&void 0!==this.selection.index){var t=this.items[this.selection.index];if(t&&t.dom)t.dom.style.cursor="",t.unselect();this.selection=void 0,this.repaintDeleteButton(),this.repaintDragAreas()}},links.Timeline.prototype.stackItems=function(t){null==t&&(t=!1);var e=this.stack;if(e||(e={},this.stack=e),e.sortedItems=this.stackOrder(this.renderedItems),e.finalItems=this.stackCalculateFinal(e.sortedItems),t||e.timer){var n=this,i=function(){var t=n.stackMoveOneStep(e.sortedItems,e.finalItems);n.repaint(),t?delete e.timer:e.timer=setTimeout(i,30)};e.timer||(e.timer=setTimeout(i,30))}else this.stackMoveToFinal(e.sortedItems,e.finalItems)},links.Timeline.prototype.stackCancelAnimation=function(){this.stack&&this.stack.timer&&(clearTimeout(this.stack.timer),delete this.stack.timer)},links.Timeline.prototype.getItemsByGroup=function(t){for(var e={},n=0;n<t.length;++n){var i=t[n],o="undefined";i.group&&(o=i.group.content?i.group.content:i.group),e[o]||(e[o]=[]),e[o].push(i)}return e},links.Timeline.prototype.stackOrder=function(t){var e=t.concat([]),n=this.options.customStackOrder&&"function"==typeof this.options.customStackOrder?this.options.customStackOrder:function(t,e){return(t instanceof links.Timeline.ItemRange||t instanceof links.Timeline.ItemFloatingRange)&&!(e instanceof links.Timeline.ItemRange||e instanceof links.Timeline.ItemFloatingRange)?-1:t instanceof links.Timeline.ItemRange||t instanceof links.Timeline.ItemFloatingRange||!(e instanceof links.Timeline.ItemRange||e instanceof links.Timeline.ItemFloatingRange)?t.left-e.left:1};return e.sort(n),e},links.Timeline.prototype.stackCalculateFinal=function(t){var e,n=this.size,i=this.options,o=i.axisOnTop,a=i.eventMargin,s=i.eventMarginAxis,r=o?n.axis.height+s+a/2:n.contentHeight-s-a/2,l=[];for(e=this.getItemsByGroup(t),j=0;j<this.groups.length;++j){var c=this.groups[j];e[c.content]?(this.finalItemsPosition(e[c.content],r,c).forEach((function(t){l.push(t)})),o?r+=c.itemsHeight+a:r-=c.itemsHeight+a):o?r+=i.groupMinHeight+a:r-=i.groupMinHeight+a}return e.undefined&&this.finalItemsPosition(e.undefined,r).forEach((function(t){l.push(t)})),l},links.Timeline.prototype.finalItemsPosition=function(t,e,n){var i,o,a,s=this.options,r=s.axisOnTop,l=s.eventMargin;for(i=0,o=(a=this.initialItemsPosition(t,e)).length;o>i;i++){var c=a[i],d=null;if(this.options.stackEvents)do{null!=(d=this.stackItemsCheckOverlap(a,i,0,i-1))&&(c.top=r?d.top+d.height+l:d.top-c.height-l,c.bottom=c.top+c.height)}while(d);n&&(n.itemsHeight=r?n.itemsHeight?Math.max(n.itemsHeight,c.bottom-e):c.height+l:n.itemsHeight?Math.max(n.itemsHeight,e-c.top):c.height+l)}return a},links.Timeline.prototype.initialItemsPosition=function(t,e){for(var n=this.options.axisOnTop,i=[],o=0,a=t.length;a>o;++o){var s,r,l=t[o],c=l.height,d=l.getWidth(this),u=l.getRight(this),h=u-d;r=(s=n?e:e-c)+c,i.push({left:h,top:s,right:u,bottom:r,height:c,item:l})}return i},links.Timeline.prototype.stackMoveOneStep=function(t,e){for(var n=!0,i=0,o=e.length;o>i;i++){var a=e[i],s=a.item,r=parseInt(s.top),l=parseInt(a.top),c=l-r;if(c){var d=l==r?0:l>r?1:-1;Math.abs(c)>4&&(d=c/4);var u=parseInt(r+d);u!=l&&(n=!1),s.top=u,s.bottom=s.top+s.height}else s.top=a.top,s.bottom=a.bottom;s.left=a.left,s.right=a.right}return n},links.Timeline.prototype.stackMoveToFinal=function(t,e){for(var n=0,i=e.length;i>n;n++){var o=e[n],a=o.item;a.left=o.left,a.top=o.top,a.right=o.right,a.bottom=o.bottom}},links.Timeline.prototype.stackItemsCheckOverlap=function(t,e,n,i){for(var o=this.options.eventMargin,a=this.collision,s=t[e],r=i;r>=n;r--){var l=t[r];if(a(s,l,o)&&r!=e)return l}},links.Timeline.prototype.collision=function(t,e,n){return null==n&&(n=0),t.left-n<e.right&&t.right+n>e.left&&t.top-n<e.bottom&&t.bottom+n>e.top},links.Timeline.prototype.trigger=function(t){var e=null;switch(t){case"rangechange":case"rangechanged":e={start:new Date(this.start.valueOf()),end:new Date(this.end.valueOf())};break;case"timechange":case"timechanged":e={time:new Date(this.customTime.valueOf())}}links.events.trigger(this,t,e),google&&google.visualization&&google.visualization.events.trigger(this,t,e)},links.Timeline.prototype.clusterItems=function(){if(this.options.cluster){var t=this.clusterGenerator.getClusters(this.conversion.factor,this.options.clusterMaxItems);if(this.clusters!=t){var e=this.renderQueue;this.clusters&&this.clusters.forEach((function(t){e.hide.push(t),t.items.forEach((function(t){t.cluster=void 0}))})),t.forEach((function(t){t.items.forEach((function(e){e.cluster=t}))})),this.clusters=t}}},links.Timeline.prototype.filterItems=function(){function t(t){t.forEach((function(t){var n=t.rendered,a=t.isVisible(i,o);n!=a&&(n&&e.hide.push(t),a&&-1==e.show.indexOf(t)&&e.show.push(t))}))}var e=this.renderQueue,n=this.end-this.start,i=new Date(this.start.valueOf()-n),o=new Date(this.end.valueOf()+n);t(this.items),this.clusters&&t(this.clusters)},links.Timeline.ClusterGenerator=function(t){this.timeline=t,this.clear()},links.Timeline.ClusterGenerator.prototype.clear=function(){this.items=[],this.groups={},this.clearCache()},links.Timeline.ClusterGenerator.prototype.clearCache=function(){this.cache={},this.cacheLevel=-1,this.cache[this.cacheLevel]=[]},links.Timeline.ClusterGenerator.prototype.setData=function(t,e){this.items=t||[],this.dataChanged=!0,this.applyOnChangedLevel=!0,e&&e.applyOnChangedLevel&&(this.applyOnChangedLevel=e.applyOnChangedLevel)},links.Timeline.ClusterGenerator.prototype.updateData=function(){this.dataChanged=!0,this.applyOnChangedLevel=!1},links.Timeline.ClusterGenerator.prototype.filterData=function(){var t=this.items||[],e={};for(var n in this.groups=e,t.forEach((function(t){var n=t.group?t.group.content:"",i=e[n];i||(i=[],e[n]=i),i.push(t),t.start&&(t.center=t.end?(t.start.valueOf()+t.end.valueOf())/2:t.start.valueOf())})),e)e.hasOwnProperty(n)&&e[n].sort((function(t,e){return t.center-e.center}));this.dataChanged=!1},links.Timeline.ClusterGenerator.prototype.getClusters=function(t,e){var n=-1,i=0;if(t>0&&(n=Math.round(Math.log(100/t)/Math.log(2)),i=Math.pow(2,n)),this.dataChanged){var o=n!=this.cacheLevel;(!this.applyOnChangedLevel||o)&&(this.clearCache(),this.filterData())}this.cacheLevel=n;var a=this.cache[n];if(!a){for(var s in a=[],this.groups)if(this.groups.hasOwnProperty(s))for(var r=this.groups[s],l=r.length,c=0;l>c;){for(var d=r[c],u=1,h=c-1;h>=0&&d.center-r[h].center<i/2;)r[h].cluster||u++,h--;for(var p=c+1;p<r.length&&r[p].center-d.center<i/2;)u++,p++;for(var f=a.length-1;f>=0&&d.center-a[f].center<i/2;)d.group==a[f].group&&u++,f--;if(u>e){for(var m=u-e+1,g=[],v=void 0,b=void 0,y=void 0,w=!1,x=0,_=c;g.length<m&&_<r.length;){var k=r[_],S=k.start.valueOf(),T=k.end?k.end.valueOf():k.start.valueOf();g.push(k),v=x?x/(x+1)*v+1/(x+1)*k.center:k.center,b=null!=b?Math.min(b,S):S,y=null!=y?Math.max(y,T):T,w=w||k instanceof links.Timeline.ItemRange||k instanceof links.Timeline.ItemFloatingRange,x++,_++}var C,M='<div title="'+("Cluster containing "+x+" events. Zoom in to see the individual events.")+'">'+x+" events</div>",D=d.group?d.group.content:void 0;(C=this.timeline.createItem(w?{start:new Date(b),end:new Date(y),content:M,group:D}:{start:new Date(v),content:M,group:D})).isCluster=!0,C.items=g,C.items.forEach((function(t){t.cluster=C})),a.push(C),c+=m}else delete d.cluster,c+=1}this.cache[n]=a}return a},links.events=links.events||{listeners:[],indexOf:function(t){for(var e=this.listeners,n=0,i=this.listeners.length;i>n;n++){var o=e[n];if(o&&o.object==t)return n}return-1},addListener:function(t,e,n){var i=this.indexOf(t),o=this.listeners[i];o||(o={object:t,events:{}},this.listeners.push(o));var a=o.events[e];a||(a=[],o.events[e]=a),-1==a.indexOf(n)&&a.push(n)},removeListener:function(t,e,n){var i=this.indexOf(t),o=this.listeners[i];if(o){var a=o.events[e];if(a)-1!=(i=a.indexOf(n))&&a.splice(i,1),0==a.length&&delete o.events[e];var s=0,r=o.events;for(var l in r)r.hasOwnProperty(l)&&s++;0==s&&delete this.listeners[i]}},removeAllListeners:function(){this.listeners=[]},trigger:function(t,e,n){var i=this.indexOf(t),o=this.listeners[i];if(o){var a=o.events[e];if(a)for(var s=0,r=a.length;r>s;s++)a[s](n)}}},links.Timeline.StepDate=function(t,e,n){this.current=new Date,this._start=new Date,this._end=new Date,this.autoScale=!0,this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1,this.setRange(t,e,n)},links.Timeline.StepDate.SCALE={MILLISECOND:1,SECOND:2,MINUTE:3,HOUR:4,DAY:5,WEEKDAY:6,MONTH:7,YEAR:8},links.Timeline.StepDate.prototype.setRange=function(t,e,n){t instanceof Date&&e instanceof Date&&(this._start=null!=t?new Date(t.valueOf()):new Date,this._end=null!=e?new Date(e.valueOf()):new Date,this.autoScale&&this.setMinimumStep(n))},links.Timeline.StepDate.prototype.start=function(){this.current=new Date(this._start.valueOf()),this.roundToMinor()},links.Timeline.StepDate.prototype.roundToMinor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.step*Math.floor(this.current.getFullYear()/this.step)),this.current.setMonth(0);case links.Timeline.StepDate.SCALE.MONTH:this.current.setDate(1);case links.Timeline.StepDate.SCALE.DAY:case links.Timeline.StepDate.SCALE.WEEKDAY:this.current.setHours(0);case links.Timeline.StepDate.SCALE.HOUR:this.current.setMinutes(0);case links.Timeline.StepDate.SCALE.MINUTE:this.current.setSeconds(0);case links.Timeline.StepDate.SCALE.SECOND:this.current.setMilliseconds(0)}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.setMilliseconds(this.current.getMilliseconds()-this.current.getMilliseconds()%this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()-this.current.getSeconds()%this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()-this.current.getMinutes()%this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()-this.current.getHours()%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()-1-(this.current.getDate()-1)%this.step+1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()-this.current.getMonth()%this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()-this.current.getFullYear()%this.step)}},links.Timeline.StepDate.prototype.end=function(){return this.current.valueOf()>this._end.valueOf()},links.Timeline.StepDate.prototype.next=function(){var t=this.current.valueOf();if(this.current.getMonth()<6)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current=new Date(this.current.valueOf()+1e3*this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current=new Date(this.current.valueOf()+1e3*this.step*60);break;case links.Timeline.StepDate.SCALE.HOUR:this.current=new Date(this.current.valueOf()+1e3*this.step*60*60);var e=this.current.getHours();this.current.setHours(e-e%this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step)}else switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()+this.step);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()+this.step);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.setHours(this.current.getHours()+this.step);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case links.Timeline.StepDate.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step)}if(1!=this.step)switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:this.current.getMilliseconds()<this.step&&this.current.setMilliseconds(0);break;case links.Timeline.StepDate.SCALE.SECOND:this.current.getSeconds()<this.step&&this.current.setSeconds(0);break;case links.Timeline.StepDate.SCALE.MINUTE:this.current.getMinutes()<this.step&&this.current.setMinutes(0);break;case links.Timeline.StepDate.SCALE.HOUR:this.current.getHours()<this.step&&this.current.setHours(0);break;case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:this.current.getDate()<this.step+1&&this.current.setDate(1);break;case links.Timeline.StepDate.SCALE.MONTH:this.current.getMonth()<this.step&&this.current.setMonth(0);case links.Timeline.StepDate.SCALE.YEAR:}this.current.valueOf()==t&&(this.current=new Date(this._end.valueOf()))},links.Timeline.StepDate.prototype.getCurrent=function(){return this.current},links.Timeline.StepDate.prototype.setScale=function(t,e){this.scale=t,e>0&&(this.step=e),this.autoScale=!1},links.Timeline.StepDate.prototype.setAutoScale=function(t){this.autoScale=t},links.Timeline.StepDate.prototype.setMinimumStep=function(t){if(null!=t){var e=31104e6,n=2592e6,i=864e5,o=36e5,a=6e4,s=1e3;1e3*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1e3),500*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=500),100*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=100),50*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=50),10*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=10),5*e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=5),e>t&&(this.scale=links.Timeline.StepDate.SCALE.YEAR,this.step=1),3*n>t&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=3),n>t&&(this.scale=links.Timeline.StepDate.SCALE.MONTH,this.step=1),5*i>t&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=5),2*i>t&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=2),i>t&&(this.scale=links.Timeline.StepDate.SCALE.DAY,this.step=1),i/2>t&&(this.scale=links.Timeline.StepDate.SCALE.WEEKDAY,this.step=1),4*o>t&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=4),o>t&&(this.scale=links.Timeline.StepDate.SCALE.HOUR,this.step=1),15*a>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=15),10*a>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=10),5*a>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=5),a>t&&(this.scale=links.Timeline.StepDate.SCALE.MINUTE,this.step=1),15*s>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=15),10*s>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=10),5*s>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=5),s>t&&(this.scale=links.Timeline.StepDate.SCALE.SECOND,this.step=1),200>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=200),100>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=100),50>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=50),10>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=10),5>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=5),1>t&&(this.scale=links.Timeline.StepDate.SCALE.MILLISECOND,this.step=1)}},links.Timeline.StepDate.prototype.snap=function(t){if(this.scale==links.Timeline.StepDate.SCALE.YEAR){var e=t.getFullYear()+Math.round(t.getMonth()/12);t.setFullYear(Math.round(e/this.step)*this.step),t.setMonth(0),t.setDate(0),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MONTH)t.getDate()>15?(t.setDate(1),t.setMonth(t.getMonth()+1)):t.setDate(1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);else if(this.scale==links.Timeline.StepDate.SCALE.DAY||this.scale==links.Timeline.StepDate.SCALE.WEEKDAY){switch(this.step){case 5:case 2:t.setHours(24*Math.round(t.getHours()/24));break;default:t.setHours(12*Math.round(t.getHours()/12))}t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.HOUR){if(4===this.step)t.setMinutes(60*Math.round(t.getMinutes()/60));else t.setMinutes(30*Math.round(t.getMinutes()/30));t.setSeconds(0),t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.MINUTE){switch(this.step){case 15:case 10:t.setMinutes(5*Math.round(t.getMinutes()/5)),t.setSeconds(0);break;case 5:t.setSeconds(60*Math.round(t.getSeconds()/60));break;default:t.setSeconds(30*Math.round(t.getSeconds()/30))}t.setMilliseconds(0)}else if(this.scale==links.Timeline.StepDate.SCALE.SECOND)switch(this.step){case 15:case 10:t.setSeconds(5*Math.round(t.getSeconds()/5)),t.setMilliseconds(0);break;case 5:t.setMilliseconds(1e3*Math.round(t.getMilliseconds()/1e3));break;default:t.setMilliseconds(500*Math.round(t.getMilliseconds()/500))}else if(this.scale==links.Timeline.StepDate.SCALE.MILLISECOND){var n=this.step>5?this.step/2:1;t.setMilliseconds(Math.round(t.getMilliseconds()/n)*n)}},links.Timeline.StepDate.prototype.isMajor=function(){switch(this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return 0==this.current.getMilliseconds();case links.Timeline.StepDate.SCALE.SECOND:return 0==this.current.getSeconds();case links.Timeline.StepDate.SCALE.MINUTE:return 0==this.current.getHours()&&0==this.current.getMinutes();case links.Timeline.StepDate.SCALE.HOUR:return 0==this.current.getHours();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return 1==this.current.getDate();case links.Timeline.StepDate.SCALE.MONTH:return 0==this.current.getMonth();case links.Timeline.StepDate.SCALE.YEAR:default:return!1}},links.Timeline.StepDate.prototype.getLabelMinor=function(t,e){switch(null==e&&(e=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return String(e.getMilliseconds());case links.Timeline.StepDate.SCALE.SECOND:return String(e.getSeconds());case links.Timeline.StepDate.SCALE.MINUTE:case links.Timeline.StepDate.SCALE.HOUR:return this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2);case links.Timeline.StepDate.SCALE.WEEKDAY:return t.DAYS_SHORT[e.getDay()]+" "+e.getDate();case links.Timeline.StepDate.SCALE.DAY:return String(e.getDate());case links.Timeline.StepDate.SCALE.MONTH:return t.MONTHS_SHORT[e.getMonth()];case links.Timeline.StepDate.SCALE.YEAR:return String(e.getFullYear());default:return""}},links.Timeline.StepDate.prototype.getLabelMajor=function(t,e){switch(null==e&&(e=this.current),this.scale){case links.Timeline.StepDate.SCALE.MILLISECOND:return this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2)+":"+this.addZeros(e.getSeconds(),2);case links.Timeline.StepDate.SCALE.SECOND:return e.getDate()+" "+t.MONTHS[e.getMonth()]+" "+this.addZeros(e.getHours(),2)+":"+this.addZeros(e.getMinutes(),2);case links.Timeline.StepDate.SCALE.MINUTE:case links.Timeline.StepDate.SCALE.HOUR:return t.DAYS[e.getDay()]+" "+e.getDate()+" "+t.MONTHS[e.getMonth()]+" "+e.getFullYear();case links.Timeline.StepDate.SCALE.WEEKDAY:case links.Timeline.StepDate.SCALE.DAY:return t.MONTHS[e.getMonth()]+" "+e.getFullYear();case links.Timeline.StepDate.SCALE.MONTH:return String(e.getFullYear());default:return""}},links.Timeline.StepDate.prototype.addZeros=function(t,e){for(var n=""+t;n.length<e;)n="0"+n;return n},links.imageloader=function(){function t(t){if(1==i[t])return!0;var e=new Image;return e.src=t,!!e.complete}function e(t){return null!=o[t]}function n(n,a,s){if(null==s&&(s=!0),t(n))s&&a(n);else if(!e(n)||s){var r=o[n];if(!r){var l=new Image;l.src=n,r=[],o[n]=r,l.onload=function(){i[n]=!0,delete o[n];for(var t=0;t<r.length;t++)r[t](n)}}-1==r.indexOf(a)&&r.push(a)}}var i={},o={};return{isLoaded:t,isLoading:e,load:n,loadAll:function(e,i,o){var a=[];if(e.forEach((function(e){t(e)||a.push(e)})),a.length){var s=a.length;a.forEach((function(t){n(t,(function(){0==--s&&i()}),o)}))}else o&&i()},filterImageUrls:function t(e,n){for(var i=e.firstChild;i;){if("IMG"==i.tagName){var o=i.src;-1==n.indexOf(o)&&n.push(o)}t(i,n),i=i.nextSibling}}}}(),links.Timeline.addEventListener=function(t,e,n,i){t.addEventListener?(void 0===i&&(i=!1),"mousewheel"===e&&navigator.userAgent.indexOf("Firefox")>=0&&(e="DOMMouseScroll"),t.addEventListener(e,n,i)):t.attachEvent("on"+e,n)},links.Timeline.removeEventListener=function(t,e,n,i){t.removeEventListener?(void 0===i&&(i=!1),"mousewheel"===e&&navigator.userAgent.indexOf("Firefox")>=0&&(e="DOMMouseScroll"),t.removeEventListener(e,n,i)):t.detachEvent("on"+e,n)},links.Timeline.getTarget=function(t){var e;return t||(t=window.event),t.target?e=t.target:t.srcElement&&(e=t.srcElement),null!=e.nodeType&&3==e.nodeType&&(e=e.parentNode),e},links.Timeline.stopPropagation=function(t){t||(t=window.event),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},links.Timeline.preventDefault=function(t){t||(t=window.event),t.preventDefault?t.preventDefault():t.returnValue=!1},links.Timeline.getAbsoluteLeft=function(t){for(var e=document.documentElement,n=document.body,i=t.offsetLeft,o=t.offsetParent;null!=o&&o!=n&&o!=e;)i+=o.offsetLeft,i-=o.scrollLeft,o=o.offsetParent;return i},links.Timeline.getAbsoluteTop=function(t){for(var e=document.documentElement,n=document.body,i=t.offsetTop,o=t.offsetParent;null!=o&&o!=n&&o!=e;)i+=o.offsetTop,i-=o.scrollTop,o=o.offsetParent;return i},links.Timeline.getPageY=function(t){if("targetTouches"in t&&t.targetTouches.length&&(t=t.targetTouches[0]),"pageY"in t)return t.pageY;var e=t.clientY,n=document.documentElement,i=document.body;return e+(n&&n.scrollTop||i&&i.scrollTop||0)-(n&&n.clientTop||i&&i.clientTop||0)},links.Timeline.getPageX=function(t){if("targetTouches"in t&&t.targetTouches.length&&(t=t.targetTouches[0]),"pageX"in t)return t.pageX;var e=t.clientX,n=document.documentElement,i=document.body;return e+(n&&n.scrollLeft||i&&i.scrollLeft||0)-(n&&n.clientLeft||i&&i.clientLeft||0)},links.Timeline.addClassName=function(t,e){for(var n=t.className.split(" "),i=e.split(" "),o=!1,a=0;a<i.length;a++)-1==n.indexOf(i[a])&&(n.push(i[a]),o=!0);o&&(t.className=n.join(" "))},links.Timeline.removeClassName=function(t,e){for(var n=t.className.split(" "),i=e.split(" "),o=!1,a=0;a<i.length;a++){var s=n.indexOf(i[a]);-1!=s&&(n.splice(s,1),o=!0)}o&&(t.className=n.join(" "))},links.Timeline.isArray=function(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)},links.Timeline.clone=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},links.Timeline.parseJSONDate=function(t){if(null!=t){if(t instanceof Date)return t;var e=t.match(/\/Date\((-?\d+)([-\+]?\d{2})?(\d{2})?\)\//i);if(e){var n=e[2]?36e5*e[2]+6e4*e[3]*(e[2]/Math.abs(e[2])):0;return new Date(1*e[1]+n)}return Date.parse(t)}},function(t){var e={},n={};t.ajaxq=function(i,o){function a(){if(e[i]){var t=e[i].shift();if(t){var o=t();n[i]=o}else delete e[i],delete n[i]}}if(void 0===o)throw"AjaxQ: queue name is not provided";var s=t.Deferred(),r=s.promise();r.success=r.done,r.error=r.fail,r.complete=r.always;var l="function"==typeof o,c=l?null:t.extend(!0,{},o);return function(t){if(e[i])e[i].push(t);else{e[i]=[];var o=t();n[i]=o}}((function(){var e=t.ajax.apply(window,[l?o():c]);return e.done((function(){s.resolve.apply(this,arguments)})),e.fail((function(){s.reject.apply(this,arguments)})),e.always(a),e})),r},t.each(["getq","postq"],(function(e,n){t[n]=function(e,i,o,a,s){return t.isFunction(o)&&(s=s||a,a=o,o=void 0),t.ajaxq(e,{type:"postq"===n?"post":"get",url:i,data:o,success:a,dataType:s})}}));var i=function(t){return e.hasOwnProperty(t)&&e[t].length>0};t.ajaxq.isRunning=function(t){return t?i(t):function(){for(var t in e)if(i(t))return!0;return!1}()},t.ajaxq.getActiveRequest=function(t){if(!t)throw"AjaxQ: queue name is required";return n[t]},t.ajaxq.abort=function(i){if(!i)throw"AjaxQ: queue name is required";var o=t.ajaxq.getActiveRequest(i);delete e[i],delete n[i],o&&o.abort()},t.ajaxq.clear=function(t){if(t)e[t]&&(e[t]=[]);else for(var n in e)e.hasOwnProperty(n)&&(e[n]=[])}}(jQuery),function(){"use strict";function t(t){return new Date((t+.5-T)*S)}function e(t){return function(t){return t.valueOf()/S-.5+T}(t)-C}function n(t,e){return x(v(t)*b(M)-y(e)*v(M),b(t))}function i(t,e){return w(v(e)*b(M)+b(e)*v(M)*v(t))}function o(t,e,n){return x(v(t),b(t)*v(e)-y(n)*b(e))}function a(t,e,n){return w(v(e)*v(n)+b(e)*b(n)*b(t))}function s(t,e){return k*(280.16+360.9856235*t)-e}function r(t){return k*(357.5291+.98560028*t)}function l(t){return t+k*(1.9148*v(t)+.02*v(2*t)+3e-4*v(3*t))+102.9372*k+g}function c(t){var e=l(r(t));return{dec:i(e,0),ra:n(e,0)}}function d(t,e){return Math.round(t-E-e/(2*g))}function u(t,e,n){return E+(t+e)/(2*g)+n}function h(t,e,n){return C+t+.0053*v(e)-.0069*v(2*n)}function p(t,e,n,i,o,a,s){var r=function(t,e,n){return _((v(t)-v(e)*v(n))/(b(e)*b(n)))}(t,n,i);return h(u(r,e,o),a,s)}function f(t){var e=k*(134.963+13.064993*t),o=k*(93.272+13.22935*t),a=k*(218.316+13.176396*t)+6.289*k*v(e),s=5.128*k*v(o),r=385001-20905*b(e);return{ra:n(a,s),dec:i(a,s),dist:r}}function m(t,e){return new Date(t.valueOf()+e*S/24)}var g=Math.PI,v=Math.sin,b=Math.cos,y=Math.tan,w=Math.asin,x=Math.atan2,_=Math.acos,k=g/180,S=864e5,T=2440588,C=2451545,M=23.4397*k,D={getPosition:function(t,n,i){var r=k*-i,l=k*n,d=e(t),u=c(d),h=s(d,r)-u.ra;return{azimuth:o(h,l,u.dec),altitude:a(h,l,u.dec)}}},O=D.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];D.addTime=function(t,e,n){O.push([t,e,n])};var E=9e-4;D.getTimes=function(n,o,a){var s,c,f,m,g,v=k*-a,b=k*o,y=d(e(n),v),w=u(0,v,y),x=r(w),_=l(x),S=i(_,0),T=h(w,x,_),C={solarNoon:t(T),nadir:t(T-.5)};for(s=0,c=O.length;c>s;s+=1)g=T-((m=p((f=O[s])[0]*k,v,b,S,y,x,_))-T),C[f[1]]=t(g),C[f[2]]=t(m);return C},D.getMoonPosition=function(t,n,i){var r=k*-i,l=k*n,c=e(t),d=f(c),u=s(c,r)-d.ra,h=a(u,l,d.dec);return h+=.017*k/y(h+10.26*k/(h+5.1*k)),{azimuth:o(u,l,d.dec),altitude:h,distance:d.dist}},D.getMoonIllumination=function(t){var n=e(t),i=c(n),o=f(n),a=149598e3,s=_(v(i.dec)*v(o.dec)+b(i.dec)*b(o.dec)*b(i.ra-o.ra)),r=x(a*v(s),o.dist-a*b(s)),l=x(b(i.dec)*v(i.ra-o.ra),v(i.dec)*b(o.dec)-b(i.dec)*v(o.dec)*b(i.ra-o.ra));return{fraction:(1+b(r))/2,phase:.5+.5*r*(0>l?-1:1)/Math.PI,angle:l}},D.getMoonTimes=function(t,e,n){var i=new Date(t);i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0);for(var o,a,s,r,l,c,d,u,h,p,f,g,v,b=.133*k,y=D.getMoonPosition(i,e,n).altitude-b,w=1;24>=w&&(o=D.getMoonPosition(m(i,w),e,n).altitude-b,u=((l=(y+(a=D.getMoonPosition(m(i,w+1),e,n).altitude-b))/2-o)*(d=-(c=(a-y)/2)/(2*l))+c)*d+o,p=0,(h=c*c-4*l*o)>=0&&(f=d-(v=Math.sqrt(h)/(2*Math.abs(l))),g=d+v,Math.abs(f)<=1&&p++,Math.abs(g)<=1&&p++,-1>f&&(f=g)),1===p?0>y?s=w+f:r=w+f:2===p&&(s=w+(0>u?g:f),r=w+(0>u?f:g)),!s||!r);w+=2)y=a;var x={};return s&&(x.rise=m(i,s)),r&&(x.set=m(i,r)),s||r||(x[u>0?"alwaysUp":"alwaysDown"]=!0),x},"function"==typeof define&&define.amd?define(D):"undefined"!=typeof module?module.exports=D:window.SunCalc=D}(),function(t){"use strict";function e(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function n(t,n,i,o,a,s){return e(function(t,e){return t<<e|t>>>32-e}(e(e(n,t),e(o,s)),a),i)}function i(t,e,i,o,a,s,r){return n(e&i|~e&o,t,e,a,s,r)}function o(t,e,i,o,a,s,r){return n(e&o|i&~o,t,e,a,s,r)}function a(t,e,i,o,a,s,r){return n(e^i^o,t,e,a,s,r)}function s(t,e,i,o,a,s,r){return n(i^(e|~o),t,e,a,s,r)}function r(t,n){t[n>>5]|=128<<n%32,t[14+(n+64>>>9<<4)]=n;var r,l,c,d,u,h=1732584193,p=-271733879,f=-1732584194,m=271733878;for(r=0;r<t.length;r+=16)l=h,c=p,d=f,u=m,h=i(h,p,f,m,t[r],7,-680876936),m=i(m,h,p,f,t[r+1],12,-389564586),f=i(f,m,h,p,t[r+2],17,606105819),p=i(p,f,m,h,t[r+3],22,-1044525330),h=i(h,p,f,m,t[r+4],7,-176418897),m=i(m,h,p,f,t[r+5],12,1200080426),f=i(f,m,h,p,t[r+6],17,-1473231341),p=i(p,f,m,h,t[r+7],22,-45705983),h=i(h,p,f,m,t[r+8],7,1770035416),m=i(m,h,p,f,t[r+9],12,-1958414417),f=i(f,m,h,p,t[r+10],17,-42063),p=i(p,f,m,h,t[r+11],22,-1990404162),h=i(h,p,f,m,t[r+12],7,1804603682),m=i(m,h,p,f,t[r+13],12,-40341101),f=i(f,m,h,p,t[r+14],17,-1502002290),h=o(h,p=i(p,f,m,h,t[r+15],22,1236535329),f,m,t[r+1],5,-165796510),m=o(m,h,p,f,t[r+6],9,-1069501632),f=o(f,m,h,p,t[r+11],14,643717713),p=o(p,f,m,h,t[r],20,-373897302),h=o(h,p,f,m,t[r+5],5,-701558691),m=o(m,h,p,f,t[r+10],9,38016083),f=o(f,m,h,p,t[r+15],14,-660478335),p=o(p,f,m,h,t[r+4],20,-405537848),h=o(h,p,f,m,t[r+9],5,568446438),m=o(m,h,p,f,t[r+14],9,-1019803690),f=o(f,m,h,p,t[r+3],14,-187363961),p=o(p,f,m,h,t[r+8],20,1163531501),h=o(h,p,f,m,t[r+13],5,-1444681467),m=o(m,h,p,f,t[r+2],9,-51403784),f=o(f,m,h,p,t[r+7],14,1735328473),h=a(h,p=o(p,f,m,h,t[r+12],20,-1926607734),f,m,t[r+5],4,-378558),m=a(m,h,p,f,t[r+8],11,-2022574463),f=a(f,m,h,p,t[r+11],16,1839030562),p=a(p,f,m,h,t[r+14],23,-35309556),h=a(h,p,f,m,t[r+1],4,-1530992060),m=a(m,h,p,f,t[r+4],11,1272893353),f=a(f,m,h,p,t[r+7],16,-155497632),p=a(p,f,m,h,t[r+10],23,-1094730640),h=a(h,p,f,m,t[r+13],4,681279174),m=a(m,h,p,f,t[r],11,-358537222),f=a(f,m,h,p,t[r+3],16,-722521979),p=a(p,f,m,h,t[r+6],23,76029189),h=a(h,p,f,m,t[r+9],4,-640364487),m=a(m,h,p,f,t[r+12],11,-421815835),f=a(f,m,h,p,t[r+15],16,530742520),h=s(h,p=a(p,f,m,h,t[r+2],23,-995338651),f,m,t[r],6,-198630844),m=s(m,h,p,f,t[r+7],10,1126891415),f=s(f,m,h,p,t[r+14],15,-1416354905),p=s(p,f,m,h,t[r+5],21,-57434055),h=s(h,p,f,m,t[r+12],6,1700485571),m=s(m,h,p,f,t[r+3],10,-1894986606),f=s(f,m,h,p,t[r+10],15,-1051523),p=s(p,f,m,h,t[r+1],21,-2054922799),h=s(h,p,f,m,t[r+8],6,1873313359),m=s(m,h,p,f,t[r+15],10,-30611744),f=s(f,m,h,p,t[r+6],15,-1560198380),p=s(p,f,m,h,t[r+13],21,1309151649),h=s(h,p,f,m,t[r+4],6,-145523070),m=s(m,h,p,f,t[r+11],10,-1120210379),f=s(f,m,h,p,t[r+2],15,718787259),p=s(p,f,m,h,t[r+9],21,-343485551),h=e(h,l),p=e(p,c),f=e(f,d),m=e(m,u);return[h,p,f,m]}function l(t){var e,n="";for(e=0;e<32*t.length;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function c(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;for(e=0;e<8*t.length;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function d(t){var e,n,i="0123456789abcdef",o="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),o+=i.charAt(e>>>4&15)+i.charAt(15&e);return o}function u(t){return unescape(encodeURIComponent(t))}function h(t){return function(t){return l(r(c(t),8*t.length))}(u(t))}function p(t,e){return function(t,e){var n,i,o=c(t),a=[],s=[];for(a[15]=s[15]=void 0,o.length>16&&(o=r(o,8*t.length)),n=0;16>n;n+=1)a[n]=909522486^o[n],s[n]=1549556828^o[n];return i=r(a.concat(c(e)),512+8*e.length),l(r(s.concat(i),640))}(u(t),u(e))}function f(t,e,n){return e?n?p(e,t):function(t,e){return d(p(t,e))}(e,t):n?h(t):function(t){return d(h(t))}(t)}"function"==typeof define&&define.amd?define((function(){return f})):t.md5=f}(this),Array.prototype.remove=function(t,e){var n=this.slice((e||t)+1||this.length);return this.length=0>t?this.length+t:t,this.push.apply(this,n)};var s=void 0,u=!1,sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(t){this.toString=function(){return"CORRUPT: "+this.message},this.message=t},invalid:function(t){this.toString=function(){return"INVALID: "+this.message},this.message=t},bug:function(t){this.toString=function(){return"BUG: "+this.message},this.message=t},notReady:function(t){this.toString=function(){return"NOT READY: "+this.message},this.message=t}}};function w(t,e,n){4!==e.length&&q(new sjcl.exception.invalid("invalid aes block size"));var i=t.b[n],o=e[0]^i[0],a=e[n?3:1]^i[1],s=e[2]^i[2];e=e[n?1:3]^i[3];var r,l,c,d,u=i.length/4-2,h=4,p=[0,0,0,0];t=(r=t.l[n])[0];var f=r[1],m=r[2],g=r[3],v=r[4];for(d=0;d<u;d++)r=t[o>>>24]^f[a>>16&255]^m[s>>8&255]^g[255&e]^i[h],l=t[a>>>24]^f[s>>16&255]^m[e>>8&255]^g[255&o]^i[h+1],c=t[s>>>24]^f[e>>16&255]^m[o>>8&255]^g[255&a]^i[h+2],e=t[e>>>24]^f[o>>16&255]^m[a>>8&255]^g[255&s]^i[h+3],h+=4,o=r,a=l,s=c;for(d=0;4>d;d++)p[n?3&-d:d]=v[o>>>24]<<24^v[a>>16&255]<<16^v[s>>8&255]<<8^v[255&e]^i[h++],r=o,o=a,a=s,s=e,e=r;return p}function x(t,e){var n,i,o,a=e.slice(0),s=t.s,r=t.b,l=s[0],c=s[1],d=s[2],u=s[3],h=s[4],p=s[5],f=s[6],m=s[7];for(n=0;64>n;n++)16>n?i=a[n]:(i=a[n+1&15],o=a[n+14&15],i=a[15&n]=(i>>>7^i>>>18^i>>>3^i<<25^i<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+a[15&n]+a[n+9&15]|0),i=i+m+(h>>>6^h>>>11^h>>>25^h<<26^h<<21^h<<7)+(f^h&(p^f))+r[n],m=f,f=p,p=h,h=u+i|0,u=d,d=c,l=i+((c=l)&d^u&(c^d))+(c>>>2^c>>>13^c>>>22^c<<30^c<<19^c<<10)|0;s[0]=s[0]+l|0,s[1]=s[1]+c|0,s[2]=s[2]+d|0,s[3]=s[3]+u|0,s[4]=s[4]+h|0,s[5]=s[5]+p|0,s[6]=s[6]+f|0,s[7]=s[7]+m|0}function C(t,e){var n,i=sjcl.random.B[t],o=[];for(n in i)i.hasOwnProperty(n)&&o.push(i[n]);for(n=0;n<o.length;n++)o[n](e)}function E(t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?sjcl.random.addEntropy(window.performance.now(),t,"loadtime"):sjcl.random.addEntropy((new Date).valueOf(),t,"loadtime")}function A(t){t.b=B(t).concat(B(t)),t.C=new sjcl.cipher.aes(t.b)}function B(t){for(var e=0;4>e&&(t.f[e]=t.f[e]+1|0,!t.f[e]);e++);return t.C.encrypt(t.f)}function D(t,e){return function(){e.apply(t,arguments)}}"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],(function(){return sjcl})),sjcl.cipher.aes=function(t){this.l[0][0][0]||this.G();var e,n,i,o,a=this.l[0][4],s=this.l[1],r=1;for(4!==(e=t.length)&&6!==e&&8!==e&&q(new sjcl.exception.invalid("invalid aes key size")),this.b=[i=t.slice(0),o=[]],t=e;t<4*e+28;t++)n=i[t-1],(0==t%e||8===e&&4==t%e)&&(n=a[n>>>24]<<24^a[n>>16&255]<<16^a[n>>8&255]<<8^a[255&n],0==t%e&&(n=n<<8^n>>>24^r<<24,r=r<<1^283*(r>>7))),i[t]=i[t-e]^n;for(e=0;t;e++,t--)n=i[3&e?t:t-4],o[e]=4>=t||4>e?n:s[0][a[n>>>24]]^s[1][a[n>>16&255]]^s[2][a[n>>8&255]]^s[3][a[255&n]]},sjcl.cipher.aes.prototype={encrypt:function(t){return w(this,t,0)},decrypt:function(t){return w(this,t,1)},l:[[[],[],[],[],[]],[[],[],[],[],[]]],G:function(){var t,e,n,i,o,a,s,r=this.l[0],l=this.l[1],c=r[4],d=l[4],u=[],h=[];for(t=0;256>t;t++)h[(u[t]=t<<1^283*(t>>7))^t]=t;for(e=n=0;!c[e];e^=i||1,n=h[n]||1)for(a=(a=n^n<<1^n<<2^n<<3^n<<4)>>8^255&a^99,c[e]=a,d[a]=e,s=16843009*(o=u[t=u[i=u[e]]])^65537*t^257*i^16843008*e,o=257*u[a]^16843008*a,t=0;4>t;t++)r[t][e]=o=o<<24^o>>>8,l[t][a]=s=s<<24^s>>>8;for(t=0;5>t;t++)r[t]=r[t].slice(0),l[t]=l[t].slice(0)}},sjcl.bitArray={bitSlice:function(t,e,n){return t=sjcl.bitArray.R(t.slice(e/32),32-(31&e)).slice(1),n===s?t:sjcl.bitArray.clamp(t,n-e)},extract:function(t,e,n){var i=Math.floor(-e-n&31);return(-32&(e+n-1^e)?t[e/32|0]<<32-i^t[e/32+1|0]>>>i:t[e/32|0]>>>i)&(1<<n)-1},concat:function(t,e){if(0===t.length||0===e.length)return t.concat(e);var n=t[t.length-1],i=sjcl.bitArray.getPartial(n);return 32===i?t.concat(e):sjcl.bitArray.R(e,i,0|n,t.slice(0,t.length-1))},bitLength:function(t){var e=t.length;return 0===e?0:32*(e-1)+sjcl.bitArray.getPartial(t[e-1])},clamp:function(t,e){if(32*t.length<e)return t;var n=(t=t.slice(0,Math.ceil(e/32))).length;return e&=31,0<n&&e&&(t[n-1]=sjcl.bitArray.partial(e,t[n-1]&2147483648>>e-1,1)),t},partial:function(t,e,n){return 32===t?e:(n?0|e:e<<32-t)+1099511627776*t},getPartial:function(t){return Math.round(t/1099511627776)||32},equal:function(t,e){if(sjcl.bitArray.bitLength(t)!==sjcl.bitArray.bitLength(e))return u;var n,i=0;for(n=0;n<t.length;n++)i|=t[n]^e[n];return 0===i},R:function(t,e,n,i){var o;for(o=0,i===s&&(i=[]);32<=e;e-=32)i.push(n),n=0;if(0===e)return i.concat(t);for(o=0;o<t.length;o++)i.push(n|t[o]>>>e),n=t[o]<<32-e;return o=t.length?t[t.length-1]:0,t=sjcl.bitArray.getPartial(o),i.push(sjcl.bitArray.partial(e+t&31,32<e+t?n:i.pop(),1)),i},g:function(t,e){return[t[0]^e[0],t[1]^e[1],t[2]^e[2],t[3]^e[3]]},byteswapM:function(t){var e,n;for(e=0;e<t.length;++e)n=t[e],t[e]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return t}},sjcl.codec.utf8String={fromBits:function(t){var e,n,i="",o=sjcl.bitArray.bitLength(t);for(e=0;e<o/8;e++)0==(3&e)&&(n=t[e/4]),i+=String.fromCharCode(n>>>24),n<<=8;return decodeURIComponent(escape(i))},toBits:function(t){t=unescape(encodeURIComponent(t));var e,n=[],i=0;for(e=0;e<t.length;e++)i=i<<8|t.charCodeAt(e),3==(3&e)&&(n.push(i),i=0);return 3&e&&n.push(sjcl.bitArray.partial(8*(3&e),i)),n}},sjcl.codec.hex={fromBits:function(t){var e,n="";for(e=0;e<t.length;e++)n+=(0xf00000000000+(0|t[e])).toString(16).substr(4);return n.substr(0,sjcl.bitArray.bitLength(t)/4)},toBits:function(t){var e,n,i=[];for(n=(t=t.replace(/\s|0x/g,"")).length,t+="00000000",e=0;e<t.length;e+=8)i.push(0^parseInt(t.substr(e,8),16));return sjcl.bitArray.clamp(i,4*n)}},sjcl.codec.base32={p:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",O:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(t,e,n){var i=sjcl.codec.base32.BASE,o=sjcl.codec.base32.REMAINING,a="",s=0,r=sjcl.codec.base32.p,l=0,c=sjcl.bitArray.bitLength(t);for(n&&(r=sjcl.codec.base32.O),n=0;a.length*i<c;)a+=r.charAt((l^t[n]>>>s)>>>o),s<i?(l=t[n]<<i-s,s+=o,n++):(l<<=i,s-=i);for(;7&a.length&&!e;)a+="=";return a},toBits:function(t,e){t=t.replace(/\s|=/g,"").toUpperCase();var n,i,o=sjcl.codec.base32.BITS,a=sjcl.codec.base32.BASE,s=sjcl.codec.base32.REMAINING,r=[],l=0,c=sjcl.codec.base32.p,d=0,u="base32";for(e&&(c=sjcl.codec.base32.O,u="base32hex"),n=0;n<t.length;n++){if(0>(i=c.indexOf(t.charAt(n)))){if(!e)try{return sjcl.codec.base32hex.toBits(t)}catch(t){}q(new sjcl.exception.invalid("this isn't "+u+"!"))}l>s?(l-=s,r.push(d^i>>>l),d=i<<o-l):d^=i<<o-(l+=a)}return 56&l&&r.push(sjcl.bitArray.partial(56&l,d,1)),r}},sjcl.codec.base32hex={fromBits:function(t,e){return sjcl.codec.base32.fromBits(t,e,1)},toBits:function(t){return sjcl.codec.base32.toBits(t,1)}},sjcl.codec.base64={p:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(t,e,n){var i="",o=0,a=sjcl.codec.base64.p,s=0,r=sjcl.bitArray.bitLength(t);for(n&&(a=a.substr(0,62)+"-_"),n=0;6*i.length<r;)i+=a.charAt((s^t[n]>>>o)>>>26),6>o?(s=t[n]<<6-o,o+=26,n++):(s<<=6,o-=6);for(;3&i.length&&!e;)i+="=";return i},toBits:function(t,e){t=t.replace(/\s|=/g,"");var n,i,o=[],a=0,s=sjcl.codec.base64.p,r=0;for(e&&(s=s.substr(0,62)+"-_"),n=0;n<t.length;n++)0>(i=s.indexOf(t.charAt(n)))&&q(new sjcl.exception.invalid("this isn't base64!")),26<a?(a-=26,o.push(r^i>>>a),r=i<<32-a):r^=i<<32-(a+=6);return 56&a&&o.push(sjcl.bitArray.partial(56&a,r,1)),o}},sjcl.codec.base64url={fromBits:function(t){return sjcl.codec.base64.fromBits(t,1,1)},toBits:function(t){return sjcl.codec.base64.toBits(t,1)}},sjcl.hash.sha256=function(t){this.b[0]||this.G(),t?(this.s=t.s.slice(0),this.o=t.o.slice(0),this.i=t.i):this.reset()},sjcl.hash.sha256.hash=function(t){return(new sjcl.hash.sha256).update(t).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.s=this.P.slice(0),this.o=[],this.i=0,this},update:function(t){"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t));var e,n=this.o=sjcl.bitArray.concat(this.o,t);for(e=this.i,t=this.i=e+sjcl.bitArray.bitLength(t),e=512+e&-512;e<=t;e+=512)x(this,n.splice(0,16));return this},finalize:function(){var t,e=this.o,n=this.s;for(t=(e=sjcl.bitArray.concat(e,[sjcl.bitArray.partial(1,1)])).length+2;15&t;t++)e.push(0);for(e.push(Math.floor(this.i/4294967296)),e.push(0|this.i);e.length;)x(this,e.splice(0,16));return this.reset(),n},P:[],b:[],G:function(){function t(t){return 4294967296*(t-Math.floor(t))|0}var e,n=0,i=2;t:for(;64>n;i++){for(e=2;e*e<=i;e++)if(0==i%e)continue t;8>n&&(this.P[n]=t(Math.pow(i,.5))),this.b[n]=t(Math.pow(i,1/3)),n++}}},sjcl.mode.ccm={name:"ccm",t:[],listenProgress:function(t){sjcl.mode.ccm.t.push(t)},unListenProgress:function(t){-1<(t=sjcl.mode.ccm.t.indexOf(t))&&sjcl.mode.ccm.t.splice(t,1)},X:function(t){var e,n=sjcl.mode.ccm.t.slice();for(e=0;e<n.length;e+=1)n[e](t)},encrypt:function(t,e,n,i,o){var a,s=e.slice(0),r=sjcl.bitArray,l=r.bitLength(n)/8,c=r.bitLength(s)/8;for(o=o||64,i=i||[],7>l&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),a=2;4>a&&c>>>8*a;a++);return a<15-l&&(a=15-l),n=r.clamp(n,8*(15-a)),e=sjcl.mode.ccm.M(t,e,n,i,o,a),s=sjcl.mode.ccm.q(t,s,n,e,o,a),r.concat(s.data,s.tag)},decrypt:function(t,e,n,i,o){o=o||64,i=i||[];var a=sjcl.bitArray,s=a.bitLength(n)/8,r=a.bitLength(e),l=a.clamp(e,r-o),c=a.bitSlice(e,r-o);r=(r-o)/8;for(7>s&&q(new sjcl.exception.invalid("ccm: iv must be at least 7 bytes")),e=2;4>e&&r>>>8*e;e++);return e<15-s&&(e=15-s),n=a.clamp(n,8*(15-e)),l=sjcl.mode.ccm.q(t,l,n,c,o,e),t=sjcl.mode.ccm.M(t,l.data,n,i,o,e),a.equal(l.tag,t)||q(new sjcl.exception.corrupt("ccm: tag doesn't match")),l.data},ea:function(t,e,n,i,o,a){var s=[],r=sjcl.bitArray,l=r.g;if(i=[r.partial(8,(e.length?64:0)|i-2<<2|a-1)],(i=r.concat(i,n))[3]|=o,i=t.encrypt(i),e.length)for(65279>=(n=r.bitLength(e)/8)?s=[r.partial(16,n)]:4294967295>=n&&(s=r.concat([r.partial(16,65534)],[n])),s=r.concat(s,e),e=0;e<s.length;e+=4)i=t.encrypt(l(i,s.slice(e,e+4).concat([0,0,0])));return i},M:function(t,e,n,i,o,a){var s=sjcl.bitArray,r=s.g;for(((o/=8)%2||4>o||16<o)&&q(new sjcl.exception.invalid("ccm: invalid tag length")),(4294967295<i.length||4294967295<e.length)&&q(new sjcl.exception.bug("ccm: can't deal with 4GiB or more data")),n=sjcl.mode.ccm.ea(t,i,n,o,s.bitLength(e)/8,a),i=0;i<e.length;i+=4)n=t.encrypt(r(n,e.slice(i,i+4).concat([0,0,0])));return s.clamp(n,8*o)},q:function(t,e,n,i,o,a){var s,r=sjcl.bitArray;s=r.g;var l=e.length,c=r.bitLength(e),d=l/50,u=d;if(n=r.concat([r.partial(8,a-1)],n).concat([0,0,0]).slice(0,4),i=r.bitSlice(s(i,t.encrypt(n)),0,o),!l)return{tag:i,data:[]};for(s=0;s<l;s+=4)s>d&&(sjcl.mode.ccm.X(s/l),d+=u),n[3]++,o=t.encrypt(n),e[s]^=o[0],e[s+1]^=o[1],e[s+2]^=o[2],e[s+3]^=o[3];return{tag:i,data:r.clamp(e,c)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(t,e,n,i,o,a){128!==sjcl.bitArray.bitLength(n)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits"));var s,r=sjcl.mode.ocb2.J,l=sjcl.bitArray,c=l.g,d=[0,0,0,0];n=r(t.encrypt(n));var u,h=[];for(i=i||[],o=o||64,s=0;s+4<e.length;s+=4)d=c(d,u=e.slice(s,s+4)),h=h.concat(c(n,t.encrypt(c(n,u)))),n=r(n);return u=e.slice(s),e=l.bitLength(u),s=t.encrypt(c(n,[0,0,0,e])),u=l.clamp(c(u.concat([0,0,0]),s),e),d=c(d,c(u.concat([0,0,0]),s)),d=t.encrypt(c(d,c(n,r(n)))),i.length&&(d=c(d,a?i:sjcl.mode.ocb2.pmac(t,i))),h.concat(l.concat(u,l.clamp(d,o)))},decrypt:function(t,e,n,i,o,a){128!==sjcl.bitArray.bitLength(n)&&q(new sjcl.exception.invalid("ocb iv must be 128 bits")),o=o||64;var s,r,l=sjcl.mode.ocb2.J,c=sjcl.bitArray,d=c.g,u=[0,0,0,0],h=l(t.encrypt(n)),p=sjcl.bitArray.bitLength(e)-o,f=[];for(i=i||[],n=0;n+4<p/32;n+=4)s=d(h,t.decrypt(d(h,e.slice(n,n+4)))),u=d(u,s),f=f.concat(s),h=l(h);return r=p-32*n,s=t.encrypt(d(h,[0,0,0,r])),s=d(s,c.clamp(e.slice(n),r).concat([0,0,0])),u=d(u,s),u=t.encrypt(d(u,d(h,l(h)))),i.length&&(u=d(u,a?i:sjcl.mode.ocb2.pmac(t,i))),c.equal(c.clamp(u,o),c.bitSlice(e,p))||q(new sjcl.exception.corrupt("ocb: tag doesn't match")),f.concat(c.clamp(s,r))},pmac:function(t,e){var n,i=sjcl.mode.ocb2.J,o=sjcl.bitArray,a=o.g,s=[0,0,0,0],r=a(r=t.encrypt([0,0,0,0]),i(i(r)));for(n=0;n+4<e.length;n+=4)r=i(r),s=a(s,t.encrypt(a(r,e.slice(n,n+4))));return n=e.slice(n),128>o.bitLength(n)&&(r=a(r,i(r)),n=o.concat(n,[-2147483648,0,0,0])),s=a(s,n),t.encrypt(a(i(a(r,i(r))),s))},J:function(t){return[t[0]<<1^t[1]>>>31,t[1]<<1^t[2]>>>31,t[2]<<1^t[3]>>>31,t[3]<<1^135*(t[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(t,e,n,i,o){var a=e.slice(0);return e=sjcl.bitArray,i=i||[],t=sjcl.mode.gcm.q(!0,t,a,i,n,o||128),e.concat(t.data,t.tag)},decrypt:function(t,e,n,i,o){var a=e.slice(0),s=sjcl.bitArray,r=s.bitLength(a);return i=i||[],(o=o||128)<=r?(e=s.bitSlice(a,r-o),a=s.bitSlice(a,0,r-o)):(e=a,a=[]),t=sjcl.mode.gcm.q(u,t,a,i,n,o),s.equal(t.tag,e)||q(new sjcl.exception.corrupt("gcm: tag doesn't match")),t.data},ba:function(t,e){var n,i,o,a,s,r=sjcl.bitArray.g;for(o=[0,0,0,0],a=e.slice(0),n=0;128>n;n++){for((i=0!=(t[Math.floor(n/32)]&1<<31-n%32))&&(o=r(o,a)),s=0!=(1&a[3]),i=3;0<i;i--)a[i]=a[i]>>>1|(1&a[i-1])<<31;a[0]>>>=1,s&&(a[0]^=-520093696)}return o},h:function(t,e,n){var i,o=n.length;for(e=e.slice(0),i=0;i<o;i+=4)e[0]^=4294967295&n[i],e[1]^=4294967295&n[i+1],e[2]^=4294967295&n[i+2],e[3]^=4294967295&n[i+3],e=sjcl.mode.gcm.ba(e,t);return e},q:function(t,e,n,i,o,a){var s,r,l,c,d,u,h,p,f=sjcl.bitArray;for(u=n.length,h=f.bitLength(n),p=f.bitLength(i),r=f.bitLength(o),s=e.encrypt([0,0,0,0]),96===r?(o=o.slice(0),o=f.concat(o,[1])):(o=sjcl.mode.gcm.h(s,[0,0,0,0],o),o=sjcl.mode.gcm.h(s,o,[0,0,Math.floor(r/4294967296),4294967295&r])),r=sjcl.mode.gcm.h(s,[0,0,0,0],i),d=o.slice(0),i=r.slice(0),t||(i=sjcl.mode.gcm.h(s,r,n)),c=0;c<u;c+=4)d[3]++,l=e.encrypt(d),n[c]^=l[0],n[c+1]^=l[1],n[c+2]^=l[2],n[c+3]^=l[3];return n=f.clamp(n,h),t&&(i=sjcl.mode.gcm.h(s,r,n)),t=[Math.floor(p/4294967296),4294967295&p,Math.floor(h/4294967296),4294967295&h],i=sjcl.mode.gcm.h(s,i,t),l=e.encrypt(o),i[0]^=l[0],i[1]^=l[1],i[2]^=l[2],i[3]^=l[3],{tag:f.bitSlice(i,0,a),data:n}}},sjcl.misc.hmac=function(t,e){this.N=e=e||sjcl.hash.sha256;var n,i=[[],[]],o=e.prototype.blockSize/32;for(this.n=[new e,new e],t.length>o&&(t=e.hash(t)),n=0;n<o;n++)i[0][n]=909522486^t[n],i[1][n]=1549556828^t[n];this.n[0].update(i[0]),this.n[1].update(i[1]),this.I=new e(this.n[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(t){return this.S&&q(new sjcl.exception.invalid("encrypt on already updated hmac called!")),this.update(t),this.digest(t)},sjcl.misc.hmac.prototype.reset=function(){this.I=new this.N(this.n[0]),this.S=u},sjcl.misc.hmac.prototype.update=function(t){this.S=!0,this.I.update(t)},sjcl.misc.hmac.prototype.digest=function(){var t=this.I.finalize();t=new this.N(this.n[1]).update(t).finalize();return this.reset(),t},sjcl.misc.pbkdf2=function(t,e,n,i,o){n=n||1e3,(0>i||0>n)&&q(sjcl.exception.invalid("invalid params to pbkdf2")),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),t=new(o=o||sjcl.misc.hmac)(t);var a,s,r,l,c=[],d=sjcl.bitArray;for(l=1;32*c.length<(i||1);l++){for(o=a=t.encrypt(d.concat(e,[l])),s=1;s<n;s++)for(a=t.encrypt(a),r=0;r<a.length;r++)o[r]^=a[r];c=c.concat(o)}return i&&(c=d.clamp(c,i)),c},sjcl.prng=function(t){this.c=[new sjcl.hash.sha256],this.j=[0],this.H=0,this.u={},this.F=0,this.L={},this.Q=this.d=this.k=this.Z=0,this.b=[0,0,0,0,0,0,0,0],this.f=[0,0,0,0],this.C=s,this.D=t,this.r=u,this.B={progress:{},seeded:{}},this.m=this.Y=0,this.w=1,this.A=2,this.U=65536,this.K=[0,48,64,96,128,192,256,384,512,768,1024],this.V=3e4,this.T=80},sjcl.prng.prototype={randomWords:function(t,e){var n,i,o=[];if((n=this.isReady(e))===this.m&&q(new sjcl.exception.notReady("generator isn't seeded")),n&this.A){n=!(n&this.w),i=[];var a,s=0;for(this.Q=i[0]=(new Date).valueOf()+this.V,a=0;16>a;a++)i.push(4294967296*Math.random()|0);for(a=0;a<this.c.length&&(i=i.concat(this.c[a].finalize()),s+=this.j[a],this.j[a]=0,n||!(this.H&1<<a));a++);for(this.H>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.j.push(0)),this.d-=s,s>this.k&&(this.k=s),this.H++,this.b=sjcl.hash.sha256.hash(this.b.concat(i)),this.C=new sjcl.cipher.aes(this.b),n=0;4>n&&(this.f[n]=this.f[n]+1|0,!this.f[n]);n++);}for(n=0;n<t;n+=4)0==(n+1)%this.U&&A(this),i=B(this),o.push(i[0],i[1],i[2],i[3]);return A(this),o.slice(0,t)},setDefaultParanoia:function(t,e){0===t&&"Setting paranoia=0 will ruin your security; use it only for testing"!==e&&q("Setting paranoia=0 will ruin your security; use it only for testing"),this.D=t},addEntropy:function(t,e,n){n=n||"user";var i,o,a=(new Date).valueOf(),r=this.u[n],l=this.isReady(),c=0;switch((i=this.L[n])===s&&(i=this.L[n]=this.Z++),r===s&&(r=this.u[n]=0),this.u[n]=(this.u[n]+1)%this.c.length,typeof t){case"number":e===s&&(e=1),this.c[r].update([i,this.F++,1,e,a,1,0|t]);break;case"object":if("[object Uint32Array]"===(n=Object.prototype.toString.call(t))){for(o=[],n=0;n<t.length;n++)o.push(t[n]);t=o}else for("[object Array]"!==n&&(c=1),n=0;n<t.length&&!c;n++)"number"!=typeof t[n]&&(c=1);if(!c){if(e===s)for(n=e=0;n<t.length;n++)for(o=t[n];0<o;)e++,o>>>=1;this.c[r].update([i,this.F++,2,e,a,t.length].concat(t))}break;case"string":e===s&&(e=t.length),this.c[r].update([i,this.F++,3,e,a,t.length]),this.c[r].update(t);break;default:c=1}c&&q(new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string")),this.j[r]+=e,this.d+=e,l===this.m&&(this.isReady()!==this.m&&C("seeded",Math.max(this.k,this.d)),C("progress",this.getProgress()))},isReady:function(t){return t=this.K[t!==s?t:this.D],this.k&&this.k>=t?this.j[0]>this.T&&(new Date).valueOf()>this.Q?this.A|this.w:this.w:this.d>=t?this.A|this.m:this.m},getProgress:function(t){return t=this.K[t||this.D],this.k>=t||this.d>t?1:this.d/t},startCollectors:function(){this.r||(this.a={loadTimeCollector:D(this,this.da),mouseCollector:D(this,this.fa),keyboardCollector:D(this,this.ca),accelerometerCollector:D(this,this.W),touchCollector:D(this,this.ha)},window.addEventListener?(window.addEventListener("load",this.a.loadTimeCollector,u),window.addEventListener("mousemove",this.a.mouseCollector,u),window.addEventListener("keypress",this.a.keyboardCollector,u),window.addEventListener("devicemotion",this.a.accelerometerCollector,u),window.addEventListener("touchmove",this.a.touchCollector,u)):document.attachEvent?(document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)):q(new sjcl.exception.bug("can't attach event")),this.r=!0)},stopCollectors:function(){this.r&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,u),window.removeEventListener("mousemove",this.a.mouseCollector,u),window.removeEventListener("keypress",this.a.keyboardCollector,u),window.removeEventListener("devicemotion",this.a.accelerometerCollector,u),window.removeEventListener("touchmove",this.a.touchCollector,u)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.r=u)},addEventListener:function(t,e){this.B[t][this.Y++]=e},removeEventListener:function(t,e){var n,i,o=this.B[t],a=[];for(i in o)o.hasOwnProperty(i)&&o[i]===e&&a.push(i);for(n=0;n<a.length;n++)delete o[i=a[n]]},ca:function(){E(1)},fa:function(t){var e,n;try{e=t.x||t.clientX||t.offsetX||0,n=t.y||t.clientY||t.offsetY||0}catch(t){n=e=0}0!=e&&0!=n&&sjcl.random.addEntropy([e,n],2,"mouse"),E(0)},ha:function(t){t=t.touches[0]||t.changedTouches[0],sjcl.random.addEntropy([t.pageX||t.clientX,t.pageY||t.clientY],1,"touch"),E(0)},da:function(){E(2)},W:function(t){if(t=t.accelerationIncludingGravity.x||t.accelerationIncludingGravity.y||t.accelerationIncludingGravity.z,window.orientation){var e=window.orientation;"number"==typeof e&&sjcl.random.addEntropy(e,1,"accelerometer")}t&&sjcl.random.addEntropy(t,2,"accelerometer"),E(0)}},sjcl.random=new sjcl.prng(6);t:try{var F,G,H,I;if(I="undefined"!=typeof module){var J;if(J=module.exports){var K;try{K=require("crypto")}catch(t){K=null}J=(G=K)&&G.randomBytes}I=J}if(I)F=G.randomBytes(128),F=new Uint32Array(new Uint8Array(F).buffer),sjcl.random.addEntropy(F,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(H=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(H);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break t;window.msCrypto.getRandomValues(H)}sjcl.random.addEntropy(H,1024,"crypto['getRandomValues']")}}catch(t){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(t))}sjcl.json={defaults:{v:1,iter:1e3,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},aa:function(t,e,n,i){n=n||{},i=i||{};var o,a=sjcl.json,s=a.e({iv:sjcl.random.randomWords(4,0)},a.defaults);return a.e(s,n),n=s.adata,"string"==typeof s.salt&&(s.salt=sjcl.codec.base64.toBits(s.salt)),"string"==typeof s.iv&&(s.iv=sjcl.codec.base64.toBits(s.iv)),(!sjcl.mode[s.mode]||!sjcl.cipher[s.cipher]||"string"==typeof t&&100>=s.iter||64!==s.ts&&96!==s.ts&&128!==s.ts||128!==s.ks&&192!==s.ks&&256!==s.ks||2>s.iv.length||4<s.iv.length)&&q(new sjcl.exception.invalid("json encrypt: invalid parameters")),"string"==typeof t?(t=(o=sjcl.misc.cachedPbkdf2(t,s)).key.slice(0,s.ks/32),s.salt=o.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.publicKey&&(o=t.kem(),s.kemtag=o.tag,t=o.key.slice(0,s.ks/32)),"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof n&&(s.adata=n=sjcl.codec.utf8String.toBits(n)),o=new sjcl.cipher[s.cipher](t),a.e(i,s),i.key=t,s.ct="ccm"===s.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&e instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(o,e,s.iv,n,s.ts):sjcl.mode[s.mode].encrypt(o,e,s.iv,n,s.ts),s},encrypt:function(t,e,n,i){var o=sjcl.json,a=o.aa.apply(o,arguments);return o.encode(a)},$:function(t,e,n,i){n=n||{},i=i||{};var o,a,s=sjcl.json;return o=(e=s.e(s.e(s.e({},s.defaults),e),n,!0)).adata,"string"==typeof e.salt&&(e.salt=sjcl.codec.base64.toBits(e.salt)),"string"==typeof e.iv&&(e.iv=sjcl.codec.base64.toBits(e.iv)),(!sjcl.mode[e.mode]||!sjcl.cipher[e.cipher]||"string"==typeof t&&100>=e.iter||64!==e.ts&&96!==e.ts&&128!==e.ts||128!==e.ks&&192!==e.ks&&256!==e.ks||!e.iv||2>e.iv.length||4<e.iv.length)&&q(new sjcl.exception.invalid("json decrypt: invalid parameters")),"string"==typeof t?(t=(a=sjcl.misc.cachedPbkdf2(t,e)).key.slice(0,e.ks/32),e.salt=a.salt):sjcl.ecc&&t instanceof sjcl.ecc.elGamal.secretKey&&(t=t.unkem(sjcl.codec.base64.toBits(e.kemtag)).slice(0,e.ks/32)),"string"==typeof o&&(o=sjcl.codec.utf8String.toBits(o)),a=new sjcl.cipher[e.cipher](t),o="ccm"===e.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&e.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(a,e.ct,e.iv,e.tag,o,e.ts):sjcl.mode[e.mode].decrypt(a,e.ct,e.iv,o,e.ts),s.e(i,e),i.key=t,1===n.raw?o:sjcl.codec.utf8String.fromBits(o)},decrypt:function(t,e,n,i){var o=sjcl.json;return o.$(t,o.decode(e),n,i)},encode:function(t){var e,n="{",i="";for(e in t)if(t.hasOwnProperty(e))switch(e.match(/^[a-z0-9]+$/i)||q(new sjcl.exception.invalid("json encode: invalid property name")),n+=i+'"'+e+'":',i=",",typeof t[e]){case"number":case"boolean":n+=t[e];break;case"string":n+='"'+escape(t[e])+'"';break;case"object":n+='"'+sjcl.codec.base64.fromBits(t[e],0)+'"';break;default:q(new sjcl.exception.bug("json encode: unsupported type"))}return n+"}"},decode:function(t){(t=t.replace(/\s/g,"")).match(/^\{.*\}$/)||q(new sjcl.exception.invalid("json decode: this isn't json!")),t=t.replace(/^\{|\}$/g,"").split(/,/);var e,n,i={};for(e=0;e<t.length;e++)(n=t[e].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i))||q(new sjcl.exception.invalid("json decode: this isn't json!")),null!=n[3]?i[n[2]]=parseInt(n[3],10):null!=n[4]?i[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(n[4]):unescape(n[4]):null!=n[5]&&(i[n[2]]="true"===n[5]);return i},e:function(t,e,n){if(t===s&&(t={}),e===s)return t;for(var i in e)e.hasOwnProperty(i)&&(n&&t[i]!==s&&t[i]!==e[i]&&q(new sjcl.exception.invalid("required parameter overridden")),t[i]=e[i]);return t},ja:function(t,e){var n,i={};for(n in t)t.hasOwnProperty(n)&&t[n]!==e[n]&&(i[n]=t[n]);return i},ia:function(t,e){var n,i={};for(n=0;n<e.length;n++)t[e[n]]!==s&&(i[e[n]]=t[e[n]]);return i}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.ga={},sjcl.misc.cachedPbkdf2=function(t,e){var n,i=sjcl.misc.ga;return n=(e=e||{}).iter||1e3,(n=(i=i[t]=i[t]||{})[n]=i[n]||{firstSalt:e.salt&&e.salt.length?e.salt.slice(0):sjcl.random.randomWords(2,0)})[i=e.salt===s?n.firstSalt:e.salt]=n[i]||sjcl.misc.pbkdf2(t,i,e.iter),{key:n[i].slice(0),salt:i.slice(0)}};